<!-- 变更日志
v1 2026-02-16: 初稿
-->

# ch01 绪论

## 学习目标

完成本章学习后，读者应能够：

1. 说明《水网预测控制》在 CHS 体系中的定位与与 M1 的衔接关系；
2. 理解模型预测控制（Model Predictive Control, MPC）在水网调度中的核心价值；
3. 区分“离线优化最优”与“在线可运行最优”的工程差异；
4. 描述胶东调水与梯级水电场景下 MPC 的共性与差异；
5. 识别本书后续章节的技术主线与学习路径。

> 本章承接《明渠水动力降阶建模》（M1）结论：降阶模型（Reduced-Order Model, ROM）解决“可实时计算”的模型底座问题；本书进一步解决“如何基于该底座进行预测—优化—执行闭环控制”。

## 为什么是模型预测控制

传统 PID/规则控制在单变量、弱约束场景下有效，但面对多目标、多约束、长时滞的水网系统时，常出现“局部稳定但全局代价偏高”的问题。MPC 的核心优势在于：在每个控制时刻显式求解约束优化问题，以预测时域 $T_p$ 内的系统行为最小化目标函数 $J$，并仅执行首个控制量，再滚动更新。

[物理直觉] 调度员并不是只看“当前水位是否合格”，而是会预判未来若干小时来水、需水和设备约束后再决策。MPC 把这种“前瞻调度”形式化、可计算化。

## 水网MPC问题的标准表述

在离散时域 $k$，水网预测控制可写为：

$$
\min_{\mathbf{u}_{k:k+N_c-1}} J=\sum_{i=1}^{N_p}\left(\|\mathbf{y}_{k+i}-\mathbf{y}_{k+i}^{ref}\|_{Q_y}^2+\|\Delta \mathbf{u}_{k+i-1}\|_{R_u}^2\right)
$$

约束包括：

- 动态约束：$\mathbf{x}_{k+1}=f(\mathbf{x}_k,\mathbf{u}_k)$；
- 物理约束：闸门开度、泵站功率、库容上下限；
- 安全约束：安全包络（Safety Envelope）与运行设计域（Operational Design Domain, ODD）；
- 运维约束：控制动作变化率、通信与计算延时上限。

[工程解释] 在工程部署中，约束建模质量往往比单纯提升预测精度更决定系统可用性。

[图1-1: 水网MPC闭环框架]
{描述: 包含“状态估计—预测模型—滚动优化—执行机构—在线监测—异常回退”的闭环流程。}
{尺寸: 全页}
{颜色方案: 蓝色系}

## 典型应用场景与挑战

### 1.4.1 胶东调水场景

长距离明渠系统以“供水稳定 + 水位约束 + 运行能耗”协同优化为目标，难点在于传播时滞显著、边界扰动频繁、季节参数时变。

### 1.4.2 梯级水电场景

梯级水电系统强调“发电收益 + 防洪安全 + 生态流量”多目标平衡，难点在于多库耦合、上下游强关联与突发工况响应。

[表1-1: 两类场景MPC建模差异]
{描述: 对比目标函数、主要约束、时间尺度、控制变量、风险关注点。}
{尺寸: 半页}
{颜色方案: 灰度}

## 可复现实例：单渠段滚动预测控制入门

【例1-1】某渠段采用 10 min 采样，预测时域 $T_p=12$，控制时域 $T_c=4$。在一次边界来水波动中，目标为保持断面水位偏差不超过 $\pm0.10$ m，且闸门开度变化率受限。

**已知**：
- ROM 预测误差标准差约 0.03 m；
- 闸门动作上限每步 3%；
- 若连续两步超限则触发保守回退策略。

**求解**：说明为何需要 $T_p>T_c$ 且动作率约束必须并入优化问题。

**解题过程**：
1. $T_p>T_c$ 可使控制器“看得更远、动得更稳”，避免短视振荡；
2. 动作率约束可抑制执行机构频繁抖动并降低运维负担；
3. 将超限触发条件与回退逻辑联动，可保障异常工况下的安全连续运行。

**结果讨论**：
该案例体现 MPC 的工程本质：不是追求某一步最优，而是在约束下实现长期可运行最优。

## 本书结构导读

- ch02：MPC 基本理论与可行性、稳定性基础；
- ch03-ch04：线性/非线性 MPC 在明渠与管网中的建模实现；
- ch05-ch08：分布式、鲁棒、经济型与自适应 MPC；
- ch09-ch10：安全约束集成与实时计算优化；
- ch11-ch12：胶东调水与沙坪梯级工程实践。

## 本章小结

本章明确了《水网预测控制》的问题边界与方法主线：在 ROM 可实时计算底座上，通过模型预测控制（MPC）将“预测—优化—执行”闭环化，并把物理、安全、运维约束统一纳入同一决策框架。与传统控制相比，MPC 的核心价值不在“公式更复杂”，而在“能以可审计方式处理多目标、多约束、长时滞工程问题”。下一章将系统展开 MPC 的数学基础与可行性条件。

## 习题

### 基础题

**1-1.** 为什么水网调度中“约束处理能力”比“单点预测精度”更关键？
**1-2.** 解释预测时域 $T_p$ 与控制时域 $T_c$ 的功能差异。
**1-3.** 结合工程实践，说明滚动优化“只执行首个控制量”的意义。

### 应用题

**1-4.** 设计一个明渠场景的 MPC 目标函数，至少包含水位跟踪项、控制平滑项与安全惩罚项。  
**1-5.** 给定闸门动作上限与通信延时约束，构造一个可执行的上线门禁清单。

### 思考题

**1-6.** 当调度团队希望“快响应”，运维团队希望“少动作”时，你如何设计算法权重与治理流程？

### 基础题参考答案要点

**1-7.** 因上线系统首先要可安全运行，约束违背会直接造成风险；精度提升需在约束满足前提下讨论。  
**1-8.** $T_p$ 决定前瞻能力，$T_c$ 决定可调动作窗口；通常 $T_p\ge T_c$。  
**1-9.** 可提升鲁棒性并利用新测量持续纠偏，降低模型失配累积风险。

## 拓展阅读

1. **Rawlings, J.B., Mayne, D.Q. & Diehl, M. (2017). *Model Predictive Control: Theory, Computation, and Design*.**
2. **Van Overloop, P.J. (2006). *Model Predictive Control on Open Water Systems*.**
3. **Litrico, X. & Fromion, V. (2009). *Modeling and Control of Hydrosystems*.**
4. **ASCE (2014). *MOP 131: Canal Automation for Irrigation Systems*.**
5. **Lei et al. (2025a). 理论背景与研究范式。**
