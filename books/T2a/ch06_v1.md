<!-- 变更日志
v1 2026-02-16: 初稿
-->

# 第六章 现代控制方法

---

## 学习目标

完成本章后，你应能够：

1. 在状态空间框架下表达水系统动态并解释各矩阵物理意义；
2. 掌握 LQR/LQG 的基本思想与工程调参路径；
3. 理解 H∞ 鲁棒控制的目标及其在不确定工况下的价值；
4. 说明自适应控制在参数时变场景中的适用边界；
5. 将现代控制与 ODD/Safety Envelope、在环测试流程联动。

> **章首衔接（承接ch05）**  
> 上一章建立了经典控制“可上线底座”。本章在此基础上进入状态空间与优化视角，形成从 PID 到 LQR/LQG、鲁棒控制与自适应控制的能力升级路径。

## 6.1 状态空间建模与工程解释

[物理直觉] 复杂水系统可由少量“关键状态”刻画其动态演化，控制目标是在约束下让状态沿着可接受轨迹运行。

[公式]
\[
\dot{\mathbf{x}}=\mathbf{A}\mathbf{x}+\mathbf{B}\mathbf{u}+\mathbf{E}\mathbf{d},\quad
\mathbf{y}=\mathbf{C}\mathbf{x}
\]

[工程解释] \(\mathbf{A}\) 反映内在动力学，\(\mathbf{B}\) 反映执行器作用效率，\(\mathbf{E}\) 表示扰动注入通道。该形式为 LQR/LQG 与鲁棒控制提供统一入口。

[表6-1: 状态空间变量与工程映射]
| 符号 | 含义 | 工程示例 |
|---|---|---|
| \(\mathbf{x}\) | 状态向量 | 水位、流量、库容、估计扰动 |
| \(\mathbf{u}\) | 控制输入 | 闸门开度、泵速、机组负荷 |
| \(\mathbf{d}\) | 外部扰动 | 来水波动、负荷变化、效率衰减 |
| \(\mathbf{y}\) | 可测输出 | 关键断面流量、液位、压力 |

## 6.2 LQR：最优状态反馈

LQR 通过最小化二次型代价函数实现“性能—动作代价”平衡：
\[
J=\int_0^{\infty}(\mathbf{x}^T\mathbf{Q}\mathbf{x}+\mathbf{u}^T\mathbf{R}\mathbf{u})dt
\]

[工程解释] 增大 \(\mathbf{Q}\) 权重可强化状态跟踪，增大 \(\mathbf{R}\) 权重可抑制执行器动作强度。工程整定通常先保守设置 \(\mathbf{R}\)，再逐步提高 \(\mathbf{Q}\) 关键分量。

## 6.3 LQG：最优估计与最优控制结合

当状态不可全测时，需以 Kalman 滤波估计状态并与 LQR 结合形成 LQG。其优势是可在测量噪声与模型扰动下保持稳定控制性能。

[图6-1: LQG结构示意（估计器+状态反馈）]
{描述: 左侧对象与扰动，中部Kalman估计器，右侧LQR反馈器，底部标注噪声协方差与权重矩阵调参接口。}
{尺寸: 全页}
{颜色方案: 蓝色系}
{对应ARCH编号: 无（本章自定义教学图）}

## 6.4 H∞ 鲁棒控制

H∞ 控制关注最坏情形下闭环传递增益上界，适用于参数不确定性和扰动强的场景。与 LQR 相比，其目标更偏“保底稳定与鲁棒性能”。

[工程解释] 当工况跨季节变化显著、模型误差难以准确统计时，H∞ 常比单纯最优控制更稳健，但调参复杂度更高。

## 6.5 自适应控制

自适应控制通过在线参数更新应对时变对象，典型场景包括设备老化、工况迁移和长期漂移。实施时必须设置参数变化率边界与稳定性监视器，防止“过快自适应”引发振荡。

[表6-2: 现代控制方法对比]
| 方法 | 优势 | 风险 | 适用场景 |
|---|---|---|---|
| LQR | 结构清晰，调参直观 | 依赖状态可得性 | 线性近似有效、约束中等 |
| LQG | 可处理噪声与不可测状态 | 协方差失配会降性能 | 传感噪声显著场景 |
| H∞ | 最坏情形鲁棒性强 | 设计复杂、保守性可能偏高 | 不确定性强场景 |
| 自适应控制 | 可在线适配时变对象 | 参数漂移风险 | 长周期工况变化 |

[图6-2: 现代控制上线门禁流程]
{描述: 展示“模型校核→控制器设计→约束联锁验证→在环测试→分级上线”的闭环流程，并标注失败回退路径。}
{尺寸: 半页}
{颜色方案: 蓝色系}
{对应ARCH编号: ARCH-06（流程思想借鉴）}

## 6.6 例题：LQR权重整定与上线判定

【例6-1】某调水节点采用状态反馈控制，目标是“液位波动最小且闸门动作平滑”。请给出 LQR 权重整定与上线判定步骤。

**已知**：
- 状态变量包含液位偏差与流量偏差；
- 执行器存在速率与幅值约束；
- ODD 边界与 Safety Envelope 已定义。

**解题过程**：

步骤1：先设置保守 \(\mathbf{R}\) 抑制动作，确保不触发执行器饱和。  
步骤2：逐步提高 \(\mathbf{Q}\) 中液位偏差权重，观察峰值误差变化。  
步骤3：在在环测试中检查越界率、恢复时间与动作平滑性。  
步骤4：若越界率上升或动作过快，回调权重并收缩 ODD 上线范围。

**结果讨论**：

LQR 整定不是一次求解，而是“目标—约束—验证”迭代过程。上线应遵循“小范围、可回退、可审计”原则。

### 现代控制上线检查清单

- [ ] 是否完成状态空间模型与参数版本归档；
- [ ] 是否校核 ODD 与 Safety Envelope 联锁一致性；
- [ ] 是否完成在环测试并记录关键KPI；
- [ ] 是否定义失效降级路径（回退至经典控制/人工接管）；
- [ ] 是否完成分级上线与审计留痕。

## 6.7 本章小结

本章建立了现代控制方法的工程应用框架：以状态空间为统一语言，LQR/LQG 提供最优控制与估计协同，H∞ 提供不确定性保底能力，自适应控制应对时变工况。下一章将进入模型预测控制（MPC），在显式约束下实现滚动优化控制。

## 习题

### 基础题

1. 解释 \(\mathbf{A},\mathbf{B},\mathbf{C}\) 矩阵在工程中的含义。  
2. LQR 中 \(\mathbf{Q}\) 与 \(\mathbf{R}\) 权重分别影响什么？  
3. 为什么 LQG 需要估计器与控制器协同设计？

### 应用题

4. 为某泵站系统设计一套 LQR 初始整定策略，并说明如何在在环测试中修正。  
5. 在参数不确定性显著场景下，比较 LQR 与 H∞ 的上线策略差异。

### 思考题

6. 当自适应控制与安全约束发生冲突时，应如何设置“学习速度”与“安全优先级”？

## 拓展阅读

1. Anderson, B.D.O., & Moore, J.B. *Optimal Control: Linear Quadratic Methods*.  
2. Zhou, K., Doyle, J.C., & Glover, K. *Robust and Optimal Control*.  
3. Litrico, X., & Fromion, V. *Modeling and Control of Hydrosystems*.  
4. 钱学森. 《工程控制论》.  
5. Lei et al. (2025a). 理论背景与研究范式。
