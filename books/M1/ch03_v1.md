<!-- 变更日志
v1 2026-02-16: 初稿
-->

# 第三章 传递函数模型

---

## 学习目标

完成本章后，你应能够：

1. 从线性化 Saint-Venant 方程的输入输出关系出发构建传递函数模型；
2. 解释增益、时滞、时间常数在明渠控制中的物理含义；
3. 掌握 FOPDT/SOPDT 结构在明渠渠段建模中的适用边界；
4. 完成基于阶跃试验数据的传递函数参数辨识；
5. 评估传递函数模型在 Model Predictive Control (MPC) 与 Hierarchical Distributed Control (HDC) 中的可用性。

## 3.1 章间衔接：从传播机理到输入输出表示

上一章给出了两条关键结论：其一，扰动沿特征线传播并形成可测传输延时 $\tau$；其二，波动在实际渠段中会受到摩阻与边界条件影响而衰减。上述机理结论并不直接等价于控制器可用模型，因此本章要把“传播机理”转写为“输入输出动态”。

[物理直觉] 调度系统关注的问题通常是“上游闸门开度变化后，下游水位多久响应、幅值多大、是否超调”。这正是传递函数模型最擅长回答的问题。

## 3.2 传递函数模型的工程定义

传递函数（Transfer Function）用于描述线性时不变系统在频域中的输入输出映射：

$$
G(s)=\frac{Y(s)}{U(s)}
$$

其中 $U(s)$ 为控制输入（如闸门开度或目标流量修正量），$Y(s)$ 为输出（如控制断面水位 $h$ 或流量 $Q$）。

[工程解释] 对明渠系统而言，传递函数不是“纯数学形式”，其参数可与物理机理一一对应：

- **静态增益 $K$**：输入单位变化引起的稳态输出变化；
- **时间常数 $T$**：系统主导惯性；
- **传输延时 $\tau$**：波传播与执行链路延迟的合成结果；
- **阻尼特性**：反映多模态耦合与波反射效应。

[表3-1: 传递函数参数—物理意义—工程获取方式对照]
{描述: 三列表，列1参数K/T/tau/zeta，列2物理解释，列3从试验数据获取的方法。}
{尺寸: 半页}
{颜色方案: 灰度}

## 3.3 明渠常用结构：FOPDT 与 SOPDT

### 3.3.1 一阶惯性纯滞后（FOPDT）

在单主导模态、弱反射、弱耦合渠段，常采用：

$$
G(s)=\frac{K e^{-\tau s}}{Ts+1}
$$

[工程解释] 当目标是在线优化与快速调参时，FOPDT 结构具有参数少、可解释性强、对工程人员友好等优势。

### 3.3.2 二阶惯性纯滞后（SOPDT）

若存在明显超调或双时标过程，可采用：

$$
G(s)=\frac{K e^{-\tau s}}{(T_1s+1)(T_2s+1)}
$$

或阻尼标准型：

$$
G(s)=\frac{K\omega_n^2 e^{-\tau s}}{s^2+2\zeta\omega_n s+\omega_n^2}
$$

[工程解释] SOPDT 可以更好描述“主波到达+次级反射”现象，但参数辨识难度明显上升，且对数据质量更敏感。

## 3.4 参数辨识流程：从时域试验到频域校核

为保证模型可复现、可审计，推荐采用“时域初识别 + 频域一致性检查”的双阶段流程：

1. 设计边界小扰动试验（幅值控制在 ODD 安全范围）；
2. 采集输入 $u(t)$ 与输出 $y(t)$，执行异常点清洗；
3. 通过阶跃响应估算 $K,\tau,T$ 初值；
4. 使用最小二乘或预测误差法细化参数；
5. 在 Bode 图或频响点上做一致性核查；
6. 输出可上线版本并附回退参数包。

[图3-1: 传递函数辨识与上线门禁流程]
{描述: 从试验设计、参数初值、优化辨识、频域校核到上线审批的流程图，含ODD与Safety Envelope门禁节点。}
{尺寸: 全页}
{颜色方案: 蓝色系}
{对应ARCH编号: ARCH-07}

## 3.5 与降阶模型族的关系

传递函数模型在 M1 中并非终点，而是后续 IDZ 与 Muskingum 类模型的比较基准：

- 与 IDZ 相比：传递函数更通用，IDZ 更强调明渠积分特性；
- 与 Muskingum 类相比：传递函数更直接用于控制器设计，Muskingum 在水文调洪语境中更常用；
- 与数据驱动 ROM 相比：传递函数外推性较稳健，但复杂非线性场景拟合能力有限。

这也是本书采用“机理—传函—IDZ—数据驱动”递进结构的原因：先用可解释模型建立稳定基线，再引入更强表达能力的方法。

## 3.6 可复现实例：单渠段 FOPDT 辨识

【例3-1】某控制渠段实施闸门开度小阶跃，稳态前后输出水位变化量分别为：输入变化 $\Delta u=0.08$（归一化），输出变化 $\Delta h=0.024\,\text{m}$。响应曲线显示：10% 起始响应在 420 s，63.2% 响应点在 1420 s，最终稳态近似在 2600 s。

**已知**：
- 小扰动近似成立；
- 无明显二次反射峰；
- ODD 允许水位偏差门限为 $\pm0.06\,\text{m}$。

**求解**：估算 FOPDT 参数并判断是否可进入控制仿真。

**解题过程**：

步骤1：静态增益
$$
K=\frac{\Delta h}{\Delta u}=\frac{0.024}{0.08}=0.30
$$

步骤2：传输延时近似取起始响应时刻
$$
\tau\approx 420\,\text{s}
$$

步骤3：一阶时间常数由 63.2% 点估计
$$
T\approx 1420-420=1000\,\text{s}
$$

步骤4：模型写成
$$
G(s)=\frac{0.30e^{-420s}}{1000s+1}
$$

步骤5：检查输出幅值约束。阶跃幅值下稳态变化约为 0.024 m，小于 0.06 m 门限。

**结果讨论**：

该模型满足 ODD 范围内的稳态约束，可进入 MPC 仿真与 In-the-Loop Testing。若后续发现频域偏差集中在高频段，可通过加入二阶极点或局部数据校正模块改进。

[图3-2: 阶跃响应与FOPDT拟合曲线]
{描述: 同图展示实测响应、FOPDT拟合响应、63.2%标记点和tau起始点。}
{尺寸: 半页}
{颜色方案: 蓝色系}

## 3.7 与国际工作的系统对比

国际文献普遍采用传递函数作为明渠控制起点，差异主要在于“模型是否仅服务控制算法论文”，还是“服务工程全生命周期”。CHS 路线强调第二种：模型不仅要在论文数据集上表现良好，还要在检修、季节切换、策略回退等运维场景中可持续运行。

因此，本书将传递函数明确嵌入“ODD + Safety Envelope + In-the-Loop Testing + 回退机制”治理框架。这一要求使得模型交付物不再是单一参数集，而是“参数 + 适用边界 + 失效判据 + 回退策略”的组合。

## 3.8 本章小结

本章完成了从传播机理到输入输出动态的关键过渡：定义了传递函数在明渠控制中的工程含义，给出了 FOPDT/SOPDT 两类常用结构及其适用边界，并通过可复现实例演示了参数辨识与上线前校核流程。结论是：传递函数模型是 ROM 体系中的“可解释基线模型”，尤其适合在线控制与工程运维协同。下一章将进一步讨论 IDZ 模型，说明其在积分特性显著渠段中的优势与与传函模型的互补关系。

## 习题

### 基础题

1. 传递函数模型中的 $K, T, \tau$ 分别代表什么物理意义？  
2. 为什么 FOPDT 常被用于明渠控制的首选模型？  
3. 在什么工况下应考虑从 FOPDT 升级到 SOPDT？

### 应用题

4. 某渠段辨识得到 $K=0.42, T=780\,\text{s}, \tau=260\,\text{s}$。当输入阶跃幅值为 0.05 时，估算稳态输出变化并判断是否满足 $\pm0.03\,\text{m}$ 门限。  
5. 给定一段含噪声阶跃试验数据，设计完整辨识流程（含去噪、初值、优化与验证指标），并说明每一步可能失败原因。

### 思考题

6. 若同一渠段在夏季和冬季辨识到的 $T$ 差异超过 40%，你会采用“季节分模型”“在线自适应”还是“统一模型+补偿项”？请给出工程化权衡。

## 拓展阅读

1. Litrico, X. & Fromion, V. (2009). *Modeling and Control of Hydrosystems*.  
2. Van Overloop, P. J. (2006). *Model Predictive Control on Open Water Systems*.  
3. ASCE (2014). *MOP 131: Canal Automation for Irrigation Systems*.  
4. Schuurmans, J. et al. (1999). Control-oriented models for canals.  
5. Lei et al. (2025b). 自主智能水网架构。
