<!-- 变更日志
v2 2026-02-16: 根据四角色评审修订——补充术语一致性声明与基础题答案要点，增强教学与工程一致性
v1 2026-02-16: 初稿
-->

# 第八章 优化理论与方法

---

## 学习目标

完成本章后，你应能够：

1. 理解线性规划、非线性规划与多目标优化在水系统中的定位；
2. 建立含约束的优化问题并解释可行域与最优解关系；
3. 区分确定性优化与随机优化在不确定工况下的适用边界；
4. 理解进化算法在复杂非凸问题中的作用与局限；
5. 将优化算法选择与MPC求解实时性、安全约束和工程可审计性联动。

> **章首衔接（承接ch07）**  
> 上一章给出MPC滚动优化控制框架。本章聚焦“优化器本身”：不同算法如何影响解算速度、最优性与上线稳定性，并为后续章节求解器部署提供方法论。

> **前章回顾**：上一章介绍了本领域的核心概念与方法。本章在此基础上进一步展开。


## 水系统优化问题的一般形式

[物理直觉] 调度与控制本质是“在约束内做最优权衡”：既要满足安全与供水刚性约束，又要尽量降低能耗、波动和运行代价。

[公式]
\[
\min_{\mathbf{z}}\;J(\mathbf{z})\quad
\text{s.t.}\;\mathbf{g}(\mathbf{z})\le 0,\;\mathbf{h}(\mathbf{z})=0
\]

[工程解释] \(\mathbf{z}\) 可表示控制序列、流量分配或设备负荷；不等式约束对应安全包络与执行器边界，等式约束对应质量守恒与网络平衡。

[表8-1: 目标函数与工程指标映射]
| 目标项 | 常见表达 | 工程意义 |
|---|---|---|
| 跟踪性能 | 偏差平方和 | 供水稳定/液位稳定 |
| 能耗代价 | 功率或电费加权和 | 降低运行成本 |
| 动作平滑 | 控制增量惩罚 | 降低设备磨损 |
| 风险惩罚 | 越界代价项 | 提升安全裕度 |

## 线性与非线性规划

### 8.2.1 线性规划（LP）

当目标与约束可线性化时，LP具有求解快、鲁棒性高的优势，适合大规模在线调度的基线方案。

### 8.2.2 非线性规划（NLP）

当系统存在显著非线性（泵效率曲线、闸门特性、非线性水力关系）时，NLP可提升建模真实性，但求解复杂度更高，需关注局部最优和收敛稳定性。

[表8-2: LP/NLP工程对比]
| 方法 | 优势 | 主要风险 | 适用场景 |
|---|---|---|---|
| LP | 速度快、稳定 | 线性化误差 | 在线快速调度 |
| NLP | 模型更真实 | 计算慢、局部最优 | 非线性显著场景 |

## 多目标优化

水系统通常需同时优化“安全、供水、能耗、设备寿命”。常用方法包括加权和法、分层优先法与 Pareto 前沿分析。

[工程解释] 在工程上线中，建议先用分层优先法保证安全约束不可妥协，再在可行域内优化能耗与平滑性。

[图8-1: 多目标优化的Pareto前沿示意]
{描述: 横轴为能耗代价，纵轴为跟踪误差，展示Pareto前沿与可行不可行区域，标注安全优先筛选点。}
{尺寸: 半页}
{颜色方案: 蓝色系}
{对应ARCH编号: ARCH-07（安全优先思想借鉴）}

## 随机优化与不确定性处理

在来水预测、需求预测存在不确定性时，可采用随机优化或情景优化：

1. 生成代表性扰动情景集；
2. 对多情景联合优化；
3. 评估最坏情形约束违例率。

[工程解释] 情景数量并非越多越好，需在覆盖度与计算时限间平衡，避免“模型完美但解算超时”。

## 进化算法与启发式方法

遗传算法、粒子群等进化算法适合非凸、多峰、不可导问题，常用于离线优化或参数寻优。其优点是全局搜索能力较强，缺点是实时性与可重复性较弱。

[图8-2: 优化方法选择决策树]
{描述: 根据“线性程度、约束复杂度、实时性要求、可解释性要求”分支，输出LP/NLP/随机优化/进化算法建议。}
{尺寸: 全页}
{颜色方案: 蓝色系}
{对应ARCH编号: 无（本章自定义教学图）}

## 例题：供水调度的多目标优化建模

【例8-1】某区域供水系统需在24小时内完成“供水偏差最小、能耗最低、闸门动作平滑”三目标优化。请给出问题建模与求解策略。

**已知**：
- 安全包络给出水位和流量上下限；
- 电价分时变化；
- 扰动预测存在不确定性。

**解题过程**：

步骤1：建立多目标代价函数并采用分层优先策略（安全>供水>能耗）。  
步骤2：将硬约束写入 \(\mathcal{X}_{safe}\subseteq\mathcal{X}_{ODD}\) 与执行器约束集合。  
步骤3：先用LP/NLP获得基线解，再用情景优化评估不确定性鲁棒性。  
步骤4：若在线计算超时，切换到简化模型与保守权重。

**结果讨论**：

优化建模的关键不是“写出复杂目标”，而是保证约束可执行、求解可实时、结果可审计。

### 优化上线检查清单

- [ ] 是否明确硬约束与软约束优先级；
- [ ] 是否验证求解时间满足采样周期要求；
- [ ] 是否完成不确定性情景覆盖度评估；
- [ ] 是否定义求解失败时的保守回退策略；
- [ ] 是否记录算法版本、参数与审计日志。

## 本章小结

本章系统讨论了水系统优化的主要方法：LP/NLP、多目标优化、随机优化与进化算法。核心结论是：算法优劣必须放在“约束可执行+实时可解+风险可控”三维框架下评估。下一章将进入可控性与可观性分析，为控制结构配置提供理论依据。

## 习题

### 基础题

**8-1.** 区分硬约束与软约束，并举例说明。  
**8-2.** 为什么LP常作为在线调度的基线方法？  
**8-3.** 多目标优化中Pareto前沿表示什么含义？

### 基础题参考答案要点

**8-4.** 硬约束不可违反（如安全水位上限），软约束可通过惩罚项折中（如经济性指标）。  
**8-5.** LP计算稳定且速度快，适合在线周期性求解与大规模调度。  
**8-6.** Pareto前沿表示在多目标下互不支配的最优折中解集合。

### 应用题

**8-7.** 为某泵站群写出一个“供水偏差+能耗+动作平滑”的多目标优化结构化表达。  
**8-8.** 某NLP求解耗时过长，请提出两种降复杂度策略并分析代价。

### 思考题

**8-9.** 在“全局最优性”与“实时可执行性”冲突时，你会如何制定工程上线优先级？

## 拓展阅读

1. Boyd, S., & Vandenberghe, L. *Convex Optimization*.
2. Nocedal, J., & Wright, S. *Numerical Optimization*.
3. Rawlings, J.B., Mayne, D.Q., & Diehl, M. *Model Predictive Control*.
4. Van Overloop, P.J. *MPC on Open Water Systems*.
5. Lei et al. (2025a). 理论背景与研究范式。
