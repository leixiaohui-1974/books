# 水系统运行科学与工程：学科基础、技术演进与未来展望

## 前言

水是人类文明的命脉，水利工程是社会运转的基础设施。当今世界拥有约58,000座大坝、数百万公里的灌溉渠系和输配水管网，构成了人类改造自然、保障发展的宏大基础设施网络。然而，一个日益严峻的问题正在浮现：我们建造了越来越多、越来越复杂的水利工程，却尚未从根本上解决"如何让这些工程更加智能、高效、安全地运行"这一核心问题。

传统的水利工程运行管理高度依赖人工经验。在小型、单一功能的工程中，经验丰富的调度员尚可胜任；但面对跨越数百甚至上千公里的长距离输水工程、涉及数百个控制节点的复杂水网系统、以及极端气候事件日益频发的严峻现实，传统的"人盯人（round-the-clock manual monitoring where human operators watch control screens continuously）"运行模式正遭遇前所未有的挑战。全球范围内，水利基础设施面临着气候变化加剧和设施老化的双重压力，亟需运行管理模式的根本性变革。

这一变革的迫切性可以从几个维度来理解。第一，复杂性维度。以中国南水北调（South-to-North Water Diversion Project, SNWDP）中线工程为例，全长1432公里的总干渠上布设了数百个控制闸门，任何一个闸门的调整都会通过水波传播影响上下游数百公里范围内的水力状态，而这种影响的到达时间可能长达数小时甚至数天。要在如此大时空尺度上实现精确控制，远非人工经验所能胜任——它需要基于精确数学模型的系统性优化方法。第二，不确定性维度。气候变化正在改变水文过程的统计特性——极端降雨更加频繁、冰期规律更加难以预测、水源来水的年际波动更加剧烈。传统基于历史经验的调度规则在新的水文统计特征下可能失效，需要能够在线学习和自适应调整的智能方法。第三，效率维度。

全球范围内，灌溉水利用系数平均约为0.45（据FAO 2020年数据），即超过一半的灌溉用水在输送过程中损失。

中国的灌溉水利用系数约为0.57（据水利部《2023年中国水资源公报》），虽高于全球平均水平，但与以色列的0.9相比仍有巨大提升空间[219]。城市供水管网的产销差率（包含物理漏损和商业损失）在发展中国家普遍超过30%（据IWA 2022年统计）。通过智能化的运行优化，这些效率损失在技术上是完全可以大幅减少的。第四，安全维度。水利工程是关乎国计民生的关键基础设施，运行失误可能导致洪水、断水等重大事故。随着工程规模和复杂度的增加，传统的"人盯人"安全保障模式的可靠性正在逐渐下降——人会疲劳、会走神、会犯错，而数百个控制节点24小时不间断运行的监控需求已经超出了人工能力的边界。

正是在这一背景下，一个新兴的交叉学科方向——"水系统运行科学与工程"——正在形成。这一学科以水系统控制论（Cybernetics of Hydro Systems, CHS）为理论内核，以水网操作系统（Water Network Operating System）（HydroOS）为技术载体，致力于推动水利工程从依赖人工经验的被动运行，走向依托智能技术的自主运行。

这一学科方向的形成，可以在更广阔的技术史脉络中找到参照。20世纪中叶以来，几乎所有关键基础设施领域都经历了从人工运行到自动化运行的转型：电力系统从人工调度发展为自动发电控制（AGC），化工过程从手动调节走向分布式控制系统（DCS），航空航天从人工驾驶演进为自动飞行控制。在这些领域，运行控制不仅仅是工程实践层面的技术改进，更催生了独立的学科分支——电力系统运行与控制、过程控制工程、飞行控制与导航等。这些学科分支共享一个基本范式：将领域物理知识与控制理论方法相结合，形成面向特定应用的系统化理论体系。水系统运行科学与工程正是这一范式在水利领域的延伸和实例化——其独特性在于水系统具有分布参数、长时延、强非线性和多目标冲突等独特的工程挑战，需要发展专门化的理论方法来应对。

本报告旨在系统梳理水系统运行科学与工程的学科基础、技术演进和未来展望，为关注这一领域的研究者、工程师和决策者提供一份全面的参考文献。报告分为四个部分：

**第一部分"学科的理论根基"**（第1.1-1.5节），梳理系统科学、控制科学、人工智能和信息物理系统等支撑学科的核心贡献。系统科学提供了认识水系统复杂性的认识论框架——涌现性、自组织性、跨尺度耦合等概念对于理解水网行为至关重要。控制科学提供了从"描述系统"到"改变系统"的方法论跨越——从经典PID到现代MPC，从集中式控制到分布式多智能体协同，控制理论的每一次范式转变都为水系统运行提供了新的技术可能。人工智能提供了从数据中提取知识并辅助决策的强大工具——从机器学习到深度学习再到大语言模型，AI技术的指数级进步正在重新定义水系统智能化的边界。信息物理系统（CPS）提供了将感知、计算、通信和控制融为一体的系统架构范式。这四大支撑学科的交汇，构成了水系统运行科学与工程的理论基础。

**第二部分"水系统运行的学科演进"**（第2.1-2.7节），回顾从古代水利实践到现代运行科学的发展历程。这一部分首先追溯水利自动化的早期实践——从古代都江堰的"被动自适应"到20世纪SCADA系统的"主动远程监控"；然后分析EMS五代框架所揭示的学科演进脉络——从人工经验到自动化再到模型驱动、数据驱动、最终走向自主运行；接着论述数字化转型对水利运行模式的深刻影响——物联网、云计算、数字孪生（Digital Twin）等技术正在重塑水利基础设施的运行方式。第二部分的核心章节详细阐述了渠道自动控制理论的发展、CHS理论框架的构建、HydroOS操作系统的架构设计，以及具有代表性的工程实践案例。

**第三部分"智慧水利（Smart Water Management）的历史、现状与挑战"**（第3.1-3.4节），分析国内外智慧水利建设的成就与不足。首先给出智慧水利从概念到学科的演进路径，然后分别从国际和国内两个视角审视智慧水利建设的进展与差距，最后深入分析市场格局碎片化、技术壁垒、数据孤岛和商业模式可持续性等深层挑战。

**第四部分"未来展望"**（第4.1-4.7节），描绘从自主运行分级到双AI融合、从HydroOS平台到在回路测试（X-in-the-Loop, xIL）体系的技术路线图。这一部分首先提出WSAL水网自主等级分级框架，为水系统自主运行提供目标牵引；然后论述物理AI与认知AI双引擎融合的技术路径；接着从HydroOS平台建设、xIL在回路测试体系、教材与专利布局等方面描绘具体的实施路径；最后以"第六次突破"为主题展望水系统运行科学与工程的长远未来。

本报告的写作遵循三个原则：第一，理论与实践并重，既有学科基础的系统梳理，也有工程案例的详细分析——理论部分力求准确反映各学科的核心思想和最新进展，工程案例部分力求真实呈现技术落地过程中的挑战和经验。第二，历史与未来兼顾，既回顾学科演进的历史脉络，也展望未来发展的技术路径——历史回顾不是学术考古，而是为了揭示技术演进的内在逻辑和规律性，从而为预判未来方向提供依据。第三，国内与国际结合，既立足中国水利工程的实际需求，也放眼全球水利科技的前沿动态——中国拥有世界上规模最大、类型最丰富的水利基础设施，这既是实践的沃土，也是理论创新的动力源泉。第四，批判性与建设性并举，在肯定已有成就的同时，也坦率指出面临的差距和挑战——真正推动学科进步的，不是回避问题，而是直面问题并提出有建设性的解决思路。

水系统运行科学与工程是一门正在形成中的学科，其理论框架和技术体系仍在快速发展。本报告所呈现的内容，既是对已有成果的系统总结，也是对未来发展的审慎展望。期望本报告能够为推动这一学科的建设和发展贡献一份力量。

### 为什么是"现在"？

回顾历史，水系统运行科学与工程的形成条件在近年来才真正成熟，这并非偶然。一方面，工程需求侧的压力在加速积累。中国在过去二十年间建成了世界上最大规模的跨流域调水工程群——南水北调东中线工程、引江济淮工程、胶东调水（Jiaodong Water Diversion Project）工程等——这些工程的运行复杂度远超传统的单体水利工程，迫切需要系统性的运行理论指导。另一方面，技术供给侧的能力在加速突破。传感器网络、5G通信、边缘计算、云平台等信息基础设施的成熟，为水系统的全面感知和实时计算提供了物质基础；模型预测控制（MPC）、深度强化学习、大语言模型等理论方法的突破，为水系统的智能决策提供了算法工具；开源软件生态、容器化部署、微服务架构等软件工程实践的成熟，为复杂系统的快速开发和灵活部署提供了工程手段。

需求与供给的双重成熟在这一时间节点上的交汇，使得水系统运行科学与工程从一个"理想概念"变为一个"可实践的学科"。

另一个重要的时代背景是人工智能技术的代际飞跃。2022年以来，以ChatGPT为代表的大语言模型引发了全社会对通用人工智能的高度关注。在水利领域，这一波AI浪潮的影响是双重的：一方面，它为水系统认知智能化提供了前所未有的技术可能——自然语言理解、多模态感知、常识推理等能力将极大地提升人机交互和决策辅助的水平；另一方面，它也带来了新的挑战——如何将大语言模型的通用智能与水利领域的专业知识深度融合，如何在保证安全性的前提下发挥AI的决策辅助作用，如何处理AI幻觉（hallucination）对安全关键系统的潜在威胁。这些问题的回答，需要一个系统性的理论框架——而这正是CHS理论试图提供的。

### 方法论说明

本报告的写作方法兼顾了文献综述的学术严谨性和技术报告的可读性。在文献基础方面，报告引用了超过200篇学术文献，涵盖水利工程、控制科学、人工智能、系统科学等多个领域的经典著作和前沿论文。在叙述方式方面，报告采用了"从一般到特殊、从历史到未来"的逻辑结构——先阐述支撑学科的一般性理论，再论述这些理论在水系统中的特殊化应用；先回顾学科的历史演进，再展望未来的发展方向。在专业术语方面，报告在首次出现时给出中英文对照和简要解释，核心术语在"关键术语说明"部分集中定义。在公式和模型方面，报告在必要时给出关键方程，但更注重物理意义的阐释而非数学推导的展开——详细的数学推导可参阅报告所引用的原始文献。

### 本报告的独特贡献

就作者所知，这是第一份试图将系统科学、控制科学、人工智能和水利工程四大学科板块置于统一视角下进行系统性梳理的中文综述报告。现有的水利信息化或智慧水利相关文献，大多从技术应用角度出发，侧重介绍某一类技术在水利领域的应用现状和案例——例如"人工智能在水文预报中的应用""物联网在水利监测中的实践"等。这些文献虽然有价值，但缺乏一个统一的理论框架来将这些散落的技术碎片组织为一个有内在逻辑的知识体系。

本报告试图提供这样一个统一框架。CHS理论的"六要素"架构（感知网络、可控模型族（Controllable Model Family）、控制器集合、执行系统、通信网络、人机界面）为水系统运行提供了一个完备的功能分解；WSAL的"六级"分级为水系统智能化演进提供了一个清晰的阶梯路径；HydroOS的"三层"架构（内核层、服务层、应用层）为水系统软件生态提供了一个开放的组织框架。这三套框架相互嵌套、互为支撑，共同构成了水系统运行科学与工程的核心骨架。

另一个独特贡献是本报告对"控制论视角"的坚持。当前AI热潮中，不少文献倾向于将水利智能化简单等同于"用深度学习替代传统方法"。本报告强调，在安全关键的水利基础设施中，物理模型的可解释性、控制理论的稳定性保障和系统工程的验证方法论，与数据驱动的AI能力同等重要甚至更加基础。"Physical AI+Cognitive AI"的双引擎架构（Dual-Engine Architecture）和xIL的系统化验证流程，体现了这种"安全第一、AI赋能"的技术哲学。这一立场在当前"AI万能论"的喧嚣中或许显得保守，但对于守护国家水基础设施的安全底线，这种保守恰恰是一种负责任的技术态度。

最后需要说明的是本报告的局限性。作为一份试图覆盖广泛学科领域的综述性文献，本报告不可避免地在某些专题的深度上有所取舍。对于感兴趣的读者，每一节的参考文献列表提供了进一步深入研究的入口。此外，水系统运行科学与工程是一个快速发展的领域，本报告反映的是截至撰写时点的认识水平——随着技术的进步和实践的积累，其中的部分观点和判断可能需要修正和更新。这也恰恰说明了持续追踪和更新的必要性，以及建立动态知识管理平台的重要性。

### 学科定位与报告范围

"水系统运行科学与工程"作为一个学科概念，其核心关切可以用一个简明的问题来概括：**水利工程"怎么建"已有成熟的理论体系，但"怎么运行好"还缺乏系统的学科支撑。

** 水力学解决了水流运动规律问题，水工结构学解决了工程安全问题，水文学解决了来水预测问题——但将这些知识整合为一个从"感知"到"决策"再到"执行"的完整闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）运行体系，长期以来缺乏统一的理论框架和技术范式。这一缺失不是某个单一学科的问题，而是源于学科边界所造成的视野盲区——水利工程师精通水力学但可能不熟悉控制理论，控制工程师擅长算法设计但可能不了解水流的物理特性，AI专家掌握数据驱动方法但可能不理解水利系统的安全约束。水系统运行科学与工程正是试图在这些学科的交叉地带建立起一个新的理论空间，用统一的框架来整合分散在各学科中的知识碎片。

本报告试图填补这一空白，通过系统梳理相关学科的理论贡献和技术演进，勾勒出水系统运行科学与工程的学科轮廓。

本报告的覆盖范围涵盖水系统运行的各个层面。在空间尺度上，从单个闸门的本地控制到跨流域调水工程的全局调度；在时间尺度上，从毫秒级的执行器响应到年度水资源调配规划；在工程类型上，从灌区渠系到城市供水管网，从水电梯级到跨流域调水；在技术层面上，从经典PID控制到深度强化学习，从单体模型仿真到分布式多智能体协同。这一广泛的覆盖范围体现了水系统运行学科的跨学科交叉特性——它不是水利工程的一个分支，也不是控制工程的一个应用方向，而是站在这些学科的交汇点上，形成了自己独特的理论视角和方法论体系。

需要特别说明的是本报告对"运行"一词的界定。在水利工程的全生命周期中，"规划-设计-施工-运行-退役"构成了完整的链条。传统上，学术界和工程界对前三个环节的研究远比"运行"环节深入——我们有成熟的水力设计理论来确定渠道的断面尺寸，有系统的结构力学方法来保证大坝的工程安全，但对于"建成之后的工程如何运行得更好"这一问题，长期以来缺乏系统性的理论指导。本报告所关注的"运行"，特指工程建成投用后的实时监测、在线决策和自动控制过程——它是水利工程发挥效益的核心环节，也是水系统运行科学与工程这一新兴学科的核心关切。

### 关键术语说明

为便于读者理解，这里对报告中频繁出现的几个核心术语做简要说明。**水系统控制论（CHS，Cybernetics of Hydro Systems）**：由雷晓辉提出的理论框架，将控制论思想系统性地引入水系统运行领域，提供了从系统建模到控制器设计再到验证测试的完整方法论。CHS的核心思想可以概括为"五个统一"——将水力学模型与控制理论统一、物理机理与数据驱动统一、单体优化与多体协同统一、确定性控制与不确定性决策统一、理论方法与工程验证统一。**HydroOS**：水网操作系统，CHS理论的软件实现平台，为水系统自主运行提供全栈技术支撑。HydroOS借鉴了计算机操作系统的经典架构思想，将水系统的感知、建模、决策和执行功能抽象为标准化的服务接口，使得不同的控制算法和应用模块可以在统一的平台上"即插即用"地协同工作。

**WSAL（Water-network System Autonomy Level）**：水网自主等级，参照自动驾驶SAE分级理念，将水系统自主运行能力分为L0至L5六个等级。从L0（完全人工，所有决策和操作由人工完成）到L5（完全自主，系统在所有预期工况下无需人工干预即可安全运行），每个等级都有明确的功能定义、测试要求和适用边界。WSAL的意义不仅在于提供了一个分类标准，更在于为水系统智能化升级提供了一条清晰的渐进式发展路径。**xIL（X-in-the-Loop）**：在回路测试体系，包括MIL（模型在回路）、SIL（软件在回路）、HIL（硬件在回路）和PIL（现场在回路）四个层级，是保障水系统控制安全性的系统化验证方法。xIL的核心理念是"在虚拟环境中充分验证，再到物理环境中安全部署"——这与航空航天领域"先仿真、后试飞"的验证哲学一脉相承。

**双引擎架构**：Physical AI（物理AI，以MPC为代表的基于物理模型的控制方法）与Cognitive AI（认知AI，以大语言模型为代表的数据驱动智能方法）的融合架构，是CHS实现自主运行的智能核心。物理AI提供精确、可解释、可约束的控制基础，认知AI提供灵活、自适应、善交互的智能辅助，两者的互补融合构成了应对水系统运行全谱系挑战的完整智能架构。**EMS五代框架**：能量管理系统（Energy Management System）从第一代（人工经验驱动）到第五代（自主运行）的演进框架，本报告将其拓展应用于水系统，作为描述水利运行管理技术代际演进的参照坐标系。

### 读者指南

本报告内容丰富，篇幅较长，不同背景的读者可以根据自身需求选择重点阅读章节。

**水利工程专业读者**（包括水利规划设计人员、工程管理者和调度运行人员），建议重点关注第二部分（学科演进）和第三部分（现状与挑战），这些章节以水利工程的实际需求为出发点，使用水利专业人员熟悉的语言阐述核心概念。其中，第2.4节（渠道自动控制）和第2.7节（工程案例）直接关联日常工程实践，可以作为了解先进控制方法的入口。建议同时参阅第4.1节（WSAL分级），了解水系统自主运行的发展方向和分级标准——这对于制定工程智能化升级路线具有实际指导意义。

**控制工程和人工智能领域的读者**（包括自动控制、计算机科学和人工智能方向的研究者和工程师），建议重点关注第一部分（理论根基）和第四部分（未来展望），这些章节系统梳理了控制理论和AI技术在水系统中的应用前沿和开放问题。第2.5节（CHS理论）对于理解控制论在水系统中的系统化应用框架尤为关键。对于关注跨领域应用的AI研究者，第4.2节（双AI融合）和第4.4节（xIL测试）提供了一个将Physical AI与Cognitive AI深度融合的独特视角——水系统因其物理规律明确、安全要求严格、数据逐步丰富的特点，可能成为AI从"实验室演示"走向"安全关键系统部署"的最佳试验场之一。

**政策制定者和产业界人士**（包括水利行政管理部门、技术政策研究者和智慧水利企业管理者），建议重点关注第三部分的市场分析（第3.3节）和国际比较（第3.4节），以及第四部分的技术路线图。第3.3节对产业格局碎片化、数据孤岛、商业模式等深层挑战的分析，对于理解行业发展的瓶颈和制定有效的政策措施具有参考价值。第4.1节提出的WSAL水网自主等级分级框架，为制定智慧水利发展规划和评估标准提供了一个可操作的分析工具。

**跨学科研究者和研究生**，建议首先通读前言和第一部分的总览性内容以建立全局视野，然后根据自己的研究方向深入阅读相关章节。本报告的一个突出特点是将多学科知识置于水系统运行的统一视角下加以审视——系统科学的涌现性思想、控制论的反馈原理、AI的学习能力、CPS的深度耦合——这种跨学科的知识整合本身就构成了一种有价值的学术思维方式。



# 第一部分　学科基础：水系统运行的理论根基

一条1432公里的调水渠道上，数百个闸门每时每刻都在调节水流——上游开闸放水，水波要经过数小时才能到达下游。在这段"盲区"时间里，任何一个闸门的误操作都可能引发级联水位波动，影响沿线千万人的用水安全。如何在如此大时空尺度上实现精准、安全、自主的协同控制？这个问题超出了任何单一学科的能力边界。

本部分的目标是构建回答这一问题的理论根基。我们将从四大支撑学科出发，逐层建立水系统运行的知识底座：§1.1从系统科学汲取"整体观"——理解水系统为什么不能拆开来管；§1.2从控制科学获取"工具箱"——从PID反馈到MPC优化，掌握控制水流的数学武器；§1.3从人工智能引入"数据智能"——让机器从海量运行数据中学习决策规律；§1.4从信息-物理系统借鉴"融合架构"——将物理水流与信息计算深度耦合。§1.5以智能演化论收束，揭示从自动化到自主化的一般规律。

五章共同回答一个核心问题：**为什么水系统运行需要一个统一的跨学科理论框架？** 这个框架——即后文将系统阐述的CHS（水系统控制论）——正是建立在本部分的理论根基之上。


### 1.1 系统科学：从整体论到复杂性

系统科学为水系统运行科学与工程提供了最根本的**世界观和方法论**——将水系统视为一个由众多相互关联、相互作用的组成部分构成的有机整体，而非孤立元素的简单集合。这一整体观是理解和驾驭复杂水系统的认识论基础。在传统水利工程学科中，水库、渠道、泵站、管网等工程单元往往被分别研究和设计，各自拥有独立的设计标准和分析方法。然而，当这些工程单元通过水流和信息连接为一个整体系统时，系统的行为特性远不是各组分特性的简单叠加——相互耦合会产生共振、振荡、级联失效等仅在系统层面才会显现的"涌现"现象。系统科学正是研究这类涌现现象的理论基础。

系统科学的演进历程，从一般系统论到耗散结构理论，从复杂适应系统到开放复杂巨系统方法论，再到网络科学，构成了一条清晰的认识论递进链条，每一次理论突破都为水系统运行研究打开了新的视野。本节将沿着这条链条逐一阐述各理论的核心思想及其对水系统运行科学的具体启示。

#### 1.1.1 一般系统论：整体观的奠基

系统科学的源头可以追溯到20世纪上半叶奥地利理论生物学家**路德维希·冯·贝塔朗菲（Ludwig von Bertalanffy）**的开创性工作。贝塔朗菲在研究生物有机体时，深感传统的机械论和还原论方法——即将复杂对象分解为最小单元来研究——无法解释生命系统所表现出的整体性、目的性和组织性。他认为，有机体是一个"开放系统"，与环境不断进行物质和能量的交换，其行为不能仅仅通过对各部分的分析来理解，必须从整体的角度来把握 [1]。

早在1924至1928年间，贝塔朗菲就发表了多篇论文，孕育了将有机体作为整体研究的思想。1937年，他在芝加哥大学的一次哲学研讨会上首次提出了"一般系统论"（General System Theory, GST）的概念。1945年，他发表了《关于一般系统论》的论文，但并未立即引起学界广泛关注。1950年，他发表了《物理学和生物学中的开放系统理论》，为系统论奠定了重要的理论基础 [2]。

1968年，他出版了集大成之作《一般系统论：基础、发展和应用》（*General System Theory: Foundations, Development, Applications*），全面总结了该理论的概念、方法和应用，标志着一般系统论作为一个独立学科的正式确立 [1]。1972年，他又发表了《一般系统论的历史和现状》，将其理论视野扩展至更广泛的系统科学范畴 [3]。

一般系统论的核心思想可以概括为以下几个方面。

**第一，整体性原则（Wholeness）。** 系统的整体功能大于其各部分功能之和，即"整体大于部分之和"。这意味着系统具有其组成部分所不具备的"涌现性质"（Emergent Properties）。对于水系统而言，一个由水库、河道、闸门、泵站组成的调水工程，其整体的调水能力和防洪功能，绝非各个单体工程功能的简单叠加，而是取决于它们之间的相互连接、相互协调和相互制约关系。例如，都江堰的鱼嘴、飞沙堰和宝瓶口三大工程的组合，产生了"自动分流、自动排沙、自动控制进水量"的涌现功能，这是任何单一工程都无法实现的。又如，南水北调中线工程沿线设有数十座节制闸和退水闸，单独看每座闸门不过是简单的流量调节装置，但当这些闸门构成一个协调控制网络时，就能实现"远距离、大流量、高精度"的水量调配功能——这正是涌现性的典型体现。

**第二，开放性原则（Openness）。** 系统与其环境之间存在着持续的物质、能量和信息交换。水系统是典型的开放系统：降雨、蒸发、地下水补给等自然过程不断向系统输入或输出水量和能量；人类的取水、排水、调度等活动则构成了社会层面的输入输出。正是这种开放性，使得水系统的运行充满了不确定性，也使得对其进行精确控制成为一项极具挑战性的任务。从控制论的角度看，开放性意味着系统必须具备持续的扰动辨识和自适应能力——一个封闭系统可以用固定的控制规则来管理，但一个开放系统必须根据环境变化不断调整自身行为。这一认识直接影响了后来水系统控制中自适应控制和鲁棒（robust，指系统在参数变化或外部干扰下仍能保持稳定性能的能力，类似于水利工程中的'抗干扰性'）控制方法的引入。

**第三，等终态性原则（Equifinality）。** 开放系统可以从不同的初始条件出发，通过不同的路径，达到相同的最终状态。这一原则对于水系统运行具有重要的实践意义：面对同一个调度目标（如将某断面水位控制在目标值），可以有多种不同的调度方案（不同的闸门开度组合、不同的泵站启停序列），而优化调度的任务就是在这些可行方案中找到最优的那一个。等终态性原则还暗示了水系统运行中"多解性"的本质特征——对于任何给定的调度目标，解空间通常是高维的、非凸的，包含大量局部最优解。这一认识促使研究者发展了基于模型预测控制（MPC）的滚动优化方法，通过在每个控制步长上重新求解优化问题来逐步逼近全局最优。

**第四，层次性原则（Hierarchy）。** 复杂系统通常呈现出层次化的结构，高层系统由低层子系统组成，每一层都有其特定的功能和规律。水系统天然具有这种层次结构：从单个闸泵（最底层），到渠段或河段（中间层），再到干线或流域（最高层），构成了一个多层次的复杂系统。这一层次性原则直接启发了后来大系统控制理论中的"分层控制"思想，并成为水系统控制论中"分层分布式统一"维度的理论基础。以南水北调中线工程为例，该系统可以分解为至少三个控制层级：顶层是总调度中心，负责全线水量分配和长期优化调度；中层是各管理处，负责辖区内的区段协调控制；底层是每座闸门的本地PID控制器，负责精确执行开度指令。这种分层结构既保证了全局最优性，又确保了局部响应的快速性，是管理大规模水系统复杂性的基本手段。

**第五，反馈原则（Feedback）。** 虽然反馈的概念更多与控制论相关联，但贝塔朗菲在一般系统论中也强调了信息反馈对于维持系统稳定性的重要作用。在水系统中，反馈无处不在：闸门调节改变了下游水位，水位变化又反过来影响闸门流量，进而需要进一步调整闸门开度——这就是一个典型的负反馈回路。正是这些嵌套的反馈回路，使得水系统呈现出复杂的动力学行为，也使得控制设计必须充分考虑反馈的动态特性。

一般系统论的提出，在学术界产生了深远的影响。它打破了传统学科之间的壁垒，为不同领域的研究者提供了一种共同的"语言"和"思维方式"。贝塔朗菲特别强调了不同系统之间的"同构性"（Isomorphism）——尽管物理机制截然不同，但电路中的电流流动、管道中的水流传输和热传导过程在数学描述上具有相同的结构形式。这种同构性使得控制理论中成熟的方法可以跨领域移植——电力系统中的频率调节方法可以启发水系统中的水位控制方法，化工过程中的温度控制策略可以类比为水网中的流量调度策略。CHS的核心方法论正是建立在这种跨领域同构性的基础之上：将电力系统中已经成熟的EMS五代框架映射到水系统语境，将工业过程控制中的MPC方法移植到渠道水位调控中。

在水利领域，系统论思想的引入，使得研究者开始将流域、灌区、城市水务等视为一个个"系统"来研究，而非仅仅关注单个水库或单条河道的水力学问题。这种"系统观"的转变，是水系统运行科学与工程得以萌生的最根本的认识论前提。

#### 1.1.2 耗散结构理论：远离平衡态的自组织

贝塔朗菲的一般系统论主要关注的是系统的结构和功能，但对于系统如何从无序走向有序、如何在复杂环境中自发地形成和维持结构，并未给出深入的解释。这一问题由俄裔比利时物理化学家**伊利亚·普里高津（Ilya Prigogine）**的**耗散结构理论（Dissipative Structure Theory）**给出了开创性的回答。

普里高津的研究聚焦于非平衡态热力学。经典热力学告诉我们，孤立系统总是趋向于熵增（即无序度增大），最终达到热力学平衡态。但现实世界中大量存在的有序结构——从生物体到城市——显然是"反熵增"的。普里高津发现，当一个开放系统远离热力学平衡态时，在与外界不断交换物质和能量的过程中，系统内部的非线性相互作用可以通过涨落（Fluctuation）被放大，导致系统从一种无序状态跃迁到一种新的、有序的、稳定的结构状态。他将这种在远离平衡态条件下形成的有序结构命名为"耗散结构"（Dissipative Structure），因为这种结构的维持需要持续地从外界"耗散"（消耗）能量 [4]。

1967年，普里高津在一次国际会议上首次公开了关于耗散结构理论的研究成果。1969年，他正式提出了"耗散结构"这一核心概念。1977年，因其在非平衡态热力学，特别是耗散结构理论方面的开创性贡献，普里高津荣获了诺贝尔化学奖 [4]。他的代表作包括1978年在《Science》上发表的论文《时间、结构与涨落》（*Time, Structure, and Fluctuations*）[5]，以及1984年与伊莎贝尔·斯唐热（Isabelle Stengers）合著的《从混沌到有序：人与自然的新对话》（*Order out of Chaos: Man's New Dialogue with Nature*）[6]。

普里高津的工作不仅创立了一个新的科学分支，更从根本上挑战了经典物理学中"可逆性"和"确定性"的世界观——他指出，在远离平衡态的非线性系统中，时间之箭不可逆转，偶然性（涨落）与必然性（动力学规律）同等重要，系统的未来演化路径取决于分岔点（Bifurcation Point）上随机涨落的选择。这种"确定性与随机性交织"的自然观，为水系统运行中"确定性物理模型+随机性水文预报"的混合建模范式提供了深层的哲学基础。

耗散结构理论对于理解水系统具有深刻的启示意义。水系统，特别是流域尺度的水循环系统，本质上就是一个远离平衡态的开放耗散系统。太阳辐射提供了驱动水循环的能量，降水、蒸发、径流等过程构成了物质和能量的持续交换。在这个过程中，河流网络的形成、洪水波的传播、水生态系统的演替等现象，都可以被视为某种意义上的"耗散结构"——它们是在能量耗散过程中自发形成的有序模式。

更具体地说，耗散结构理论为水系统运行提供了三个层面的启示。**第一个层面是运行状态的动态性。** 水系统的"良好运行状态"不是一个可以一劳永逸达到的静态目标，而是需要通过持续的监测、调控和反馈来动态维持的耗散结构。一旦外部能量和信息的输入中断（如传感器失效或通信中断），系统将迅速从有序状态退化为无序状态——这就是为什么SCADA系统的可靠性对于维持水系统运行至关重要。**第二个层面是涨落的放大效应。** 在远离平衡态的条件下，微小的扰动可以被非线性相互作用放大，导致系统发生质变。在水系统中，一个闸门的小幅误操作可以通过渠道的波动传播效应被逐级放大，最终引发远端的水位越限甚至溃堤事故。这一认识促使控制系统设计者必须高度重视"安全包络"（Safety Envelope）的概念——确保系统在任何小扰动下都不会偏离安全运行域。**第三个层面是自组织的可能性。

** 耗散结构理论表明，在适当条件下，系统可以自发地形成有序结构。这一思想启发了后来多智能体系统（MAS）在水系统控制中的应用——每个智能体（如每座闸门的控制器）按照局部规则行事，但通过相互之间的信息交换和协调，可以涌现出全局有序的调度行为，而无需一个集中式的"大脑"来统一指挥。

#### 1.1.3 协同学：序参量与自组织的数学描述

与耗散结构理论几乎同时代，德国物理学家**赫尔曼·哈肯（Hermann Haken）**创立了**协同学（Synergetics）**，从另一个角度揭示了复杂系统中有序结构涌现的机制。如果说普里高津关注的是"为什么会出现有序"，那么哈肯关注的是"有序是如何出现的"——他提供了更具操作性的数学工具。

哈肯最初在研究激光物理时发现，当激光器的泵浦强度超过某个阈值时，原本混乱的光子发射会突然变得高度有序——所有光子开始同步振荡，发出相干光。这种从无序到有序的突变，并不需要外部指令，而是系统内部各组成部分"协同"作用的结果。1969年至1977年间，哈肯将这一发现推广为一般性的理论框架，于1977年出版了《协同学：自然界的不稳定性和结构形成导论》（*Synergetics: An Introduction*）[47]，正式创立了协同学。

协同学的核心概念是**序参量（Order Parameter）**和**伺服原理（Slaving Principle）**。序参量是描述系统宏观有序程度的变量，它由系统各组成部分的集体行为涌现而出，反过来又支配着各组成部分的行为——这就是伺服原理。在激光中，序参量是光场的振幅；在流体对流中，序参量是对流环的速度。关键在于：复杂系统虽然有大量的自由度，但在临界点附近，绝大多数自由度被少数几个慢变量（即序参量）所"奴役"，系统的宏观行为可以用少数序参量的低维动力学来描述。

这一思想对水系统控制具有深刻的方法论意义。一个大型调水工程可能有数百个闸门和泵站，理论上构成一个几百维的控制系统。但在实际运行中，系统的宏观行为往往由少数关键变量主导——例如主要控制断面的水位和流量。这些关键变量就是水系统的"序参量"。协同学告诉我们，有效的控制策略不需要逐一精确控制每一个闸门，而只需要抓住这些序参量（关键断面水位），通过序参量的调控来实现全系统的有序运行。这一思想与后来模型降阶（Model Order Reduction）技术的发展高度一致——通过数学方法将高维的Saint-Venant方程降阶为低维的传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）模型，正是对"用序参量描述复杂系统"这一哲学的具体实践。

此外，协同学中"相变"（Phase Transition）的概念也为理解水系统运行中的突变行为提供了框架。当某个外部参数（如来水流量）连续变化并越过某个临界点时，水系统可能从一种运行模式突然跳变到另一种模式——例如从自由流转变为回水淹没、从稳定输水转变为水锤振荡。这些"相变"现象要求控制系统具备模式识别和快速切换的能力，而不仅仅是在单一模式下进行参数调节。CHS框架中的"可控模型族"概念正是对这一需求的响应——针对不同的运行模式准备不同的控制模型，当检测到模式切换时自动调用相应的模型和控制器。

协同学还为理解水系统控制中"控制参数"（Control Parameter）的选择提供了理论指导。在哈肯的理论中，系统的行为由控制参数决定——当控制参数越过临界值时，序参量发生质变。在水系统中，控制参数对应于可调节的闸门开度、泵站转速等操控变量，序参量对应于水位、流量等关键状态变量。协同学提示我们，有效的控制策略应该关注"在什么条件下微调控制参数能够引发序参量的有利跃迁"——这比简单的线性反馈调节具有更深层的理论意义。

#### 1.1.4 复杂适应系统：涌现与自适应

系统科学的第三次重大飞跃，来自20世纪末兴起的**复杂性科学（Complexity Science）**，其核心概念之一是美国科学家**约翰·霍兰（John H. Holland）**提出的**复杂适应系统（Complex Adaptive System, CAS）**理论。

1992年，霍兰在圣塔菲研究所（Santa Fe Institute）提出了CAS理论，并在1995年出版了具有里程碑意义的著作《隐秩序：适应性造就复杂性》（*Hidden Order: How Adaptation Builds Complexity*）[8]。霍兰认为，复杂系统中的主体（Agent）具有适应性——它们能够根据环境的变化调整自身的行为策略。CAS的核心机制包括：聚集（Aggregation）——主体的组合产生更高层次的结构；非线性（Nonlinearity）——主体间的相互作用具有非线性特征，导致系统行为不可通过简单叠加来预测；流（Flow）——物质、能量和信息在主体之间的流动构成了系统的动态行为；多样性（Diversity）——主体之间的差异性是系统适应能力的来源。

CAS理论对水系统运行研究的影响是革命性的。传统的水系统控制方法基于"集中式"思维——一个中央控制器掌握全部信息，做出全局最优决策，然后下达指令给各执行机构。但CAS理论表明，复杂系统的有效运行并不一定需要集中式控制，分布式的、自适应的主体通过局部交互就可以涌现出全局有序的行为。这一思想直接催生了多智能体系统（Multi-Agent System, MAS）在水系统控制中的应用。在MAS框架下，每个闸门控制器被视为一个具有局部感知和决策能力的"智能体"，智能体之间通过通信进行协商和协调，共同实现全系统的调度目标。与集中式控制相比，MAS具有更好的容错性（某个智能体失效不影响全局）、可扩展性（新增智能体无需重新设计整个系统）和适应性（智能体可以根据局部环境变化调整策略）。

CAS理论还引入了一个重要概念——**涌现（Emergence）**。涌现是指系统整体表现出的性质和行为，无法从其组成部分的性质中直接推导出来。例如，一群鸟在飞行中自发形成V字队形，并不是因为有某只"领头鸟"在指挥，而是每只鸟遵循几条简单的局部规则（保持间距、对齐方向、向中心靠拢）的结果。在水系统中，类似的涌现行为包括：多个小水库的联合调度可以产生等效于一个大水库的调蓄能力；多个分散的雨水花园和渗透设施的组合可以形成城市级别的洪涝削峰效果。理解和利用涌现，是水系统控制论追求的更高层次目标——不仅要控制系统的确定性行为，还要引导系统的涌现行为向有利方向发展。

CAS理论还启发了**基于智能体的建模**（Agent-Based Modeling, ABM）在水系统研究中的应用。在ABM框架中，水系统中的各类主体——水库调度员、灌区管理者、城市用水户、生态需水——被建模为具有各自目标函数和决策规则的智能体，然后在计算机中模拟这些智能体的交互过程，观察系统层面的涌现行为。这种"自下而上"的建模方法与传统的"自上而下"优化方法形成了有益的互补：前者能够揭示微观行为如何累积为宏观现象（如个体取水行为如何导致区域性水资源短缺），后者则从宏观目标出发设计最优策略。CHS框架中的多智能体系统（MAS）架构，在技术实现层面借鉴了ABM的智能体交互范式，但在控制目标层面则融入了经典最优控制的严格性——每个智能体不仅是一个自适应的决策主体，还必须满足全局安全约束和性能目标。

霍兰在CAS理论中还特别强调了**内部模型**（Internal Model）的重要性。一个真正具有适应能力的智能体，必须拥有关于其环境的某种内部表征——通过这个内部模型，智能体可以预测自身行动的后果，而不必每次都通过实际试错来学习。这一洞见与后来MPC（模型预测控制）的核心思想高度一致——MPC控制器正是通过其内部的水力学模型来预测控制动作的后果，从而实现"先预测、再行动"的智能决策。从CAS的理论视角来看，MPC控制器可以被视为一个拥有"内部模型"的适应性智能体——它不断地根据新的观测数据更新其内部模型（参数辨识），并利用更新后的模型进行预测和优化。这种跨学科的理论共鸣，再次证明了系统科学作为统一性理论框架的深刻价值。

#### 1.1.5 钱学森的开放复杂巨系统方法论

在中国，系统科学的发展有着自己独特的传统，其中最具标志性的贡献来自**钱学森（Tsien Hsue-shen, 1911-2009）**。钱学森不仅是中国航天事业的奠基人，也是中国系统科学学派的创立者。他将系统科学提升到了哲学和方法论的高度，提出了一系列对水系统运行科学具有深远影响的思想。

钱学森对系统科学的最大贡献之一，是提出了**"开放的复杂巨系统"（Open Complex Giant System）**的概念及其方法论。1990年，钱学森在《自然杂志》上发表了具有里程碑意义的论文《一个科学新领域——开放的复杂巨系统及其方法论》[9]，系统阐述了这一理论。他将系统按照组成部分的数量和相互作用的复杂程度分为三类：**简单系统**（组成部分少，相互作用简单，如行星运动）、**简单巨系统**（组成部分多但种类少，相互作用服从统计规律，如气体分子运动）和**复杂巨系统**（组成部分多且种类多，相互作用复杂且不完全可预测，如生态系统、社会系统）。而"开放的复杂巨系统"则是在复杂巨系统基础上，进一步强调系统与环境之间的持续交互。

水系统恰恰是钱学森所定义的开放复杂巨系统的典型代表。以南水北调工程为例：它由数以万计的工程构筑物（闸门、泵站、隧洞、渡槽等）组成（"巨"的特征）；这些构筑物的类型、功能和运行规则各不相同（"复杂"的特征）；系统与自然水文过程、社会用水需求、政策法规环境等持续交互（"开放"的特征）。用简单系统的方法（如经典的PID控制）来管理这样一个系统是远远不够的，也无法用简单巨系统的方法（如统计力学）来刻画它的行为——因为它的组成部分具有质的差异性和主动的适应性。

更为重要的是，钱学森提出了处理开放复杂巨系统问题的方法论——**"从定性到定量的综合集成方法"（Meta-Synthesis）**，也称为**"综合集成研讨厅体系"**[10]。这一方法论的核心思想是：对于开放复杂巨系统问题，单靠数学模型或计算机模拟是不够的，也不能仅靠专家经验或定性判断，而必须将"人的知识、经验和智慧"与"计算机的高速计算和大容量存储能力"以及"各种数据和信息"有机结合起来，通过反复的讨论、模拟、验证循环，逐步逼近对系统行为的深刻理解。

钱学森的综合集成方法论对水系统运行科学具有直接的指导意义。水系统运行决策从来都不是一个纯粹的数学优化问题——它需要融合水文模型的计算结果、工程师的经验判断、政策法规的约束要求以及利益相关者的诉求平衡。水系统控制论（CHS）中"Physical AI与Cognitive AI双引擎融合"的思想，在某种意义上可以看作钱学森综合集成方法论在人工智能时代的具体实现：Physical AI对应"计算机的高速计算和模型模拟能力"，Cognitive AI对应"人的知识、经验和推理能力"，而两者的融合正是"综合集成"的现代技术形态。

钱学森还提出了**"系统科学的体系结构"**，将其分为四个层次：最高层是系统论（哲学层面）；第二层是系统学（基础理论层面，如一般系统论、信息论、控制论）；第三层是系统工程的技术科学（如运筹学、自动控制理论、系统动力学）；第四层是系统工程实践（如航天工程系统、水利工程系统的实际建设与运行）[11]。这一体系结构的清晰划分，为水系统运行科学与工程确立了自己的学科定位——它处于第三层（技术科学）和第四层（工程实践）之间，以第二层的基础理论为根基，服务于第四层的工程需求。

#### 1.1.6 网络科学：拓扑视角下的水系统

21世纪初兴起的**网络科学（Network Science）**为系统科学开辟了一个全新的维度——从拓扑结构的角度来理解复杂系统的组织原理和动力学行为。网络科学的两篇奠基性论文分别是：1998年邓肯·瓦茨（Duncan J. Watts）和史蒂文·斯特罗加茨（Steven H. Strogatz）在《Nature》上发表的关于**"小世界网络"（Small-World Networks）**的研究 [12]，以及1999年阿尔伯特-拉斯洛·巴拉巴西（Albert-László Barabási）和雷卡·阿尔伯特（Réka Albert）在《Science》上发表的关于**"无标度网络"（Scale-Free Networks）**的发现 [13]。

瓦茨和斯特罗加茨发现，许多真实世界的网络——从人类社交网络到线虫的神经网络——都具有"小世界"特性：网络中任意两个节点之间的平均距离很短（类似于随机网络），但同时网络的聚集系数很高（类似于规则网络）。这意味着网络既具有高效的全局连通性，又保持了紧密的局部结构。巴拉巴西和阿尔伯特则发现，许多真实网络的度分布遵循幂律分布——少数"枢纽"节点拥有大量连接，而大多数节点只有少量连接。这种无标度特性赋予了网络对随机故障的强鲁棒性（因为随机故障通常不会击中枢纽节点），但对蓄意攻击却很脆弱（因为攻击枢纽节点会导致网络迅速崩溃）。

网络科学的这些发现对水系统研究产生了重要影响。**从结构角度看**，供水管网、灌溉渠网和河流水系都可以抽象为网络——节点是水库、分水口、用水户等，边是河道、渠道、管道等。研究表明，城市供水管网通常具有某种程度的无标度特性——少数主干管扮演着"枢纽"角色，承载着大量的水量输送任务。这意味着供水系统对随机管段破裂具有较好的容忍度，但对主干管故障非常敏感。这一认识对供水系统的应急管理和冗余设计有直接的指导意义。

**从动力学角度看**，网络拓扑对系统中扰动的传播具有决定性影响。在一个树状结构的渠网中，某个节点的扰动只能沿着单一路径传播；而在一个网状结构的管网中，扰动可以沿着多条路径同时传播，形成复杂的干涉和叠加效应。理解扰动传播的网络动力学，是设计有效的分布式控制策略的前提。水系统控制论中的"多智能体系统"设计，正需要以网络拓扑分析为基础——智能体之间的通信拓扑应当与水力耦合拓扑相匹配，才能实现高效的协调控制。

**从脆弱性角度看**，网络科学提供了一套量化评估系统脆弱性的工具——如介数中心性（Betweenness Centrality）、级联失效（Cascading Failure）分析等。利用这些工具，可以识别水网中的关键薄弱环节，为"安全包络"的设计提供定量依据。例如，通过计算调水渠网中各节点的介数中心性，可以找出那些"一旦失效就会导致大面积断水"的关键枢纽，从而为这些枢纽配置更高级别的冗余保护和应急预案。

网络科学还提供了分析水网**级联失效**（Cascading Failure）的理论工具。当水网中的某个关键节点发生故障（如主要泵站停机或输水隧洞堵塞）时，其影响不会局限于该节点本身，而会沿着网络拓扑向下游传播，可能触发一系列连锁反应——下游渠池水位下降→下游闸门自动加大开度→再下游渠池流量突变→更远处的泵站负荷激增。这种级联效应的传播模式和最终影响范围，取决于水网的拓扑结构和各节点的控制策略。网络科学中的**渗流理论**（Percolation Theory）提供了分析级联失效阈值的数学工具——当故障节点比例超过某个临界阈值时，整个网络的功能将发生突变式崩溃。了解这一临界阈值，对于水网的冗余设计和应急预案编制具有重要的指导价值。

此外，网络科学中的**韧性度量**（Resilience Metrics）可以量化水网在局部故障条件下维持整体服务能力的程度——韧性越高的水网，其局部故障导致全局崩溃的概率越低。这些定量化的网络分析工具，为水网规划设计和运行管理提供了超越传统水力学的新视角。

#### 1.1.7 系统工程方法论：从理论到实践的桥梁

系统科学不仅提供了认识复杂系统的理论框架，还通过**系统工程（Systems Engineering）**方法论为解决实际复杂工程问题提供了实践路径。系统工程起源于20世纪40年代的美国军事和航天领域。1940年代，贝尔电话实验室首先使用"系统工程"一词来描述对复杂通信系统的整体设计方法。1950年代，兰德公司（RAND Corporation）将系统分析方法应用于国防战略规划。1957年，美国国防部在"北极星"（Polaris）潜射弹道导弹项目中成功运用了系统工程方法，成为该方法论的经典案例。1962年，亚瑟·霍尔（Arthur D. Hall）出版了《系统工程方法论》（*A Methodology for Systems Engineering*），为系统工程奠定了方法论基础 [14]。此后，系统工程经历了从文档驱动向模型驱动的范式转变。

21世纪初，基于模型的系统工程（Model-Based Systems Engineering, MBSE）成为主流趋势——用形式化的系统模型（如SysML语言描述的架构模型）取代传统的文档描述，实现需求、设计、验证和确认之间的可追溯性和一致性。MBSE思想对CHS框架的影响体现在：HydroOS的架构设计采用了系统模型驱动的方法，从需求规格（ODD定义）到功能分解（六元架构）再到接口设计（模型总线），各层级之间保持形式化的追溯关系，确保系统设计的完整性和可验证性。

在中国，系统工程方法论的推广与钱学森的推动密不可分。1978年，钱学森与许国志、王寿云在《文汇报》上联名发表了《组织管理的技术——系统工程》一文，向国内学术界和管理层系统介绍了系统工程的思想方法。此后，系统工程在中国已在多个工程中成功部署，从航天工程到三峡工程，从城市规划到水利建设，都可以看到系统工程方法论的影子。

对于水系统运行科学与工程而言，系统工程方法论的价值主要体现在以下几个方面。

**第一，需求分析与问题定义。** 系统工程强调在动手设计之前，首先要充分理解问题本身——利益相关者是谁？他们的需求和约束是什么？系统的边界在哪里？这一"需求驱动"的思维方式对于水系统运行至关重要。一个水库的调度，不仅要满足防洪安全的要求，还要兼顾发电效益、下游供水、生态流量、航运水深等多方面需求，而这些需求之间往往相互矛盾。系统工程方法论提供了一套结构化的需求分析和权衡取舍框架，帮助决策者在多目标之间做出明智的平衡。

**第二，V模型与验证确认体系。** 系统工程中经典的"V模型"将系统开发过程分为左侧的"分解与设计"阶段和右侧的"集成与验证"阶段，每个设计层级都有对应的验证活动。这一框架对于水系统控制系统的开发具有直接的指导意义——从概念设计到详细设计再到实现，每一步都应有对应的测试和验证。水系统控制论中"模型在回路仿真（MIL）→ 软件在回路仿真（SIL）→ 硬件在回路仿真（HIL）"的逐级验证流程，正是V模型思想在水系统领域的具体体现。

**第三，全生命周期管理。** 系统工程关注系统从概念到退役的全生命周期。水利工程的运行系统同样需要全生命周期的视角——从需求分析、系统设计、开发测试、部署上线到运维升级，每个阶段都有其特定的管理要求。水系统控制论中"全生命周期统一"的维度，正是这一系统工程思想的体现。

系统工程方法论的另一个重要贡献是**需求工程**（Requirements Engineering）在水系统控制中的引入。传统水利工程的控制需求往往以模糊的自然语言表述（如"保障供水安全"、"实现优化调度"），缺乏可验证的定量标准。系统工程要求将这些模糊需求转化为可测量、可验证的具体指标——如"在95%的运行时间内，各渠池水位偏差不超过目标值的±5cm"、"对阶跃型来水扰动的调节时间不超过2小时"、"在任何单点传感器故障条件下，系统仍能维持基本的安全运行"。这种需求的形式化是后续控制器设计和验证的前提——没有明确的需求定义，就无法判断控制系统是否"足够好"，验证测试也就失去了判定基准。

CHS框架将需求工程的方法引入水系统控制领域，要求每一个控制系统的设计都从"需求规格书"（Specification）开始，为后续的MIL-SIL-HIL验证链条提供可追溯的基准。


---

#### 1.1.8 本节小结：系统科学对水系统运行的方法论启示


综上所述，系统科学的各分支理论为水系统运行科学与工程提供了以下六重启示：

**第一，整体论视角。** 一般系统论告诉我们，必须将水系统视为一个有机整体，关注组成部分之间的相互作用和涌现性质，而非仅仅优化各个局部。

**第二，动态维持观。** 耗散结构理论揭示，水系统的有序运行状态需要通过持续的能量和信息输入来维持，任何控制系统的设计都必须充分考虑这种动态维持的需要。

**第三，序参量简化。** 协同学提供了用少数关键变量（序参量）来刻画和控制复杂系统的思想，这直接启发了模型降阶和关键断面控制的技术路线。

**第四，分布式自组织。** 复杂适应系统理论表明，分布式的自适应主体通过局部交互可以涌现出全局有序行为，这为多智能体水系统控制提供了理论基础。

**第五，综合集成方法论。** 钱学森的开放复杂巨系统方法论指出，必须将定量计算与定性判断、机器智能与人类智慧有机结合，这一思想在"Physical AI + Cognitive AI"双引擎架构中得到了现代化实现。

**第六，网络拓扑视角。** 网络科学提供了从拓扑结构角度理解水系统脆弱性和扰动传播的工具，为分布式控制策略的设计和系统安全性评估提供了定量方法。

这六重启示共同构成了水系统运行科学与工程的系统科学基底。值得强调的是，这六重启示并非彼此独立，而是在水系统运行的具体场景中相互交织、协同作用的。以南水北调中线工程的运行为例：将整条干渠视为有机整体（整体论视角），认识到稳定的输水状态需要持续的控制能量输入来维持（动态维持观），用主要控制断面水位作为系统运行的序参量来降阶建模（序参量简化），各渠段控制器通过信息交互实现局部自主与全局协调（分布式自组织），人工经验与自动算法在极端工况下互补决策（综合集成方法论），基于水网拓扑结构分析脆弱节点和扰动传播路径（网络拓扑视角）——六重启示在同一工程中缺一不可。这种多理论视角的融合运用，正是CHS作为交叉学科的本质特征。

在下一节中，我们将看到，控制论——系统科学的"孪生兄弟"——如何为水系统运行提供了更加具体的"操作工具"。

---

**思考与讨论**

1. （概念理解）一般系统论的"整体大于部分之和"原则在水系统运行中有哪些具体体现？试举两例说明。
2. （分析比较）耗散结构理论和复杂适应系统理论分别从什么角度解释水系统的运行行为？两者的互补性体现在何处？
3. （综合应用）如果你需要为一个包含5座水库和12条渠道的灌区设计监控方案，网络科学中的哪些概念（如节点度、介数中心性）可以帮助你确定关键监测断面？


---


---

### §1.1 本节小结


本节从一般系统论到网络科学，梳理了系统科学五大理论里程碑对水系统运行的方法论启示。核心结论有三：（1）贝塔朗菲的"整体大于部分之和"确立了水系统不可还原为单一工程单元的基本认识；（2）普里高津的耗散结构理论揭示了水系统作为开放系统维持有序运行的能量代价；（3）霍兰的复杂适应系统理论为多智能体协同调控提供了概念原型。协同学的序参量思想直接启发了CHS框架中"抓关键断面而非逐闸控制"的降阶控制策略。

> **图 1-1　水系统运行科学的学科谱系图**
> *Fig. 1-1 Disciplinary Genealogy of Water System Operation Science*
>
> ```
>                           ┌─────────────────────────────────────────┐
>                           │    水系统运行科学与工程 (CHS)            │
>                           │    Water System Operation Sci. & Eng.   │
>                           └──────────────┬──────────────────────────┘
>                      ┌───────────┬───────┼───────┬────────────┐
>                      ▼           ▼       ▼       ▼            ▼
>              ┌───────────┐ ┌─────────┐ ┌─────┐ ┌──────┐ ┌──────────┐
>              │ 系统科学   │ │ 控制科学│ │  AI │ │ CPS  │ │ 智能演化 │
>              │ §1.1      │ │ §1.2    │ │§1.3 │ │ §1.4 │ │ §1.5     │
>              └──┬────────┘ └──┬──────┘ └──┬──┘ └──┬───┘ └──────────┘
>                 │            │           │       │
>    ┌────┬───┬──┘    ┌───┬──┘    ┌──┬──┘   ┌──┘
>    ▼    ▼   ▼       ▼   ▼      ▼  ▼     ▼
>  一般  耗散 复杂   PID MPC   ML  RL   数字孪生
>  系统论 结构 适应    ↓   ↓    DL LLM  边缘计算
>        理论 系统  鲁棒 DMPC
> ```

### 1.2 控制论与控制科学：从反馈到智能

> ---

> **📖 给水利工程师的速览：什么是"控制"？**
>
> 在传统水利工程中，调度员根据经验和调度图手动调节闸门——这是"开环控制"。如果给闸门装上水位传感器，让控制器自动根据实际水位与目标水位的偏差来调节闸门开度，这就是"闭环控制"（也叫反馈控制）。控制科学研究的核心问题就是：如何设计这个"控制器"，使水位又快又准地到达目标值，同时不产生剧烈振荡？从最简单的PID（比例-积分-微分）控制器到最先进的MPC（模型预测控制），本质上都是在回答这个问题。
> ---

如果说系统科学提供了"世界观"——告诉我们水系统是什么样的，那么控制论（控制科学）则提供了"方法论"——告诉我们如何去驾驭和调控水系统。控制科学是水系统运行科学与工程最直接、最核心的理论基础。水系统控制论（CHS）的名称本身就表明了这种深刻的渊源关系。

控制科学的发展历程，从经典控制到现代控制，从大系统控制到智能控制，再到多智能体系统和分布式预测控制，每一个阶段都在水系统控制领域找到了对应的应用和发展。以下将按照时间顺序，逐一梳理控制科学各阶段的核心思想及其向水系统控制领域的迁移，并深入分析每次迁移中遇到的独特挑战与创新性解决方案。

#### 1.2.1 控制论的诞生：维纳与反馈的哲学

1948年，美国数学家**诺伯特·维纳（Norbert Wiener）**出版了划时代的著作《控制论：或关于在动物和机器中控制和通信的科学》（*Cybernetics: Or Control and Communication in the Animal and the Machine*）[14]。这本书的出版标志着控制论作为一门独立学科的正式诞生。

维纳的天才之处在于，他发现了生物体和机器在"控制"和"通信"方面的深刻共性。无论是人体通过神经系统调节体温，还是高射炮通过伺服机构追踪飞机，其核心机制都是**负反馈**（Negative Feedback）——系统通过将输出信息反馈到输入端，与期望值进行比较，根据偏差来调整行为，从而使系统趋向于期望的状态。维纳将这一机制抽象为一个普遍的科学原理，适用于一切具有"目的性行为"的系统。

维纳的控制论思想对水系统运行具有直接而深刻的启示。水系统运行的本质，就是一个**闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）反馈控制**过程：**感知**（Sensing）——通过水位计、流量计、雨量计等传感器获取水系统的实时状态信息；**决策**（Decision）——将感知到的信息与期望的目标（如目标水位、目标流量）进行比较，根据偏差计算出控制指令；**执行**（Actuation）——通过调节闸门开度、启停水泵等操作，将控制指令施加于物理水系统；

**反馈**（Feedback）——执行操作后，水系统的状态发生变化，新的状态信息再次被感知，形成闭环。这一"感知→决策→执行→反馈"的闭环结构，正是水系统控制论（CHS）的基本范式。

维纳不仅提出了负反馈的概念，还深刻讨论了**正反馈**和**时滞**对系统稳定性的影响。他指出，如果反馈中存在过大的时滞，负反馈可能变成正反馈，导致系统振荡甚至失控——这一现象在人体运动控制中表现为意向性震颤（Intention Tremor），在工程系统中表现为振荡和不稳定。在水系统中，时滞是一个核心挑战：一条长达数百公里的调水渠道，上游闸门的调节可能需要数小时甚至数天才能影响到下游水位。这种大时滞特性使得简单的实时反馈控制极易引发振荡，迫使研究者必须发展基于预测的前馈-反馈复合控制策略——这正是后来模型预测控制（MPC）在水系统中获得广泛应用的根本原因。

维纳的控制论并不是孤立的思想事件，它与20世纪中叶的信息革命紧密相连。维纳的好友和合作者**克劳德·香农（Claude Shannon）**于1948年发表了《通信的数学理论》，创立了信息论。维纳和香农的工作共同揭示了信息在控制系统中的核心地位：没有信息的获取（传感）、传输（通信）和处理（计算），就不可能有有效的控制。这一洞察对水系统运行具有深远意义——水系统的自动化控制水平，在根本上受制于信息基础设施的完善程度。从早期依赖人工观测和电话调度，到现代的SCADA系统和光纤/5G通信网络，水系统控制能力的每一次飞跃都伴随着信息获取和传输能力的质的提升。

与维纳同时代的英国控制论学者**威廉·罗斯·阿什比（W. Ross Ashby）**提出了**"必要多样性定律"（Law of Requisite Variety）**——一个控制器要有效地控制一个系统，其自身的多样性（即可选择的控制动作的丰富程度）必须至少等于系统可能出现的状态的多样性。换言之，简单的控制器不可能有效控制复杂的系统。这一定律对水系统控制的启示极为深刻：一个仅有几种固定操作模式的调度规则，无法应对水系统在极端工况下的复杂多变性；只有具备丰富的控制手段和灵活的决策能力的智能控制系统，才能胜任复杂水网的实时运行管理。CHS框架中强调的"可控模型族"概念——为不同场景准备不同精度的模型，并根据运行工况动态切换——正是阿什比必要多样性定律在水系统控制中的一种具体实现。

几乎在同一时期，中国科学家**钱学森**于1954年在美国出版了《工程控制论》（*Engineering Cybernetics*）[15]。钱学森将维纳的控制论原理系统地应用于工程技术问题，强调控制论在工程设计和系统优化中的实际应用价值。《工程控制论》的出版标志着工程控制论的诞生，为控制理论从哲学层面走向工程实践架起了桥梁。特别值得指出的是，钱学森在书中提出的"工程控制论"概念——将控制论作为一门工程技术科学来发展，而非仅停留在哲学思辨层面——对水系统控制论（CHS）的学科定位有着直接的启示。CHS正是追求将控制论原理转化为可工程实施的水系统运行技术。

#### 1.2.2 经典控制理论：PID控制及其在水系统中的应用

控制论诞生后，首先发展起来的是**经典控制理论**，其核心工具是基于传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）的频域分析方法和以**PID（比例-积分-微分）控制器**为代表的反馈控制器设计方法。

PID控制器的基本原理是：根据系统输出与期望值之间的偏差（Error），分别计算偏差的比例（P）、积分（I）和微分（D）三个分量，将它们加权求和后作为控制输入。其数学表达为：

$$u(t) = K_p e(t) + K_i \int_0^t e(\tau) d\tau + K_d \frac{de(t)}{dt}$$

其中 $K_p$、$K_i$、$K_d$ 分别为比例、积分和微分增益。比例项提供即时的纠偏力度，积分项消除稳态误差（steady-state error，系统达到稳定后实际输出与目标值之间的偏差，如水位控制中最终剩余的水位偏差），微分项预测偏差的变化趋势以提前纠偏。尽管PID控制器的结构简单，但通过合理的参数整定，它能够在大量实际工程中取得令人满意的控制效果。瑞典隆德大学的**卡尔·约翰·奥斯特罗姆（Karl Johan Åström）**和**托尔·赫格伦德（Tore Hägglund）**是PID控制领域的权威专家，他们的著作系统总结了PID控制的理论和实践 [16]。

**PID控制在水系统中的迁移**有着悠久的历史。PID控制器是最早被应用于水系统自动化控制的算法之一。在灌区渠道的水位控制中，PID控制器被用于根据渠道某一断面的水位偏差来自动调节上游或下游闸门的开度，以维持目标水位。根据控制信号取自闸门上游还是下游，可以分为**上游控制**（Upstream Control）和**下游控制**（Downstream Control）两种基本模式。上游控制以上游水位作为被控量，响应快但对下游需求变化不敏感；下游控制以下游水位作为被控量，能更好地响应用户需求但稳定性较差。美国垦务局（USBR）在20世纪70年代就开始在其管辖的灌区渠道上试验自动化水位控制，PID控制器是其中最常用的算法之一。

1991年，**克利福德·布亚尔斯基（Clifford P. Buyalski）**编写的《渠道系统自动化手册》系统总结了USBR的实践经验 [28]。

在城市供水管网中，PID控制器被广泛用于水泵的变频调速控制，根据管网压力的偏差来调节水泵的转速，以维持稳定的供水压力。在水电站中，PID控制器用于水轮发电机组的调速和励磁控制，以维持发电频率和电压的稳定。可以说，PID控制器至今仍然是水系统自动化中应用最广泛的基础控制算法。

然而，PID控制器在水系统中的实际应用远比在工业过程控制中复杂。工业过程中的PID参数整定通常可以使用**齐格勒-尼科尔斯（Ziegler-Nichols）**方法——通过使系统产生临界振荡来确定参数——但在水系统中，人为制造临界振荡不仅不经济（大量水资源浪费），而且具有安全风险（可能导致渠道溢出或供水中断）。因此，水系统的PID参数整定更多依赖于基于模型的离线仿真方法或基于经验的逐步试探法。此外，水系统的运行工况随季节和水文条件变化很大——丰水期和枯水期的流量可能相差数倍，同一组PID参数很难在所有工况下都表现良好，这就引出了**增益调度（Gain Scheduling）**的需求，即根据工况实时切换PID参数。

在供水管网领域，PID控制器还面临着**水锤（Water Hammer）**防护的挑战。阀门的快速调节会在管道中产生压力瞬变波，严重时可导致管道破裂。因此，PID控制器的输出必须经过速率限制器（Rate Limiter）的约束，确保控制动作的变化速率不超过管道系统的承受能力。这种"安全约束下的控制"需求，恰恰是后来MPC方法在水系统中获得广泛应用的另一个重要原因——MPC能够将控制动作的变化率约束直接纳入优化问题的约束条件中。

然而，PID控制器也有其固有的局限性。它本质上是一个**单输入单输出（SISO）**的线性控制器，难以处理多变量耦合、大时滞、非线性等复杂控制问题。而水系统，特别是长距离输水渠道和复杂的河流-水库系统，恰恰具有这些特征。在一条长距离调水渠道中，闸门之间存在强耦合——调整某一座闸门不仅影响其相邻渠段的水位，还会通过波的传播影响远端渠段。多个独立的PID控制器如果不进行协调，就会出现"各管各的"导致的系统级振荡。此外，水力系统的非线性特征——如堰流公式中流量与水位的3/2次方关系、渠道糙率随水深的变化——使得线性PID在工作点偏离设计点时性能急剧下降。这些局限性，推动了更先进的控制理论向水系统领域的迁移。

#### 1.2.3 现代控制理论：状态空间（state space，用一组状态变量——如各断面水位和流量——来完整描述系统在任意时刻行为的数学框架）与最优控制

20世纪60年代，控制理论迎来了一次革命性的飞跃——从经典控制的频域方法转向**现代控制**的**状态空间方法**。这一转变的核心人物是匈裔美国数学家**鲁道夫·卡尔曼（Rudolf E. Kálmán）**。

1960年，卡尔曼发表了具有里程碑意义的论文《线性滤波和预测问题的新方法》（*A New Approach to Linear Filtering and Prediction Problems*）[17]，提出了后来以他名字命名的**卡尔曼滤波器（Kalman Filter）**。卡尔曼滤波器是一种递推的最优状态估计算法，能够在存在噪声的情况下，从不完整的、不精确的观测数据中，估计出系统的真实状态。在状态空间框架下，系统被描述为一组一阶微分方程（或差分方程）：

$$\dot{\mathbf{x}}(t) = A\mathbf{x}(t) + B\mathbf{u}(t), \quad \mathbf{y}(t) = C\mathbf{x}(t) + D\mathbf{u}(t)$$

其中 $\mathbf{x}$ 为状态向量，$\mathbf{u}$ 为控制输入，$\mathbf{y}$ 为可观测输出，$A, B, C, D$ 为系统矩阵。卡尔曼同时提出了**可控性**（Controllability）和**可观性**（Observability）的严格数学定义——这两个概念回答了控制系统设计中最根本的两个问题：系统是否可以被控制到任意目标状态？系统的内部状态是否可以从外部观测中被推断出来？

基于状态空间模型，可以系统地设计各种最优控制器。其中最经典的是**线性二次型调节器（Linear Quadratic Regulator, LQR）**，它通过最小化性能指标：

$$J = \int_0^\infty [\mathbf{x}^T Q \mathbf{x} + \mathbf{u}^T R \mathbf{u}] dt$$

来求解最优的状态反馈控制律 $\mathbf{u} = -K\mathbf{x}$。LQR理论为多变量系统的最优控制提供了一个优雅而强大的数学框架 [18]。

与LQR同时发展的另一个重要最优控制工具是苏联数学家**列夫·庞特里亚金（Lev Pontryagin）**于1956年提出的**极大值原理（Pontryagin's Maximum Principle）**。极大值原理为连续时间系统的最优控制提供了必要条件，通过引入**协状态变量（Co-state Variable）**和**哈密顿函数（Hamiltonian）**，将最优控制问题转化为一个两点边值问题。在水库优化调度中，极大值原理被用于求解连续时间的最优泄流策略——通过分析协状态变量（可解释为"水资源的边际价值"）随时间的演化，确定每个时刻的最优泄流量。尽管极大值原理在理论上是优美的，但其两点边值问题在多水库系统中的数值求解非常困难，因此在工程实践中逐渐被动态规划和后来的MPC方法所替代。

值得注意的是，LQR和卡尔曼滤波之间存在一种深刻的数学**对偶关系（Duality）**：LQR是在已知状态下求最优控制，卡尔曼滤波是在已知控制下估计最优状态；二者的数学结构完全对称，都归结为一个代数Riccati方程的求解。将二者结合，就得到了**LQG（Linear Quadratic Gaussian）控制器**——在存在高斯噪声的环境下，利用卡尔曼滤波估计状态，然后利用LQR计算最优控制，二者的分离是最优的（即分别设计不损失最优性）。LQG控制器在水系统中的应用场景是自然的：传感器的测量噪声和水文过程的随机性恰好可以用高斯模型来近似。

与卡尔曼同时代的另一位重要人物是美国数学家**理查德·贝尔曼（Richard Bellman）**。1957年，贝尔曼出版了《动态规划》（*Dynamic Programming*）[19]，提出了动态规划方法及其核心——**最优性原理**（Principle of Optimality）：一个最优策略的任何子策略也必须是最优的。动态规划方法在水库优化调度中得到了极为广泛的应用，因为水库调度本质上就是一个多阶段序贯决策问题。1962年，**哈佛水资源项目**（Harvard Water Program）的里程碑式著作《水资源系统设计》（*Design of Water-Resource Systems*）由Arthur Maass等人出版 [20]，首次将系统分析方法系统地引入水资源规划与管理，其中动态规划是核心工具之一。

**现代控制理论在水系统中的迁移**：状态空间方法和LQR控制器的引入，使得水系统控制研究从单变量的PID控制迈向了**多变量最优控制**。法国国家农业、食品与环境研究院（INRAE）的**皮埃尔-奥利维耶·马拉泰尔（Pierre-Olivier Malaterre）**在1998年提出的PILOTE算法，就是LQR控制器在灌区渠道控制中的经典应用 [21]。PILOTE算法将渠道系统建模为一个线性状态空间模型，然后利用LQR方法设计最优的闸门控制律，能够同时协调多个闸门的动作，实现对多个渠段水位的联合控制。马拉泰尔在其博士论文和后续研究中，还系统比较了不同控制方法在ASCE灌区渠道控制测试平台上的性能 [22]，为渠道控制算法的标准化评估做出了重要贡献。

卡尔曼滤波器在水系统中的应用同样广泛。在水文预报中，卡尔曼滤波及其非线性扩展（如**集合卡尔曼滤波**, EnKF）被用于实时校正水文模型的参数和状态，以提高预报精度。在渠道控制中，卡尔曼滤波被用于从有限的水位和流量观测中估计渠道系统的完整状态——因为在实际工程中，不可能在渠道的每个位置都安装传感器，但控制器需要完整的状态信息才能做出最优决策。这一"从有限观测推断完整状态"的需求，正是可观性理论在水系统中的直接应用。UCLA的**叶维廉（William W.-G. Yeh）**在1985年发表的经典综述论文中 [23]，对动态规划及其变体在水库调度中的应用进行了全面的回顾，该论文至今仍是水库优化调度领域被引用最多的文献之一。

#### 1.2.4 大系统控制理论：分层、分散与分解协调

现代控制理论虽然在理论上是优美的，但在面对大规模、复杂系统时，却遇到了严重的**"维数灾难"（Curse of Dimensionality）**问题——随着系统规模的增大，状态变量和控制变量的数量急剧增加，使得集中式的最优控制问题在计算上变得不可行。为了解决这一问题，20世纪60至80年代，**大系统控制理论（Large-Scale Systems Control Theory）**应运而生，催生了三个主要的理论分支。

**分层控制（Hierarchical Control）** 的奠基人是美国凯斯西储大学的**米哈伊洛·梅萨罗维奇（Mihajlo D. Mesarović）**。1970年，梅萨罗维奇出版了《层次化多级系统理论》[24]，奠定了分层系统理论的数学基础。该理论将大系统组织为多个层次，每个层次有不同的决策权限和时间尺度。在水系统控制中，分层控制思想最典型的体现就是**HDC（Hierarchical Distributed Control）**架构：L0层为单闸PID控制（秒级响应），L1层为渠段MPC协调（分钟级），L2层为全线优化调度（小时级）。这三层结构既保证了局部响应的快速性，又实现了全局目标的协调。

**分散控制（Decentralized Control）** 的代表人物是**德拉戈斯拉夫·希利亚克（Dragoslav D. Šiljak）**。1978年，希利亚克出版了《大规模动态系统：稳定性与结构》[25]，系统阐述了大规模动态系统的关联稳定性理论。分散控制的核心思想是：每个子系统的控制器只利用本地可获得的信息来做出控制决策，从而避免了对全局通信的依赖。对于水系统而言，分散控制意味着每座闸门的控制器可以仅根据本地水位和流量信息来决策，不依赖与中央控制器的实时通信。这在通信不可靠的偏远地区尤为重要——即使通信中断，本地控制器仍能维持基本的安全运行。希利亚克的关联稳定性理论提供了一套严格的数学工具，用于判断这种分散控制策略是否能保证整体系统的稳定性。

**分解协调（Decomposition-Coordination）** 的代表人物是波兰华沙理工大学的**弗拉迪斯瓦夫·芬德森（Władysław Findeisen）**。1980年，芬德森出版了《分层系统中的控制与协调》[26]，详细介绍了分层系统中的控制与协调方法，包括价格协调法（通过"影子价格"引导子系统的决策）和目标协调法（通过分配子目标来协调子系统）。这些方法在水资源系统的优化分配中有着天然的应用场景——例如，在一个多水库系统中，可以通过为每个水库设定"水资源价格"来引导各水库的独立调度，使得全系统的总效益最大化。中国水利水电科学研究院（IWHR）**王浩院士**团队在水资源系统分析中采用的分解协调方法，正是这一理论在中国水利实践中的成功应用。

大系统控制理论对水系统控制论（CHS）的影响是深远而根本的。CHS中的**"分层分布式统一"**维度，就是分层控制与分散控制思想的综合体现。在CHS框架下，水系统被组织为多个控制层级，每个层级内部采用分布式控制，层级之间通过协调机制保持一致性。这种"层内分布、层间协调"的架构，直接源于大系统控制理论的思想遗产。

#### 1.2.5 鲁棒（robust，指系统在参数变化或外部干扰下仍能保持稳定性能的能力，类似于水利工程中的'抗干扰性'）控制与自适应控制：应对不确定性

控制系统在实际运行中，不可避免地面临各种不确定性：模型参数的误差、外部扰动的不确定性、传感器的测量噪声、执行器的非理想特性等。**鲁棒控制（Robust Control）**和**自适应控制（Adaptive Control）**是控制科学应对不确定性的两条主要技术路线。

鲁棒控制的核心思想是"最坏情况下的最优"——在设计控制器时，不是针对系统的标称模型进行优化，而是要保证在模型参数变化、外部扰动等不确定性因素在给定范围内变化时，系统仍能保持稳定并满足性能要求。鲁棒控制理论的奠基性工作是美国数学家**乔治·扎梅斯（George Zames）**于1981年提出的 $H_\infty$ 最优控制理论 [27]，该理论将控制器设计问题转化为一个最小化"最坏情况下系统增益"的优化问题。随后，**约翰·道尔（John C. Doyle）**和**基思·格洛弗（Keith Glover）**等人进一步发展了 $H_\infty$ 控制和结构化奇异值（$\mu$-synthesis）方法，形成了完整的鲁棒控制理论体系。

自适应控制则采取了另一种策略——不是在设计阶段就考虑所有可能的不确定性，而是让控制器在运行过程中根据实测数据"学习"和"适应"。自适应控制器通过在线辨识系统参数，并根据辨识结果实时调整控制策略，从而适应系统特性的变化。**卡尔·约翰·奥斯特罗姆**和**比昂·维特马克（Björn Wittenmark）**的著作《自适应控制》（*Adaptive Control*，第二版，1995年）[28]是该领域的经典教材。

**在水系统中的迁移**：鲁棒控制和自适应控制对水系统运行具有特殊的重要性，因为水系统的不确定性是本质性的、无法消除的。水文预报永远存在误差，用水需求随时在变化，渠道糙率随季节和生物附着而变化，闸门的实际过流特性与理论公式总有偏差。在这种不确定性环境下，一个仅基于标称模型设计的控制器（无论多么"最优"）在面对实际运行条件时都可能失效。

鲁棒MPC是鲁棒控制与MPC的结合产物，它在优化过程中显式地考虑了模型不确定性和扰动的有界性，通过求解一个带有不确定性约束的min-max优化问题来保证控制系统在最坏情况下仍然满足安全约束。水系统控制论中**"安全包络"（Safety Envelope）**的概念，本质上就是鲁棒控制思想的体现——安全包络定义了系统在所有可能的不确定性实现下都必须满足的硬约束边界。

自适应控制在水系统中的应用则体现在参数在线辨识和控制策略的自动调整上。例如，渠道的糙率系数 $n$ 会随着时间变化（杂草生长、泥沙淤积等），自适应MPC控制器可以通过在线对比模型预测与实际观测的偏差，持续更新 $n$ 的估计值，从而保持模型的准确性和控制的有效性。

更深入地分析，水系统中的不确定性具有**结构化特征**，这为鲁棒控制方法的应用提供了有利条件。水力学模型的不确定性主要来源于几个可辨识的参数：曼宁糙率系数 $n$（通常在±20%范围内变化）、闸门流量系数 $C_d$（受闸门磨损和淤积影响）、旁侧入流量（受降雨和地下水补给的随机影响）以及取水量的预报偏差。这些不确定性的有界性使得鲁棒控制理论中的**集合预测方法（Set-based Prediction）**特别适用：通过计算系统状态在所有可能的不确定性实现下的**可达集（Reachable Set）**，可以严格保证水位不会超过安全限值。

在实际工程中，鲁棒控制和自适应控制往往不是二选一的关系，而是互为补充。短时间尺度上（分钟到小时），鲁棒控制提供"最坏情况"的安全保证；长时间尺度上（天到季），自适应机制根据积累的运行数据逐步修正模型参数，缩小不确定性的范围，使鲁棒控制器的保守性逐渐降低、性能逐步提升。这种**"短期鲁棒、长期自适应"**的双时间尺度策略，在CHS框架中被概括为**"确定性与随机性统一"**维度的核心内容——确定性控制方法处理已知的系统动力学，随机性方法处理不可预测的扰动和变化。

#### 1.2.6 模型预测控制（MPC）：从工业过程到水系统

**模型预测控制（Model Predictive Control, MPC）**是20世纪后半叶控制科学最重要的方法论创新之一，它完美地融合了最优控制的理论优雅和工程实践的现实需求，被公认为处理多变量、多约束、大时滞系统控制问题的最有效方法。

MPC的起源可以追溯到20世纪70年代末的石化工业。1978年，法国工程师**雅克·里沙莱（Jacques Richalet）**等人提出了**"模型算法控制"（Model Algorithmic Control, MAC）**，也称为**"模型预测启发控制"（Model Predictive Heuristic Control, MPHC）**[29]，开创了工业MPC的先河。几乎同时，美国壳牌石油公司的**查尔斯·卡特勒（Charles R. Cutler）**和**布赖恩·雷马克（Brian L. Ramaker）**提出了**"动态矩阵控制"（Dynamic Matrix Control, DMC）**[30]。

1987年，英国学者**大卫·克拉克（David W. Clarke）**等人提出了**"广义预测控制"（Generalized Predictive Control, GPC）**[31]，进一步统一和推广了MPC的理论框架。

MPC的核心思想可以概括为三个关键步骤的循环：**预测**——利用系统的动态模型，在每个控制时刻预测未来一段时间（预测时域 $T_p$）内系统的行为；**优化**——在满足各种约束的前提下，求解一个使性能指标最小化的优化问题，得到未来一段时间内的最优控制序列；**滚动执行**——只执行最优控制序列的第一个控制动作，然后在下一个控制时刻，利用新的测量信息重新进行预测和优化。这种"滚动时域"策略的精妙之处在于：它将一个不可解的无穷时域最优控制问题，转化为一系列可解的有限时域优化问题，同时通过反复利用最新的测量信息来补偿模型误差和扰动的影响。

MPC问题的标准数学表述为：

$$\min_{\mathbf{u}_{k:k+N_c-1}} J = \sum_{i=1}^{N_p} \left( \|\mathbf{y}_{k+i} - \mathbf{y}_{k+i}^{ref}\|_{Q}^2 + \|\Delta \mathbf{u}_{k+i-1}\|_{R}^2 \right)$$

约束条件包括：动态约束 $\mathbf{x}_{k+1} = f(\mathbf{x}_k, \mathbf{u}_k)$（系统的状态转移方程），物理约束（闸门开度上下限、泵站功率限制、库容约束等），安全约束（水位不得超过警戒线、流速不得超过渠道设计值等），以及运维约束（控制动作变化率限制、执行机构频繁动作次数限制等）。

MPC在学术界的理论完善主要归功于三位学者的贡献。美国威斯康星大学的**詹姆斯·罗林斯（James B. Rawlings）**和英国学者**大卫·梅恩（David Q. Mayne）**在MPC的稳定性理论和鲁棒性分析方面做出了奠基性贡献，他们合著的《模型预测控制：理论、计算与设计》（2017年）[32]是MPC领域最权威的理论专著。特别是，罗林斯和梅恩建立的**终端约束/终端代价框架**为证明MPC的闭环稳定性提供了系统化的理论工具：通过在有限时域优化问题中添加适当的终端约束集和终端代价函数，可以保证滚动时域策略产生的闭环系统是渐近稳定的。这一理论框架对水系统MPC的工程实施具有直接的指导意义——在设计水系统MPC控制器时，必须仔细选择终端约束和终端代价，以保证在各种运行工况下的闭环稳定性。

近年来，**经济MPC（Economic MPC）**作为MPC理论的重要扩展受到了广泛关注。传统MPC的目标函数通常是跟踪参考轨迹的二次型代价，而经济MPC允许使用更一般的目标函数——例如直接最小化运行成本或最大化经济收益。对于水系统而言，经济MPC特别适用于水电站的发电调度（直接以发电收益为目标函数）和水资源分配（以经济总效益为目标函数），它将"控制"和"优化调度"统一在一个数学框架中。

荷兰代尔夫特理工大学的**彼得·扬·范·奥弗卢普（Peter Jan van Overloop）**则将MPC系统地引入开放水道控制领域，他2006年的博士论文《开放水系统的模型预测控制》（*Model Predictive Control on Open Water Systems*）[33]是水系统MPC领域的里程碑之作。

**MPC在水系统中的迁移**是控制科学向水系统领域迁移的最成功案例之一。MPC之所以特别适合水系统控制，是因为水系统恰好具备MPC最擅长处理的三个特征：**大时滞**（长距离输水渠道的波传播延时可达数小时）、**多变量耦合**（多个闸门之间通过水力学过程相互影响）和**多约束**（水位上下限、流量限制、设备能力等各种硬约束）。PID控制器无法处理约束，LQR控制器虽然能处理多变量但同样无法显式处理约束，而MPC将约束处理作为其核心能力之一。

MPC在水系统中的标志性应用当属澳大利亚**Rubicon Water**公司的**"全面渠道控制"（Total Channel Control, TCC）**系统 [34]。TCC系统将MPC算法与Rubicon自主研发的高精度自动化闸门（FlumeGate）相结合，实现了灌区渠道水位的厘米级精确控制和按需供水，将灌溉水利用效率从传统的60%-70%提升到90%以上。TCC系统在澳大利亚、美国、中国等多个国家的灌区得到了成功应用，是MPC从理论走向工程实践的典范。在中国，胶东调水工程的MPC控制系统实现了500多公里输水干线的自动化调度，控制精度达到±0.05米。

#### 1.2.7 分布式模型预测控制（Distributed Model Predictive Control, DMPC）（DMPC）：大规模水网的新范式

当水系统的规模进一步增大——从单条渠道扩展到跨流域水网——集中式MPC面临着严峻的挑战：计算复杂度随系统规模呈指数增长，通信负担急剧加重，且存在单点故障风险。为了克服这些困难，**分布式模型预测控制（Distributed Model Predictive Control, DMPC）**应运而生，它是大系统控制理论与MPC方法的有机融合。

DMPC的核心思想是：将大规模系统分解为多个子系统，每个子系统配备一个本地MPC控制器，各本地控制器之间通过通信交换预测信息和耦合变量，通过迭代协商来协调各自的控制决策，最终达到全局一致的（近）最优解。DMPC保留了MPC处理约束和预测优化的优势，同时通过分布式计算降低了单个控制器的计算负担，并通过去中心化架构提高了系统的鲁棒性。

根据协调机制的不同，DMPC可以分为多种类型：**合作式DMPC**中，各子系统共享同一个全局目标函数，通过迭代优化各自的局部控制变量来最小化全局目标；**非合作式DMPC**中，各子系统各有自己的目标函数，通过纳什均衡或其他博弈论概念来达到平衡；**层次化DMPC**中，上层协调器负责分配全局资源和目标，下层控制器在给定的资源和目标约束下独立优化。

对于大规模水网而言，DMPC是最有前景的控制架构之一。DMPC的理论挑战主要在于两个方面：一是**收敛性保证**——各本地控制器的迭代协商过程是否一定收敛到全局（近）最优解？二是**闭环稳定性**——在滚动时域框架下，DMPC是否能保证系统的稳定性？针对第一个问题，研究者发展了多种收敛性保证方法：在合作式DMPC中，如果各子系统的耦合强度满足一定条件（如对角占优条件），可以证明交替方向乘子法（ADMM）等分布式优化算法的收敛性；在非合作式DMPC中，纳什均衡的存在性和唯一性条件提供了收敛保证。针对第二个问题，**终端约束法**和**终端代价法**是两种主要的稳定性保证策略——通过在局部优化问题中添加适当的终端约束或终端惩罚项，可以在不牺牲分布式架构优势的前提下保证闭环稳定性。

在南水北调中线工程这样的超大型调水系统中，一条1,432公里长的总干渠被划分为多个控制段，每个控制段配备本地DMPC控制器。控制器之间通过通信网络交换相邻渠段的水位预测和流量协调信号，通过几轮迭代协商就能达到全线协调的控制方案。即使某个控制段的通信中断，该段的本地控制器仍可独立运行（采用分散控制模式），保证基本安全——这种"优雅降级"（Graceful Degradation）能力是集中式控制所不具备的。

#### 1.2.8 智能控制：模糊控制与神经网络控制

20世纪60年代以来，随着人工智能技术的发展，**智能控制（Intelligent Control）**作为控制科学的一个新分支逐渐兴起。智能控制试图将人工智能的方法引入控制系统设计，以解决传统控制方法难以处理的高度非线性、强不确定性和难以精确建模的复杂系统控制问题。

**模糊控制（Fuzzy Control）**的理论基础是美国加州大学伯克利分校的**卢特菲·扎德（Lotfi A. Zadeh）**于1965年提出的**模糊集合论（Fuzzy Set Theory）**[35]。模糊控制器利用模糊集合和模糊推理规则（如"如果水位偏高，则减小闸门开度"），将人类专家的经验知识编码为控制规则，无需建立精确的数学模型即可实现有效的控制。模糊控制在水系统中的应用始于20世纪90年代。由于水系统的决策过程中大量依赖调度员的经验判断和模糊推理，模糊控制为将这些经验知识形式化和自动化提供了一种自然的途径。

**神经网络控制（Neural Network Control）**则利用人工神经网络强大的非线性映射和学习能力来设计控制器。神经网络在水系统中的应用广泛：在水文预报领域，长短期记忆网络（LSTM）等深度学习模型在降雨-径流预报方面取得了优异的性能；在水系统控制领域，神经网络被用于建立水力学过程的快速替代模型（Surrogate Model），以加速MPC等在线优化算法的求解。

近年来，**强化学习（Reinforcement Learning, RL）**作为一种新兴的智能控制方法，在水系统控制中引起了广泛关注。强化学习的核心思想是：智能体通过与环境的试错交互来学习最优控制策略，无需预先建立精确的系统模型。

**深度强化学习（Deep RL）**将深度神经网络与强化学习相结合，能够处理高维状态空间和连续动作空间的控制问题。在水库调度中，Deep RL已被用于学习多目标调度策略——在防洪、发电、生态流量等多个目标之间自动寻找帕累托最优的调度方案。然而，强化学习在水系统中的应用面临一个根本性挑战：水系统的安全约束是**硬约束**（如水位不得超过堤防高度），而标准的RL算法只能处理**软约束**（通过奖惩信号来"引导"而非"保证"约束满足）。如何在RL框架中保证硬约束的满足，是当前研究的前沿课题之一，其解决方案包括约束强化学习（Constrained RL）、安全强化学习（Safe RL）以及将RL与MPC相结合的混合方法。

值得特别指出的是，智能控制方法并不是要取代经典的基于模型的控制方法，而是要与之互补融合。在水系统控制论（CHS）的框架中，**物理模型驱动的控制方法**（如MPC）和**数据驱动的智能控制方法**（如神经网络）被视为互补的"双引擎"——前者提供物理可解释性和安全保障，后者提供灵活性和自适应能力。这种融合的思想，在CHS中被概括为"Physical AI + Cognitive AI"的双引擎架构。

这里有必要对物理AI和认知AI的分工与协作进行更详细的说明。**物理AI（Physical AI）**是指基于物理定律和数学模型的控制方法，包括MPC、鲁棒控制、LQR等。物理AI的优势在于：其行为是可解释的（每个控制动作都可以追溯到物理原因），是可验证的（可以通过数学证明保证稳定性和约束满足），且在模型准确的前提下能达到理论最优。但物理AI的局限在于：对模型精度高度依赖，对未见过的工况适应性差，且在面对难以建模的复杂现象（如淤积、冰凌、生物附着）时力不从心。

**认知AI（Cognitive AI）**是指基于机器学习和人工智能的方法，包括深度学习、强化学习、大语言模型等。认知AI的优势在于：能从大量运行数据中发现隐藏的模式和规律，对未建模的扰动具有天然的适应能力，且能处理传统模型难以描述的复杂现象。但认知AI的局限在于：其行为缺乏可解释性（黑箱性质），无法保证约束满足（安全性无法证明），且对训练数据的质量和代表性高度依赖。

CHS的双引擎架构正是要发挥两者的互补优势：以物理AI为主引擎，保证系统的安全性、稳定性和可解释性；以认知AI为辅助引擎，增强系统的适应性、灵活性和对未知工况的应对能力。具体而言，认知AI可以在以下方面增强物理AI的能力：模型参数的在线辨识和校正（利用深度学习从运行数据中估计难以直接测量的物理参数），扰动的预测和补偿（利用LSTM等时序模型预测未来的降雨、需水量等扰动信号），以及运行模式的自动识别和切换（利用分类模型判断当前系统处于正常、过渡、紧急等哪种运行模式，从而自动选择最适合的控制策略）。这种"物理为基、数据增强"的融合范式，是CHS在控制方法论层面的核心创新。

#### 1.2.9 多智能体系统（MAS）：从集中到分布式智能

控制科学发展的最新前沿之一是**多智能体系统（Multi-Agent Systems, MAS）**。MAS的概念源于分布式人工智能和计算机科学，但其核心思想与大系统控制理论中的分散控制和分层控制高度一致，可以视为大系统控制理论在人工智能时代的新发展。

MAS领域的重要学者包括英国的**迈克尔·伍尔德里奇（Michael Wooldridge）**和**尼克·詹宁斯（Nick Jennings）**。伍尔德里奇的著作《多智能体系统导论》（2009年第二版）[36]是该领域的经典教材。MAS的核心思想是：将一个复杂系统分解为多个自主的、具有感知、推理和行动能力的智能体，每个智能体负责系统的一个局部，智能体之间通过通信和协商来协调行为，共同完成全局任务。

MAS方法在水系统控制中的应用带来了一种全新的**架构范式**。从软件工程的角度看，MAS为水系统控制提供了一个天然的**模块化和标准化框架**。国际上，**FIPA（Foundation for Intelligent Physical Agents）**制定了一套智能体通信和交互的国际标准，包括智能体通信语言（ACL）、交互协议（如合同网协议Contract Net Protocol）、智能体管理服务等。在水系统中采用FIPA兼容的MAS架构，意味着不同厂商开发的控制模块可以通过标准化的接口进行集成和互操作，这对于打破水利行业长期存在的信息孤岛和系统封闭问题提供了关键理论支撑。

具体而言，在一个基于MAS的水系统控制架构中，可以定义三类智能体：**渠池智能体**（Pool Agent）——负责单个渠段或节点的本地控制，维持水位在安全范围内，其内部集成了本地MPC控制器和状态估计器；**枢纽智能体**（Hub Agent）——负责分水口、汇合口等关键节点的流量协调和资源分配，具有多目标优化和冲突仲裁能力；**全局协调智能体**（Global Coordinator Agent）——负责全系统目标的设定和资源的宏观分配，基于全局优化模型制定调度方案并将分解后的子目标下达给各枢纽智能体。三类智能体之间形成"自底向上汇报、自顶向下协调"的信息流，构成一个有机的分层分布式控制体系。

MAS方法与传统SCADA系统的融合正在形成一种新的技术范式——**SCADA+MAS融合架构**。在这一架构中，SCADA系统继续承担数据采集和监控的基础功能，而MAS层则叠加在SCADA之上，为系统注入分布式决策智能。每个MAS智能体可以访问SCADA系统中的实时数据，利用本地模型进行预测和决策，并通过SCADA的通信网络与其他智能体交换信息。这种融合架构既保留了SCADA系统成熟可靠的工业特性，又引入了MAS的分布式智能和灵活性，是水系统从自动化向智能化演进的重要技术路径。

MAS方法的独特优势在于其**容错性和可扩展性**。当某个渠池智能体因通信故障而失联时，其邻居智能体可以通过协商重新分配控制任务，确保系统整体的运行不受严重影响。当水网新增一条支线或一座泵站时，只需增加相应的智能体并建立与邻居的通信连接，无需重新设计整个控制系统。这种"即插即用"的可扩展性，对于中国正在建设中的国家水网具有重要的工程意义。

此外，MAS与博弈论（Game Theory）的结合正在成为水系统控制研究的新热点。在多用户共享水资源的场景中，各用户可以被建模为具有各自利益的博弈参与者，通过纳什均衡（Nash Equilibrium）或帕累托最优（Pareto Optimum）等博弈论概念来设计分配规则，实现水资源的公平高效分配。这种基于博弈论的MAS方法，为解决水资源分配中的公平性与效率的权衡问题提供了新的数学工具。

值得特别指出的是，水系统的网络拓扑结构为博弈论的应用提供了自然的框架。在一个树状分水网络中，上游用户的取水决策直接影响下游用户的可用水量，这种**序贯博弈（Sequential Game）**结构可以用**斯坦科尔伯格博弈（Stackelberg Game）**来建模——上游作为"领导者"先行决策，下游作为"跟随者"做出最优反应。而在一个环状管网中，各用户之间的影响是相互的、同时的，更适合用**纳什博弈**来建模。不同的水网拓扑结构对应不同的博弈结构，需要不同的求解方法和均衡概念。

#### 1.2.9.1 网络控制理论：水系统控制的图论基础

近年来兴起的**网络控制理论（Networked Control Theory）**为水系统控制提供了新的数学工具。网络控制理论将控制系统与通信网络相结合，研究在有限的通信带宽、网络时延、数据丢包等通信约束下如何设计有效的控制策略。对于水系统这种地理分布广泛、传感器和执行机构通过通信网络连接的大规模分布式系统，网络控制理论的工具是不可或缺的。

**图论（Graph Theory）**为描述水网的拓扑结构提供了自然的数学语言。水网可以被建模为一个有向图，其中节点代表水库、泵站、分水口等设施，边代表渠道、管道等输水线路。图的邻接矩阵、拉普拉斯矩阵等代数工具，可以用于分析水网的连通性、可控性和鲁棒性。特别是，**图论可控性**的研究表明，一个网络系统的可控性不仅取决于各节点的动力学特性，还取决于网络的拓扑结构——某些节点（如水网中的关键枢纽）对全系统的可控性贡献远大于其他节点。这一发现对于水网中传感器和执行机构的优化布局具有重要的指导意义。

**一致性理论（Consensus Theory）**是网络控制理论的核心内容之一，研究多个智能体如何通过局部通信达成全局一致。在水系统控制中，一致性理论可应用于多个渠段控制器之间的流量协调——各控制器通过与相邻控制器交换信息，逐步调整各自的流量决策，最终达到全局供需平衡。一致性算法的收敛速度取决于网络的拓扑结构（由拉普拉斯矩阵的代数连通度决定），这为水网通信架构的设计提供了定量的优化准则。

#### 1.2.10 控制科学各阶段向水系统迁移的总结

下表系统总结了控制科学各阶段的核心思想及其向水系统控制领域的迁移历程：

| 控制科学阶段 | 时间 | 代表人物 | 核心思想 | 在水系统中的迁移应用 |
| :--- | :--- | :--- | :--- | :--- |
| 控制论诞生 | 1948 | 维纳、钱学森 | 反馈、通信、控制的统一 | 水系统运行的"感知-决策-执行-反馈"闭环范式 |
| 经典控制（PID） | 1940s-1960s | Åström、Hägglund | 基于偏差的比例-积分-微分反馈 | 渠道水位控制、管网压力控制 |
| 现代控制（LQR） | 1960s | Kalman、Bellman | 状态空间、最优控制、动态规划 | 多变量渠道控制（PILOTE）、水库优化调度 |
| 大系统控制（HDC） | 1970s-1980s | Mesarović、Šiljak、Findeisen | 分层、分散、分解协调 | 大型调水工程的分层分布式控制架构 |
| 鲁棒/自适应控制 | 1980s | Zames、Åström | 不确定性下的稳定性和性能保证 | 应对水文预报误差和模型不确定性 |
| 模型预测控制（MPC） | 1978- | Richalet、Clarke、Rawlings、Van Overloop | 基于模型的预测、在线优化、约束处理 | 渠道精确控制（TCC）、水库实时调度 |
| 分布式MPC（DMPC） | 2000s- | 合作/非合作/层次化架构 | 大规模系统的分布式预测优化 | 跨流域水网的协同控制 |
| 智能控制 | 1965- | Zadeh | 模糊逻辑、神经网络 | 经验知识形式化、非线性系统建模与控制 |
| 多智能体系统（MAS） | 1990s- | Wooldridge、Jennings | 分布式决策、协作式问题求解 | 水网分布式协同调度、SCADA+MAS融合 |

这一迁移历程清晰地表明，水系统控制领域的发展始终与控制科学的前沿保持着紧密的同步关系。每当控制科学出现新的理论突破，水系统控制研究者就会迅速将其引入并加以应用和发展。更重要的是，水系统的独特特征——大时滞、强非线性、多约束、分布式、高安全要求——也在反向推动着控制理论的创新。例如，水系统对安全性的极端要求催生了"安全包络"的概念；水网的超大规模推动了DMPC和MAS方法的发展；水系统的开放复杂巨系统特性促成了"Physical AI + Cognitive AI"双引擎的融合思想。这种"理论迁移"与"需求倒逼"的双向互动，正是水系统运行科学与工程不断走向成熟的核心动力。

从更宏观的视角审视这一迁移历程，可以发现一条清晰的演进主线：**从确定性到不确定性，从集中式到分布式，从反应式到预测式，从单一目标到多目标，从人工决策到自主智能**。维纳的反馈控制论假设系统是确定的、可精确建模的；鲁棒控制和自适应控制引入了对不确定性的显式处理；MPC将控制从"反应"推向了"预测"；经济MPC和多目标优化扩展了控制的目标维度；而强化学习和MAS正在将控制从人工决策推向自主智能。每一次转变都使得控制理论更接近水系统运行的真实需求，也为CHS理论框架的建立提供了越来越完善的技术基础。

特别值得强调的是控制科学中**"系统"思维**对CHS的深层影响。控制科学不是简单地研究"如何设计一个好的控制器"，而是研究"如何使一个系统整体表现最优"。这种系统整体论的视角，使得CHS超越了传统水利工程中"以工程设施为中心"的思维模式，转向"以系统运行为中心"的新范式。在CHS的框架中，物理基础设施（渠道、闸门、水库）只是系统的"躯体"，信息基础设施（传感器、通信网络、计算平台）是系统的"神经系统"，而控制算法和决策策略则是系统的"大脑"。三者的有机融合，才构成一个完整的、具有自主运行能力的水系统。

从控制科学发展史中还可以汲取一个重要的方法论启示：**理论的简洁性与工程的复杂性之间的平衡**。控制科学中最成功的方法——如PID控制、MPC——并不是数学上最优美或最深奥的，而是在理论完整性和工程可实现性之间取得了最佳平衡。PID控制器虽然理论上不如LQR"最优"，但其结构简单、参数直观、实现容易，因而在工程中经久不衰。MPC虽然计算量大于PID，但其框架足够灵活以容纳各种工程约束，因而在复杂系统中脱颖而出。CHS在发展过程中，同样追求这种"理论深度"与"工程实用性"之间的平衡——既要有严格的数学基础，又要能在真实的大型水利工程中得到实际应用。这种"面向工程的控制科学"精神，直接继承了钱学森《工程控制论》的学术传统。

---

**思考与讨论**

1. （概念理解）PID控制器的三个参数（比例、积分、微分）分别对应水位控制中的什么物理含义？
2. （分析比较）经典PID控制和模型预测控制（MPC）在处理大延迟系统（如50km渠池）时各有什么优劣势？
3. （综合设计）假设你面对一条有3个渠池串联的输水渠道，每个渠池延迟约20分钟，请分析采用集中式MPC和分布式MPC的利弊。


---


---

### §1.2 本节小结


本节回顾了控制科学从经典PID到现代分布式MPC的演进脉络，提炼出三条对水系统控制具有决定性影响的技术线索：（1）反馈控制原理（维纳→卡尔曼）为水位闭环调节提供了数学基础；（2）最优控制与MPC（庞特里亚金→Rawlings）为多约束、多目标水系统调度提供了在线优化框架；（3）鲁棒控制与自适应控制为应对模型不确定性和参数时变提供了理论保障。这三条线索在CHS框架中被整合为"可控模型族+分层MPC+安全包络"的控制体系。

> **图 1-2　控制理论在水系统中的技术演进时间线**
> *Fig. 1-2 Timeline of Control Theory Evolution in Water Systems*
>
> ```
>   1940s        1960s        1980s        2000s        2020s
>     │            │            │            │            │
>     ▼            ▼            ▼            ▼            ▼
>   维纳         卡尔曼       Åström       Rawlings      CHS
>   控制论       状态空间     自适应控制    MPC综述      双引擎
>     │            │            │            │            │
>     ▼            ▼            ▼            ▼            ▼
>   ┌──────┐  ┌──────────┐  ┌────────┐  ┌─────────┐  ┌────────┐
>   │PID水位│  │最优水库  │  │自校正  │  │渠道MPC  │  │DMPC+   │
>   │调节器 │  │调度      │  │渠道控制│  │安全约束 │  │安全RL  │
>   └──────┘  └──────────┘  └────────┘  └─────────┘  └────────┘
>   Buyalski    Yakowitz     Åström &     Negenborn    Lei 2025
>   (1991)     (1982)       Wittenmark   (2009)       CHS框架
>                           (1995)
> ```

### 1.3 人工智能：从符号推理到深度学习

> ---

> **📖 给水利工程师的速览：AI在水利中能做什么？**
>
> 人工智能在水利中的应用可以分为三个层次：**第一层是"看"**——用图像识别检测大坝裂缝、用异常检测发现管网漏损；**第二层是"预测"**——用深度学习进行洪水预报、水位预测，通常比传统水文模型更准确；**第三层是"决策"**——用强化学习优化水库调度策略。目前大多数应用集中在第一、二层（数据分析和预测），第三层（自主决策）仍处于研究阶段。AI不能替代物理模型——它不理解水力学原理，可能给出物理上不可能的结果。因此CHS提出"双引擎"架构：物理AI（基于水力学方程）负责安全关键的控制决策，认知AI（如大语言模型）负责辅助分析和知识问答。
> ---

人工智能（Artificial Intelligence, AI）是水系统运行科学与工程的第三大理论支柱。如果说系统科学提供了"世界观"，控制科学提供了"方法论"，那么人工智能则提供了一种全新的"智能化手段"——让水系统具备学习、推理、理解和自主决策的能力。AI的发展历程——从符号推理到机器学习，从深度学习到大语言模型——每一次突破都在重新定义水系统运行的可能性边界[212]。

#### 1.3.1 AI的诞生与早期发展

1956年，在美国达特茅斯学院举行的一次夏季研讨会上，**约翰·麦卡锡（John McCarthy）**、**马文·明斯基（Marvin Minsky）**、**克劳德·香农（Claude Shannon）**和**纳撒尼尔·罗切斯特（Nathaniel Rochester）**等人首次提出了"人工智能"这一术语。这次会议标志着AI作为一个独立学术领域的正式诞生 [38]。

早期AI研究遵循**符号主义**（Symbolism）路线，试图通过形式逻辑和符号推理来实现智能。代表性成果包括纽厄尔（Allen Newell）和西蒙（Herbert Simon）的"通用问题求解器"（GPS），以及费根鲍姆（Edward Feigenbaum）开创的"专家系统"（Expert System）。专家系统通过"如果-那么"（IF-THEN）规则将人类专家的知识编码为计算机可执行的推理系统。在水利领域，20世纪80至90年代也出现了一些基于规则的专家系统，用于辅助水库调度决策、水质分析和灌区管理。

例如，美国陆军工程兵团（USACE）开发了基于专家系统的洪水预警和调度辅助系统，澳大利亚灌溉委员会研制了灌区需水预测专家系统，中国水利水电科学研究院也在20世纪90年代开发了面向南水北调工程的调度知识库原型。然而，这些系统的知识获取成本高、维护困难、泛化能力差，随着机器学习技术的兴起逐渐退出了主流。

与符号主义路线并行发展的还有**联结主义**（Connectionism）路线，它试图通过模拟人脑神经元的连接结构来实现智能。1943年，McCulloch和Pitts提出了人工神经元的数学模型；1957年，罗森布拉特（Frank Rosenblatt）发明了感知机（Perceptron），开创了人工神经网络研究的先河。然而，1969年明斯基和帕普特的著作《感知机》指出了单层感知机的局限性（无法解决XOR问题），导致神经网络研究进入了长达十余年的"寒冬"。1986年，鲁梅尔哈特（David Rumelhart）等人提出了**反向传播算法**（Back-Propagation），使得多层神经网络的训练成为可能，人工神经网络研究由此复兴。

在水利领域，基于BP神经网络的水文预报模型在20世纪90年代至21世纪初已在多个工程中成功部署，成为将AI引入水系统研究的重要桥梁。ASCE于2000年发表的专题文章系统评价了人工神经网络在水资源领域的应用状况，标志着这一技术在水利学界获得了主流认可。

尽管符号主义路线在实践中遭遇了瓶颈，但它留下了一个重要的遗产——**知识表示与推理**（Knowledge Representation and Reasoning, KR&R）的框架。这一框架在后来的知识图谱（knowledge graph，以图结构存储实体及其关系的知识表示方法，如'闸门A→控制→渠段B→连接→闸门C'）技术中得以复兴，成为水系统认知智能的重要组成部分。值得指出的是，AI发展中符号主义与联结主义两条路线的长期之争，在水系统领域有着特殊的映射——**符号主义对应于基于物理机理的建模方法**（如Saint-Venant方程的数值求解），**联结主义对应于基于数据驱动的建模方法**（如神经网络的拟合训练）。而CHS所倡导的"数据与物理融合"的建模理念，从AI哲学的角度看，本质上是对符号主义和联结主义两条路线的辩证统一。

#### 1.3.2 机器学习：从数据中学习

20世纪80年代至21世纪初，AI研究的重心从符号推理转向**机器学习**（Machine Learning, ML）。机器学习的核心思想是：不需要人为编写规则，而是让计算机从数据中自动学习规律。这一思路的转变对水系统研究产生了深远影响，因为水利行业恰好拥有大量的历史运行数据，却难以将所有运行规律显式地总结为规则。

机器学习的主要范式包括**监督学习**（Supervised Learning）、**无监督学习**（Unsupervised Learning）和**强化学习**（Reinforcement Learning）[205]。在水系统领域，监督学习被广泛应用于水文预报（利用历史降雨-径流数据训练预报模型）、需水预测（利用历史用水数据预测未来需求）和设备故障诊断（利用设备运行数据训练异常检测模型）。无监督学习则被用于水质异常检测、管网漏损定位和运行工况聚类分析。

值得特别提及的是**半监督学习**（Semi-Supervised Learning）在水系统中的潜在价值。水利行业存在一个普遍的"标注瓶颈"——获取大量带标注的训练数据往往需要耗费大量的人力和时间（例如，对管网漏损事件进行标注需要结合现场勘查结果），而未标注的运行数据则相对容易获取。半监督学习可以同时利用少量标注数据和大量未标注数据进行学习，大大降低了对标注数据的需求。此外，**主动学习**（Active Learning）策略可以智能地选择最有价值的数据样本进行标注，进一步提高数据标注的效率。这些技术对于降低水系统智能化的数据门槛具有重要的现实意义。

强化学习将在本章§1.3.4中单独详细讨论。

在众多机器学习算法中，**支持向量机**（Support Vector Machine, SVM）、**随机森林**（Random Forest）和**梯度提升树**（Gradient Boosting Trees）在21世纪初的水系统研究中已在多个工程中成功部署。这些方法在处理中等规模数据集的表格型数据时表现出色，但在处理大规模、高维、序列型数据时存在局限性——这一局限性后来被深度学习所克服。

值得特别强调的是**集成学习**（Ensemble Learning）思想在水系统中的价值。水系统运行数据具有多源异构、时空相关、噪声多样的特点，单一模型难以全面捕捉这些复杂特性。集成学习通过组合多个弱学习器来构建强学习器，本质上是一种"模型民主化"策略。在水文预报中，将多个不同结构的模型进行集成（如贝叶斯（Bayesian，一种基于先验知识和观测数据进行概率推断的统计方法）模型平均、堆叠泛化），其预报精度和可靠性通常显著优于任何单一模型。这一思想后来在CHS的可控模型族谱中得到了继承和发展——通过构建从高保真到低保真的多层次模型族谱，并在不同场景下选择最优模型或进行模型融合，实现计算效率与精度的最佳平衡。

**迁移学习**（Transfer Learning）是另一个对水系统研究影响深远的机器学习范式。水利行业的一个普遍困境是：数据丰富的流域或工程可以训练出高精度的模型，但数据稀缺的流域或新建工程却缺乏足够的训练数据。迁移学习提供了一种解决方案——将在数据丰富场景中学习到的知识（模型参数、特征表示）迁移到数据稀缺的场景中。在水文预报领域，跨流域迁移学习已经成为活跃的研究方向，其核心挑战在于如何度量流域之间的"相似性"以及如何有效地进行领域自适应。在输水工程中，迁移学习同样具有重要价值——一条渠道上积累的运行经验和控制策略，经过适当的调整后可以迁移到另一条具有相似水力特性的渠道上，大大缩短新工程的智能化部署周期。

此外，**因果推断**（Causal Inference）正在成为机器学习与水系统研究交叉的新兴前沿。传统的机器学习方法（包括深度学习）本质上是学习数据中的统计相关性，但相关性并不等于因果性。在水系统运行中，理解变量之间的因果关系至关重要——例如，需要区分"上游来水增大导致下游水位上升"（因果关系）和"上下游水位同时上升是因为降雨"（混淆变量导致的虚假相关）。基于因果图模型（如贝叶斯网络、结构方程模型）的因果推断方法，可以帮助识别水系统中的真实因果链条，为故障诊断、异常归因和干预效果评估提供更可靠的分析基础。Pearl提出的因果阶梯理论——从"看到"（关联）到"干预"（因果）再到"想象"（反事实）——为水系统的认知智能提供了一个深刻的思维框架。

#### 1.3.3 深度学习：表示学习的突破

2006年，杰弗里·辛顿（Geoffrey Hinton）等人提出了深度信念网络的高效训练方法，标志着**深度学习**（Deep Learning）时代的开启。随后，卷积神经网络（CNN）在图像识别领域的突破（2012年AlexNet在ImageNet竞赛中的胜利）和循环神经网络（RNN）及其变体在序列数据处理方面的进展，推动了深度学习在各个领域的广泛应用。辛顿、**约书亚·本吉奥（Yoshua Bengio）**和**杨立昆（Yann LeCun）**因其在深度学习领域的先驱性贡献，于2018年共同获得了图灵奖 [39]。

深度学习的核心优势在于**自动表示学习**（Representation Learning）——它能够从原始数据中自动提取多层次的特征表示，而无需人工设计特征。这一能力对于水系统研究具有特殊的价值，因为水系统的许多关键规律（如暴雨-洪水的非线性转换关系、管网水力瞬变过程的复杂动力学）难以用简单的手工特征来捕捉。

深度学习在水系统中的主要应用包括以下几个方向：

**水文预报。

** 长短期记忆网络（Long Short-Term Memory, LSTM）和门控循环单元（Gated Recurrent Unit, GRU）等循环神经网络变体，在降雨-径流预报方面取得了突破性的进展。2019年，弗雷德里克·克莱特勒（Frederik Kratzert）等人在《Hydrology and Earth System Sciences》上发表的研究表明，LSTM模型在241个美国流域上的预报性能超过了传统的概念性水文模型 [40]。这一结果引发了水文学界关于"数据驱动vs物理驱动"模型的广泛讨论。后续研究进一步表明，当与物理信息相结合时（如物理信息嵌入式LSTM），深度学习模型在数据稀缺地区和极端事件预报方面的表现可以进一步提升。

特别值得注意的是**EA-LSTM**（Entity-Aware LSTM）的发展——它通过将流域属性（如面积、坡度、土壤类型）作为静态输入嵌入LSTM的门控机制中，实现了单一模型对多个流域的统一建模，为跨流域迁移学习奠定了基础。在输水系统中，LSTM被用于渠道输水能力预测、管网需水量预测和冰期水温预测等任务，其性能在多个工程案例中得到了验证。

**遥感图像分析。** CNN在水体提取、洪水淹没范围识别、冰情监测、大坝变形检测等遥感图像分析任务中取得了优异的性能。特别是基于U-Net及其变体（如Attention U-Net、TransUNet）的语义分割方法，能够从卫星和无人机影像中精确提取水体边界和冰凌分布，为水系统的大范围态势感知提供了强大的工具。在南水北调中线工程的冰期运行中，基于深度学习的冰凌遥感监测系统已经投入实际应用，实现了对总干渠冰情的准实时、全覆盖监测。

**替代模型构建。** 深度学习被用于构建物理模型的快速**替代模型**（Surrogate Model）。一个完整的水动力学模型（如求解Saint-Venant方程组）可能需要数分钟甚至数小时来完成一次模拟，无法满足在线控制的实时性要求。而一个训练良好的深度学习替代模型可以在毫秒级完成相同精度的预测，为MPC等在线优化算法提供了实时可用的预测模型。

**Transformer架构的兴起与时空建模。

** 2017年，Vaswani等人提出的Transformer架构及其核心的**自注意力机制**（Self-Attention Mechanism）彻底改变了序列建模的格局。与RNN/LSTM逐步处理序列数据不同，Transformer能够在一步之内捕捉序列中任意两个位置之间的依赖关系，极大地提升了长程依赖的建模能力和训练的并行化效率。在水系统领域，基于Transformer的时序预测模型（如Informer、Autoformer、PatchTST）在长时间序列预报（如月尺度的径流预测、周尺度的用水需求预测）方面展现出了超越LSTM的性能。

特别值得注意的是**时空Transformer**（Spatial-Temporal Transformer）的发展——它同时对空间维度和时间维度进行注意力建模，能够捕捉水系统中"上下游传播"和"时间演化"的耦合动力学。这种时空联合建模能力对于大型渠道网络和管网系统的状态预测尤为重要，因为水系统中某一节点的状态变化会通过水力学过程在时空中传播，影响到整个网络。

**图神经网络与水网拓扑建模。** 水系统本质上是一个复杂的网络——由节点（水库、泵站、用水户）和边（渠道、管道、河道）组成的图结构。**图神经网络**（Graph Neural Network, GNN）是一类专门处理图结构数据的深度学习方法，它能够在保持网络拓扑结构的同时进行特征学习和信息传播。在水系统中，GNN被用于管网漏损检测（利用网络中水压传感器的时空关联模式定位漏损点）、水质扩散预测（在管网图上模拟污染物的传播过程）和调度策略推荐（基于网络状态的全局特征生成协调的多闸门控制策略）。GNN的消息传递机制（Message Passing）——节点通过与其邻居交换信息来更新自身表示——与水系统中的物理传播过程（水波沿渠道传播、水质沿管道扩散）具有天然的结构相似性，这使得GNN成为水系统建模的一种"物理启发型"深度学习工具。

**扩散模型与生成式水文建模。** 近年来，以去噪扩散概率模型（Denoising Diffusion Probabilistic Models, DDPM）为代表的扩散模型在生成任务中展现出了优异的性能。在水文领域，扩散模型被用于生成合成的水文时间序列——在保持统计特性（均值、方差、自相关结构）的同时，生成大量的合成径流场景，用于水资源规划中的蒙特卡洛分析。与传统的参数化随机模型相比，基于扩散模型的生成方法能够更好地捕捉水文序列中的非线性特征和极端事件特性。

#### 1.3.4 强化学习：序贯决策的优化

**强化学习**（Reinforcement Learning, RL）是机器学习的一个特殊分支，它关注的是智能体如何在与环境的交互中通过试错来学习最优的行为策略。与监督学习不同，强化学习不需要"标准答案"（标注数据），而是通过奖励信号来引导学习——做得好就获得正奖励，做得不好就获得负奖励或惩罚。

强化学习的理论基础是马尔可夫决策过程（Markov Decision Process, MDP），其核心是贝尔曼方程。2013年，DeepMind公司将深度学习与强化学习相结合，提出了**深度强化学习**（Deep Reinforcement Learning, DRL），其代表性成果DQN（Deep Q-Network）在Atari游戏中达到了人类水平的表现。2016年，AlphaGo战胜围棋世界冠军李世石，进一步展示了深度强化学习的强大能力。

强化学习对水系统运行的启示是深刻的，因为水系统的调度本质上就是一个**序贯决策问题**——在每个时间步，调度者需要根据当前的水情（状态）做出调度决策（动作），以使得长期的累积效益最大化。这与强化学习的问题框架天然契合。具体而言，水系统调度的MDP可以这样定义：**状态空间（state space，用一组状态变量——如各断面水位和流量——来完整描述系统在任意时刻行为的数学框架）** $\mathcal{S}$ 包括各断面水位、流量、蓄水量、气象预报等；**动作空间** $\mathcal{A}$ 包括各闸门开度、泵站转速、阀门启闭等控制变量；**转移概率** $P(s'|s,a)$ 由水力学方程和随机扰动共同决定；**奖励函数** $R(s,a)$ 反映供水保障、节能降耗、安全约束等多目标的综合评价。

智能体的目标是找到一个策略 $\pi^*(a|s)$，使得期望累积奖励 $\mathbb{E}\left[\sum_{t=0}^{\infty} \gamma^t R(s_t, a_t)\right]$ 最大化。

近年来，DRL被应用于水库优化调度、渠道闸门控制、城市排水系统实时控制等场景，取得了一些令人鼓舞的结果。在水库群联合调度中，**多智能体强化学习**（Multi-Agent Reinforcement Learning, MARL）被用于解决多个水库之间的协调优化问题——每个水库可以被建模为一个独立的智能体，通过合作型MARL算法（如QMIX、MAPPO）实现全局最优的联合调度策略。在渠道控制中，DRL被用于学习闸门的最优控制策略，特别是在水力学模型不精确或运行工况频繁变化的情况下，DRL能够通过在线学习自适应地调整控制策略。

然而，强化学习在水系统中的工程应用面临着一个根本性的挑战——**安全性**。强化学习通过试错来学习，但在水系统运行中，某些"错误"的代价是不可承受的（如洪水漫堤、供水中断）。这意味着RL智能体在探索新策略时，必须始终遵守安全约束。为此，**安全强化学习**（Safe Reinforcement Learning）成为了研究热点，它通过在RL框架中引入安全约束（如约束MDP，即CMDP），确保智能体在学习过程中不会违反安全边界。CMDP在标准MDP的基础上增加了约束条件：$\mathbb{E}\left[\sum_{t=0}^{\infty} \gamma^t c_i(s_t, a_t)\right] \leq d_i$，其中 $c_i$ 是第 $i$ 个安全代价函数，$d_i$ 是对应的安全阈值。

求解CMDP的方法包括拉格朗日（Lagrange，数学优化中常用的约束优化方法，通过引入乘子将有约束问题转化为无约束问题）对偶法、内点法和基于屏障函数的方法等。这一研究方向与水系统控制论中"安全包络"的概念高度一致——CHS定义的安全包络本质上就是对RL智能体行为空间的约束，确保任何控制动作都不会导致系统进入不安全状态。两者的结合正在成为水系统自主运行的前沿课题。

值得注意的是**离线强化学习**（Offline RL，也称批量强化学习）的发展。传统的在线RL需要与环境进行实时交互，这在真实的水系统中往往不可行（风险太高、交互成本太大）。离线RL可以完全利用历史运行数据来学习策略，无需与环境进行任何新的交互。这一范式与水利行业的实际情况高度契合——水利系统拥有大量的历史运行日志，但在线试错的机会非常有限。通过离线RL，可以从历史数据中提取出比人类调度员更优的控制策略，然后经过仿真验证后部署到实际系统中。

#### 1.3.5 物理信息神经网络（PINNs）：数据与机理的融合

纯数据驱动的深度学习方法虽然在预测精度上表现出色，但存在三个根本性不足：缺乏物理可解释性、对训练数据之外的工况泛化能力差、以及难以保证输出满足物理守恒定律[201]。为了克服这些不足，2019年，布朗大学的**马兹亚尔·莱西尼亚（Maziar Raissi）**等人提出了**物理信息神经网络**（Physics-Informed Neural Networks, PINNs）[41]的概念，开创了数据驱动与物理驱动融合建模的新范式。

PINNs的核心思想是：在神经网络的训练损失函数中，不仅包含数据拟合项（使网络输出逼近观测数据），还包含物理约束项（使网络输出满足控制方程）。以Saint-Venant方程为例，PINNs的损失函数可以表示为：

$$L = L_{data} + \lambda_1 L_{continuity} + \lambda_2 L_{momentum}$$

其中 $L_{data}$ 是数据拟合损失，$L_{continuity}$ 和 $L_{momentum}$ 分别是连续性方程和动量方程的残差损失，$\lambda_1, \lambda_2$ 是权重系数。通过这种方式，PINNs将物理定律作为"软约束"嵌入到神经网络的训练过程中，使得训练得到的模型既能拟合观测数据，又能尊重基本的物理规律。

PINNs对水系统控制论的意义在于，它提供了一种**数据增强型可控模型**（Data-Enhanced Controllable Model）的构建途径。在CHS的可控模型族谱中，传统的物理模型（如Saint-Venant方程的有限差分求解）位于"机理精确但计算量大"的一端，纯数据驱动的替代模型位于"计算快但物理可解释性差"的另一端，而PINNs则处于两者之间的"甜蜜地带"——它兼具物理一致性和计算效率，是MPC在线优化的理想预测模型。

进一步发展的方向包括**物理信息算子学习**（Physics-Informed Operator Learning），如DeepONet和Fourier Neural Operator（FNO），它们可以学习从输入参数（如边界条件）到输出场（如水位分布）的映射算子，实现对不同工况的快速推断，为MPC提供更高效的预测内核。

具体而言，**DeepONet**（Deep Operator Network）由Lu等人于2021年提出，其理论基础是万能逼近定理的算子版本——任何连续算子都可以被两个子网络（分支网络和主干网络）的乘积所逼近。在水系统中，DeepONet可以学习从边界条件序列（如上游入流过程）到渠道水位场时空演化的映射，一旦训练完成，就能在毫秒级预测任意边界条件下的水位响应——这是传统数值模型无法达到的计算速度。**FNO**（Fourier Neural Operator）则在傅里叶空间中定义卷积核，天然适合处理具有周期性或波动特性的物理过程。对于明渠中的水波传播问题，FNO可以高效地学习Saint-Venant方程的解算子，将预测速度提高三个数量级以上。

**物理信息深度学习的挑战与前沿。

** 尽管PINNs及相关方法前景广阔，但在工程实践中仍面临若干挑战。首先是**多尺度问题**——水系统的物理过程跨越多个时空尺度（从毫秒级的水锤到季节性的水资源变化），PINNs在同时捕捉多个尺度的动力学时容易出现训练困难和精度损失。其次是**复杂几何域的处理**——真实的水系统具有复杂的空间结构（分叉、汇合、突变截面），在不规则域上有效地施加物理约束是技术难点。最后是**不确定性量化**——物理信息贝叶斯神经网络（Physics-Informed Bayesian Neural Networks）和集成学习策略正在被开发用于量化PINNs预测的不确定性，这对于水系统的安全运行决策至关重要。

近年来，**神经算子**（Neural Operator）方向的快速发展——包括Galerkin Transformer、Spectral Neural Operator等新方法——正在不断拓展物理信息深度学习的能力边界，为构建下一代水系统数字孪生模型提供了坚实的技术基础。

#### 1.3.6 大语言模型：通用智能的新范式

2022年底，OpenAI发布的ChatGPT标志着**大语言模型**（Large Language Model, LLM）进入公众视野。此后，GPT-4、Claude、Gemini等一系列大语言模型的出现，引发了全球范围内关于通用人工智能（AGI）的热烈讨论。大语言模型的核心能力——自然语言理解与生成、上下文推理、知识整合、代码生成——正在深刻改变各行各业的工作方式。

对于水系统运行领域，大语言模型带来的影响是多方面的。

**第一，自然语言交互界面。** LLM使得水系统的操控界面从传统的图形化界面（GUI）升级为自然语言交互界面（NLI）。调度员可以用日常语言向系统发出指令（如"将A断面水位在未来2小时内降低到5.0米"），LLM理解指令后将其转化为形式化的控制目标和约束条件，传递给MPC求解器执行。这种交互方式极大地降低了系统的使用门槛，使得非专业人员也能有效地操控复杂的水系统。

**第二，运行知识整合与推理。** 水利行业积累了海量的文档资料——调度规程、运行手册、事故复盘报告、技术标准等。这些知识以非结构化文本的形式存在，传统上只能靠人工查阅和理解。LLM具备理解和整合这些非结构化知识的能力，可以充当"运行知识大脑"——当调度员面对一个不常见的工况时，LLM可以快速检索相关的历史案例和操作规程，提供基于知识的建议。

**第三，异常诊断与解释。** 当水系统出现异常时（如某断面水位突然偏离目标值），LLM可以结合实时数据、历史模式和专家知识，给出可能的原因分析和处置建议，并以自然语言形式向调度员进行解释。这种"可解释的智能"对于建立人机信任至关重要。

然而，通用大语言模型在水系统运行场景中也面临着严峻的挑战。通用LLM在水利专业术语的使用上可能不够准确（如混淆"明渠"和"管道"、误用"水头"的含义），在涉及安全关键的调度建议时可能产生看似合理但实际不可执行的"幻觉"（Hallucination），且缺乏对具体工程系统运行参数的精确把握。因此，直接将通用LLM应用于水系统运行是不安全的，必须进行领域化的定制和约束。

针对这些挑战，需要构建**面向水网运行的领域大语言模型**。其核心技术路线包括：构建水利领域多源语料库（涵盖规范标准、调度规程、运行日志、学术文献等），在通用LLM基座上进行领域持续预训练和指令微调，构建知识图谱增强的检索增强生成（RAG）框架以提高知识的准确性和可追溯性，引入物理与安全约束校核器确保输出的可执行性，以及建立在线评估与持续学习机制实现模型的持续进化。

**领域大模型的安全保障机制。** 在安全关键的水系统运行场景中，大语言模型的输出必须经过多重校验才能执行。具体而言，可以构建"LLM生成→物理校验→安全校验→人工确认"的四级安全流水线。当LLM生成一条调度建议时（如"将某闸门开度从30%调整到50%"），首先由物理校验模块检查这一操作是否符合水力学规律（预测执行后的水位变化是否在合理范围内），然后由安全校验模块检查是否满足所有安全约束（如最大流速不超限、下游水位不超警），最后由人工调度员确认后方可执行。这种多层级的安全保障机制确保了LLM在水系统运行中的可靠应用。

**智能体架构（Agent Architecture）的兴起。** 随着LLM能力的不断增强，基于LLM的**自主智能体**（Autonomous Agent）成为AI领域的热点方向。一个LLM智能体通常由四个核心模块组成：感知模块（接收环境信息）、记忆模块（存储和检索历史经验）、规划模块（制定行动方案）和执行模块（调用工具完成任务）。在水系统运行中，可以构建**水网运行智能体群**——每个闸门、泵站或调度区间对应一个智能体，各智能体通过协商和协作完成分布式的调度优化任务。这种基于LLM的多智能体系统与CHS所提出的"分布式—层次化"控制架构具有天然的亲和力——局部智能体负责单元级的精细化控制，全局智能体负责系统级的协调优化，两者通过标准化的通信协议实现信息共享和策略协调。这一方向代表了水系统自主运行的最前沿探索。

**AI伦理与水系统公平性。** 随着AI在水资源管理中的应用不断深入，AI伦理问题也日益突出。水资源是公共资源，水系统的调度决策直接关系到不同地区、不同用户群体的用水权益。如果AI调度算法存在系统性偏差（如过度偏向经济效益高的用户），可能导致水资源分配的不公平。因此，在设计和部署AI调度系统时，必须考虑**公平性约束**——确保不同区域、不同优先级的用水需求得到合理保障。此外，AI系统的**可解释性**和**可问责性**也是重要的伦理要求——当AI做出重大调度决策时，必须能够解释决策的依据和逻辑，并在出现问题时追溯责任。CHS框架中的WSAL自主等级体系通过明确人机权责划分，为解决AI伦理问题提供了制度性框架。

#### 1.3.7 知识图谱：结构化知识的载体

**知识图谱**（Knowledge Graph, KG）是一种以图结构表示知识的技术，它将实体（如"闸门"、"渠段"、"调度规程"）和实体之间的关系（如"控制"、"属于"、"相邻"）以三元组 $(h, r, t)$ 的形式进行结构化表示。2012年，谷歌推出了"知识图谱"项目，用于增强搜索引擎的理解能力，此后知识图谱技术在各行业已在多个工程中成功部署。

在水系统运行领域，知识图谱的价值在于将分散在不同系统和文档中的运行知识进行结构化整合。一个水系统运行知识图谱可以包含以下类型的知识：**设备知识**（如闸门的类型、位置、参数、过流能力）、**规程知识**（如不同工况下的调度规则、应急预案的触发条件和处置步骤）、**工况知识**（如冰期运行、检修期运行、防洪调度的特殊要求）和**因果知识**（如"上游来水增大→渠段水位上升→需增大下游闸门开度"的因果链）。

构建水系统知识图谱的技术流程包括多个关键步骤。**知识抽取**阶段，需要从规范标准、调度规程、运行日志、设备手册等多源异构文档中自动提取实体和关系——这一过程可以借助自然语言处理技术（命名实体识别、关系抽取、事件抽取）来实现，但由于水利领域文档的专业性和格式多样性，通常需要结合领域词典和人工校验。**知识融合**阶段，需要将来自不同来源的知识进行对齐和去重——例如，同一个闸门在不同文档中可能有不同的命名方式（"XX节制闸"vs"XX闸"），需要通过实体消解技术进行统一。**知识推理**阶段，可以基于已有的知识图谱推导出新的隐含知识——例如，如果知道"A闸门故障"且"A闸门是B渠段的唯一出水口"，则可以推理出"B渠段存在漫溢风险"。

**本体构建**（Ontology Construction）是知识图谱的基础性工作。水系统运行本体需要定义一套规范化的概念体系和关系类型。在雷晓辉等人的研究中，提出了面向水网运行的多层本体架构：**物理层本体**描述水利工程的物理实体及其拓扑关系，**过程层本体**描述水力学和水文学的物理过程及其参数，**控制层本体**描述控制系统的架构、算法和参数，**管理层本体**描述调度规程、组织架构和权限关系。这种分层本体架构使得知识图谱能够在不同抽象层次上支持不同类型的智能应用。

知识图谱与大语言模型的结合——即**知识图谱增强的RAG**——是构建可靠的水系统认知AI的关键技术。在这种架构中，当用户提出问题时，系统首先在知识图谱中检索相关的结构化知识（实体、关系、规则），然后将检索结果作为上下文提供给LLM，由LLM生成最终的回答。这种方式既利用了LLM的语言理解和生成能力，又通过知识图谱保证了回答的准确性和可追溯性。

具体而言，水系统RAG架构的技术实现涉及多个关键环节。**查询理解**环节需要将用户的自然语言问题转化为结构化的知识图谱查询——这可以通过LLM的语义解析能力来实现，将自然语言转化为SPARQL或Cypher等图查询语言。**知识检索**环节需要在知识图谱中高效地搜索相关子图——对于大规模水系统知识图谱，需要采用向量索引和图嵌入技术来加速检索。**答案生成**环节需要将检索到的知识片段与LLM的推理能力相结合——通过精心设计的提示模板（Prompt Template），引导LLM基于检索到的事实知识生成准确、连贯的回答。**可溯源性保障**是水系统RAG区别于通用RAG的关键特征——每一条回答都必须能够追溯到知识图谱中的具体来源（如特定的调度规程条款、设备技术参数或历史运行记录），以便于人工核实和责任追溯。

#### 1.3.8 生成式AI对水系统运行的范式冲击

生成式AI（Generative AI）——以大语言模型为代表——对水系统运行领域的影响不仅仅是"多了一个工具"，而是一次**范式级别的冲击**。这种冲击体现在三个层面。

**第一个层面：从"物理AI引擎"到"物理+认知双引擎"。** 在LLM出现之前，水系统控制的智能化手段主要局限于基于物理模型的计算智能——如MPC基于水力学模型进行优化调度。这可以称为"Physical AI引擎"。LLM的出现，使得"认知智能"——理解自然语言、整合非结构化知识、进行推理和解释——变得可实现，为水系统运行提供了一个全新的"Cognitive AI引擎"。Physical AI引擎擅长精确计算和约束优化，但不善于处理模糊的、非结构化的知识；Cognitive AI引擎擅长理解和推理，但缺乏物理精确性和安全保障。两者的融合——"Physical AI + Cognitive AI"双引擎架构——正是水系统控制论（CHS）所倡导的下一代智能化路径。

**第二个层面：从"人写规则"到"AI生成策略"。** 传统的调度规程是由人类专家根据经验和分析编写的，编写过程耗时费力，且难以覆盖所有可能的工况组合。生成式AI具备根据给定的约束条件和目标自动生成调度策略的潜力——给定系统的物理模型、安全约束和调度目标，LLM可以辅助生成候选的调度规程，并用自然语言解释策略背后的逻辑。当然，这些AI生成的策略必须经过严格的仿真验证和人工审查后才能投入使用。

**第三个层面：从"数据孤岛"到"知识连通"。** 水利行业长期面临"数据孤岛"问题——不同工程、不同单位、不同专业之间的数据和知识难以互通。LLM具备跨领域知识整合的能力，可以充当不同专业之间的"翻译器"——将水力学工程师的技术语言转化为管理者可理解的决策信息，将历史运行案例中的隐性经验转化为可复用的显性知识。这种知识的连通和整合能力，对于打破水利行业的信息壁垒提供了关键理论支撑。

**第四个层面：从"静态程序"到"进化系统"。** 传统的水系统软件一旦开发完成并部署，其功能和行为就基本固定，升级需要重新进行需求分析、编码、测试和部署的完整周期。生成式AI使得软件系统具备了"自我进化"的潜力——通过持续地从新的运行数据和反馈中学习，系统可以不断优化自身的预测精度、控制策略和知识库，实现真正意义上的"活的数字孪生"。在这种范式下，水系统的运行管理平台不再是一个静态的工具，而是一个持续进化的智能伙伴，其能力随着运行时间的积累而不断增强。这一愿景与CHS提出的水网自主运行系统（WSAL L4-L5级）高度一致——高度自主的水系统应当具备从运行经验中持续学习和自我改进的能力。

**第五个层面：从"单一模态"到"多模态融合"。** 水系统运行涉及多种信息模态——数值型的传感器数据、图像型的视频监控画面、文本型的运行日志和调度规程、空间型的GIS地理信息。**多模态大模型**（Multimodal Large Model）能够同时处理和关联这些不同模态的信息，实现更全面的态势感知和更深层的语义理解。例如，当渠道某处发生漫溢风险时，多模态模型可以同时分析水位传感器数值、现场摄像头画面、上游来水预报数据和历史事故报告，综合判断风险等级并给出处置建议。这种多模态融合能力是单一模态的AI系统无法实现的。

#### 1.3.9 AI发展对水系统运行的整体影响

综合以上各方面的分析，AI各分支对水系统运行的影响可以用以下框架来概括：

| AI技术 | 核心能力 | 在水系统中的典型应用 | 局限性 | 与CHS的关系 |
| :--- | :--- | :--- | :--- | :--- |
| 专家系统 | 规则推理 | 早期调度辅助决策 | 知识获取困难、不灵活 | 历史遗产，已被整合到KG |
| 机器学习 | 模式识别 | 水文预报、异常检测 | 可解释性差、泛化不足 | 数据处理工具层 |
| 深度学习 | 表示学习 | 高精度预报、替代模型 | 黑箱、数据饥渴 | Physical AI的计算内核 |
| 强化学习 | 序贯决策 | 水库调度优化 | 安全性挑战 | 学习型控制策略生成 |
| PINNs | 数据-机理融合 | 数据增强型可控模型 | 训练难度、多尺度 | 可控模型族的新成员 |
| LLM | 语言理解与生成 | 自然语言交互、知识整合 | 幻觉、安全校核 | Cognitive AI引擎核心 |
| 知识图谱 | 结构化知识 | 运行知识库、RAG增强 | 构建成本高 | 知识底座层 |

从历史发展的视角看，AI对水系统运行的影响经历了三个阶段：**第一阶段（1980s-2000s）**是"AI辅助"阶段，专家系统和简单的机器学习方法为人工决策提供参考信息，但不直接参与控制——在这一阶段，AI的角色类似于"幕僚"或"参谋"，最终决策权完全在人类手中；**第二阶段（2010s-2020s）**是"AI增强"阶段，深度学习和强化学习开始直接参与预测和优化，AI从"参谋"升级为"副手"，在人类的监督和授权下执行具体的预测和优化任务，但关键决策仍由人类做出；**第三阶段（2020s-）**是"AI自主"阶段，LLM和双引擎架构的出现使得水系统具备了认知智能的能力，AI从"副手"进一步升级为"合作伙伴"，能够独立处理常规工况、辅助处理复杂工况、在紧急工况下提供决策建议并解释推理过程。

每个阶段的转变都伴随着关键技术的突破和理论框架的革新。从第一阶段到第二阶段，关键的推动力是深度学习和GPU计算的突破，以及MPC与数据驱动模型的结合。从第二阶段到第三阶段，关键的推动力是大语言模型和多模态AI的出现，以及"物理AI+认知AI"双引擎架构的提出。水系统控制论（CHS）正是在第二阶段向第三阶段过渡的关键时刻应运而生的理论框架，它为AI技术在水系统中的系统性集成和安全应用提供了统一的架构和规范。

展望未来，AI对水系统运行的影响将持续深化。**联邦学习**（Federated Learning）将使得多个水利工程可以在不共享原始数据的前提下协同训练全局模型，解决数据隐私和数据主权的问题。**边缘AI**（Edge AI）将使得智能算法可以部署在闸门、泵站等边缘设备上，实现本地化的实时智能控制，减少对中心服务器的依赖和通信延迟。**数字孪生与AI的深度融合**将产生能够自我学习、自我校准、自我进化的"活的数字孪生"，成为水系统自主运行的核心数字基础设施。

**通用人工智能**（AGI）如果实现，将可能带来水系统运行范式的根本性变革——一个真正的通用智能系统可以同时扮演水力学专家、控制工程师、调度决策者和管理协调者的角色，实现水系统运行的全面智能化。当然，AGI的实现时间和路径仍存在巨大的不确定性，但CHS所构建的理论框架——特别是WSAL自主等级体系和安全包络机制——为迎接这一可能的未来变革提供了坚实的概念准备。

> **图 1-3　AI范式在水系统中的演进路线**
> *Fig. 1-3 Evolution of AI Paradigms in Water Systems*
>
> ```
>   解释性 ▲                              ┌──────────────┐
>          │                              │ 物理AI+认知AI │
>          │   ┌──────────┐               │  (CHS双引擎)  │
>          │   │物理模型驱动│──────────────→│  2020s-      │
>          │   │(SV方程)  │     ↗         └──────┬───────┘
>          │   │1960s-    │    /                  │
>          │   └──────────┘   /          知识+数据融合
>          │                 /                    │
>          │        ┌──────┐    ┌──────────────┐  │
>          │        │混合AI├───→│ PINN/知识引导 │──┘
>          │        │      │    │  2018-       │
>          │        └──────┘    └──────────────┘
>          │                          ↑
>          │   ┌──────────┐    ┌─────┴────────┐
>          │   │统计模型  │───→│ 深度学习      │
>          │   │(回归/SVM)│    │ (LSTM/GNN)   │
>          │   │1990s-    │    │  2015-       │
>          │   └──────────┘    └──────────────┘
>          └──────────────────────────────────────→ 数据依赖
>          低                                    高
> ```


---

**思考与讨论**

1. （概念理解）机器学习中的"过拟合（overfitting，模型过度学习了训练数据中的噪声和细节，导致对新数据的预测能力反而下降——类似于根据历史水文资料拟合的经验公式在异常年份严重失准）"问题在水文预报中可能导致什么后果？如何缓解？
2. （分析比较）物理模型驱动（如Saint-Venant方程数值解）和数据驱动（如LSTM神经网络）在水位预测任务中各有什么优缺点？
3. （批判思考）有人认为大语言模型可以直接替代传统水力学模型进行调度决策，你是否同意？请从可解释性、安全性和数据需求三个角度进行分析。


---


---

### §1.3 本节小结


本节梳理了人工智能从符号推理到大语言模型的七十年演进，聚焦其对水系统运行的三重赋能：（1）机器学习提供了数据驱动的水文预测能力（如LSTM径流预报）；（2）深度强化学习为水库群联合调度提供了免模型的优化路径；（3）大语言模型为调度员提供了自然语言交互和知识问答的认知辅助。CHS框架将物理模型驱动（"物理AI"）与数据驱动（"认知AI"）融合为双引擎架构，避免了纯AI方案在安全关键场景中的不可解释性风险。

### 1.4 信息-物理系统（CPS）：理论的融合与升华

> ---

> **📖 给水利工程师的速览：什么是CPS和数字孪生？**
>
> CPS（信息-物理系统）可以理解为"SCADA的终极进化"。传统SCADA只做"采数据、看屏幕"；CPS在此基础上增加了"算模型、做决策、自动执行"的能力，让物理世界（渠道、闸门、水流）和信息世界（模型、算法、数据）深度融合。数字孪生则是在计算机中建立物理工程的"虚拟镜像"——不是静态的三维模型，而是接入实时数据、与真实工程同步运行的"活"模型。调度员可以在数字孪生上先"试一试"调度方案的效果，确认安全后再在真实工程上执行。
> ---

21世纪初，随着传感器网络、嵌入式计算、实时通信和控制技术的快速发展，一个将物理世界与信息世界深度融合的新概念——**信息-物理系统**（Cyber-Physical Systems, CPS）——应运而生。CPS理论为系统科学、控制科学和人工智能三大理论思潮的融合提供了一个统一的框架，也为水系统运行科学与工程的学科构建提供了重要的理论参照。

#### 1.4.1 CPS的概念起源与发展

CPS的概念最早由美国国家科学基金会（NSF）于2006年正式提出，用于描述一类"计算过程与物理过程深度交互"的系统。CPS不是简单地将信息技术"附加"到物理系统上，而是要实现计算与物理的"深度融合"——计算过程感知和影响物理过程，物理过程的状态变化又反过来驱动计算过程的调整，形成紧密的闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）。

然而，CPS的学术渊源远早于2006年。其思想根基可以追溯到20世纪40年代维纳的控制论——"在动物和机器中控制与通信的科学"本质上就是对物理过程与信息过程交互的最早系统性思考。20世纪60-70年代兴起的嵌入式系统研究——将计算机嵌入物理设备中执行实时控制——可视为CPS的技术前身。但嵌入式系统研究主要关注单个设备层面的计算-物理交互，而CPS概念的革命性在于将这种交互**扩展到网络化的大规模系统**——数以千计的传感器、执行器和计算节点通过通信网络形成协同控制的整体。这一扩展使得CPS面临嵌入式系统不曾遇到的新挑战：网络延迟与不确定性、分布式状态一致性、异构系统集成、大规模系统涌现行为等。

CPS的理论根基可以追溯到多个学科的交汇：控制科学提供了反馈控制和稳定性的框架；计算机科学提供了实时计算、网络通信和软件工程的工具；系统工程提供了复杂系统的分析和设计方法论。CPS可以被视为控制系统、嵌入式系统和网络系统的"三位一体"融合。

值得特别辨析的是CPS与物联网（IoT）的区别。虽然两者在技术栈上有大量重叠——都涉及传感器、通信网络、云计算等——但其本质关注点截然不同。IoT的核心是"连接"（connectivity），强调万物互联、数据汇聚和信息服务；CPS的核心是"控制"（control），强调信息流与物质/能量流的深度耦合和精确协调。一个只采集水位数据并展示在大屏上的系统是IoT；一个根据水位数据实时调整闸门开度以维持目标水位的系统才是CPS。这一区分对水利领域尤为重要——大量的"智慧水利"项目停留在IoT层面（数据采集→可视化展示），真正实现CPS闭环控制的寥寥无几。

从产业实践来看，中国"十三五"期间启动的数百个智慧水利项目中，绝大多数的核心建设内容是"监测站网建设+数据中心建设+可视化平台开发"，即典型的IoT架构。这些项目建成后能够实现"数据看得见"，但距离"系统控得住"仍有本质差距。造成这一现象的原因既有技术层面的（闭环控制需要高可靠的执行机构和实时通信，技术门槛显著高于数据采集），也有体制层面的（水利工程的运行管理权分散在不同层级的管理单位，实施跨单位的自动化闭环控制面临责任界定的制度性障碍）。CPS视角为智慧水利指明了从IoT向CPS跃迁的技术路径——不是否定已建成的IoT基础设施，而是在此基础上**逐步补齐"控制回路"的短板**——从局部闭环（如单个泵站的自动控制）到区域闭环（如渠段的自动调节），再到系统闭环（如全线的协调调度），这也正是WSAL分级体系所描述的演进路径。

CPS概念的提出引发了全球主要工业国家的战略响应。德国将CPS作为"工业4.0"战略的核心技术基础；美国NSF从2008年起持续投入超过10亿美元用于CPS研究计划（据NSF CPS Program Solicitation统计）；欧盟在"Horizon 2020"框架下设立了多个CPS相关研究项目。中国国家自然科学基金委也于2010年前后将CPS列为信息科学部的重点资助方向。这些战略布局反映了一个共识：物理世界与信息世界的深度融合是21世纪工业革命的核心驱动力。

美国加州大学伯克利分校的**爱德华·李（Edward A. Lee）**是CPS理论的重要推动者。他强调CPS区别于传统嵌入式系统的关键特征在于其对"时间"和"并发"的显式建模——CPS必须对物理过程的时间特性（如延迟、时序约束）进行精确的建模和分析，而不是简单地将其视为"非功能性需求"。2008年，他发表了极具影响力的论文《CPS——计算与物理的联合？》（*Cyber Physical Systems: Design Challenges*）[42]，系统阐述了CPS设计中面临的理论挑战，包括时间建模、异构系统集成、安全性和可靠性保障等。

Lee的理论洞察对水系统具有特殊的启发意义。水系统的物理过程具有显著的"时间常数分层"特性：闸门响应的时间常数在秒到分钟级，渠段水力传播的时间常数在分钟到小时级，水库蓄放水的时间常数在小时到天级，而流域水文循环的时间常数在天到季节级。CPS设计必须尊重这种时间层次结构——不同层级的控制回路必须匹配物理过程的时间尺度，过快的控制回路会引发不必要的执行器磨损和系统振荡，过慢的控制回路则无法及时响应扰动。这正是CHS框架中"分层分布式"控制架构的理论基础。

CPS理论还特别强调**安全性验证**的重要性。由于CPS直接控制物理世界，软件中的错误（bug）可能导致物理世界的灾难——2010年丰田汽车的电子油门失控事件、2018年波音737 MAX的MCAS系统缺陷导致的空难，都是CPS安全性失败的惨痛案例。这些事故推动了**形式化验证**（Formal Verification）在CPS领域的研究——用数学方法证明控制软件在所有可能的运行条件下都不会违反安全约束。对水系统而言，闸门控制软件的一个逻辑错误可能导致渠道溢水或断流，造成数亿元的经济损失和不可逆的生态破坏。因此，CHS框架借鉴了CPS安全性验证的理念，提出了"xIL逐级验证"（MIL→SIL→HIL→PIL）的严格验证体系——每一个控制算法都必须在虚拟环境中经历从模型在环到硬件在环的逐级验证，才能被部署到实际工程中。

形式化验证在水系统CPS中的具体应用面临独特的挑战。与航空电子系统（通常可以建模为有限状态机，适合模型检验方法）不同，水系统的控制逻辑涉及连续状态空间（水位、流量等物理量的连续变化）和混合动力学行为（闸门的开/关切换引入离散事件），属于**混成系统**（Hybrid System）的范畴。混成系统的形式化验证是计算机科学中公认的困难问题——状态空间的连续性使得穷尽搜索不可行，混合动力学使得传统的不变式证明方法失效。近年来，基于**可达集计算**（Reachability Analysis）和**屏障证书**（Barrier Certificate）的方法取得了重要进展——前者通过过逼近或内逼近方法计算系统状态在给定时间内的可达范围，判断其是否与不安全区域相交；后者通过构造一个类似"能量函数"的标量函数来证明系统轨迹不会穿越安全边界。

这些方法目前已可以处理中等规模（数十维状态空间）的水系统安全验证问题，但要扩展到大规模水网（数百个控制节点）仍需要理论和算法层面的重大突破。

#### 1.4.2 CPS的三层参考架构

CPS的典型参考架构可以概括为三个层次：

**感知层（Perception Layer）。

** 由各类传感器和数据采集设备组成，负责获取物理系统的实时状态信息。在水系统中，感知层包括水位计、流量计、雨量计、视频监控、卫星遥感等感知手段，以及SCADA系统的数据采集终端。感知层的关键挑战是数据质量——传感器的精度、可靠性、采样频率和覆盖范围直接决定了上层决策的质量。正如控制理论中"可观性"的概念所指出的：如果系统的关键状态无法被观测到，再好的控制算法也无法发挥作用。水系统感知层面临的特殊挑战在于**感知稀疏性和环境恶劣性**的双重约束。与工业过程控制（如化工厂的密集仪表布置）不同，水利工程的空间尺度巨大（一条输水干渠可能绵延数百公里），传感器只能布置在有限的断面上，大量中间状态需要通过模型推算或数据融合来"虚拟感知"。

同时，水利传感器长期浸泡在水中或暴露在野外，面临淤积、水草附着、雷击、冰冻等恶劣环境的侵蚀，其故障率远高于工厂环境中的工业仪表。因此，水系统CPS的感知层设计不能仅追求"更多传感器"，还必须建立基于物理模型的**软测量**（Soft Sensor）能力——利用有限的硬测量数据结合水动力学模型，实时估算全系统的状态分布。这一需求催生了CHS框架中"模型驱动+数据增强"的状态估计方法。

**网络层（Network Layer）。** 由通信网络和数据传输基础设施组成，负责在感知层和决策层之间传输信息。在水系统中，网络层包括光纤通信、4G/5G无线通信、北斗卫星短报文、LoRa等物联网通信技术。网络层的关键挑战是通信的实时性和可靠性——在分布式控制场景中，通信延迟和丢包率直接影响控制性能。特别是在极端天气条件下（如暴雨、冰灾），通信基础设施本身可能受损，这就要求控制系统必须具备在通信退化条件下的"优雅降级"能力。

水系统网络层面临的一个独特挑战是**通信基础设施与被保护对象的空间重叠**。在洪水防御场景中，通信基站和光缆可能被洪水淹没或冲毁，而恰恰是在这种情况下，对实时监测和控制的需求最为迫切——这是一种"越需要越不可用"的悖论。类似的悖论在冰冻期的北方输水工程中同样存在：严寒天气可能导致太阳能供电的远程测站断电、4G基站因冰覆盖而信号衰减。应对这一悖论需要**多层级通信冗余**设计：主链路（光纤或5G）、备份链路（4G/专网无线）、应急链路（北斗短报文或卫星通信），以及**通信自愈**算法——当检测到某条链路失效时，自动切换到备份链路并降低数据传输频率以适应低带宽条件。

在极端情况下（所有通信中断），本地控制器必须具备"离网自主运行"能力——基于本地传感器数据和预存的安全策略独立维持基本运行，直到通信恢复。这一需求直接推动了CHS框架中MAS架构的"局部自治+全局协调"设计理念。

**决策层（Decision Layer）。

** 由计算平台和控制算法组成，负责基于感知信息进行分析、推理和决策，并将控制指令下达到物理执行机构。在水系统中，决策层包括云端的优化调度平台、边缘端的实时控制器以及连接两者的分布式计算架构。决策层的关键挑战是"实时性-最优性-安全性"三者之间的权衡——更复杂的优化算法可以获得更好的调度方案，但计算时间更长，可能无法满足实时性要求；过于简化的算法虽然快，但可能遗漏重要的约束条件，带来安全风险。CHS框架通过**"云-边-端"三级计算架构**来应对这一三角权衡：端侧（闸站本地PLC）执行毫秒级的联锁保护和基本PID控制，确保安全性；边缘侧（区域控制中心的工控服务器）运行秒到分钟级的MPC优化，兼顾实时性与一定程度的最优性；云侧（中心调度平台的高性能服务器）执行小时到天级的全局优化调度，追求全局最优性。

三级之间通过"目标下达-状态上报"的层次化信息交互实现协调，每一级都在自己的时间尺度内独立运行，不依赖于上级的实时指令——这既是对Lee所强调的"CPS必须尊重物理过程时间特性"原则的工程实现，也保障了上级通信中断时下级的自主运行能力。

#### 1.4.3 数字孪生：CPS的高级形态

**数字孪生**（Digital Twin）是CPS理论在21世纪10年代的重要发展，它代表了CPS的一种高级形态——不仅实现物理系统与信息系统的交互，更要在信息空间中构建物理系统的高保真"镜像"，使得可以在虚拟空间中对物理系统进行实时监测、诊断、预测和优化[207]。

数字孪生的概念最早由密歇根大学的**迈克尔·格里夫斯（Michael Grieves）**于2003年在产品生命周期管理（PLM）的语境下提出。他设想了一个由"物理空间"、"虚拟空间"和"连接两者的数据/信息通道"组成的三维模型。2012年，NASA在其技术路线图中正式采用了"数字孪生"的术语，将其定义为"飞行器或系统的多物理场、多尺度、概率性的集成仿真模型"。此后，数字孪生概念迅速从航空航天领域扩展到制造业、城市规划、能源系统等各行各业。

在水利领域，中国水利部于2022年提出了**"数字孪生流域"**建设的战略部署。数字孪生流域的目标是构建流域水利工程和水文过程的数字化镜像，实现"以虚映实、以虚控实、以虚预实"——用虚拟空间中的模型来实时反映物理流域的运行状态（映实），用虚拟空间中的仿真来指导物理流域的运行调控（控实），用虚拟空间中的推演来预测物理流域的未来行为（预实）。这一战略部署推动了一批数字孪生试点项目的启动，覆盖了黄河、长江等主要流域和南水北调等重大工程。

然而，数字孪生在水利领域的实施面临着特殊的挑战。与制造业的数字孪生不同，水系统的数字孪生面临着更强的不确定性（自然水文过程本质上是随机的）、更大的空间尺度（流域级别可达数万平方公里）、更复杂的多物理场耦合（水力学、水文学、泥沙运动、水生态等）以及更长的时间尺度跨度（从秒级的闸门控制到季节级的水资源配置）。这些挑战要求水利数字孪生必须发展专门的建模方法和计算架构，而不能简单照搬其他行业的技术路线。

具体而言，水利数字孪生面临三个层次的技术难题。**模型保真度**方面，水力学模型（如基于Saint-Venant方程的一维非恒定流模型）需要精确的边界条件和参数（如Manning糙率系数），而这些参数在实际工程中往往随季节、淤积、水草生长等因素动态变化，这要求数字孪生具备持续的"模型校准"能力——即根据实测数据不断更新模型参数，保持模型与物理系统的同步。**多尺度耦合**方面，水系统运行涉及从局部闸门（米级、秒级）到渠段水力响应（公里级、分钟级）到全线调度（百公里级、小时级）再到季节水资源配置（流域级、月/季级）的多尺度过程，数字孪生需要将不同尺度的子模型通过合理的接口和时间步长策略耦合在一起，这是计算科学中的经典难题。

**实时性**方面，用于运行控制的数字孪生必须能够以超过实时的速度运行——例如以10倍速或更快的速度完成预测计算，才能为MPC优化提供足够的"超前预见"能力。这对模型简化、并行计算和算法效率提出了极高的要求。

从功能层次来看，水利数字孪生可以区分为三个递进的层级：**描述性孪生**（Descriptive Twin），侧重于"映实"——将物理系统的状态实时反映到虚拟空间中，核心功能是可视化监测和数据管理；**预测性孪生**（Predictive Twin），侧重于"预实"——基于当前状态预测未来行为，核心功能是方案推演和风险预警；**决策性孪生**（Prescriptive Twin），侧重于"控实"——不仅预测未来还优化决策并直接执行，核心功能是闭环控制和自主调度。当前中国水利领域的数字孪生大多处于第一层级，正在向第二层级迈进，而第三层级正是CHS框架的核心目标。

从国际比较来看，不同行业的数字孪生成熟度差异显著。航空航天领域走在最前沿——美国空军已在F-35战斗机的维护中部署了决策性孪生，根据飞行数据实时预测结构疲劳并自动生成维护计划。制造业紧随其后——西门子Amberg工厂的数字孪生覆盖了产品设计、生产调度、质量控制的全流程。电力行业处于从预测性到决策性的过渡阶段——电网调度中心已广泛使用在线安全稳定分析系统，基于电网数字模型实时计算安全裕度并辅助调度决策。水利行业整体处于描述性到预测性的过渡阶段，个别先进项目（如南水北调中线的数字孪生平台）开始探索预测性功能，但真正实现决策性闭环的案例尚未出现。

造成水利数字孪生落后于电力等行业的深层原因，不仅是技术问题，更是**数据基础和模型验证**的制约。电力系统的基尔霍夫定律是精确的代数方程，电网潮流计算可以达到工程精度的0.1%以内；而水力学的圣维南方程（Saint-Venant equations，描述明渠水流运动的基本方程，由连续性方程和动量方程组成）是含有Manning糙率等经验参数的偏微分方程，受河道地形、泥沙、水草等因素影响，模型精度通常在5-15%范围内波动。更关键的是，电力系统的量测体系高度完善（每个变电站都有精密的电压、电流、功率量测），而水利系统的量测密度远低于电力系统（长距离输水渠道上两个水位测站可能间隔数十公里）。

这些差异要求水利数字孪生发展出独特的**数据稀疏条件下的模型同化**方法——如何用有限的观测数据持续校正大规模水动力学模型的参数和状态，是水利数字孪生必须攻克的核心技术瓶颈。

#### 1.4.4 SCADA+MAS融合架构：水系统CPS的实践路径

在水系统运行实践中，CPS理论的落地需要一条务实的技术路径。考虑到水利行业现有的技术基础，**SCADA+MAS融合架构**是一条可行的实践路径——在现有SCADA系统（提供感知和执行的基础能力）之上，叠加多智能体系统（提供分布式决策的智能能力），形成一个分层分布式的CPS架构。

在这种融合架构中，SCADA系统承担CPS的感知层和执行层功能——负责传感器数据采集、远程监控和闸门/泵站的远程控制。MAS则承担CPS的决策层功能——三类智能体（渠池智能体、枢纽智能体、全局协调智能体）构成的分层分布式决策体系，在SCADA提供的数据基础上进行实时的协调控制和优化调度。

SCADA+MAS融合架构的关键优势在于其**渐进式的部署策略**。水利工程的SCADA系统通常已经建成并运行多年，具有稳定的感知和执行能力。在此基础上引入MAS，不需要对现有基础设施进行大规模改造，而是通过"软件升级"的方式增加智能决策能力。这种"SCADA不动、智能叠加"的策略，大大降低了技术风险和投资门槛，是水系统CPS落地的最务实路径。

此外，SCADA+MAS融合架构还具备**优雅降级**（Graceful Degradation）的特性。当MAS层出现故障（如某个智能体失联或算法异常）时，系统可以自动回退到SCADA的基本监控模式，由人工调度员接管决策。这种"分层容错"机制确保了系统在任何故障条件下都不会完全失控，满足了水系统对安全性的极端要求。

优雅降级机制的设计需要解决一个微妙的技术问题——**状态一致性恢复**。当MAS层从故障中恢复后重新接管控制时，它必须首先准确了解当前的系统状态和之前的控制历史，才能平滑地恢复自主控制而不引起控制指令的突变。这要求SCADA层在MAS故障期间不仅要维持基本控制，还要持续记录完整的运行日志（状态轨迹、控制动作、外部扰动等），作为MAS恢复时的"上下文信息"供其快速重建内部状态。类似机制在航空自动驾驶仪中已有成熟实践——当自动驾驶从"手动模式"重新切换到"自动模式"时，系统需要经过一个"状态捕获"（State Capture）阶段来同步自动控制器的内部状态与飞机的实际状态。

水系统的特殊性在于其"慢系统"特性——由于水力过程的时间常数较长（通常在分钟到小时量级），状态恢复有较充裕的时间窗口，但同时也意味着之前的控制动作可能仍在"传播中"（如上游调整的水波尚未到达下游），MAS恢复时必须将这些"在途效应"纳入考量。

SCADA+MAS融合架构的技术实现涉及几个关键的接口设计问题。**数据接口**方面，SCADA系统通常采用Modbus、OPC-UA等工业通信协议，而MAS系统采用FIPA-ACL等智能体通信协议。融合架构需要设计一个"协议桥接"层，将SCADA的点表数据（Point Table）转换为MAS智能体能够理解的语义化信息。例如，SCADA的一个数据点"AI_001=3.56"只是一个无语义的数值，协议桥接层需要将其转换为"胶东干渠第3渠池下游水位=3.56米"这样的语义化信息，才能被渠池智能体正确处理。

**控制权限**方面，融合架构需要明确定义MAS何时可以直接向SCADA下达控制指令（自主模式）、何时只能提供建议由人工确认后执行（辅助模式）、以及在什么条件下必须立即交出控制权（紧急回退模式）。这三种模式的切换逻辑，本质上就是WSAL不同等级的工程实现。

**时间同步**方面，SCADA系统通常以固定周期（如1-5秒）采样，而MAS的决策周期可能更长（如15分钟的MPC优化周期），两者之间的时间协调需要精心设计，以避免控制指令的冲突或"振荡"。

**网络安全**方面，SCADA+MAS融合架构引入了新的攻击面。传统SCADA系统运行在相对封闭的工控网络中，而MAS层通常需要更开放的网络环境来实现跨站点的智能体通信和云端计算资源的调用。2021年美国佛罗里达州Oldsmar水厂远程入侵事件（攻击者试图将氢氧化钠浓度调高至危险水平）警示了水系统SCADA网络安全的严峻现实。在融合架构中，必须实施**纵深防御**（Defense-in-Depth）策略：在SCADA层与MAS层之间设置安全隔离区（DMZ），所有跨层通信经过数据二极管（Data Diode）的单向传输审核；

MAS智能体的控制指令需要经过**安全代理**（Security Proxy）的合法性校验，包括指令范围检查（是否超出预定义的安全包络）、变化速率检查（是否异常突变）和序列逻辑检查（是否符合操作规程），任何不合规的指令将被拦截并触发安全告警。这种"信任但验证"的安全架构确保了MAS的智能化不以牺牲安全性为代价。

#### 1.4.5 CPS对水系统控制论的方法论启示

CPS理论对水系统控制论（CHS）的构建提供了四个方面的方法论启示：

**第一，融合思维。** CPS的核心是"融合"——计算与物理的融合、信息与能量的融合、虚拟与实在的融合。CHS继承了这种融合思维，追求将物理模型与数据驱动方法融合（Physical AI + Cognitive AI），将集中式与分布式控制融合（HDC + MAS），将多种水利专业融合（供水、防洪、发电、生态的统一控制）。

**第二，实时闭环。** CPS强调信息处理和物理过程之间的实时闭环交互。CHS同样强调从感知到决策到执行再到反馈的完整闭环——这一闭环必须在系统的时间常数范围内完成，否则就无法实现有效的控制。对于不同层级的控制任务，闭环的时间尺度不同：本地PID控制的闭环在秒级，渠段MPC的闭环在分钟级，全线调度的闭环在小时级。

**第三，安全保障。** CPS的安全性是一个核心主题——当计算系统直接控制物理过程时，任何软件bug或算法错误都可能导致物理世界的灾难。CHS将安全保障提升到了理论框架的核心位置，提出了"安全包络"和"最小风险状态（Minimal Risk Condition, MRC）"等概念，确保系统在任何异常情况下都不会突破安全边界。

**第四，系统工程方法。** CPS的开发需要系统工程的方法论支撑——需求分析、架构设计、V&V（验证与确认）体系、全生命周期管理等。CHS同样采用系统工程的方法论来组织其理论框架和工程实践，特别是"MIL→SIL→HIL"的逐级验证流程，就是CPS安全性验证方法在水系统领域的具体应用。

**第五，人机协作。** CPS理论的一个重要发展方向是"人在回路的CPS"（Human-in-the-loop CPS），即研究人类操作员与自主系统之间的最优交互模式。在水系统中，调度员的经验知识和临场判断力在可预见的未来仍然不可替代——特别是在极端工况、多目标冲突和政治敏感性调度（如跨省水量分配）等场景下。CHS框架通过WSAL分级体系，为人机协作提供了渐进式的发展路径：从L0（完全人工）到L2（人工决策、机器辅助），再从L3（机器决策、人工监督）逐步过渡到L4（高度自主）——每一级的跃迁都是人机角色分配的一次系统性调整，而不是简单的"一步到位"的自动化替代。

**第六，韧性工程。

** CPS理论的一个重要发展方向是**韧性CPS**（Resilient CPS），即研究CPS在面对未预见的扰动（如极端天气、网络攻击、级联故障）时的"吸收—适应—恢复"能力。韧性概念超越了传统可靠性工程的"预防失效"范式，转而承认"失效不可避免"并追求"优雅退化和快速恢复"。对水系统而言，韧性工程的理念具有特殊的实践价值——水利工程面临的自然不确定性（如超标准洪水、极端干旱）远大于工业过程，试图通过冗余设计消除所有风险既不经济也不现实。

CHS框架吸收了韧性CPS的思想，在安全保障机制中设计了**多级降级策略**：正常运行时采用最优控制策略（L3/L4级自主运行），遭遇已知异常时切换到预定义的应急响应策略（L2级人机协同），遭遇未知异常时自动退回到最小风险状态（MRC，L1级基本安全保障）。这种"优雅降级"的思路确保系统在任何不利条件下都能保持基本功能，是水系统CPS设计的核心安全哲学。

综合来看，CPS理论为CHS提供了一个从"理论概念"到"工程实施"的方法论桥梁。如果说系统科学提供了"世界观"，控制科学和人工智能提供了"方法论"和"工具箱"，那么CPS理论则提供了"工程架构"——它告诉我们如何将抽象的理论转化为可实施、可验证、可演进的工程系统。这也是CHS将CPS列为第四个理论支柱（而非仅仅作为应用领域）的深层原因。

### 1.5 本部分小结：三大理论思潮的交汇

至此，我们已经系统梳理了支撑水系统运行科学与工程的四大理论支柱：系统科学提供了整体论的世界观和复杂性分析的方法论；控制科学提供了从反馈控制到分布式智能的完整方法论工具箱；人工智能提供了学习、推理和认知智能的技术手段；信息-物理系统理论为三者的融合提供了统一的框架。

这四大理论支柱并非孤立发展的，它们之间存在着深刻的内在联系和协同效应。系统科学的整体论思维为控制科学的多变量控制和大系统控制提供了认识论基础；控制科学的反馈机制为AI的强化学习提供了核心范式；AI的深度学习为控制科学的建模和决策提供了强大的计算工具；CPS理论则将这些分散的能力整合为一个有机的整体。水系统控制论（CHS）正是在这四大理论支柱的交汇点上应运而生的——它不是某一个理论的简单应用，而是多个理论的"化学融合"，旨在为水系统的自主运行提供一个系统性的、可工程实施的理论框架。

值得强调的是，这四大理论支柱的融合并非发生在抽象的理论层面，而是被具体的**工程需求**所驱动和检验。水系统运行面临的核心挑战——在强不确定性条件下实现大规模分布式系统的安全最优控制——超出了任何单一学科的能力范围。系统科学告诉我们"整体大于部分之和"，但不提供具体的控制算法；控制科学提供了精确的数学工具，但面对高维非线性系统的"维数灾难"力不从心；人工智能展现了强大的学习和泛化能力，但在安全关键场景中缺乏可证明的保证；CPS理论提供了融合框架，但其具体实现路径必须根据水系统的物理特性进行定制。正是这些互补的优势和共同的局限，催生了CHS作为一个**领域特定的交叉理论框架**的必要性——它不是通用理论的简单应用，而是在水系统这一特定领域中，将多种理论工具"重新组合"为一个有机整体的创造性尝试。

> **图 1-4　水利CPS三层闭环架构**
> *Fig. 1-4 Three-Layer Closed-Loop Architecture of Water CPS*
>
> ```
>   ┌─────────────────────────────────────────────────────┐
>   │                   云端层 (Cloud)                     │
>   │  全局优化 · 数字孪生 · 大模型推理 · 知识图谱         │
>   └──────────────────────┬──────────────────────────────┘
>                    ▲     │     ▲
>                    │模型同步│  │全局指令
>                    │     ▼     │
>   ┌────────────────┴──────────┴─────────────────────────┐
>   │                   边缘层 (Edge)                      │
>   │  局部MPC · 安全包络监测 · 通信中断自治 · 数据预处理   │
>   │  ┌─────┐  ┌─────┐  ┌─────┐  ┌─────┐  ┌─────┐       │
>   │  │闸站1│  │闸站2│  │闸站3│  │ ... │  │闸站n│       │
>   │  └──┬──┘  └──┬──┘  └──┬──┘  └──┬──┘  └──┬──┘       │
>   └─────┼────────┼────────┼────────┼────────┼───────────┘
>         │传感+执行│        │        │        │
>   ┌─────┴────────┴────────┴────────┴────────┴───────────┐
>   │                  物理层 (Physical)                    │
>   │  渠道 · 闸门 · 泵站 · 管道 · 传感器 · 水流           │
>   └─────────────────────────────────────────────────────┘
> ```


---

**思考与讨论**

1. （概念理解）数字孪生与传统仿真模型的核心区别是什么？请用"实时性"和"双向性"两个关键词解释。
2. （分析应用）在一个全长200km的调水渠道中部署边缘计算节点，你认为合理的节点间距是多少？需要考虑哪些因素？
3. （综合设计）请设计一个水利CPS的"感知—计算—执行"闭环架构，说明各层的功能和它们之间的数据流。


---


---

### §1.4 本节小结


本节阐述了信息-物理系统（CPS）理论如何为水系统运行提供融合架构。CPS的"感知—计算—执行"闭环与水系统"监测—决策—调控"闭环具有同构性，数字孪生技术则为水系统提供了"虚实映射"的在线仿真能力。边缘计算解决了广域水网中实时控制的通信延迟问题。CHS框架中HydroOS的"边缘—区域—中央"三层架构直接借鉴了CPS的分层计算范式。

### 1.5 智能演化与水系统控制的深层类比

在完成了对系统科学、控制科学、人工智能和CPS四大理论支柱的梳理之后，本节将引入一个全新的视角——从生物智能演化的角度，来审视水系统控制科学的发展历程。这一视角源于麦克斯·班尼特（Max Bennett）在《智能简史》（*A Brief History of Intelligence*）中提出的"智能五次突破"框架 [43]。我们将看到，生物智能从简单反射到自主决策的演化路径，与水系统从人工操作到自主运行的演进路径之间，存在着深刻的结构性同构。这种同构不是偶然的巧合，而是揭示了"智能系统"——无论是碳基的生物体还是硅基的工程系统——在面对复杂环境时所遵循的共同演化逻辑。

引入这一类比视角有三重目的。第一，它为水系统控制技术的发展提供了一个统一的叙事框架——从PID到MPC到MAS到LLM的技术演进，不再是一系列孤立的技术创新，而是一条遵循智能演化规律的必然路径。第二，它为CHS理论的完备性提供了检验标准——如果某个智能演化阶段在水系统控制中缺乏对应的技术实现，则可能标志着一个有待填补的理论空白。第三，更为深远地，它将水系统控制的研究置于"智能系统设计"这一更广阔的跨学科语境中，为从神经科学、认知科学等领域汲取设计灵感打开了大门。

#### 1.5.1 生物智能的五次突破

班尼特在梳理了6亿年的大脑进化史后，将人类智能的形成过程概括为五次结构性突破：

**第一次突破：转向（Steering）。

** 约6亿年前，最早的两侧对称动物演化出了第一个大脑——一个能将外界刺激分为"好的"和"坏的"并做出趋利避害转向决策的神经网络。多巴胺和血清素等神经调质使这种价值判断得以持续和调节。这是智能的起点——最原始的"感知-决策-执行"闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）。在寒武纪大爆发的选择压力下，这一简单机制催生了地球上最早的"主动行为者"——不再被动地随水流漂浮，而是朝向食物、远离危险地主动移动。从工程角度来看，这一突破的核心贡献是建立了"偏差→纠正"的基本反馈回路，这正是所有后续智能的基石。

值得注意的是，这第一个"大脑"的结构极其简单——可能只有数百个神经元——但它解决了智能系统最根本的问题：将外界的物理信号转化为内部的价值判断，再将价值判断转化为行为输出。这一"感知→估值→行动"的三元架构，至今仍是所有智能系统——从恒温器到自动驾驶汽车——的基本蓝图。

**第二次突破：强化（Reinforcement）。** 约5亿年前，脊椎动物演化出了试错学习的能力。基底神经节的出现使动物能够通过"做了某件事→得到了好结果→以后多做这件事"的强化学习机制来积累经验。多巴胺系统从简单的"好事将近"信号进化为精确的时序差分学习信号——Schultz等人在1990年代的实验中发现，猴子中脑多巴胺神经元的放电模式与Sutton & Barto强化学习理论中的TD误差信号惊人地吻合。这一发现证实了生物大脑和人工强化学习算法在数学结构上的深层统一。班尼特指出，这第二次突破的关键创新在于"时间"维度的引入——第一次突破只能处理"当下"的刺激，而强化学习使动物能够将"过去"的经验与"当下"的情境关联起来，从而做出"基于历史的"决策。

这种时间维度的扩展，恰好对应了从无记忆的PID控制（只关注当前偏差）到自适应控制（基于历史数据调整参数）的技术跨越。

**第三次突破：模拟（Simulation）。

** 约1亿年前，哺乳动物演化出了新皮质，获得了在行动前先在"脑中模拟"的能力。动物不再需要通过实际试错来学习，而是可以通过想象来探索不同行动方案的后果，进而做出更明智的规划。这一能力的生物基础是新皮质六层柱状结构中的"生成模型"——大脑不断预测下一刻的感觉输入，当预测与现实不符时产生"预测误差"信号，驱动模型的更新和修正。这种"预测-修正"循环是所有基于模型的智能的核心机制——从贝叶斯（Bayesian，一种基于先验知识和观测数据进行概率推断的统计方法）大脑假说到卡尔曼滤波，从自由能最小化到MPC，本质上都是同一机制的不同实现形式。班尼特特别强调，新皮质的计算本质可以理解为一台"预测机器"（Prediction Machine）——它持续地生成关于外部世界的预测，并通过与实际感觉输入的比对来不断修正这些预测。

Karl Friston的自由能原理（Free Energy Principle）将这一思想推向了极致：大脑的所有功能——从感知到运动到学习——都可以统一描述为"最小化预测误差"（即最小化变分自由能）的过程。这一理论洞见与MPC的数学框架惊人地一致：MPC控制器也是通过最小化目标函数（即预测的状态偏差和控制代价）来生成最优行为的。

**第四次突破：心智化（Mentalizing）。** 约3000万年前，灵长类动物演化出了建构自己和他人心理状态模型的能力——即"心智理论"（Theory of Mind）。这使得灵长类动物能够理解他人的意图、预测他人的行为，并通过观察来学习。心智化能力的演化压力来自灵长类日益复杂的社会生活——在一个充满竞争与合作的群体中，能够预测同伴和对手行为的个体具有显著的生存优势。邓巴（Dunbar）提出的"社会大脑假说"认为，灵长类大脑新皮质的相对尺寸与其社会群体规模呈正相关——协调更大的社会网络需要更强的认知能力。

**第五次突破：语言（Language）。** 约10万年前，人类发展出了语言能力，使思想不仅可以在个体内部处理，还可以在个体之间传递和跨代积累。语言使得知识的共享和文化的演进成为可能，从而极大地加速了智能的发展。班尼特强调，语言的革命性意义不在于交流本身（很多动物都有交流能力），而在于"符号化"——用有限的符号规则生成无限的意义组合。这种"有限规则、无限生成"的特性，使得人类能够讨论从未见过的事物、规划遥远的未来、传递祖先的教训——这些能力远超任何非语言交流所能承载的信息量和抽象层次。

#### 1.5.2 从生物智能到水系统控制的映射

令人惊叹的是，水系统控制科学的发展历程与生物智能的五次突破呈现出高度的结构性同构。下面逐一展开这种映射关系。

**转向 → PID反馈控制。** 生物智能的第一次突破是"转向"——对外界刺激做出最基本的趋利避害反应。在水系统控制中，PID控制器扮演了完全类似的角色：它检测水位偏差（"好"或"坏"的信号），然后做出简单的调整动作（增大或减小闸门开度）。PID控制器就是水系统的"最原始大脑"——它具备了最基本的"感知-决策-执行"闭环，但其行为是纯反应式的、无记忆的、无预见的。正如最早的两侧对称动物只能对当前刺激做出即时反应一样，PID控制器也只能对当前的水位偏差做出即时响应，无法预见未来的变化趋势。PID中的微分（D）项虽然试图捕捉变化趋势，但这只是一阶的局部预测，远未达到真正的"预见"能力。

**强化 → 自适应控制与参数学习。** 生物智能的第二次突破是"强化学习"——通过试错积累经验，学会在特定情境下做出更好的选择。在水系统控制中，自适应控制和参数在线辨识扮演了类似的角色。自适应控制器能够根据运行经验（历史数据）调整自身的控制参数——如果某组PID参数在某种工况下导致了较大的水位偏差（"负奖励"），控制器会自动调整参数以减小偏差（"正奖励"）。这种从运行经验中学习的能力，正是从"纯反射"到"经验学习"的飞跃。

更进一步，深度强化学习（DRL）直接将生物强化学习的数学框架——时序差分学习——应用于水系统调度策略的优化，实现了从"手工整定参数"到"自动学习策略"的跨越。但这里的一个关键差异值得注意：生物强化学习可以容忍失败（被捕食者吃掉的个体不会影响种群的学习），而水系统的强化学习不能容忍失败——一次错误的闸门操作可能导致灾难性后果。这就是为什么CHS框架强调"安全强化学习"（Safe RL）——必须在约束条件下进行试错学习，确保学习过程本身不违反安全底线。在实践中，这通常通过在数字孪生环境（而非物理系统）中进行大量"虚拟试错"来实现——这又回到了第三次突破"模拟"的能力，说明智能能力之间的相互依赖性。

**模拟 → 模型预测控制（MPC）。** 生物智能的第三次突破是"模拟"——新皮质使动物能够在行动前先在脑中模拟不同方案的后果。这一突破在水系统控制中的对应物正是MPC。MPC的核心能力就是"在行动前先预测"——它利用水力学模型在每个控制时刻模拟未来一段时间内不同控制方案的后果，然后选择使目标函数最小的最优方案。这与哺乳动物"在脑中探索世界"的能力完全类似。MPC的预测时域 $T_p$ 就像是新皮质"向前看"的时间范围——$T_p$ 越长，控制器的"前瞻"能力越强，但计算负担也越大。MPC的滚动优化策略——在每一步只执行第一个控制动作，然后利用新信息重新预测和优化——正是"用模拟指导行动，用现实修正模拟"的闭环过程，与哺乳动物"想象→行动→观察→修正想象"的学习循环如出一辙。

这一映射还有一个更深层的含义。班尼特指出，新皮质的出现是智能进化的"分水岭"——它使得动物从"只能通过实际试错来学习"飞跃到"可以通过想象来学习"。同样，MPC的出现也是水系统控制的"分水岭"——它使得控制系统从"只能对当前偏差做出反应"飞跃到"可以预见未来并主动优化"。没有MPC（或类似的预测性控制方法），水系统的自主运行是不可能实现的——正如没有新皮质，哺乳动物的规划和反事实推理能力就不可能出现。

**心智化 → 多智能体系统（MAS）与博弈论。** 生物智能的第四次突破是"心智化"——建构自己和他人的心理状态模型，从而理解他人的意图和预测他人的行为。在水系统控制中，多智能体系统（MAS）实现了类似的功能。在一个MAS架构中，每个智能体（如每座闸门的控制器）不仅关注自身的局部目标，还需要"理解"相邻智能体的意图和行为——下游智能体需要预测上游智能体的放水计划，上游智能体需要考虑下游智能体的需求约束。这种"站在对方的角度思考"的能力，正是心智化在工程系统中的体现。

博弈论在MAS中的引入进一步加深了这种类比。在多用户共享水资源的场景中，各用户被建模为具有各自利益的博弈参与者。纳什均衡等博弈论概念为多智能体的协调提供了数学工具——就像灵长类动物在社会群体中通过"政治智慧"来协调利益冲突一样，水系统中的智能体通过博弈论算法来协调调度冲突。班尼特指出，灵长类动物大脑容量的增大与社会群体规模的增大之间存在正相关——更大的社会群体需要更强的心智化能力。类似地，在水系统控制中，水网的规模越大（涉及的智能体越多），对MAS协调机制的智能化要求就越高。

**语言 → 认知AI（大语言模型）。** 生物智能的第五次突破是"语言"——使思想能够被命名、传递和跨代积累。在水系统控制中，大语言模型（LLM）的出现实现了类似的飞跃。LLM赋予了水系统"理解自然语言"和"生成自然语言"的能力——调度员可以用日常语言与系统交流，系统可以用自然语言解释自己的决策逻辑。更重要的是，LLM使得水系统运行中积累的隐性知识（如经验丰富的老调度员的"直觉"）得以被形式化、传递和累积——这正是语言的核心功能。

语言还使得"知识的跨系统迁移"成为可能。一个在胶东调水工程上积累的运行经验，通过自然语言的编码和大语言模型的理解，可以被迁移到南水北调或引江济淮等其他工程上——就像人类通过语言实现了知识的跨代和跨地域传播一样。CHS框架中"Cognitive AI引擎"的概念，正是"语言作为智能飞跃催化剂"这一进化洞见在工程领域的映射。

然而，班尼特也提醒我们注意语言的双刃剑特性：语言在使知识传播成为可能的同时，也使得"错误知识的传播"成为可能——谣言、偏见和过时信息同样可以通过语言媒介快速扩散。这一洞见对于水系统中LLM的应用具有重要的警示意义：大语言模型可能"一本正经地胡说八道"（即所谓的"幻觉"问题），在安全攸关的水系统运行决策中，这种幻觉输出可能造成严重后果。CHS框架因此强调"认知AI辅助决策、物理AI执行控制"的分工原则——LLM的输出必须经过物理模型和安全包络的"形式化验证"后才能转化为实际的控制动作，确保"语言的力量"在安全边界内发挥作用。

#### 1.5.3 第六次突破：水系统的自主运行

班尼特在《智能简史》的结尾预言了智能的"第六次突破"——超级智能的出现，即智能从碳基生物媒介向硅基数字媒介的跃迁。在这个新媒介中，单一智能体的认知能力将实现质的扩展，不再受限于神经元处理速度和大脑容量的生物学约束。

在水系统的语境下，"第六次突破"对应的是**完全自主运行**（WSAL L5级）的实现。这意味着水系统从根本上超越人类调度员的认知和决策能力：它能同时处理数百个变量的耦合关系（人脑无法做到），能在毫秒级做出跨越数百公里的全局最优决策（人类需要数小时），能从海量历史数据中发现人类无法察觉的隐含模式和规律，能在极端工况下保持冷静理性的决策（人类可能在压力下犯错）。

然而，正如班尼特所提醒的，第六次突破不仅是技术问题，更是哲学和伦理问题。当水系统具备了超越人类的决策能力时，我们是否愿意将关乎千百万人饮水安全和防洪安全的决策权交给一个"硅基系统"？如何确保这个系统的决策是可审计的、可解释的、可追溯的？如何在追求效率最优的同时确保公平性和公正性？这些问题没有简单的答案，但它们正是水系统控制论（CHS）必须面对和回答的核心问题。

从演化论的角度来看，"第六次突破"可能不会以"完全取代人类"的形式出现，而更可能以"人机共生"的形式出现——就像人类语言的出现并没有取消人类的模拟能力和心智化能力，而是在它们之上增加了新的维度。在水系统控制的语境下，这意味着未来的"完全自主运行"系统不是要取代人类调度员，而是要形成一种新的"人机共生智能"——系统负责实时的数据处理、模型预测和优化决策（这是硅基智能的优势），人类负责价值判断、异常应对和战略规划（这是碳基智能的优势）。WSAL分级体系的设计哲学，正是这种"渐进共生"理念的体现——从L0（人类独立）到L5（系统独立）的过程中，L3-L4区间可能是最长期的稳定状态，在此状态下人机各自发挥比较优势，形成"1+1>2"的协同效应。

值得注意的是，这种智能演化的视角也为我们理解水系统控制的"国别差异"提供了线索。不同国家的水系统智能化水平之所以差异显著，不仅仅是技术投入的差异，更深层的原因在于各国水系统面临的"演化压力"不同。荷兰面临海平面上升的生存威胁，驱动了其防洪系统向L3甚至L4水平的快速演化；以色列面临极端水资源短缺，驱动了其灌溉系统向高度自动化的方向演化；中国面临的是超大规模水网的全局协调问题，这要求的是第四次突破（MAS协调）和第五次突破（认知AI）层面的能力——这也正是CHS框架重点关注的方向。

#### 1.5.4 映射表：智能演化与水系统控制的对照

| 智能演化阶段 | 时间尺度 | 核心能力 | 水系统控制对应物 | CHS中的技术实现 |
| :--- | :--- | :--- | :--- | :--- |
| 第一次：转向 | ~6亿年前 | 趋利避害的即时反应 | PID反馈控制 | 本地闸门PID控制器 |
| 第二次：强化 | ~5亿年前 | 从经验中学习 | 自适应控制/参数学习 | 在线参数辨识、DRL |
| 第三次：模拟 | ~1亿年前 | 行动前的内部预演 | 模型预测控制（MPC） | 基于ROM的滚动优化 |
| 第四次：心智化 | ~3000万年前 | 理解他人意图 | MAS多智能体协调 | 渠池/枢纽/全局三类Agent |
| 第五次：语言 | ~10万年前 | 知识传递与累积 | 认知AI（LLM） | 领域大语言模型 + KG-RAG |
| 第六次：超级智能 | 即将来临 | 超越生物限制 | 完全自主运行（L5） | HydroOS + CHS全栈 |

这张映射表不仅是一个类比工具，更揭示了水系统控制技术发展的**内在必然性**——每一次技术跃升都不是偶然的创新，而是水系统在面对日益增长的复杂性挑战时，"智能演化压力"驱动下的必然回应。PID不够用了，才会发展自适应控制；自适应控制不够用了，才会引入MPC；单体MPC不够用了，才会发展MAS；MAS协调效率不够高，才会引入认知AI。这种"需求倒逼→技术演化→新的需求"的递归循环，与生物智能的进化逻辑如出一辙。

这种映射关系还有一个深层含义：生物智能的演化并非前一阶段被后一阶段所取代，而是层层叠加——人类大脑同时保有爬行动物的应激反应回路（脑干）、哺乳动物的情感学习回路（边缘系统）和灵长类的理性思维回路（新皮质）。同样，先进的水系统控制架构也应该是层次叠加的：底层是PID的快速反馈保护（毫秒级响应，保障安全底线），中层是MPC的优化预测（分钟级决策，追求性能最优），顶层是认知AI的战略推理（小时级规划，应对极端工况和跨域协调）。各层次之间不是替代关系，而是互补关系——正如人在紧急时刻本能地"缩手"（脑干反射）而不会等大脑皮层"想清楚"再行动，水系统在检测到危险水位时也应立即触发底层PID保护闭环，而无需等待上层MPC或AI的优化计算结果。CHS的"安全包络"机制正是这种多层次叠加架构的制度化表达。

#### 1.5.5 从类比中提取的方法论启示

这一深层类比为水系统控制论的理论构建和技术发展提供了三个重要的方法论启示。

**第一，累积性而非替代性。** 生物智能的五次突破不是相互替代的，而是逐层累积的——新皮质的出现并没有取消基底神经节的功能，语言的出现并没有取消新皮质的模拟能力。同样，水系统控制技术的发展也应该是累积性的——MPC不取代PID，MAS不取代MPC，LLM不取代物理模型。每一层技术都在其适用的尺度上继续发挥作用，共同构成一个多层次的智能控制体系。CHS框架中"分层分布式统一"的思想，正是这种累积性哲学的体现。

**第二，约束是创新的驱动力。** 生物智能的每次突破都是环境压力驱动的结果——两侧对称是捕食竞争的产物，强化学习是生存竞争的产物，新皮质是与恐龙共存压力的产物。同样，水系统控制的每次技术进步都是工程约束驱动的结果——时滞驱动了MPC的发展，规模驱动了分布式控制的发展，安全需求驱动了安全包络的发展。这意味着，水系统的独特工程约束不应被视为"阻碍"，而应被视为"创新的驱动力"。

**第三，理解过去才能导航未来。** 班尼特的核心论点是：理解智能的去向，需要先看清它从何处出发。同样，要规划水系统控制技术的未来发展方向，也需要深刻理解其过去的演进逻辑。五次突破的映射表不仅帮助我们理解"水系统控制为什么是现在这个样子"，也为我们预见"水系统控制将走向何方"提供了启发——如果第六次突破确实是"超级智能"，那么水系统控制的终极目标就是实现完全自主的、超越人类能力的运行控制系统。但更务实的启示在于：当前水利行业的大部分工程尚处于第一次和第二次突破对应的阶段（PID和简单自适应），距离第三次突破（MPC/数字孪生）仍有相当差距。理解这一现实，有助于制定更合理的技术发展路线图——不是跳跃式地追求最高级别的智能，而是按照演化规律，扎实地完成每一次突破。

值得补充的是，生物智能演化的历史还揭示了一个重要的"设计原则"：**鲁棒（robust，指系统在参数变化或外部干扰下仍能保持稳定性能的能力，类似于水利工程中的'抗干扰性'）性比最优性更重要**。在6亿年的演化史中，存活下来的不是"最优"的物种，而是"最鲁棒"的物种——即那些能够在环境剧变中保持基本功能的物种。鳄鱼的设计在2亿年间几乎没有变化，因为它已经足够鲁棒；而许多在短期内"最优化"的物种反而在环境突变中灭绝了。同样，在水系统控制中，一个能够在各种扰动和异常条件下保持安全运行的系统，比一个在正常条件下能达到理论最优但在异常条件下可能崩溃的系统，具有更高的实际价值。这一"鲁棒优先"的原则，深刻影响了CHS框架的设计哲学——安全包络、最小风险状态、优雅降级等核心概念，都是"鲁棒性优先"原则的工程体现。

**第四，跨学科思维的方法论价值。** 从生物智能演化中提取水系统控制的设计原则，这一方法本身就体现了跨学科思维的巨大威力。水系统控制论（CHS）的理论创新，在很大程度上得益于其创立者广泛的学科视野——从钱学森的工程控制论中汲取系统方法论，从生物智能演化中汲取设计哲学，从自动驾驶分级中汲取评估框架，从计算机操作系统中汲取软件架构理念。这种跨学科的"概念迁移"能力，是原创性理论产生的重要源泉。正如维纳（Wiener）当年创立控制论时，是从神经生理学和数学的交叉中找到灵感；CHS的创立也是从控制科学、水利工程、人工智能和生物进化的交叉中找到了独特的理论视角。

这一认识论层面的启示对于水利学科的发展提供了关键理论支撑。传统水利学科的知识边界相对封闭——水力学、水文学、水工结构等方向各自深耕，与外部学科的交流有限。CHS框架的出现，在某种意义上打开了水利学科的"知识边界"——它邀请控制工程师、计算机科学家、人工智能研究者甚至进化生物学家共同参与水系统运行问题的讨论，从而为水利学科注入了全新的思想资源和方法论工具。

**第五，"足够好"原则与演化经济学。** 生物演化还教导我们一个常被忽视的原则：自然选择不追求"完美"，只追求"足够好"（Good Enough）。一个生态位中，存活下来的物种不是理论上最优的那个，而是在特定环境约束下"性价比"最高的那个。眼睛并不是完美的光学设计（视网膜是"倒装"的），但它在进化可及的范围内已经足够好用。这一原则对水系统智能化建设具有重要的实践指导意义：不应追求理论上的"全局最优"（如L5级全自动运行），而应追求在当前技术条件和工程约束下的"足够好"（如L3级条件自动化，在特定ODD内可靠运行）。过早追求不成熟的高级智能，可能反而不如成熟的中级智能安全可靠。CHS框架中WSAL渐进式分级的设计哲学，正是这种演化经济学思维的体现。


---

**思考与讨论**

1. （概念理解）自动化（Automation）和自主化（Autonomy）的本质区别是什么？请用水利场景举例说明。
2. （分析比较）从自动驾驶的L0-L5演进历程中，你认为水网自主运行可以借鉴哪些经验，又有哪些本质差异需要注意？

# 第二部分　学科演进：从古代实践到现代科学

两千多年前，李冰在都江堰竖立石人"量水位"——这或许是人类最早的水位监测装置。两千多年后，南水北调中线工程的调度中心里，上万个传感器每分钟回传一次数据。技术天翻地覆，但核心问题从未改变：**如何让水在对的时间、以对的流量、到达对的地方？**

本部分回溯这个问题的求解历程——从经验实践到科学理论的演进全景。§2.1追溯古代水利中隐含的控制论雏形；§2.2回顾20世纪SCADA和水库调度的学科奠基；§2.3分析物联网与数字孪生驱动的数字化转型；§2.4详述渠道自动控制的六代技术演进（PID→ID→IDZ→MPC→DMPC→CHS双引擎）；§2.5系统阐述CHS理论框架——六维统一、八大原理、可控模型族；§2.6介绍HydroOS水网操作系统；§2.7通过胶东调水、沙坪水电、南水北调中线三大工程案例验证理论。

本部分与第一部分的关系是：第一部分提供了"通用工具"（系统科学、控制论、AI、CPS），本部分展示这些工具在水系统中如何被"特殊化"和"工程化"。核心叙事线索是：**水系统运行如何从"经验驱动"走向"理论驱动"？**


## 2.1 早期实践：运行智慧的千年传承

水系统的运行实践几乎与人类文明同样古老。早在系统科学、控制论等现代理论诞生之前数千年，人类就已经在水利工程的建设和运行中积累了丰富的实践智慧。这些早期实践虽然没有形成系统的理论，但其中蕴含的"感知—决策—执行—反馈"闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）思想，与现代控制论的核心理念一脉相承。回顾这段历史，不仅能帮助我们理解水系统运行科学与工程的实践渊源，更能揭示从经验实践到科学理论演进的内在逻辑。

### 2.1.1 古代水利工程中的运行智慧

#### （1）美索不达米亚：灌溉文明的起源

人类最早的大规模水利工程实践可以追溯到公元前6000年左右的美索不达米亚（Mesopotamia，今伊拉克地区）。底格里斯河与幼发拉底河两河流域的先民，在干旱半干旱的自然条件下，发展出了世界上最早的灌溉渠系。苏美尔人修建的灌溉渠道网络覆盖面积超过数万公顷，通过分级渠道将河水引入农田。这些渠系已经具备了初步的水量分配功能：主渠道上设置简易的分水口，由专门的"水官"根据农时和水量需求进行人工调节。

值得注意的是，苏美尔语中已经出现了专门描述灌溉管理的词汇和文书。乌尔第三王朝（约公元前2112—前2004年）的行政档案中，记录了详细的渠道维护制度、水量分配规则和劳力征调方案。这些制度化的管理实践表明，早在四千多年前，人类就已经认识到水系统运行不仅是一个工程技术问题，更是一个需要制度保障的系统管理问题。

更为引人注目的是，公元前1750年左右的《汉谟拉比法典》（Code of Hammurabi）中，专门有多条法律涉及灌溉渠道的运行管理。法典第53条规定："若一人因疏于维护其田间堤坝而导致邻人田地被水淹没，该人应赔偿所损失之谷物。"第55条更进一步："若一人开启灌溉水口后因疏忽导致水流冲毁邻人田地，该人应按邻人田地之正常产量予以赔偿。"这些法律条文的存在说明，灌溉系统的运行失误（相当于现代概念中的"控制故障"）已经引起了严重的社会后果，以至于需要通过法律手段来规范运行行为。从现代系统工程的视角来看，这可以被视为人类最早的"水系统运行安全规范"——虽然形式上是法律条文而非技术标准，但其功能指向是一致的：确保水系统的运行不造成不可接受的损害。

美索不达米亚灌溉实践中蕴含的一个重要历史教训是盐碱化问题。由于长期灌溉而缺乏有效的排水机制，大量灌区出现了严重的土壤盐碱化，最终导致部分地区农业产量锐减乃至文明衰退。从现代系统论的视角来看，这一教训深刻揭示了水系统的"开放性"特征——灌溉系统不是一个封闭的输水通道，而是与土壤、地下水、气候等环境要素持续交互的开放系统。忽视系统的开放性，只关注输水功能而忽略排水和盐分平衡，最终导致系统整体功能的崩溃。这一教训在今天的灌区管理中仍具有深刻的警示意义。

#### （2）古埃及：水文监测与调度决策的萌芽

古埃及文明高度依赖尼罗河的年度洪水周期。每年6月至9月，尼罗河泛滥带来肥沃的淤泥，滋养两岸农田。古埃及人围绕这一自然规律，发展出了一套精密的水文监测与灌溉调度体系，其核心工具是"尼罗河水位计"（Nilometer）。

尼罗河水位计是人类历史上最早的水文监测仪器之一。最古老的水位计遗址可追溯到公元前3000年左右，分布在尼罗河沿岸从阿斯旺到开罗的多个观测站点。水位计主要有三种形式：一是刻有标尺的垂直石柱，立于河岸或河中，直接读取水位；二是与河流相连的阶梯状竖井，通过井中水面的升降来反映河流水位变化；三是导水渠道式水位计，将河水引入专门的测量室。其中，位于开罗罗达岛（Roda Island）的尼罗河水位计是保存最完好的古代水文监测设施之一，其记录可追溯到公元622年，连续观测记录长达千年以上，是世界上最长的水文记录序列之一。

从现代控制论的视角来审视，古埃及的尼罗河水文监测与调度体系已经具备了闭环控制的基本要素。水位计构成了"传感器"（Sensor），负责采集水文信息；祭司或官员根据水位读数判断洪水大小并制定灌溉方案，充当了"控制器"（Controller）的角色；农民按照指令开挖或封堵灌溉口，执行"执行器"（Actuator）的功能；而洪水退去后对农田产量的评估，则形成了原始的"反馈"（Feedback）机制——如果某年的灌溉效果不佳，来年会调整水量分配策略。这一"感知—决策—执行—反馈"的闭环结构，与维纳在两千多年后提出的控制论基本范式在本质上是相通的。

更值得关注的是，古埃及人已经发展出基于水位监测的"预测调度"思想。上游阿斯旺的水位变化先于下游开罗数日至数周，通过沿河各站的水位接力观测，可以提前预判洪水的到来时间和规模，从而为灌溉准备赢得宝贵的提前量。这种"利用上游信息预测下游状态"的思想，与现代水文预报和前馈控制（Feedforward Control）的理念不谋而合。

值得一提的是，罗达岛水位计的千年连续记录在现代水文学和气候学研究中具有珍贵的科学价值。20世纪的统计水文学家对这组数据进行了深入分析，发现尼罗河年最高水位序列表现出明显的长程相关性（Long-Range Dependence）——即相距数十年乃至上百年的观测值之间仍存在统计关联。英国水文学家赫斯特（Harold Edwin Hurst）基于对这一现象的研究，于1951年提出了"赫斯特指数"（Hurst Exponent），揭示了水文时间序列不同于纯随机过程的"持久性"特征。这一发现不仅深刻影响了水文学的统计基础理论，还启发了曼德博（Benoît Mandelbrot）的分形几何研究。古埃及水位观测的遗产，竟以这种方式跨越数千年，为现代非线性科学的发展做出了贡献——这或许是古代水文监测智慧最意想不到的延续。

#### （3）都江堰：被动自适应控制的杰作

中国是世界上水利工程历史最悠久的国家之一。公元前256年左右，蜀郡太守李冰主持修建的都江堰，是古代水系统运行智慧的杰出代表，也是世界水利史上"无坝引水"工程的典范。

都江堰由鱼嘴分水堤、飞沙堰溢洪道和宝瓶口引水口三大主体工程组成，巧妙利用了岷江出山口的自然地形和弯道水流特性，实现了"自动分流、自动排沙、自动控制进水量"三大功能。从现代控制论的视角来看，都江堰的运行机制蕴含着深刻的反馈控制思想：

其一，鱼嘴的自适应分水机制。鱼嘴将岷江分为内江（灌溉用水）和外江（排洪通道）。在枯水期，由于河床断面形态的作用，约六成水量进入内江，保证灌溉需求；在洪水期，由于主流偏向外江，约六成水量经外江排走，防止灌区遭受洪水侵袭。这种分水比例随水位自动调节的机制，本质上是一种被动自适应控制（Passive Adaptive Control）——系统不需要外部信息输入和人工干预，仅凭工程结构本身就能根据水位变化自动调节运行状态。

其二，飞沙堰的自动溢流排沙功能。飞沙堰的堰顶高程经过精心设计，当内江水位超过一定阈值时，多余的水量自动从飞沙堰溢出排入外江，同时利用弯道环流效应将泥沙排出。这一机制相当于一个具有固定阈值的"安全阀"（Safety Valve），在现代控制术语中可以类比为"安全包络"（Safety Envelope）的原始形态——当系统状态超出安全边界时，自动触发保护动作。

其三，宝瓶口的流量限制功能。宝瓶口是在坚硬岩石上开凿的引水口，其宽度固定，起到了天然的"节流阀"作用，限制了进入灌区的最大流量。无论上游来水如何变化，通过宝瓶口的流量都不会超过其过流能力所允许的上限。这一设计体现了"硬约束"（Hard Constraint）的工程思想——在系统设计阶段就通过物理结构确保关键安全指标不被突破。

三大工程的有机组合，产生了任何单一工程都无法实现的涌现功能（Emergent Function）。都江堰建成两千多年来，至今仍在发挥灌溉效益，灌溉面积从最初的约70万亩扩展到今天的1000余万亩，是世界上年代最久、唯一留存、仍在使用的无坝引水工程。其长久的生命力，很大程度上归功于其运行机制对自然水文变化的高度适应性——这种适应性不依赖于任何机械装置或人工操作，而是内嵌于工程结构本身。

#### （4）灵渠与大运河：长距离输水的运行管理

除都江堰外，中国古代还建造了一系列以长距离输水为特征的大型水利工程，积累了丰富的运行管理经验。

灵渠建于公元前214年，是世界上最古老的运河之一。灵渠通过铧嘴将湘江水分为两股，一股仍入湘江，一股经渠道引入漓江，沟通了长江水系与珠江水系。灵渠全长仅约34公里，但其运行管理制度却相当精密。灵渠设有"陡门"（一种原始的船闸），在唐代已有36座之多。陡门的启闭需要根据上下游水位差和航运需求进行人工调节，这可以视为人类最早的"水位—流量协调控制"实践之一。陡门的启闭规则在长期实践中逐渐制度化，形成了专门的管理规程，由"陡夫"负责日常操作——这是古代"调度员"角色的雏形。

京杭大运河是中国古代最宏大的水利工程，全长约1794公里，贯通海河、黄河、淮河、长江、钱塘江五大水系。大运河的运行管理面临极其复杂的挑战：沿线地势起伏，需要通过多级船闸进行水位衔接；水源补给依赖沿线多条河流，需要协调各段的水量分配；黄河夺淮、淤积堵塞等突发事件频发，需要建立应急响应机制。

明清时期，大运河的运行管理达到了高度成熟的水平。朝廷设立了从中央到地方的多级管理机构，形成了"河道总督—管河道员—闸官—闸夫"的分层管理体系。这种分层管理结构，与现代分层分布式控制（Hierarchical Distributed Control, HDC）的组织架构高度相似：中央（河道总督）负责全局决策和资源调配，区域（管河道员）负责本段的协调管理，基层（闸官、闸夫）负责单个闸门的具体操作。各层之间通过驿报系统传递水情信息和调度指令，形成了一个覆盖数千公里的信息传递与指挥控制网络。

特别值得关注的是大运河调度中的"时序协调"问题。漕船通过多级船闸时，需要上下游闸门的启闭在时间上精确配合——下游闸门放水充室时，上游闸门需保持关闭以维持水位差；船只通过后，需要依次复位以恢复各闸室的正常水位。这种时序约束下的多闸协调操作，在本质上是一个"有序调度"问题，与现代计算机科学中的"流水线"（Pipeline）控制和工业自动化中的"顺序控制"（Sequential Control）概念高度吻合。清代文献记载，繁忙时段的南旺段每日过船可达数百艘，闸夫需要在分钟级的时间尺度上完成闸门操作的协调——这对人工调度的精确性和及时性提出了极高要求，也从反面说明了自动化控制对于复杂水工系统运行的重要价值。

清代《河防一览》等典籍详细记录了大运河的运行管理规程，包括各段的水位控制标准、船闸的启闭规则、洪水期间的应急预案等。这些规程的精细程度令人惊叹——例如，对于南旺分水枢纽（大运河的最高点和分水岭），规定了"南七北三"的分水比例，即七分水量南流入长江方向，三分水量北流入海河方向，以保证南北两段的航运水深。这一分水规则的制定，显然是基于长期运行经验的总结和对水量平衡关系的深刻理解。

大运河的运行管理中还蕴含着一个有趣的"多目标博弈"问题。运河同时承载着漕运（粮食运输）、灌溉、排洪和城市供水等多重功能。各功能对水位和流量的需求往往相互矛盾：漕运需要充足的航深，灌溉需要在农时引水入田，排洪则需要在汛期快速泄放洪水。管理者必须在这些相互竞争的需求之间进行权衡和取舍。明代"治河保漕"的政策就反映了这种多目标决策的困境——为保证漕运通畅而采取的河道治理措施，有时反而加剧了水患。这一历史经验说明，水系统运行本质上是一个多目标优化问题，需要从系统全局的视角来寻求平衡解，而非仅从单一目标出发。

#### （5）古罗马引水渠与坎儿井：跨文明的运行智慧

古代水利运行智慧并非中华文明独有。古罗马帝国修建了总长超过400公里的引水渠（Aqueducts）系统，将清洁水源从远处的山泉和河流输送到城市。罗马引水渠的设计坡度极为精确——通常在每公里1至3米之间——完全依靠重力输水，不需要任何泵送装置。在分水点设置了"分水城堡"（Castellum Divisorium），通过不同高度的出水口将来水按比例分配给公共浴场、喷泉和私人用户。塞克斯图斯·尤利乌斯·弗朗提努斯（Sextus Julius Frontinus）在其公元97年所著的《罗马城供水》（*De Aquaeductu Urbis Romae*）中，详细记录了罗马供水系统的管理制度，包括水量计量方法、用水权分配规则、渠道巡查与维修制度等，是现存最早的供水系统运行管理专著。

弗朗提努斯的记述中包含了若干值得从控制论角度深入分析的内容。他描述了一种基于"量水管"（Calix）的流量计量方法——不同直径的铅管对应不同的标准流量，用户的用水权以其接入管道的口径来定量化。这可以被视为最早的"定量化水量分配"制度——在没有流量计的时代，通过物理结构（管径）来近似控制流量。弗朗提努斯还记录了供水系统中普遍存在的"偷水"问题（非法接管或扩大管径），并描述了相应的巡查和惩罚机制。从系统安全的角度来看，"偷水"本质上是一种"非授权扰动"——它改变了系统的实际运行状态，使之偏离设计的分配方案。弗朗提努斯对这一问题的关注和应对措施，反映了古人对水系统运行"扰动—响应"问题的朴素认识。

波斯地区的坎儿井（Qanat）系统是另一种独特的古代水利工程形式。坎儿井利用地形坡度，通过地下暗渠将高处的地下水引至低处的绿洲或农田，全程依靠重力输水，不需要任何动力装置。坎儿井系统的独特之处在于其"去中心化"的运行管理模式——每一段暗渠由相邻村落共同维护，水量分配遵循世代相传的习惯法则，不需要统一的中央调度机构。这种自组织的运行模式，与现代分布式控制和多智能体系统（MAS）中"自主协商"的理念有着有趣的相似之处。

### 2.1.2 古代运行智慧的控制论解读

综合以上对各古代文明水利工程运行实践的回顾，可以提炼出一些跨越时空的共性智慧。虽然古代工程师并不拥有现代控制论的概念工具，但他们通过长期实践形成的运行策略，在结构上与现代控制论的基本范式存在深刻的对应关系。

| 古代实践 | 控制论对应概念 | 典型案例 |
|:--------|:------------|:--------|
| 水位观测与记录 | 状态感知（Sensing） | 尼罗河水位计、水尺 |
| 基于经验的调度规则 | 控制律（Control Law） | 大运河"南七北三"分水规则 |
| 闸门/堰坝的启闭操作 | 执行器动作（Actuation） | 灵渠陡门、罗马分水城堡 |
| 工程结构的自动调节 | 被动自适应控制 | 都江堰鱼嘴分水 |
| 溢洪道/安全阀 | 安全包络（Safety Envelope） | 飞沙堰溢流排沙 |
| 固定断面限流 | 硬约束（Hard Constraint） | 宝瓶口流量限制 |
| 上游水情的提前观测 | 前馈控制（Feedforward Control） | 尼罗河沿线接力观测 |
| 分层管理体制 | 分层分布式控制（HDC） | 大运河多级管理机构 |
| 社区协商分水 | 多智能体协商（MAS Negotiation） | 坎儿井社区自治管理 |

这一对照揭示了一个重要的认识：现代水系统控制论中的核心概念，并非凭空创造的抽象构想，而是对人类数千年运行实践智慧的理论升华。古代工程师用石头、泥土和经验实现的功能，现代工程师用传感器、控制器和算法来实现——工具变了，但底层的控制逻辑是一脉相承的。

然而，古代运行智慧也存在本质的局限性。第一，依赖经验而非理论，无法进行定量分析和优化设计。第二，依赖被动调节而非主动控制，对极端工况的应对能力有限。第三，依赖人工操作和口耳相传的知识传承方式，难以系统化和普适化。要突破这些局限，必须等待近代自然科学——特别是流体力学和水文学——理论体系的建立。

从知识工程的视角来看，古代运行智慧的传承模式存在三个结构性瓶颈：一是"属人性"——关键知识依赖特定个人的经验积累，人员流失即导致知识断裂，大运河闸官的技艺代际传承中断便是典型案例；二是"属地性"——经验高度绑定于特定工程的物理条件，都江堰的运行智慧无法直接移植到其他水系统；三是"非量化性"——"多放些水""少开几分闸"等模糊指令缺乏精确性，难以支撑大规模系统的协调运行。这三个瓶颈恰好对应了现代水系统控制技术致力于解决的三大核心问题：知识的显式化与模型化、控制策略的可迁移性、以及决策的精确量化。

### 2.1.3 近代水力学理论的奠基

进入近代以后，随着水利工程规模的不断扩大和功能的日益复杂，纯粹基于经验的运行管理模式日益捉襟见肘。19世纪中叶至20世纪初，一系列奠基性的水力学和水文学理论的建立，为水系统运行管理的科学化奠定了坚实的理论基础。

#### （1）圣维南方程（Saint-Venant equations，描述明渠水流运动的基本方程，由连续性方程和动量方程组成）：明渠非恒定流的数学描述

1871年，法国工程师阿德马尔·让-克洛德·巴雷·德·圣维南（Adhémar Jean Claude Barré de Saint-Venant）发表了描述一维非恒定明渠流的偏微分方程组，即著名的圣维南方程组（Saint-Venant Equations）[52]。该方程组由连续性方程和动量方程组成：

$$\frac{\partial A}{\partial t} + \frac{\partial Q}{\partial x} = q_l$$

$$\frac{\partial Q}{\partial t} + \frac{\partial}{\partial x}\left(\frac{Q^2}{A}\right) + gA\frac{\partial h}{\partial x} = gA(S_0 - S_f) + q_l v_l$$

其中，$A$ 为过水断面面积，$Q$ 为流量，$q_l$ 为侧向入流，$h$ 为水深，$S_0$ 为底坡，$S_f$ 为摩阻坡降，$g$ 为重力加速度，$v_l$ 为侧向入流速度分量。

圣维南方程组的提出具有里程碑意义。它第一次将明渠中水流运动的物理规律用严格的数学语言表达出来，使得工程师能够在原则上"预测"渠道中水流随时间和空间的变化过程。然而，圣维南方程是一组非线性双曲型偏微分方程，除极少数特殊情况外没有解析解。这意味着在相当长的时期内，圣维南方程的工程应用受到数值求解能力的严重制约——理论已经走在了前面，但计算工具尚未跟上。这一矛盾的解决，要等到20世纪中叶计算机的出现。

值得注意的是，在计算机出现之前，工程师发展了一系列简化方法来应对圣维南方程的求解困难。运动波近似（Kinematic Wave Approximation）忽略了动量方程中的惯性项和压力梯度项，将偏微分方程简化为一阶双曲型方程；扩散波近似（Diffusion Wave Approximation）保留了压力梯度项但忽略惯性项，增加了对回水效应的描述能力。这些简化模型虽然牺牲了精度，但在特定条件下（如长渠道缓变流）能够提供工程可接受的近似解。这种"在精度与可解性之间寻求平衡"的方法论思想，至今仍然是水系统建模的核心策略——CHS框架中"可控模型族"的概念，正是这一思想在现代语境下的系统化发展。

#### （2）曼宁公式与谢才公式：工程实用的阻力定律

在圣维南方程建立之前和之后，工程师们发展了一系列描述明渠均匀流的经验和半经验公式。1769年，法国工程师安托万·德·谢才（Antoine de Chézy）提出了明渠均匀流的流速公式，建立了流速与水力坡降和水力半径之间的定量关系。1889年，爱尔兰工程师罗伯特·曼宁（Robert Manning）在谢才公式的基础上提出了更为实用的曼宁公式 [53]：

$$V = \frac{1}{n} R^{2/3} S^{1/2}$$

其中，$V$ 为断面平均流速，$n$ 为曼宁糙率系数，$R$ 为水力半径，$S$ 为水力坡降。曼宁公式因其形式简洁、参数物理意义明确而成为水力学中应用最广泛的工程公式之一。在圣维南方程的数值求解中，曼宁公式通常被用来计算摩阻坡降 $S_f$，从而建立了基础理论方程与工程实用参数之间的桥梁。

然而，曼宁糙率系数$n$的确定本身就是一个长期困扰水利工程师的难题。糙率系数受渠道材料、壁面状态、水生植物生长、泥沙淤积等多种因素影响，且随季节和运行工况动态变化——同一段渠道，夏季水草茂盛时的糙率可能比冬季高出30%以上。传统方法依赖查表和经验估算，主观性强、精度有限。这一参数不确定性问题，直接影响到基于模型的控制策略的可靠性：如果模型参数不准确，控制器的决策就可能产生偏差。因此，糙率系数的在线辨识和动态校正，成为水系统控制领域持续关注的核心技术问题之一。CHS框架将此纳入"自主演进"原则，通过扩展卡尔曼滤波（EKF）等方法实现参数的实时在线更新。

#### （3）水文学基础理论：从单位线到系统方法

在水文学领域，20世纪上半叶建立了一系列重要的理论方法，为水系统运行中的来水预测提供了科学工具。

1932年，美国水文学家勒罗伊·谢尔曼（LeRoy K. Sherman）提出了单位线（Unit Hydrograph）概念，将流域视为一个线性系统，建立了有效降雨与直接径流之间的输入—输出关系。单位线理论是水文学中"系统方法"的开端——它第一次将流域的降雨—径流过程抽象为一个"黑箱"系统，用脉冲响应函数来描述其输入—输出特性，这与控制论中系统辨识的思想高度一致。

1945年，美国陆军工程兵团的麦卡锡（G. T. McCarthy）提出了马斯京根法（Muskingum Method），用线性水库模型来模拟河道的洪水演进过程。1960年，爱尔兰水文学家约翰·纳什（J. E. Nash）进一步提出了纳什瞬时单位线模型 [54]，将流域概化为一系列等容量线性水库的串联，建立了一个参数简洁而物理意义明确的概念性水文模型。

这些水文学方法的共同特点是将复杂的自然过程"系统化"——用输入—输出关系来描述水文过程，用模型参数来表征流域特性。这种系统化的思维方式，为后来控制论方法引入水利领域奠定了认识论基础。正是因为水文学家已经习惯于将流域视为一个"系统"来研究，水利工程师才能够自然地将流域—工程—用户作为一个更大的"系统"来进行整体控制和优化。

值得特别指出的是，水文系统方法与控制系统理论之间存在深刻的数学同构性。单位线理论中的"卷积"运算与线性系统理论中的"脉冲响应"概念完全等价；马斯京根法中的线性水库模型在传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）形式上与控制系统中的一阶惯性环节相同；纳什级联模型在拉普拉斯域中的传递函数为$G(s) = \frac{1}{(1+Ks)^n}$，恰好是$n$个一阶环节的串联——这与控制工程中多级RC滤波器的传递函数完全一致。这种数学同构性不是巧合，而是反映了水文过程和控制过程在物理本质上的共通性：两者都涉及信号（水流/控制信号）在具有延迟和衰减特性的系统中的传播和变换。

20世纪50年代以后，计算机技术的出现从根本上改变了水力学和水文学的面貌。**计算水力学（Computational Hydraulics）**作为一门新兴学科应运而生，其核心任务是开发求解圣维南方程等水力学方程的数值方法和计算机程序。1969年，美国学者**怀利（E. Benjamin Wylie）**和**斯特里特（Victor L. Streeter）**出版了具有里程碑意义的著作《明渠水力学中的水力学瞬变》，系统介绍了特征线法等圣维南方程的数值解法。同一时期，有限差分法、有限元法和有限体积法等通用数值方法也被引入水力学领域。计算机和数值方法的结合，使得工程师第一次能够定量地"预测"复杂渠道系统和管网中的水流动态行为——这为后续的基于模型的优化控制奠定了计算基础。

在水文预报领域，**萨克拉门托模型（Sacramento Soil Moisture Accounting Model）**（1973年）、**新安江模型**（赵人俊等，1984年）等概念性水文模型的开发，使得水文预报从经验方法转向了基于物理机理的模型方法。萨克拉门托模型采用两层土壤水储存结构，包含上下层自由水和张力水共六个水库，通过产流和汇流两大过程模拟流域降雨—径流响应。新安江模型则基于蓄满产流理论，更适合湿润半湿润地区的水文条件，其三层蒸散发结构精巧地反映了中国南方地区的植被和土壤特征。两个模型代表了不同水文气候条件下的建模范式——前者以蓄满超渗双机制见长，后者以蓄满产流为核心——体现了"因地制宜"的水文建模哲学。这些预报模型的出现意味着水系统运行的关键输入——来水量——可以被提前预测，这为前馈控制策略的实施提供了信息基础。

没有可靠的水文预报，任何预测性控制（如MPC）都无从谈起。因此，水文预报能力的进步，是水系统控制水平提升的先决条件。

### 2.1.4 从经验实践到科学理论的跨越

纵观人类水系统运行实践从古代到近代的演进，可以清晰地看到一条从经验到理论、从被动到主动、从定性到定量的发展主线。

古代水利工程的运行智慧——无论是都江堰的被动自适应调节，还是大运河的分层管理体制——都是在"知其然而不知其所以然"的状态下，通过数百年甚至数千年的试错积累形成的。这些智慧的传承高度依赖特定的工程实体和人文传统，难以脱离具体场景进行抽象化和普适化推广。

近代水力学和水文学理论的建立，实现了从"经验"到"科学"的第一次跨越。圣维南方程使得明渠水流运动有了精确的数学描述，曼宁公式提供了工程实用的阻力计算方法，单位线理论将水文过程纳入了系统分析的框架。这些理论工具使得工程师能够从定性的经验判断转向定量的科学分析，从"大约多少"走向"精确计算"。

然而，近代理论仍然存在一个根本性的缺陷：它们主要关注的是"描述"和"预测"——描述水流运动的规律，预测洪水演进的过程——而非"控制"和"优化"。换言之，这些理论能告诉工程师"水会怎样流"，却不能告诉工程师"应该怎样调"。从描述性科学到规范性科学（从"is"到"ought"）的第二次跨越，需要等待控制论、系统工程和计算机科学的共同推动。

这种从"描述"到"控制"的范式转换，可以用一个类比来说明。牛顿力学可以精确地计算一颗炮弹的飞行轨迹（描述），但仅凭牛顿力学无法设计一枚自动追踪目标的导弹（控制）——后者需要控制论的反馈思想和实时计算能力。同样，圣维南方程可以精确地计算渠道中水流的传播过程（描述），但仅凭圣维南方程无法设计一个自动维持目标水位的闸门控制系统（控制）——后者需要优化理论的目标函数框架、模型预测控制的滚动优化策略以及实时计算平台的支撑。

值得注意的是，这一"从描述到控制"的范式转换在不同的工程领域发生的时间差异很大。电力系统在20世纪40年代就开始引入自动频率控制（AGC）和自动电压调节（AVR），1950年代建立了以经济调度为核心的能量管理系统（EMS）雏形，至1970年代已实现大规模互联电网的分层分布式自动控制。化工过程控制在20世纪50年代随着模拟计算机的出现而迅速发展，1960年代引入直接数字控制（DDC），1970年代集散控制系统（DCS）成为标准配置，至1990年代先进过程控制（APC）和实时优化（RTO）已广泛应用于炼油、石化等行业。

相比之下，水利领域的自动控制研究直到20世纪60年代才萌芽，1980年代Buyalski等人在美国垦务局开展的渠道自动控制实验属于先驱性质的探索，大规模工程应用更是要等到21世纪初。水利行业的自动化进程比电力行业晚了约半个世纪，比化工行业晚了约三十年。

造成这种时间差的原因是多方面的：水系统的时间常数长（渠道水流传播动辄数小时乃至数日，意味着手动控制在多数情况下"还能应付"），水文过程的不确定性大（降雨、蒸发、渗漏等随机因素增加了自动控制的难度），水利基础设施的地理分散性（远程通信和数据采集的成本高于集中式工厂），以及水利行业传统上更偏重"建设"而非"运行"的文化惯性（工程设计和施工获得的关注和资源远多于运行管理）。理解这一历史差距，有助于认识当前水利领域自动化和智能化建设所面临的深层次挑战——不仅是技术层面的，还有认知层面和组织层面的。

这正是下一节将要讲述的从计算水力学到水信息学、再到水系统运行科学与工程的学科演进历程。

---

**思考与讨论**

1. （概念理解）都江堰的"深淘滩、低作堰"蕴含了什么控制论思想？请用现代术语重新表述。
2. （批判思考）有人认为古代水利工程中的运行智慧对现代智能水网没有参考价值，你如何反驳？


---


---

### §2.1 本节小结


本节回溯了从都江堰到20世纪初水利运行实践的千年传承。核心发现：古代水利工程中已隐含"感知—决策—执行—反馈"的控制论雏形——都江堰的"观石鱼量水位"是原始传感，"深淘滩、低作堰"是经验规则库，"岁修"是闭环维护机制。罗马引水渠的分水城堡（Castellum Divisorium）则是最早的流量分配控制器。这些实践智慧为现代CHS理论提供了历史渊源和工程直觉。

## 2.2 学科奠基：三大技术方向的汇流

20世纪下半叶，随着计算机技术的飞速发展和控制理论的日益成熟，水系统运行研究开始从分散的实践经验走向系统的科学研究。在这一过程中，三大技术方向——计算水力学与水文学、水资源系统工程和水信息学——各自独立发展，又相互交叉渗透，共同为水系统运行科学与工程的形成奠定了学科基础。理解这三大方向的发展历程、各自贡献和内在局限，是把握水系统运行学科演进逻辑的关键。

### 2.2.1 计算水力学与水文学：物理过程的数值模拟

#### （1）从解析近似到数值求解

如前一节所述，圣维南方程（Saint-Venant equations，描述明渠水流运动的基本方程，由连续性方程和动量方程组成）组自1871年提出以来，长期因缺乏有效的求解手段而难以在工程中广泛应用。20世纪中叶电子计算机的出现，彻底改变了这一局面。

1950年代至1960年代，数值方法的发展为圣维南方程的工程化应用打开了大门。1933年，库朗、弗里德里希斯和列维（Courant, Friedrichs, and Lewy）提出了著名的CFL条件，为双曲型偏微分方程的数值稳定性分析奠定了基础。在此基础上，特征线法（Method of Characteristics, MOC）最早被应用于明渠非恒定流的数值求解。MOC将偏微分方程沿特征方向转化为常微分方程，具有物理意义直观、边界条件处理自然的优点。1969年，怀利和斯特里特（Wylie and Streeter）在其经典著作《流体暂态》（*Fluid Transients*）中系统总结了特征线法在管道和明渠瞬变流分析中的应用 [51]，该书成为水力瞬变计算领域的奠基之作。

然而，特征线法在处理复杂渠道几何形状和分汇流结构时存在局限。1961年，法国水力学家普雷斯曼（Alexandre Preissmann）提出了一种隐式有限差分格式——普雷斯曼四点加权格式（Preissmann Box Scheme），这一格式具有无条件稳定的优良特性，可以采用远大于CFL条件限制的时间步长进行计算，极大地提高了长距离渠道和河道水流模拟的计算效率。普雷斯曼格式后来成为绝大多数商业水力学软件的核心数值引擎。

1970年代至1980年代，一批重要的水力学数值模拟软件相继诞生，标志着计算水力学从学术研究走向工程应用：丹麦水力研究所（DHI）开发的MIKE系列软件（包括MIKE 11用于一维河道和渠道模拟，MIKE 21用于二维浅水模拟），美国陆军工程师兵团水文工程中心（HEC）开发的HEC-RAS（River Analysis System），以及法国电力公司开发的TELEMAC系统。这些软件至今仍是水力学数值模拟的行业标准工具。

#### （2）从正向模拟到实时预报

计算水力学发展的第二个重要阶段，是从离线正向模拟（给定初始条件和边界条件，计算水流过程）向实时预报方向的扩展。这一转变发生在1980年代至1990年代，主要驱动力来自防洪和水资源管理对实时预报能力的迫切需求。

实时预报的核心挑战在于模型初始化和不确定性处理。离线模拟只需要一组确定的边界条件即可运行，但实时预报需要不断地将最新的观测数据融入模型，修正模型状态，减小预报误差。这一需求催生了数据同化（Data Assimilation）技术在水力学模型中的应用。卡尔曼滤波（Kalman Filter）及其扩展形式（如集合卡尔曼滤波，Ensemble Kalman Filter, EnKF）被引入水力学模型的状态估计，使得模型能够在运行过程中持续地自我校正。

从控制论的视角来看，实时预报本质上就是一个状态估计（State Estimation）问题——根据有限的、含噪声的观测数据，估计系统当前的完整状态。这一认识将计算水力学与控制理论联系了起来：水力学模型提供了系统动力学的描述（状态方程），传感器网络提供了观测数据（观测方程），卡尔曼滤波等方法则提供了将二者融合的最优估计框架。

从"离线模拟"到"在线预报"的演进，还催生了"模型—数据融合"（Model-Data Fusion）这一更广泛的研究范式。传统上，物理模型和数据驱动方法被视为两种对立的建模路径；数据同化框架表明，两者完全可以在贝叶斯（Bayesian，一种基于先验知识和观测数据进行概率推断的统计方法）统计的理论框架下实现有机融合——物理模型提供"先验知识"，观测数据提供"似然信息"，融合后的"后验估计"既尊重物理规律又利用了最新观测。这一"模型与数据互补而非互斥"的思想，后来发展为CHS中"物理AI与认知AI融合"理念的重要理论渊源。

#### （3）计算水力学的贡献与局限

计算水力学为水系统运行提供了"算得准"的能力——能够精确地模拟和预测水系统中的水流运动过程。这种能力是水系统控制的基础前提，因为控制的前提是对被控对象行为的准确预测。

然而，计算水力学本身并不直接解决"怎么控制"的问题——它告诉我们"如果这样操作，水流会怎样变化"，但不告诉我们"应该怎样操作才能达到目标"。从"模拟"到"控制"的跨越，需要控制理论的介入。换言之，计算水力学提供了被控对象的数学模型，但还需要控制理论来设计作用于这个模型的控制器。

此外，传统计算水力学模型的计算量通常较大，难以满足实时控制对计算速度的苛刻要求。一个典型的长距离调水渠道模型可能包含数千个计算节点，每个时间步需要求解一个大规模的稀疏线性方程组。在模型预测控制（MPC）等需要反复求解模型的场景下，这种计算负担会进一步加重。MPC在每个控制时刻需要在预测时域内多次求解模型来寻找最优控制序列，如果每次模型求解都需要数分钟，那么实时优化就根本不可行。

这一矛盾催生了后续降阶建模（Reduced-Order Modeling）技术的发展——通过将高维的圣维南方程模型降阶为低维的状态空间（state space，用一组状态变量——如各断面水位和流量——来完整描述系统在任意时刻行为的数学框架）模型或传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）模型，在保持足够精度的同时大幅降低计算量，使实时控制成为可能。降阶建模的发展形成了CHS框架中"五级模型层次"的技术基础：从最完整的线性化圣维南（LSV）模型，到积分延迟零阶保持（IDZ）传递函数模型，到纯积分延迟（ID）模型，到纯积分（I）模型，再到稳态（SS）模型——每一级降阶都牺牲了一些物理细节以换取计算效率的大幅提升。

控制器设计者可以根据具体场景的精度要求和实时性要求，选择最合适的模型层次。这种"分层建模"的思想，是计算水力学与控制科学融合的关键创新点之一。

### 2.2.2 水资源系统工程：优化调度的数学框架

#### （1）系统工程思想的引入

与计算水力学侧重于物理过程模拟不同，水资源系统工程（Water Resources Systems Engineering）侧重于运用系统工程和运筹学的方法来优化水资源的开发、利用和管理。这一方向的兴起与20世纪50至60年代系统分析（Systems Analysis）思想向各行业领域渗透的大潮密切相关。其直接驱动力来自工程实践中的迫切需求：二战后美国大规模兴建多目标水利工程（如田纳西河流域管理局TVA的梯级水库群、密苏里河流域的"匹克—斯隆计划"），单一水库的经验调度规则面对多水库耦合系统时捉襟见肘，迫切需要能够在全局范围内权衡防洪、发电、灌溉、航运等竞争目标的数学优化工具。与此同时，线性规划（Dantzig, 1947）、动态规划（Bellman, 1957）等运筹学方法的成熟，以及大型计算机的快速普及，为水资源系统优化提供了理论武器和计算平台。

1962年，哈佛水利学组（Harvard Water Program）出版了里程碑式的著作《水资源系统设计》（*Design of Water-Resource Systems*），由梅斯（Arthur Maass）等多位学者共同撰写。该书首次系统地将系统分析方法——包括线性规划、动态规划、模拟和多目标分析——引入水资源规划领域，开创了水资源系统工程的先河。哈佛水利学组的工作确立了一个重要的研究范式：将水资源问题视为一个多目标、多约束的优化问题来求解。

#### （2）关键学者与经典文献

美国康奈尔大学的丹尼尔·卢克斯（Daniel P. Loucks）是水资源系统规划与管理领域的权威学者。1981年，他与Stedinger和Haith合著出版了《水资源系统规划与分析》（*Water Resource Systems Planning and Analysis*）[55]，系统介绍了线性规划、动态规划、随机规划等优化方法在水资源系统中的应用，成为该领域数十年来最具影响力的教材。2017年，他与van Beek合著出版了该书的更新版《水资源系统规划与管理》[56]，进一步纳入了气候变化适应、生态系统服务价值评估等新内容。

在水库调度优化领域，加州大学洛杉矶分校的叶维廉（William W.-G. Yeh）于1985年发表的综述论文 [21]，全面回顾了线性规划、动态规划、非线性规划、模拟等方法在水库管理和运行中的应用，成为该领域被引次数最高的文献之一。科罗拉多州立大学的约翰·拉巴迪（John W. Labadie）于2004年发表的综述论文《多水库系统的最优运行：最新进展综述》[57]，对多水库系统的优化调度方法进行了全面更新，涵盖了隐式随机优化、显式随机优化、参数化规则优化等前沿方法。德克萨斯A&M大学的拉尔夫·沃布斯（Ralph A. Wurbs）于1993年发表了关于水库系统模拟和优化模型的综述 [58]，并开发了广泛应用的WRAP水资源管理模型 [59]。

在中国，中国水利水电科学研究院的王浩院士是水资源系统工程领域的领军人物。王浩团队发展了"自然—人工"二元水循环理论，将自然水循环过程与人类活动对水循环的影响纳入统一的分析框架，为水资源优化配置提供了新的理论基础。这一理论框架对后来水系统控制论中"将自然过程与人工控制作为统一系统来研究"的思想产生了重要影响。

中国的水资源系统工程研究还有几条重要的发展脉络。在水库群联合调度方面，清华大学等机构的研究团队发展了大规模水库群多目标联合优化调度方法，需要处理高维、非线性、非凸的优化问题——动态规划方法遇到了"维数灾难"（Curse of Dimensionality），催生了逐步优化算法（POA）、分解协调方法和智能优化算法（如遗传算法（genetic algorithm，模拟生物进化过程的优化方法，通过选择-交叉-变异操作搜索最优解，常用于水库调度优化）、粒子群（particle swarm optimization，受鸟群觅食行为启发的群体智能优化算法）优化、差分进化等）的应用。在水资源-能源-粮食纽带（Water-Energy-Food Nexus）方面，多个研究团队开展了跨部门资源配置的系统分析，将水系统运行嵌入更广泛的社会经济系统中进行综合优化。

这些研究拓展了水资源系统工程的边界，但也进一步凸显了"在线实时控制"能力的缺失——优化方案再好，如果不能在实际运行中精确实施，其效果也会大打折扣。

#### （3）水资源系统工程的贡献与局限

水资源系统工程为水系统运行提供了"调度优化"的数学框架和方法工具。其核心贡献在于将水资源管理问题形式化为可求解的数学优化问题，使得工程师能够系统地比较不同方案的优劣，并在理论上找到最优解。

然而，传统水资源系统工程的主要局限在于其"离线"特性。经典的水库优化调度方法通常假设完美的水文预报信息，在时间序列或场景集合上进行全局优化，得到一组调度规则或调度方案。但在实际运行中，水文预报存在误差，运行工况不断变化，预先计算的最优方案可能并非当前时刻的最优选择。从"离线优化"到"在线实时控制"的跨越，需要控制理论——特别是模型预测控制（MPC）等滚动优化方法——的介入。

另一个根本性挑战是所谓的"维数灾难"（Curse of Dimensionality）。对于包含$N$座水库的系统，如果每座水库的蓄水量被离散为$M$个状态，则动态规划的状态空间规模为$M^N$——当$N$超过3至4时，计算量便超出实际可承受范围。尽管研究者发展了随机动态规划（SDP）、随机对偶动态规划（SDDP）、逐次逼近动态规划（DPSA）和强化学习等方法来缓解维数灾难，但多水库系统的全局最优解在计算上仍是极具挑战性的问题。CHS框架通过引入分层分布式架构——将大系统分解为若干子系统分别优化，再通过协调层求解耦合约束——为这一问题提供了一种兼顾全局性和计算可行性的系统化解决思路。

此外，水资源系统工程的研究对象通常是较大时空尺度上的水量分配问题（如月、旬尺度的水库调度），而对较小时空尺度上的水流动力学过程（如分钟、小时尺度的渠道水位和流量变化）关注不够。这一"尺度缺口"恰好是计算水力学所擅长的领域，也是两个方向走向融合的天然接口。

### 2.2.3 水信息学：信息技术的系统集成

#### （1）Abbott与水信息学的创立

水信息学（Hydroinformatics）由丹麦国际水利与环境工程学院（IHE Delft）的迈克尔·阿博特（Michael B. Abbott）于1991年正式提出 [60]。Abbott在其著作《水信息学：信息技术与水环境》（*Hydroinformatics: Information Technology and the Aquatic Environment*）中，将水信息学定义为一个将信息与通信技术（ICT）应用于水资源管理和水环境工程的交叉学科。

Abbott提出水信息学的背景，是他敏锐地观察到信息技术革命正在深刻改变工程实践的面貌。他认为，传统的水力学和水文学虽然建立了描述水系统物理过程的理论基础，但面对日益复杂的水问题，仅靠物理模型是不够的——还需要数据管理、信息融合、人机交互、决策支持等信息技术的系统集成。Abbott的远见在于，他不仅看到了信息技术作为"工具"的价值，更看到了信息技术可能带来的"范式变革"——从基于模型的分析范式走向基于数据与模型融合的智能决策范式。

Abbott的理论主张在工程实践中得到了充分体现。他参与创立的丹麦水力研究所（DHI）开发的MIKE系列软件（MIKE 11河道模拟、MIKE 21二维水动力、MIKE URBAN城市排水等），成为全球水利行业应用最广泛的商业软件平台之一。MIKE系列软件的成功，在很大程度上得益于其将水力学模型与GIS数据管理、实时数据接口和可视化工具进行了系统集成——这正是水信息学"集成"理念的典型产品化案例。然而，也正是这种以"集成"为核心的技术路径，使得水信息学在理论深度上难以与自成体系的控制科学和系统科学相比肩。

#### （2）水信息学的主要分支与代表学者

水信息学自创立以来，形成了多个分支方向。联合国教科文组织-国际水教育学院（UNESCO-IHE）的罗兰·普赖斯（Roland K. Price）在城市水信息学领域做出了重要贡献，他与Vojinović合著的《城市水信息学》（*Urban Hydroinformatics*，2011年）[61]成为该分支方向的经典教材，系统介绍了城市排水、供水和洪涝管理中信息技术的集成应用。

英国埃克塞特大学的德拉甘·萨维奇（Dragan Savić）是水信息学在供水管网领域应用的领军人物。他在进化算法优化管网设计、智能漏损检测、管网资产管理等方面做出了开创性工作。萨维奇的研究表明，将数据驱动方法（如遗传算法、人工神经网络）与物理模型相结合，可以显著提高供水管网运行管理的智能化水平。

荷兰代尔夫特理工大学的迪米特里·索拉马蒂纳（Dimitri Solomatine）在水信息学的机器学习方法方面做出了重要贡献。他系统地研究了人工神经网络、模型树、集成学习等方法在水文预报和水力学模拟中的应用，提出了"数据驱动建模"（Data-Driven Modelling）作为传统物理建模的补充和替代。

2014年，《水信息学杂志》（*Journal of Hydroinformatics*）创刊，标志着水信息学作为一个独立学科方向的正式确立。该期刊由国际水协会（IWA）出版，为水信息学领域的研究成果提供了专门的发表平台。

#### （3）水信息学的贡献与局限

水信息学的核心贡献在于为水利领域引入了信息技术的系统集成视角。它强调数据管理、模型集成、人机交互和决策支持的一体化，推动了水利行业信息化水平的整体提升。

然而，水信息学也有其内在局限。第一，水信息学本质上是一个"集成"学科，它将已有的技术和方法组合在一起，但并未提供新的控制理论或算法框架。正如Abbott本人坦承的，水信息学更像是一个"聚合器"（Aggregator）而非"原创者"（Originator）——它的力量来自组合，而非来自理论突破。第二，水信息学的研究重心偏向数据管理和信息处理，对系统层面的控制和优化问题关注不足。在水信息学的文献中，"预测"远多于"控制"，"模拟"远多于"优化"——这反映了该学科仍停留在"描述"而非"规范"的范式层面。第三，水信息学在方法论上偏重数据驱动方法，对物理机理的利用不够充分，在安全性和可解释性要求较高的场景中存在局限。

当一个基于神经网络的水位预测模型给出异常结果时，水信息学缺乏系统化的机制来判断"是否应该信任这个预测"——而这恰恰是CHS通过"安全包络"和"可控模型族"机制致力于解决的核心问题。

### 2.2.4 三大方向的局限与融合需求

回顾计算水力学、水资源系统工程和水信息学三大方向的发展，可以发现它们各自解决了水系统运行中的一部分问题，但没有任何一个方向能够独立地提供水系统运行所需的完整理论和方法框架：

| 方向 | 核心能力 | 局限 |
|:-----|:---------|:-----|
| 计算水力学 | "算得准"——精确模拟水流过程 | 不解决"怎么控制"的问题 |
| 水资源系统工程 | "调得优"——全局优化调度方案 | 离线优化，难以应对实时变化 |
| 水信息学 | "集成好"——数据与模型的融合 | 缺乏控制理论核心，偏重工具集成 |

三大方向的融合需求早已显现。在实际工程中，一个完整的水系统运行决策过程需要：用水力学模型预测水流动态（计算水力学的贡献），用优化方法寻找最优调度策略（水资源系统工程的贡献），用信息技术实现数据采集、传输、融合和人机交互（水信息学的贡献），并用控制理论将三者整合为闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）的实时控制系统。然而，长期以来，这三个方向之间缺乏一个统一的理论框架来实现有机融合。这一"理论缺口"，正是水系统控制论（CHS）力图填补的核心空间。

## 2.3 范式升级：从"水利管理"到"水系统运行科学与工程"

### 2.3.1 传统"水利管理"范式的特征与困境

长期以来，水利工程建成后的运行工作被归入"水利管理"（Water Resources Management）的范畴。在这一传统范式下，"运行"被视为"管理"的一部分——与人事管理、财务管理、资产管理并列。运行调度的理论基础来自管理科学和运筹学，研究方法以经验总结、统计分析和优化建模为主，评价标准侧重管理效率（如响应时间、人员利用率、经费使用效率等）。

这一范式在水利工程规模有限、运行工况相对简单的历史条件下是基本适用的。然而，随着水利基础设施的规模化、网络化和多功能化，传统"水利管理"范式日益暴露出其内在的局限性。

第一，理论深度不足。"管理"视角下的运行研究，主要关注制度设计、流程优化和资源配置等组织层面的问题，对运行过程的物理机理和动力学特性缺乏深入的理论分析。当水系统规模增大、耦合关系变得复杂时，单纯的管理优化无法解决系统层面的稳定性、鲁棒（robust，指系统在参数变化或外部干扰下仍能保持稳定性能的能力，类似于水利工程中的'抗干扰性'）性和安全性问题。

第二，实时性缺失。传统水利管理的决策周期通常较长（日、旬、月），而现代水系统的运行控制需要在分钟甚至秒级的时间尺度上做出实时决策。管理范式下的决策流程——层层上报、集体研判、逐级下达——难以满足实时控制的时效性要求。

第三，学科定位模糊。当"运行"被归入"管理"时，它在学科体系中的地位自然低于"设计"和"施工"——因为"管理"往往被视为支撑性的、辅助性的工作，而非需要深厚理论支撑和持续技术创新的核心学科方向。这种定位上的模糊，直接导致了水利行业长期存在的"重建轻管（emphasis on construction over operation, a structural problem in China's water sector where investment heavily favors new infrastructure over operational management）"问题——大量投资用于工程建设，但建成后的运行管理投入不足、技术水平不高。

### 2.3.2 范式转换的四个维度

从传统"水利管理"到"水系统运行科学与工程"的范式升级，可以从以下四个维度来理解。这种范式转换并非水利领域独有——事实上，几乎所有基础设施行业在信息化和智能化进程中都经历了类似的转换。电力行业从"电力管理"转向"电力系统自动化"，交通行业从"交通管理"转向"智能交通系统"，化工行业从"生产管理"转向"过程控制与优化"——这些转换的共同特征是：将运行控制从"管理问题"重新定位为"工程科学问题"，引入控制理论和信息技术作为核心方法论。水利行业的这一转换之所以滞后于上述行业，部分原因在于水利系统的时间常数较长（日/周级别），长期以来人工调度"还能应付"，缺乏紧迫的自动化需求。但随着水网规模的急剧扩大和对精细化管理要求的提高，这一转换已经势在必行。

第一，研究对象的转变。从"人与制度"转向"物理系统与信息系统"。传统水利管理的研究对象主要是管理制度、组织架构、人员行为等社会组织层面的要素。水系统运行科学与工程的研究对象则是水系统本身——其物理过程、动力学特性、可控性和可观性，以及与之耦合的信息系统（传感器网络、通信网络、计算平台）。

第二，核心工具的转变。从管理学的分析框架转向控制科学的分析框架。研究的基本工具不再是组织行为学和项目管理方法，而是状态空间模型、传递函数、最优控制、模型预测控制、多智能体系统、安全包络分析等控制科学的核心概念和方法。

第三，方法论的转变。从定性的经验判断和制度设计，转向定量的数学建模、仿真分析和优化求解。研究的主要方法不再是调研访谈和案例分析，而是建立数学模型、设计控制算法、进行仿真验证和实验测试，形成"建模—设计—仿真—验证"的工程闭环。

第四，评价标准的转变。从管理效率转向控制性能。核心评价指标不再是响应时间和人员利用率，而是水位偏差、流量跟踪精度、系统稳定性、鲁棒性、安全越界次数、人工接管频率、恢复时间等定量的控制性能指标。

### 2.3.3 "重建轻管"问题的深层剖析

这一范式转换的必要性，可以从水利行业长期存在的"重建轻管"（重视工程建设、轻视运行管理）问题中得到进一步印证。

"重建轻管"的表面原因是资金投入不均衡——中国水利工程的维修养护经费到位率长期偏低，许多中小型水利设施因缺乏运行维护而带病运行。据统计，中国现有大中型水库约4700余座（据水利部《2023年全国水利发展统计公报》），但相当比例的水库闸门自动化率不足30%，仍依赖人工操作；南水北调等大型跨流域工程的年运行维护费用占工程总投资的比例，也低于国际通行的2%至3%的建议标准。但其深层原因则涉及学科体系的结构性缺陷。在传统水利学科体系中，"设计"和"施工"有着完整的理论体系和专业教育支撑——水工结构设计有材料力学和结构力学，水力机械设计有流体机械原理，水利工程施工有施工技术和项目管理。然而，"运行"却缺乏一个同等地位的独立学科方向来提供理论支撑。

国际比较也佐证了这一判断。荷兰的水务管理以其精细化运行闻名全球，其Delta Works防洪系统和Rijkswaterstaat运维体系拥有专职的运行科学团队，运行维护预算通常占总投资的3%至5%。以色列的Mekorot国家水公司将运行控制视为核心竞争力，其远程SCADA系统覆盖全国供水管网，自动化率超过90%。这些国际经验表明，"运行"不是工程建成后的附属工作，而是需要持续投入、持续创新的核心技术能力。

这种学科体系上的"缺位"，导致了一系列连锁效应。在人才培养层面，高校缺乏专门的"水系统运行"专业方向，运行调度人才主要依靠工作岗位上的"师傅带徒弟"方式培养，知识体系不够系统。在技术研发层面，运行控制技术的创新投入远低于工程设计和建设技术，许多先进的控制理论和方法未能及时引入水利领域。在产业生态层面，水利信息化市场长期以硬件集成和软件定制开发为主，缺乏具有深厚理论根基的核心产品和平台。

### 2.3.4 确立"运行"的独立学科地位

水系统控制论（Cybernetics of Hydro Systems, CHS）的提出，正是要从理论层面确立"运行"的独立学科地位，为水系统运行提供一个与"设计"、"施工"同等重要的理论框架和方法论体系。

CHS的学科定位可以用一个简洁的表述来概括：CHS之于水系统运行，犹如结构力学之于水工结构设计——它是水系统运行的理论基础学科。就像结构力学为水工结构的设计提供了应力分析、稳定性分析和可靠度分析的理论工具一样，CHS为水系统运行提供了可控性分析、稳定性分析、性能优化和安全保障的理论工具。

这一类比还可以进一步延伸。结构力学并不直接给出某个具体大坝的设计图纸，但它提供了设计所依据的基本原理和分析方法；同样，CHS并不直接给出某个具体渠道的调度方案，但它提供了调度方案设计所依据的建模方法、控制策略和安全评估框架。结构力学的成熟催生了大坝设计规范、抗震设计标准等一系列行业标准；同样，CHS的成熟也有望催生水系统运行控制的设计规范、自动化等级标准（如WSAL）和安全评估准则。

这一学科定位的确立具有多重意义。在学术层面，它为水系统运行研究提供了明确的理论边界和方法论指引，使分散的研究成果能够在统一的框架下得到整合和升华。在教育层面，它为"水系统运行"专业方向的课程体系设计提供了逻辑主线——从基础理论（系统科学、控制科学）到核心方法（CHS六大统一）再到工程实践（HydroOS与环上测试），形成层次递进的知识架构，使人才培养从经验传授走向理论培训。在产业层面，它为水利信息化产品的技术路线提供了理论指导，使产品开发从功能堆砌走向理论驱动——HydroOS作为CHS理论的工程化载体，正是这一理论驱动产品化路径的典型案例。

### 2.3.5 与相邻学科的界面关系

水系统运行科学与工程作为一个新兴的学科方向，需要与已有的相邻学科建立清晰的界面关系。这些相邻学科至少包括：

与水力学的关系：水力学提供了水系统物理过程的描述模型（如圣维南方程），是CHS建立被控对象模型的基础。CHS在水力学的基础上进一步发展了面向控制的降阶模型（如IDZ传递函数模型），使水力学模型能够直接用于控制器设计。

与水文学的关系：水文学提供了来水预报和需水预测的方法，是CHS进行前馈控制和滚动优化的信息基础。CHS将水文预报的不确定性纳入鲁棒控制和随机优化的框架，使调度决策能够在不确定条件下保持安全和高效。

与水资源规划的关系：水资源规划解决的是较大时空尺度上的资源配置问题（如何在各用户之间分配水量），CHS解决的是较小时空尺度上的实时控制问题（如何精确地实现已确定的分配方案）。两者在时间尺度上形成互补，规划的输出（调度任务）构成了控制的输入（设定值）。

与自动化工程的关系：自动化工程提供了传感器、执行器、通信网络和SCADA系统等硬件基础设施，CHS在此基础上提供了智能化的控制算法和决策逻辑。自动化解决的是"执行层"的问题——如何准确地执行指令，CHS解决的是"决策层"的问题——如何生成最优的指令。

与人工智能的关系：人工智能提供了数据驱动建模、模式识别和智能决策的算法工具，CHS将这些工具纳入控制论的框架，使其在安全约束和可解释性要求下发挥作用。CHS强调物理AI（基于机理模型的算法）与认知AI（基于数据学习的算法）的融合，而非简单地用AI替代传统方法。

这些界面关系的厘清，有助于避免学科边界的模糊和研究方向的混淆，也为跨学科合作提供了明确的协作框架。水系统运行科学与工程正是站在这些相邻学科的交汇点上，以控制科学为核心，将各学科的贡献有机整合为面向水系统运行的完整理论和方法体系。

需要特别强调的是，水系统运行科学与工程不是上述相邻学科的简单"拼盘"，而是以独特的理论视角——控制论视角——对这些学科资源进行了"化学重组"。水力学模型在CHS中不是用来做"研究性模拟"的，而是用来做"控制性预测"的——这要求对模型的精度-速度权衡、可辨识性和鲁棒性提出与纯学术研究完全不同的要求。水文预报在CHS中不是一个独立的"信息产品"，而是MPC优化器的"前馈输入"——这要求预报不仅给出"最可能的结果"，还要给出"不确定性范围"以供鲁棒优化使用。人工智能方法在CHS中不是"黑箱替代"物理模型，而是在物理模型框架内发挥"增强"作用——参数辨识、扰动预测、异常检测等。这种以控制论为"灵魂"、以多学科方法为"肢体"的学科架构，是水系统运行科学与工程区别于已有学科的本质特征。

---

**思考与讨论**

1. （概念理解）SCADA系统在水利工程中的核心功能是什么？它与HydroOS的本质区别在哪里？
2. （分析比较）水库调度从经验调度到数学优化（线性规划→动态规划→随机优化）的演进中，每一步解决了前一步的什么局限？


---


---

### §2.2 本节小结


本节梳理了20世纪下半叶水系统运行的学科奠基过程——SCADA系统的引入实现了远程数据采集，水库调度从经验调度走向数学优化（线性规划→动态规划→随机优化），水力学数值模型（Saint-Venant方程数值解）为控制器设计提供了预测能力。三大技术方向（感知、建模、决策）在此期间各自独立发展，但尚未形成统一的理论框架——这正是CHS理论在21世纪需要解决的整合问题。

## 2.3 数字化转型：从信息化到智能化的过渡

如果说计算水力学、水资源系统工程和水信息学为水系统运行奠定了学科基础，那么21世纪前二十年的数字化转型浪潮，则为这些学科成果的工程落地提供了前所未有的技术条件。物联网（IoT）使传感器网络覆盖密度实现数量级跃升，云计算为大规模水力模型的实时求解提供了弹性算力，大数据技术使得海量运行数据的存储和分析成为可能，数字孪生概念的引入则为"以虚映实、以虚控实"提供了新的技术范式。这一时期的技术进步，不仅改变了水系统运行管理的手段，更深刻地改变了人们对"水系统应该如何运行"这一根本问题的认知——从"人看数据、人做决策"的辅助模式，开始向"机器分析、机器建议、机器（部分）执行"的智能模式过渡。

### 2.3.1 物联网与感知革命

传统水利监测系统的核心矛盾在于感知密度与系统复杂度之间的不匹配。一条数百公里的长距离输水渠道，可能只在关键断面布设了十余个水位/流量监测站，站点之间数十公里的渠段处于"监测盲区"。城市供水管网的情况更为严峻——数千公里的地下管道中，压力和流量的监测点可能不到管网节点总数的5%。这种稀疏感知的现实，使得水系统运行长期处于"信息贫乏"的状态——调度员对系统大部分区域的实时状态知之甚少，决策不得不依赖粗糙的假设和经验推断。

物联网技术的成熟从根本上改变了这一局面。低功耗广域网（LPWAN）技术——包括LoRa、NB-IoT和Sigfox——使得在偏远地区部署电池供电的无线传感器成为经济可行的选择。一个NB-IoT水位传感器的硬件成本已从2010年代初的数千元降至数百元，电池寿命可达5-10年，数据传输延迟在秒级，覆盖范围可达数公里。这意味着在长距离输水渠道上每隔1-2公里布设一个水位传感器已经不再是技术或经济障碍——南水北调中线工程总干渠的监测站密度已经从最初设计的平均每20公里一站，逐步加密到平均每3-5公里一站。

在城市水务领域，智能水表和管网传感器的大规模部署同样带来了质的变化。超声波流量计、电磁流量计和压力变送器等智能仪表不仅精度更高（精度等级从传统的2.5级提升至0.5级），更重要的是它们支持远程自诊断和自校准——当传感器出现零点漂移或信号异常时，系统可以自动检测并发出维护预警。这种"可自我诊断"的感知能力，是水系统从信息化向智能化过渡的基础条件之一。

然而，感知密度的提升也带来了新的挑战。海量传感器产生的数据流远超传统SCADA系统的处理能力。一个配备2000个实时传感器、每秒采集一次数据的城市供水系统，每天产生的数据量约1.7亿条记录——传统关系型数据库和SCADA历史数据库在存储、查询和分析这种规模的数据时力不从心。更深层的问题在于，数据量的爆炸并不自动等同于信息量和知识量的增长——如果没有有效的数据分析和知识提取工具，海量数据反而可能导致"数据洪水、信息饥渴"的悖论。

从控制论的视角来看，物联网带来的感知革命解决的是系统的"可观测性"（Observability）问题——只有当系统的内部状态能够被充分感知时，基于状态的反馈控制才有可能实现。从这个意义上说，物联网不仅仅是一种数据采集技术，更是水系统闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）控制的"使能技术"（Enabling Technology）。经典控制理论中的可观测性判据（Kalman判据）要求系统的状态变量数不超过独立量测数——物联网技术的普及正在使越来越多的水系统满足这一基本条件。但值得注意的是，水系统的空间分布特性决定了即使传感器网络再密集，也无法在每个空间点都布设传感器。

因此，基于物理模型的状态估计（State Estimation）——利用有限的量测点信息推断全系统状态——仍然是不可或缺的技术手段。物联网+状态估计的组合，构成了水系统"全域感知"的完整技术方案。

遥感技术的进步为水系统感知增添了另一个重要维度。卫星遥感（如Sentinel-1 SAR、MODIS、Landsat系列）和无人机（UAV）遥感能够提供大范围的水面面积、水位变化和土壤含水量等信息——这些信息是地面传感器网络难以覆盖的空间尺度。特别是在大型水库和湖泊的蓄水量估计、洪泛区的淹没范围监测和灌区的实际用水量核查等应用场景中，遥感技术提供了不可替代的空间观测能力。合成孔径雷达（SAR）干涉测量技术甚至可以监测水利工程结构（如大坝、堤防）的毫米级形变，为工程安全监测提供了新的手段。将遥感数据与地面传感器数据融合——利用遥感提供空间覆盖、利用地面传感器提供时间分辨率——是构建水系统"天空地"一体化监测网络的核心技术路径。

视频监控和图像识别技术也正在水利领域找到越来越多的应用场景。基于深度学习的图像识别可以从监控视频中自动检测河道水位（通过识别水面与河岸的交界线）、识别水面漂浮物和垃圾、监测鱼道过鱼数量、甚至判断水体颜色变化所指示的水质异常。与传统的接触式传感器相比，视频监测具有非接触、免维护、信息丰富的优势——一台摄像头可以同时获取水位、流态、悬浮物等多种信息，而传统方案需要分别部署水位计、流速仪和浊度计。这种"一传感器多信息"的特性，使得视频智能成为水系统感知网络的重要补充。

综合来看，水系统的感知网络正在从"单一传感器+人工巡检"的传统模式，向"天空地一体化、多源异构融合"的智能感知模式演进。这一演进过程中，边缘AI（Edge AI）扮演着日益重要的角色——将轻量化的机器学习模型部署在传感器端或边缘网关上，实现数据的本地化预处理和初步分析。例如，在水位传感器端集成简单的异常检测模型，可以在数据上传到中心之前就过滤掉明显的噪声和虚假读数，大幅减轻中心处理负荷并缩短异常响应时间。在视频监控端集成目标检测模型，可以在本地完成水面漂浮物识别和水位读取，只将分析结果（而非原始视频流）上传，节省90%以上的通信带宽。这种"感知-分析一体化"的边缘智能模式，正在从根本上改变水利感知系统的架构——从"中心集中式处理"向"边缘分布式智能+中心协调优化"的混合架构演进。

### 2.3.2 云计算与计算范式变革

水力模型的实时求解一直是制约水系统智能化的瓶颈之一。求解一维Saint-Venant方程的Preissmann隐式差分格式，对于一个包含100个计算节点、时间步长为60秒的渠道，单次求解耗时约0.1秒——对于实时控制而言尚可接受。但当系统规模扩大到千个节点的管网或跨流域调水系统时，求解耗时急剧增加；特别是MPC（模型预测控制）需要在每个控制步中多次迭代求解优化问题，对计算速度的要求更为苛刻。

云计算技术的成熟为这一瓶颈的突破提供了两条路径。第一条是"算力上云"——将计算密集型的模型求解任务提交到云端服务器集群，利用多核并行计算和GPU加速大幅缩短求解时间。对于水资源优化配置这类时间尺度较长（小时至天级）的任务，算力上云是自然的选择。Amazon AWS、Microsoft Azure和阿里云等公有云平台已经能够提供按需弹性伸缩的计算资源，使得水利部门无需自建大规模计算基础设施即可获得充足的算力。

第二条路径是"边缘计算"——将对实时性要求最高的控制计算下沉到靠近物理设备的边缘节点。这一路径的驱动力在于网络延迟：一个闸门PID控制器的控制周期通常为1-10秒，而从现场传感器经广域网到云端再返回的往返延迟可能达到100-500毫秒甚至更长，且存在不可预测的抖动——这对于实时闭环控制是不可接受的。边缘计算将控制逻辑部署在RTU或本地工控机上，实现毫秒级的本地控制响应，同时将非实时的优化计算和数据分析任务上传到云端处理。

这种"云—边—端"三级计算架构，与水系统运行的多时间尺度特性高度吻合：端侧（传感器/执行器）负责毫秒级的物理量采集和指令执行，边缘层负责秒至分钟级的本地控制和状态监测，云端负责分钟至小时级的全局优化和长期规划。这一架构日后成为HydroOS三层架构（边缘—区域—中央）的直接技术先驱。

从软件架构的角度看，云计算还催生了水利行业的"平台化"趋势。传统的水利信息系统通常是针对特定工程定制开发的"烟囱式"系统——每个项目从底层数据库到上层应用界面全部重新开发，代码复用率低，维护成本高，系统间数据难以互通。云原生架构（微服务、容器化、API网关）为水利软件的模块化和平台化提供了技术基础：底层数据服务、中间层模型服务和上层应用服务可以独立开发、独立部署、独立升级，通过标准化API进行交互。这种"松耦合"的架构理念，正是HydroOS"一切皆服务"（Everything as a Service）设计思想的技术渊源。

容器化技术（Docker/Kubernetes）的普及进一步加速了水利软件的现代化进程。传统水利软件的部署是一个耗时耗力的过程——需要配置操作系统、安装数据库、编译模型代码、调试通信接口——每个项目的部署环境都不完全相同，导致"在开发环境跑得好好的，到现场就不行了"的问题反复出现。容器化技术将应用程序及其所有依赖项打包为标准化的容器镜像，保证在任何环境中都能一致运行。在HydroOS的部署实践中，每个模型服务、控制服务和数据服务都封装为独立的Docker容器，通过Kubernetes进行编排管理——系统的部署从"手工配置数天"简化为"一键部署数小时"，运维效率提升了一个数量级。

值得特别提及的是开源技术生态对水利软件发展的深远影响。21世纪的第一个十年，开源运动（Open Source Movement）深刻改变了软件行业的格局——Linux操作系统、Apache Web服务器、MySQL数据库、Python编程语言等开源项目已成为全球IT基础设施的骨干。在水利领域，EPANET（美国EPA开发的管网水力模拟软件）和SWMM（暴雨水管理模型）是最早也是最成功的开源水利软件——它们的开源特性使得全球研究者可以在其基础上自由扩展和改进，形成了庞大的用户和开发者社区。近年来，HEC-RAS（美国陆军工程兵团开发的河道水力模型）也转向了开源路线。

这些开源实践为HydroOS的"开放生态"理念提供了宝贵的参考——一个真正的"水网操作系统"不能是封闭的私有系统，而必须是开放的平台，通过标准化接口和开发者工具吸引整个行业的智力资源共同参与。

### 2.3.3 大数据与知识发现

水利行业长期以来是一个"数据丰富但信息贫乏"的领域。全国数万个水文监测站积累了数十年的连续观测数据，大型水利工程的SCADA系统存储了海量的运行日志——但这些数据大部分处于"沉睡"状态，仅在事后分析和报告编写时被调用，远未发挥其潜在的决策支持价值。

大数据技术的引入改变了这一状况。从技术手段来看，分布式存储系统（如HDFS/HBase）解决了海量历史数据的高效存储问题，流处理引擎（如Apache Kafka/Flink）实现了实时数据流的毫秒级处理，机器学习框架（如TensorFlow/PyTorch）则为从数据中自动发现规律提供了强大的算法工具。

在水文预报领域，深度学习方法取得了令人瞩目的进展。Kratzert等人（2018, 2019）的系列研究表明，LSTM（长短期记忆网络）在流域降雨-径流模拟中可以达到甚至超过概念性水文模型（如SAC-SMA、VIC等）的性能——特别是在数据丰富的流域中，LSTM能够捕捉传统模型难以表达的非线性降雨-径流关系。Nearing等人（2021）进一步证明，当训练数据充足时，基于深度学习的水文模型在大样本水文学（Large-Sample Hydrology）基准测试中系统性地优于传统物理概念模型，这一发现在水文学界引发了关于"数据驱动vs物理驱动"的广泛讨论。

在水质监测领域，异常检测算法被用于识别水质突变事件。传统的阈值报警方法（当某参数超过设定值时触发报警）存在明显的局限——许多水质污染事件表现为多参数的协同缓慢变化，单参数阈值难以捕捉。基于机器学习的异常检测方法（如Isolation Forest、Auto-encoder）能够学习正常工况下多参数之间的关联模式，当实际数据偏离这一模式时自动发出预警。这种"基于模式"而非"基于阈值"的监测方法，在国际上已被多个城市供水系统采用。

在管网漏损检测领域，夜间最小流量分析（Night Flow Analysis）和区域计量（DMA，District Metered Area）技术与大数据分析的结合，使得管网漏损率的精确定位成为可能。通过对DMA分区内流量数据的时序分析和统计建模，可以将漏损定位精度从传统的"管段级"（数百米）提升到"节点级"（数十米），大幅降低了漏损修复的开挖成本。英国在2000年代推广DMA技术后，全国供水管网的漏损率从1990年代的30%以上降至2020年代的约20%（据Ofwat年度行业绩效报告），每年减少了超过10亿立方米的水资源浪费——这一成功实践生动说明了数据技术对水系统运行效率的直接贡献。

在洪水预警领域，集成了气象预报、水文模型和实时监测数据的综合预警系统已成为许多国家防洪减灾的核心工具。欧洲的EFAS（European Flood Awareness System）和中国的国家防汛抗旱指挥系统代表了不同的技术路线——前者更侧重于概率预报和集合预测，后者更侧重于确定性预报和实时调度。两种路线都高度依赖大数据技术：EFAS每天处理来自数十个气象模式的集合预报数据，中国的防汛系统实时接入全国12万个水文监测站的数据流。这些系统的运行产生了海量的历史预报数据，通过对这些数据的回顾分析（Post-Event Analysis），可以不断改进预报模型和预警阈值——这是一种典型的"数据飞轮"效应：更多的数据→更好的模型→更准确的预报→更多的应用→更多的数据。

然而，大数据技术在水利领域的应用也面临着独特的挑战。首先是数据质量问题——水利传感器工作环境恶劣（水下、野外、冰冻），数据缺失、漂移和异常的比例远高于其他行业（有研究表明原始数据的可用率可能低于70%）。其次是样本不平衡问题——水利系统大部分时间处于正常运行状态，极端事件（如洪水、管网爆裂）的样本极为稀少，而恰恰是这些极端事件最需要准确预测。第三是可解释性问题——水利是攸关公共安全的领域，"黑箱"模型即使预测精度很高，也难以获得调度员和决策者的信任——当模型给出一个反直觉的建议时，如果无法解释"为什么"，调度员通常会选择忽略。

这些挑战指向了一个深层的认识：纯数据驱动的方法在水利领域存在本质的局限性，需要与物理模型深度融合——这正是CHS理论"物理AI+认知AI双引擎"架构的实践背景。数据驱动不是物理驱动的替代者，而是增强者；物理模型提供骨架和约束，数据方法提供灵活性和适应性——二者的融合才是水系统智能化的正确路径。

近年来，物理信息神经网络（Physics-Informed Neural Networks, PINN）的兴起为这一融合提供了有力的技术路径。PINN的核心思想是将物理方程（如Saint-Venant方程、Richards方程）作为神经网络损失函数的正则化项，使得网络在拟合数据的同时自动满足物理约束。Raissi等人（2019）的开创性工作表明，PINN在正问题（已知方程求解场）和逆问题（已知观测反演参数）中都展现了显著优势——特别是在数据稀疏的条件下，物理约束可以有效弥补数据不足，避免纯数据驱动模型的过拟合（overfitting，模型过度学习了训练数据中的噪声和细节，导致对新数据的预测能力反而下降——类似于根据历史水文资料拟合的经验公式在异常年份严重失准）问题。

在水利领域，PINN已被初步应用于地下水流模拟、河道水动力反演和管网状态估计等场景，展现了良好的应用前景。

迁移学习（Transfer Learning）是另一项具有重要应用价值的技术。水利系统的一个现实困境是：每个工程的运行数据相对有限（一条新建渠道可能只有2-3年的运行记录），但不同工程之间存在共性的物理规律和运行模式。迁移学习允许在数据丰富的"源域"（如一条运行多年的老渠道）上训练模型，然后将学到的知识迁移到数据稀缺的"目标域"（如一条新建渠道），只需少量目标域数据即可完成模型适配。这种"知识复用"的能力，对于水利行业尤为重要——因为每一条渠道、每一个水库虽然在参数上各不相同，但在物理本质上遵循相同的水力学定律。

### 2.3.4 数字孪生：从制造业到水利的概念迁移

"数字孪生"（Digital Twin）概念的起源可以追溯到NASA在阿波罗计划中为航天器建立的镜像系统——在地面实验室中维护一套与飞行中航天器完全相同的备份系统，用于模拟故障场景和验证修复方案。2002年，Grieves在密歇根大学的产品生命周期管理课程中正式提出了Digital Twin的概念框架；2010年代，随着传感器技术、云计算和仿真技术的成熟，数字孪生在航空航天（GE的飞机发动机数字孪生）、汽车制造（BMW的虚拟工厂）和能源行业（Siemens的电厂数字孪生）中已在多个工程中成功部署。

数字孪生引入水利领域，始于2018年前后国际水协会（IWA）和世界银行推动的"智慧水务"（Smart Water）倡议。在学术界，Savic等人提出了城市水系统数字孪生的概念框架，强调物理空间与信息空间的双向映射和实时同步。在产业界，Bentley Systems、DHI、Innovyze等国际水务软件公司相继推出了面向城市供水和排水系统的数字孪生平台。

在中国，水利部于2021年首次提出"数字孪生流域"概念，2022年发布《数字孪生流域建设技术大纲（试行）》，将数字孪生作为智慧水利建设的核心技术路径。这一政策推动催生了大规模的数字孪生流域建设热潮——截至2023年底，全国已启动98个数字孪生先行先试项目，涵盖防洪、水资源调配、农村供水、河湖管理等多个领域。

然而，数字孪生在水利领域的落地也暴露出一系列深层问题。最突出的是"重可视化、轻计算"的倾向——大量项目将三维可视化作为核心交付物，投入大量资源构建精美的三维场景模型，但在实际运行调度中发挥的决策支持作用有限。三维可视化固然有助于工程展示和公众沟通，但数字孪生的核心价值在于"预演"——即在虚拟空间中快速模拟不同调度方案的效果，为决策者提供科学依据。要实现这一核心价值，需要的不是视觉精度，而是物理精度——水力模型能否准确预测闸门操作后的水位变化过程，水质模型能否可靠预测污染物的迁移扩散，这才是决定数字孪生能否真正发挥作用的关键。

从CHS理论的视角来看，数字孪生的本质是系统的"可控模型族"在信息空间中的实例化。如果说物理水系统是"实体"，那么数字孪生就是这个实体在信息空间中的"投影"——投影的保真度取决于模型的精度和参数的时效性。CHS强调的"模型族"层次——从简化的IDZ传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）到精细的Saint-Venant方程——为数字孪生的模型选择提供了理论指导：不是所有场景都需要最精细的模型，关键是在计算速度和模型精度之间找到适合当前任务需求的平衡点。对于实时控制（秒级响应），IDZ简化模型足以满足需求；对于日调度优化（分钟级计算），一维Saint-Venant模型是合适的选择；对于洪水风险评估和防洪预案制定（小时级计算），二维甚至三维水动力模型才是必要的。

值得注意的是，数字孪生在水利领域的标准化工作尚处于起步阶段。与制造业已有较为成熟的数字孪生标准体系（如ISO 23247数字孪生制造框架）不同，水利领域目前缺乏统一的数字孪生数据模型、接口规范和成熟度评估标准。中国水利部发布的《数字孪生流域建设技术大纲》提供了宏观指导，但在具体实施层面的技术规范仍在完善中。国际上，OGC（Open Geospatial Consortium）的WaterML 2.0标准为水文观测数据的交换提供了初步框架，但远未覆盖数字孪生所需的模型描述、控制接口和实时同步等核心功能。这种标准缺失的现状，使得不同单位建设的数字孪生系统之间难以互通，"数据孤岛"问题在数字孪生时代可能以新的形式重现。CHS理论的六要素架构和HydroOS的标准化接口体系，正是试图从学术源头为这一标准化困境提供解决思路。

### 2.3.5 国际智慧水务的发展脉络

在国际层面，水系统的数字化转型呈现出不同于中国的发展路径。欧美国家的水利基础设施建设较早完成，21世纪的重点已从"新建"转向"运维优化"——如何让已有的老旧基础设施运行得更高效、更安全、更经济，是核心关切。这一背景催生了"智慧水务"（Smart Water）运动。

在城市供水领域，英国的Thames Water和Anglian Water率先推行了大规模的智能水表部署和分区计量（DMA）项目，通过精细化的水量平衡分析将管网漏损率从30%以上降至15%以下。以色列的Mekorot公司利用先进的SCADA和决策支持系统，在极端水资源匮乏的条件下实现了全国供水的精细化管理——其管网漏损率控制在8%以下，在全球名列前茅。新加坡公用事业局（PUB）则建设了全国性的智慧水网（Smart Water Grid），通过超过300个在线水质监测站实现了从源头到龙头的全流程水质监控。

在灌溉水利领域，澳大利亚的Rubicon Water公司开发的TCC（Total Channel Control）系统是全球灌区自动化的标杆。TCC系统将FlumeGate™自动量水闸门与分布式控制系统相结合，实现了灌区渠系的全自动运行——从用水户提交用水订单到水量准确送达田间出水口，全过程无需人工干预。Goulburn-Murray灌区（GMID）的实践表明，TCC系统可以将灌溉水输配效率从70%提升至90%以上，年节水量超过4亿立方米。这一系统在WSAL框架中可以被评定为L3级（有条件自主运行），是目前全球水利领域自动化水平最高的工程实践之一。

在欧洲，荷兰的Rijkswaterstaat（国家水务局）在水资源管理和防洪系统中大量应用了实时控制技术。Maeslantkering风暴潮屏障是世界上最大的自动防洪闸，其BOS（Beslis en Ondersteunend Systeem，决策支持系统）能够自动判断风暴潮威胁等级并触发闸门关闭程序——这是水利领域"自主决策"的早期实践。法国的Société du Canal de Provence在地中海气候条件下运营着高度自动化的灌溉供水系统，其控制系统由INRAE（原IRSTEA）团队设计，采用了基于IDZ模型的MPC控制器。

在亚洲，日本和韩国的智慧水务建设走在前列。日本国土交通省（MLIT）自2003年起推行"水管理信息化"战略，在全国主要河川建立了高密度实时监测网络，并开发了"水文水质数据库系统"（Water Information System）供公众和研究者免费使用。横河电机（Yokogawa）在化工厂水处理领域实现了35天无人值守的自主运行——虽然严格来说这属于化工过程控制而非水利系统，但其展示的AI自主运行技术路径对水利领域具有重要参考价值。韩国K-water（韩国水资源公社）建设了"智能水管理（SWM）"平台，整合了全国水库、河川和供水系统的实时监测数据，采用AI辅助的洪水预警和水量调度决策支持系统——其核心技术包括基于集合预报的概率洪水预测和基于强化学习的水库群联合调度优化。

这些国际实践表明，水系统的数字化转型正在沿着一条清晰的路径推进：从数据采集（SCADA）→数据分析（大数据/AI）→决策支持（DSS）→半自动执行（HDC）→全自动运行（Autonomous）。不同国家和地区在这条路径上处于不同的位置，但前进方向是共同的——用机器的计算和分析能力逐步替代人的判断和操作，最终实现水系统的自主运行。这一趋势既是技术发展的必然结果，也是应对水资源挑战加剧（气候变化、城市化、人口增长）和运行人才日益短缺这一双重压力的现实需要。

### 2.3.6 从信息化到智能化：未竟的跃迁

回顾2000-2020年水利数字化转型的二十年，可以清晰地看到：技术手段的进步是显著的（从模拟到数字、从有线到无线、从单机到云端、从人工分析到机器学习），但"智能化"的承诺并未完全兑现。大量被冠以"智慧水利""数字孪生"标签的项目，最终交付的核心功能仍然是"监测+展示"——本质上是功能更丰富、界面更美观的新一代SCADA系统。调度决策的最终环节，仍然由人工完成。

造成这一"跃迁未竟"困境的根本原因，并非技术手段不够先进，而是缺乏一个将感知、建模、决策和执行整合为完整闭环的系统性理论框架。IoT解决了感知问题，云计算解决了算力问题，大数据解决了学习问题，数字孪生提供了仿真平台——但没有一个统一的框架告诉我们：这些技术手段应该如何有机地组合在一起，才能实现从"信息化"到真正"智能化"的质变。

这正是水系统控制论（CHS）应运而生的历史背景。CHS不是又一项新技术，而是一个整合框架——它以控制论的"闭环"思想为灵魂，以系统科学的"层次性"为骨架，以人工智能的"学习性"为肌肉，将数字化转型时代积累的各种技术手段整合为一个有机整体。CHS理论的六要素架构（传感器网络、通信系统、数字模型族、智能决策引擎、执行器系统和人机交互界面），恰好对应了数字化转型时代各种技术手段的系统化集成。

从这个意义上说，2000-2020年的数字化转型是CHS理论的"技术准备期"——没有IoT就没有可观测性，没有云计算就没有实时优化，没有大数据就没有数据驱动，没有数字孪生就没有仿真验证。CHS站在这些技术巨人的肩膀上，但它提供的不是又一块砖，而是将所有砖块砌成大厦的设计图纸。

更深层地反思，这一时期暴露出的"智能化跃迁未竟"问题还有一个常被忽视的维度：组织和人才的断层。技术工具的进步速度远快于组织管理模式和人员能力的更新速度。许多水利管理单位配置了先进的SCADA系统和数字孪生平台，但操作人员仍然习惯于基于经验的传统调度模式——先进系统被降维使用为"电子看板"，其优化建议和预警信息并未真正融入调度决策流程。要跨越从信息化到智能化的鸿沟，不仅需要技术框架（如CHS）和软件平台（如HydroOS），还需要配套的组织变革（建立"数据驱动决策"的管理文化）、人才培养（培育兼具水利专业和信息技术能力的复合型人才）和制度设计（明确人机协同决策中的责任划分和操作规程）。这一认识将在第三篇"挑战与现状"中进一步展开。

---

**思考与讨论**

1. （概念理解）为什么"数据多"不等于"智慧高"？请用DMA分区计量的案例说明数据如何转化为控制行动。
2. （分析应用）英国管网DMA分区将漏损率从30%降至20%，请分析这一成功背后至少需要哪三个技术要素的配合。


---


---

### §2.3 本节小结


本节分析了21世纪初物联网、云计算和大数据驱动的水利数字化转型。转型的核心成就是将数据采集频率从小时级提升到分钟级、将数据存储从本地服务器扩展到云端，但转型的局限同样突出——数据虽多但缺乏实时决策闭环，"看得见但管不住（"visible but uncontrollable" — data is collected but not translated into automated control actions）"成为普遍困境。DMA分区计量在英国将管网漏损率从30%降至20%的成功案例表明，数据驱动的精细化管理潜力巨大，但前提是数据必须转化为控制行动。

## 2.4 学科形成：从渠道控制到运行科学

> ---

> **📖 给水利工程师的速览：渠道控制为什么难？**
>
> 渠道控制之所以困难，核心原因是"延迟"：上游闸门动作后，水波要经过数十分钟甚至数小时才到达下游。这意味着控制器必须"预见"未来的水位变化来提前动作，而不能等水位偏差出现后再调整（那就来不及了）。这就是为什么简单的PID控制器在短渠段可以工作，但在长距离输水渠道中表现不佳——它只看当前偏差，不看未来。MPC（模型预测控制）通过内置水力学模型来"预演"未来若干步的水位变化，提前优化闸门动作序列，因此成为长距离渠道控制的主流方法。
> ---

如果说计算水力学、水资源系统工程和水信息学分别从"模拟"、"优化"和"信息化"三个角度为水系统运行奠定了基础，那么渠道自动化控制（Canal Automation and Control）则是水系统运行科学与工程最直接的实践源头——它是第一个将控制理论系统性地应用于水系统运行的技术方向。从渠道控制的早期探索到MPC的工程突破，再到水系统控制论（CHS）的理论提升，这一演进历程生动地展示了一个新兴学科从实践需求中萌芽、在理论创新中成长的完整轨迹。


> **表 2-3　渠道自动控制方法演进对比**
> *Table 2-3 Six Generations of Canal Automatic Control*
>
> | 代次 | 时期 | 方法 | 模型基础 | 关键突破 | 代表学者 | 局限性 |
> |:----:|:----:|:----:|:--------:|:---------|:---------|:-------|
> | 第一代 | 1970s | PID | 无模型（纯反馈） | 实现基本水位稳定 | Buyalski (1991) | 无法处理时滞和耦合 |
> | 第二代 | 1980s | ID模型+前馈 | 积分-延迟 | 引入时滞补偿 | Corriga (1982) | 忽略回水效应 |
> | 第三代 | 1990s | IDZ模型+LQR/H∞ | 积分-延迟-零点 | 捕获回水动态 | Litrico & Fromion (2004) | 单渠段最优≠全局最优 |
> | 第四代 | 2000s | MPC | IDZ/LSV | 滚动优化+约束处理 | van Overloop (2006) | 集中式难以扩展 |
> | 第五代 | 2010s | DMPC+MAS | IDZ+通信网络 | 分布式协调控制 | Lei et al. (2020) | 通信依赖、鲁棒（robust，指系统在参数变化或外部干扰下仍能保持稳定性能的能力，类似于水利工程中的'抗干扰性'）性 |
> | 第六代 | 2020s | CHS双引擎 | 可控模型族+LLM | 物理AI+认知AI融合 | Lei (2025) | 理论验证中 |


### 2.4.1 渠道控制的早期探索（1970s—1990s）

#### （1）先驱机构与早期实验

渠道自动化控制的研究始于20世纪70年代。美国垦务局（U.S. Bureau of Reclamation, USBR）是最早开展渠道自动化实验的机构之一。USBR在美国西部多个灌区进行了闸门自动控制的现场试验，积累了丰富的工程经验。1991年，布亚尔斯基（Buyalski）编写的《渠道系统自动化手册》系统总结了USBR在SCADA系统和闸门自动控制方面的实践经验 [62]，成为该领域重要的工程参考文献。

法国普罗旺斯运河公司（Société du Canal de Provence, SCP）是另一个重要的先驱机构。SCP运营的普罗旺斯运河系统是法国南部重要的农业和城市供水工程，全长超过200公里。从1970年代开始，SCP与法国国家农业研究院（INRAE，前身为Cemagref）合作，在运河上开展了一系列自动化控制实验。SCP的工程实践催生了多种重要的控制算法，也培养了一批渠道控制领域的核心研究人员。

这些早期实验主要采用简单的PID控制器或开关控制（On-Off Control）来调节闸门开度，以维持渠道的目标水位。PID控制器由比例（P）、积分（I）和微分（D）三个控制环节组成：比例环节根据当前水位偏差产生控制动作，积分环节消除稳态偏差，微分环节提供预测性补偿以减小超调。然而，PID控制器的参数通常需要现场人工整定——调试人员通过反复试验确定比例增益$K_p$、积分时间$T_i$和微分时间$T_d$的最佳值。面对不同的运行工况（丰水期与枯水期、大流量与小流量），由于渠道的水力特性发生变化，PID参数需要频繁调整，工程适用性受到限制。

更深层的问题在于，PID控制器本质上是一种本地反馈控制方法——它只关注"眼前"的水位偏差，无法预见"未来"的水位变化趋势。在长距离调水渠道中，上游闸门操作产生的水位变化需要经过较长时间才能传播到下游控制点。如果PID控制器在检测到下游水位偏差后才开始调节上游闸门，由于传播延迟的存在，调节效果滞后，容易引发水位振荡甚至失稳。这一"大时滞系统的反馈控制困境"成为推动渠道控制方法从PID向预测控制演进的根本动力。

此外，早期的开关控制方法虽然实现简单（水位高于设定值时关闸，低于设定值时开闸），但频繁的闸门启闭不仅加速机械磨损，还在渠道中产生不必要的水位波动。一些改进方案引入了"死区"控制——只有当水位偏差超过一定阈值时才触发闸门动作，但死区的设置本身就是一个工程折中：死区太大导致水位控制精度差，死区太小导致闸门动作过于频繁。

然而，这些早期尝试尽管在技术上存在种种局限，但它们证明了一个关键命题：控制理论可以被成功地应用于水系统运行——渠道水位是可以通过自动控制来精确维持的。这一命题的验证，为后续更先进的控制方法（如MPC）在水系统中的应用扫清了认识障碍。

#### （2）关键学者与奠基性贡献

20世纪90年代，渠道控制研究进入快速发展阶段，一批学者做出了奠基性的贡献。

加州理工州立大学（Cal Poly）的查尔斯·伯特（Charles M. Burt）是灌溉现代化和渠道自动化领域的先驱。1988年，他创立了灌溉培训与研究中心（Irrigation Training and Research Center, ITRC），致力于推动灌溉系统的现代化改造和自动化控制。伯特强调"现代化"不仅仅是安装自动化设备，更重要的是通过系统工程方法重新设计运行策略，使水的输配更加精准高效。1999年，他与Styles合著的FAO技术报告《灌溉中的现代水控制与管理实践》[63]系统总结了灌溉渠道现代化改造的原理和实践，在全球灌溉领域产生了广泛影响。

伯特提出的"灌溉现代化"（Irrigation Modernization）理念，将硬件升级（自动化闸门、SCADA）与软件升级（先进控制算法、决策支持系统）视为不可分割的整体，这一整体观对后续水系统运行科学的形成具有重要的启示意义。

美国农业部农业研究服务局（USDA-ARS）的阿尔伯特·克莱门斯（Albert J. Clemmens）在渠道控制算法的标准化测试方面做出了决定性贡献。1998年，他与Kacerek、Grawitz和Schuurmans合作，在ASCE《灌溉与排水工程杂志》上发表了具有里程碑意义的论文《渠道控制算法测试案例》[64]。这篇论文定义了一组标准化的测试场景（包括定流量供水变化、计划与非计划需水变化、闸门故障等），为评估和比较不同渠道控制算法的性能提供了公平的测试基准。就像航空领域的标准测试风洞和汽车工业的碰撞测试标准一样，ASCE测试案例的建立标志着渠道控制研究从个别工程的经验积累走向了系统化的科学评价。

同年，法国Cemagref的马拉泰尔（Pierre-Olivier Malaterre）与Rogers和Schuurmans合作发表了《渠道控制算法分类》[65]，对当时已有的各类渠道控制算法进行了系统分类。马拉泰尔提出了著名的三维分类框架：按控制变量分类（上游水位控制、下游水位控制、流量控制）、按控制逻辑分类（反馈、前馈、最优控制）、按信息集中程度分类（本地控制、集中控制、分布式控制）。这一分类框架至今仍是渠道控制领域最常用的概念工具。马拉泰尔还在同年发表了PILOTE算法 [20]，这是线性二次调节器（LQR）在渠道控制中的经典应用，展示了现代控制理论在水系统中的工程可行性。

#### （3）建模方法的突破：从圣维南到传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）

渠道控制研究的一个核心挑战是：如何将圣维南方程（Saint-Venant equations，描述明渠水流运动的基本方程，由连续性方程和动量方程组成）这一复杂的非线性偏微分方程"翻译"为控制理论可以直接使用的数学模型。

荷兰代尔夫特理工大学的扬·舒尔曼斯（Jan Schuurmans）在这一方向上做出了重要突破。1995年，他在《Applied Mathematical Modelling》上发表了"Open-channel flow model approximation for controller design"一文 [66]，提出了积分延迟模型（Integrator-Delay Model, ID Model），将一个渠段的水位—流量动态关系简化为一个由纯延迟环节和积分环节串联而成的低阶传递函数：

$$G_{ID}(s) = \frac{e^{-\tau_d \cdot s}}{A_s \cdot s}$$

其中$A_s$为渠段的等效蓄量面积（水面宽度与渠段长度之积），$\tau_d$为传播延迟时间。ID模型的物理意义非常直观：纯延迟$e^{-\tau_d s}$代表水波从上游闸门传播到下游控制点所需的时间；积分环节$1/(A_s \cdot s)$代表渠段的水量存蓄效应——流入流出之差转化为水位变化。尽管ID模型在数学上极为简洁，但它捕捉了渠道系统最本质的两个动力学特征——时滞和积分效应——因此在许多工况下能够提供令人满意的控制性能。

2004年，法国学者利特里科（Xavier Litrico）和弗罗米昂（Vincent Fromion）在ID模型的基础上提出了积分延迟零模型（Integrator Delay Zero, IDZ Model）[67]。IDZ模型在ID模型中增加了一个零点项：

$$G_{IDZ}(s) = \frac{(1 + \tau_z \cdot s) \cdot e^{-\tau_d \cdot s}}{A_s \cdot s}$$

新增的零点时间常数$\tau_z$通过对线性化圣维南方程的频域分析确定，其物理意义是对高频段动态响应的修正补偿。在低频段（慢速水位变化），ID模型和IDZ模型的精度相当；但在中频段（较快的闸门调节动作），IDZ模型通过零点项的补偿，显著提高了模型精度。利特里科和弗罗米昂的严格证明表明，IDZ模型是线性化圣维南方程在低频到中频段的最佳一阶有理函数近似。

从ID到IDZ的发展，不仅是模型精度的提升，更重要的是建立了从偏微分方程（PDE）到传递函数的严格数学桥梁。这座桥梁的一端是水力学家熟悉的圣维南方程，另一端是控制工程师熟悉的传递函数——它使得两个原本相对隔绝的学科领域能够对接和协作。CHS理论后来提出的"可控模型族"概念，正是对这一建模方法论的系统化总结和扩展。

#### （4）ASCE测试案例的标准化意义

值得特别指出的是克莱门斯等人1998年提出的ASCE测试案例的学科意义。该测试框架定义了三类标准化场景：第一类是上游来水变化场景，模拟水源供水量的突变或渐变对渠系水位的影响；第二类是下游需水变化场景，包括计划性需水变化（如灌溉轮灌制度切换）和非计划性需水变化（如用户突然开关取水口）；第三类是设备故障场景，如闸门卡死或传感器失灵时系统的应对能力。每类场景都有明确的性能评价指标——最大水位偏差（Maximum Absolute Error, MAE）、积分绝对误差（Integral Absolute Error, IAE）和稳态时间（Settling Time）。

ASCE测试案例的建立标志着渠道控制研究从"各自表演"走向"统一评判"的质的飞跃。此前，不同研究团队在各自的实验渠道或仿真平台上测试自己的算法，由于渠道参数、测试工况和评价标准各不相同，算法之间的比较几乎不可能。ASCE测试案例提供了一个公平的"竞技场"，使得全球研究者能够在统一的基准上比较和改进算法。这种标准化测试的思想后来被CHS理论继承和发展——CHS提出的"在回路测试"（In-Loop Testing）方法论，正是将ASCE测试案例的思想从单一的算法测试扩展到"模型在环—软件在环—硬件在环"的系统级测试体系。

在ID模型的基础上，后续学者又发展出了更完善的建模方法。Schuurmans、De Haan和Overloop等人将ID模型扩展为状态空间（state space，用一组状态变量——如各断面水位和流量——来完整描述系统在任意时刻行为的数学框架）形式，使之能够直接用于多变量MPC控制器的设计。他们通过将多个渠段的ID/IDZ模型串联组合，建立了整个渠系的集总参数状态空间模型——这一建模范式成为后续MPC在渠道控制中大规模应用的标准方法。值得注意的是，从分布参数的圣维南PDE到集总参数的状态空间模型，信息的损失是不可避免的。如何在降阶过程中保留对控制最关键的动力学特征，同时丢弃对控制影响不大的高频细节，是渠道控制建模方法论的核心问题。

CHS后来提出的"可控模型族"概念，正是对这一问题的系统化回应——在不同的控制时间尺度和精度需求下，从模型族中选取最合适的降阶层级。

### 2.4.2 MPC在渠道控制中的突破（2000s—2010s）

#### （1）Van Overloop的系统性贡献

进入21世纪，模型预测控制（Model Predictive Control, MPC）开始在渠道控制领域得到系统性的应用，并展现出优越的性能。

代尔夫特理工大学的范·奥弗卢普（Peter-Jules van Overloop）是将MPC系统性地应用于明渠水系统控制的先驱。2006年，他出版了专著《明渠系统的模型预测控制》（*Model Predictive Control on Open Water Systems*）[32]，这是第一本专门讨论MPC在水系统中应用的学术专著。该书系统介绍了MPC在渠道控制中的建模方法（基于ID/IDZ模型的状态空间离散化）、约束处理方法（将水位上下限、闸门开度限制和变化速率限制纳入优化约束）、以及多种工程案例。

Van Overloop的工作之所以具有划时代意义，在于他完整地解决了"如何在有约束的长时滞水系统中实现在线优化控制"这一核心问题。传统的PID控制器只能基于当前偏差信号进行调节，无法预见未来的扰动变化，更无法显式处理水位上下限等硬约束——当水位逼近安全边界时，PID控制器可能因积分饱和而失效。LQR控制器虽然能考虑多变量耦合和前瞻优化，但其标准形式假设无约束，难以处理水系统中无处不在的不等式约束（水位范围、闸门行程、变化速率等）。

MPC则天然地将约束作为优化问题的一部分。Van Overloop在书中详细阐述了MPC应用于水系统时的完整技术框架：第一，预测模型的构建——将IDZ传递函数模型离散化为状态空间形式，多个渠段串联后构成高维状态空间模型；第二，滚动优化问题的公式化——在每个控制时刻$k$，以水位跟踪精度和控制动作平滑性为双重目标，在预测域$N_p$内求解带约束的二次规划（QP）问题；第三，可行性保障——当约束过紧导致QP无可行解时，通过松弛变量机制自动放宽非关键约束，确保算法始终给出可用的控制输出；第四，计算效率优化——利用IDZ模型的稀疏结构加速QP求解，使在线优化能够在标准工控机上实时运行。

Van Overloop还系统讨论了MPC关键参数的工程整定方法。预测域$N_p$需要足够长以覆盖系统的传播延迟，否则MPC的前瞻预测优势无法发挥——他建议$N_p$至少为最大传播延迟的1.5倍。控制域$N_c$的选择需要在控制灵活性和计算负担之间折中——他给出了基于渠段数量和延迟特性的经验公式。权重矩阵$\mathbf{Q}$和$\mathbf{R}$的整定则被转化为直观的工程参数：$\mathbf{Q}$反映"水位偏差的容许范围"，$\mathbf{R}$反映"闸门每次最大调节幅度"。这套整定方法极大降低了MPC在工程应用中的门槛，使水利工程师无需深入理解优化理论也能合理配置MPC参数。

Van Overloop的工作在荷兰和美国的多个灌区得到了验证。在荷兰的实践中，MPC展示了相比PID控制显著的水位控制精度改善和水量损失降低。这些工程效果使MPC在渠道控制领域迅速获得了广泛认可，也为后续CHS理论将MPC作为核心方法论奠定了坚实的实践基础。更深远的影响在于，Van Overloop的工作建立了"基于模型的优化控制"作为水系统运行核心方法论的地位——此前水利界对于是否需要引入"复杂的"控制方法存在广泛争议，Van Overloop用工程事实证明了MPC的必要性和优越性。

#### （2）Litrico和Fromion的理论系统化

2009年，利特里科和弗罗米翁出版了《水力系统的建模与控制》（*Modeling and Control of Hydrosystems*）[33]，从控制理论的角度系统阐述了水力系统（包括渠道和河流）的建模和控制方法。该书的独特之处在于将水力学建模与控制理论设计有机结合——先从圣维南方程出发推导传递函数模型，再基于传递函数模型进行频域分析和控制器设计。

该书的方法论贡献体现在三个层面。第一层是建模层面：Litrico和Fromion建立了从圣维南方程到传递函数的完整数学推导链路——线性化→Laplace变换→分布参数传递矩阵→有理函数近似。这一推导链路的每一步都有严格的数学证明和误差估计，使得降阶模型的精度边界是可知的、可控的。第二层是分析层面：他们利用频域工具（Bode图、Nyquist图、奇异值分解等）系统分析了明渠系统的动态特性——包括系统的带宽、相位裕度（phase margin，衡量反馈控制系统稳定性裕量的指标——值越大系统越稳定，类似于水利工程中的安全超高概念）、增益裕度和鲁棒稳定性。这些分析揭示了渠道系统作为控制对象的本质特征：低频积分特性（对缓慢扰动的累积效应）、高频衰减特性（对快速扰动的滤波效应）和纯延迟特性（水波传播的时滞效应）。

第三层是设计层面：基于频域分析结果，他们展示了如何运用鲁棒控制方法（如H∞控制、μ综合）设计渠道控制器，使控制系统在模型不确定性和外部扰动条件下仍能保持稳定性和性能。

Litrico和Fromion的工作在方法论上提供了关键理论支撑。他们证明了水力学中的圣维南方程可以在线性化和降阶的条件下转化为经典控制理论可以处理的传递函数模型，而控制理论中的频域设计方法可以直接应用于渠道系统的控制器设计。这一"水力学—控制理论"的双向桥梁的建立，是水系统运行科学与工程从经验技术走向严格理论的关键一步。该书至今仍是明渠控制领域的经典教材。值得注意的是，CHS理论的创始人雷晓辉曾在学术交流中与Litrico和Fromion深入讨论过频域方法在中国长距离调水工程中的适用性问题，这些学术对话直接影响了CHS理论中"可控模型族"概念的形成。

#### （3）ASCE MOP 131：技术成熟度的标志

2014年，美国土木工程师学会（ASCE）出版了《实践手册131：灌溉系统渠道自动化》（*Manual of Practice 131: Canal Automation for Irrigation Systems*），由Clemmens、Holly和Schuurmans等渠道控制领域的核心学者主编。MOP 131系统总结了渠道自动化控制的理论基础、算法设计、系统集成和工程实践，涵盖了从简单的PID控制到先进的MPC控制的全谱系方法。

MOP 131的出版具有里程碑意义：它标志着渠道自动化控制从学术研究走向成熟的工程实践——当一个技术领域的知识体系成熟到可以编写为"实践手册"时，说明该技术已经跨越了从实验室到工程现场的鸿沟。

MOP 131的内容架构体现了渠道控制知识体系的完整性。全书分为四个部分：第一部分"基础"涵盖水力学基础、控制理论基础和系统辨识方法，为后续内容提供理论支撑；第二部分"控制方法"系统介绍了从简单反馈控制（PID、EL-FLO）到先进控制（MPC、鲁棒控制）的全谱系方法，每种方法都给出了适用场景和性能对比；第三部分"系统集成"讨论了SCADA架构设计、通信协议选择、传感器配置和人机界面设计等工程实施问题；第四部分"案例研究"收录了澳大利亚、法国、美国和西班牙等国的典型工程案例。

从学科发展的视角来看，MOP 131的编写过程本身就是一次重要的知识整合活动。它将分散在数百篇学术论文、数十个工程项目和多个国家研究团队中的渠道控制知识，经过系统梳理和标准化处理，凝练为一部可供全球工程师直接参考使用的技术手册。这种"从论文到手册"的知识转化路径，也是CHS学科发展所追求的目标——将CHS理论的核心内容最终凝练为可操作的工程标准和技术规范。

MOP 131也为全球灌溉现代化提供了权威技术指南。该手册被翻译为多种语言，在亚洲、非洲和南美洲的灌溉现代化项目中得到广泛参考。中国的南水北调工程、胶东调水工程等大型调水项目的控制系统设计，也在一定程度上借鉴了MOP 131中的方法和经验。

#### （4）Rubicon Water的商业化成功

在工程实践方面，澳大利亚Rubicon Water公司的"全面渠道控制"（Total Channel Control, TCC）系统是渠道自动化控制商业化应用的标杆 [34]。

Rubicon Water成立于2000年代初，由前代尔夫特理工大学研究人员参与创立，其核心技术直接源自学术界的渠道控制研究成果。TCC系统的核心组件包括高精度自动化闸门（FlumeGate，集成了流量测量和水位控制功能）和基于MPC的集中控制软件平台。TCC系统在澳大利亚维多利亚州的Goulburn-Murray灌区得到了大规模应用。该灌区是澳大利亚最大的灌区之一，灌溉面积超过68万公顷，渠道总长超过6,000公里。TCC系统的部署使灌溉水利用效率从约70%提升到90%以上，每年节约的水量相当于一个中等城市的全年用水量。

TCC系统的成功具有多重意义。第一，它证明了先进控制理论在水系统运行中具有巨大的实践价值——不仅能提高运行效率，还能产生可观的经济效益（水资源节约）和环境效益（减少退水污染）。第二，它验证了"学术研究→技术转化→商业产品→大规模工程应用"的创新路径在水系统领域是可行的。第三，它为全球灌溉现代化提供了一个可复制的技术范例。目前，Rubicon的技术已推广至美国、印度、中国等多个国家。

值得关注的是，Rubicon的成功也揭示了渠道自动化控制从实验室到大规模工程部署过程中必须跨越的几道"鸿沟"。第一道鸿沟是环境鲁棒性——实验室和仿真环境中的算法在现场面临传感器噪声、通信中断、水草堵塞、泥沙淤积等恶劣条件，Rubicon为此开发了专用的自清洁闸门和抗干扰传感器系统。第二道鸿沟是规模可扩展性——从数十个闸门的单一渠段控制到数千个闸门的灌区级全网控制，计算复杂度和通信需求呈非线性增长，Rubicon采用了分层分区的控制架构来解决这一问题。第三道鸿沟是用户接受度——灌区农户和管水员对自动化系统的信任建立需要较长的过渡期，Rubicon通过"影子运行"（系统在后台运行但不实际控制，与人工操作结果对比展示）策略来逐步建立用户信任。

这些工程经验对CHS理论的发展有直接的启示意义——特别是"环境鲁棒性"映射到CHS的安全包络设计，"规模可扩展性"映射到分层分布式架构，"用户接受度"映射到WSAL的渐进式等级提升。

在中国，渠道控制技术的发展虽然起步较晚但进展迅速。2010年代以来，以中国水利水电科学研究院为核心的研究团队，在胶东调水、南水北调中线等世界级大型调水工程中积极开展MPC控制系统的研发和部署，积累了丰富的超大规模渠道控制经验。与国际上以灌区渠道（百公里级）为主要应用对象不同，中国的渠道控制面对的是千公里级的长距离调水渠道——这种规模差异不仅是量的变化，更是质的挑战：传播延迟从数小时扩展到数天，控制节点从数十个扩展到数百个，跨省跨区的管辖协调引入了行政边界这一"软约束"。正是这些中国特有的超大规模工程挑战，直接催生了CHS理论中"分层分布式控制"和"多主体协同"等核心概念。

### 2.4.3 从渠道控制到CHS的理论升华

#### （1）渠道控制的局限与扩展需求

尽管渠道控制取得了显著的技术成就，但从学科发展的角度来看，它仍然存在若干根本性的局限。

第一，对象范围的局限。渠道控制主要针对的是灌溉渠系——一类相对简单的、单向输水的水利工程。然而，现代水利工程的形态远比灌溉渠系复杂：长距离跨流域调水工程（如南水北调）涉及多水源、多通道、多目标的协调控制，一条干线上可能有数十座节制闸和数十个分水口，控制维度远超传统灌区；水力发电系统需要在发电效率、防洪安全和生态流量之间进行动态平衡，控制目标具有本质的多元性和矛盾性；城市供排水系统面临管网拓扑复杂、用户需求随机变化、水质约束严格等挑战，与灌溉渠系的"确定需求、单向输水"特征有本质差异。更进一步，当代水利工程日益呈现"网络化"趋势——单一的渠道或管道被编织成复杂的水网系统，节点之间的耦合关系远比简单的串联渠段复杂。渠道控制的理论和方法难以直接推广到这些更为复杂的水系统类型。

第二，理论框架的局限。渠道控制主要借用了工业过程控制中现成的控制理论和方法（PID、LQR、MPC等），缺乏针对水系统特殊性质的理论创新。工业过程控制的对象通常是封闭的、集中的（如化工反应釜、炼油塔），而水系统是开放的、分布式的（水流在开放的渠道或管网中流动，与大气和地下水环境持续交互）。水系统作为大规模基础设施网络，其控制问题具有许多独特的特征——超大时滞（长距离输水渠道的水流传播时间可达数天甚至数周）、强约束耦合（水位、流量、水质等多种约束相互交织）、多时间尺度（从秒级的闸门动作到季节级的水资源配置）、高安全要求（溃坝或水淹的后果可能是灾难性的）——这些特征需要发展专门的控制理论和方法来应对，简单搬用工业控制的现成工具是不够的。

第三，系统集成的局限。渠道控制主要关注的是控制算法层面的问题——如何设计一个好的控制器使水位跟踪更精确。但水系统的自主运行远不止是"设计一个好的控制器"这么简单。传感器网络如何设计才能保证系统的可观测性？通信架构如何规划才能在延迟和可靠性之间取得平衡？当传感器故障或通信中断时系统如何保障安全？调度员如何有效地监督和介入自主运行过程？运行决策如何满足合规性和可追溯性的要求？这些系统级问题在渠道控制研究中很少被系统性地讨论，但在实际工程中却是决定自主运行能否成功的关键因素。一个真正的水系统自主运行体系，需要从传感层到执行层、从算法层到治理层进行全栈设计。

#### （2）CHS的理论贡献

水系统控制论（CHS）正是在渠道控制等前期工作的基础上，通过理论创新和系统集成，形成的一个面向水系统运行的完整学科框架。CHS相对于渠道控制的理论提升，主要体现在以下几个方面。

其一，对象范围的拓展。CHS将研究对象从灌溉渠系拓展到一切具有"输水、蓄水、用水"功能的水利工程系统——包括长距离调水工程、水力发电系统、城市供排水管网、流域水资源调配系统等。这一拓展不是简单的"换一个工程背景"，而是需要建立统一的理论框架来处理不同类型水系统的共性控制问题。

其二，理论深度的提升。CHS在渠道控制的基础上，发展了若干原创性的理论贡献。这些理论贡献将在下一节（§2.5 CHS理论框架）中详细阐述，这里仅概述其与渠道控制理论的关键差异：

"六个统一"的学科结构是CHS最重要的理论创新之一。渠道控制中，水力学建模和控制器设计往往是分离的——水力学家负责建模，控制工程师负责设计控制器，两个群体使用不同的语言和工具，协作效率低下。CHS提出的"模型—控制统一"打破了这一壁垒，将建模和控制纳入同一个方法论框架。类似地，"分层—分布式统一"解决了集中式控制在大规模系统中的可扩展性问题；"数据—物理统一"融合了机理模型和数据驱动方法的各自优势；"稳态—暂态统一"实现了多时间尺度调度的协调；"确定—随机统一"将不确定性处理嵌入控制器设计的核心环节；"优化—安全统一"确保性能追求不以牺牲安全为代价。

"可控模型族"（Controllable Model Family）的建模方法论是CHS对渠道控制建模理论的系统化扩展。渠道控制中使用的ID/IDZ模型只是一种特定的降阶模型——从圣维南方程到传递函数的一条特定路径。CHS将这一思想推广为一个完整的模型族概念：从高保真的全阶模型（如圣维南方程的有限体积求解）到中等精度的降阶模型（如IDZ传递函数）再到低精度但极快速的代理模型（如神经网络代理），构成一个精度—速度折中谱系。不同的模型在不同的应用场景中发挥作用：全阶模型用于离线仿真和验证，降阶模型用于在线MPC优化，代理模型用于超实时预测和大规模蒙特卡洛评估。模型族之间的一致性验证和切换策略，是CHS建模理论的核心内容。

"水网自主等级"（WSAL, Water-network System Autonomy Level）的分级体系借鉴了自动驾驶的SAE分级思想，但针对水系统的特殊性进行了深度定制。渠道控制中虽然已经实现了一定程度的自动化，但缺乏一个清晰的分级框架来描述"自动到什么程度"以及"在什么条件下自动"。WSAL通过定义L0（人工运行）到L5（完全自主运行）的六个等级，以及每个等级对应的运行设计域（Operational Design Domain, ODD）（ODD）和安全包络（Safety Envelope），为水系统自主化提供了一个可操作的路线图和评价标准。

其三，系统架构的完善。CHS不仅关注控制算法，还提出了覆盖"感知—建模—控制—执行—监管"全链条的系统架构。渠道控制的研究范围通常止步于"算法设计"和"仿真验证"，对于算法如何在工程现场可靠运行、如何与SCADA系统集成、如何保障故障安全、如何支撑人机协作等系统级问题缺乏系统的方法论。CHS通过HydroOS（水网操作系统）这一软件载体，将控制算法、数据管理、安全保障、人机交互和运行监管集成为一个完整的软件平台，实现了从单点控制到系统级自主运行的跨越。

其四，验证方法论的创新。渠道控制中，算法的验证通常依赖于ASCE测试案例的仿真验证或小型实验渠道的现场测试。但从仿真到工程的鸿沟是巨大的——仿真中表现优异的算法在工程现场可能面临传感器噪声、通信延迟、执行器故障等诸多实际问题。CHS发展了"在回路测试"（In-Loop Testing）方法论，定义了从MIL（模型在环）到SIL（软件在环）到HIL（硬件在环）的渐进式验证流程，每一级测试逐步引入更多的真实工程因素，系统性地弥合了仿真与工程之间的鸿沟。这一方法论的灵感直接来源于航空航天领域的飞控系统验证标准（如DO-178C），但针对水系统的慢动态和大时滞特性进行了专门的定制设计。

其五，学科哲学的升华。CHS明确提出了"水系统运行科学与工程"作为一个独立学科方向的定位，不再将"运行"视为"管理"的附属，而是赋予其与"设计"和"施工"同等重要的学科地位。传统上，水利学科的核心课程体系围绕"水文学""水力学""水工结构"和"水利规划"展开——这些课程主要服务于工程的规划、设计和建设阶段，对工程建成后的运行管理缺乏系统的知识供给。CHS试图填补这一空白，为水系统运行建立从理论基础、核心方法到工程实践的完整知识体系。这一定位的变化看似形式上的调整，实则对人才培养方向、技术研发重点和产业生态格局具有深远影响。

#### （3）从渠道控制到CHS的学术传承

从学术传承的角度来看，CHS的形成可以追溯到一条清晰的学术脉络：

USBR/SCP的早期工程实验（1970s—1980s）→ Burt/Clemmens/Malaterre的算法开发与标准化（1990s）→ Schuurmans/Litrico/Fromion的建模理论化（1990s—2000s）→ Van Overloop的MPC系统化（2000s）→ ASCE MOP 131的工程成熟化（2014）→ CHS的理论体系化（2020s）。

这条脉络清晰地展示了一个学科从实践走向理论、从单点走向系统、从技术走向科学的演化历程。每一代研究者都在继承前人成果的基础上实现了质的飞跃。

值得特别关注的是这条脉络中的几个关键转折点。第一个转折点是1998年ASCE测试案例的建立——它标志着渠道控制从"各自为战"走向"标准评价"，使算法比较和技术进步有了客观的基准。第二个转折点是2006年Van Overloop的MPC系统化——它标志着渠道控制从"反馈调节"走向"预测优化"，控制方法论实现了质的跃升。第三个转折点是2014年MOP 131的出版——它标志着渠道控制从"学术研究"走向"工程实践"，技术成熟度达到了可以标准化推广的水平。第四个转折点是2020年代CHS的理论体系化——它标志着从"渠道控制"到"水系统运行科学"的学科升华，对象范围、理论深度和系统架构都实现了根本性的拓展。

在地理维度上，这条学术脉络也展现了鲜明的国际合作特征。早期的研究中心集中在美国（USBR、USDA-ARS）和法国（Cemagref/INRAE、SCP），1990年代荷兰（代尔夫特理工大学）成为重要力量，2000年代澳大利亚（Rubicon Water）通过商业化将技术推向全球市场。进入2010年代后，中国成为这一领域最活跃的研究力量之一——南水北调工程的建设和运行为渠道控制和水系统运行提供了世界上最大规模的工程实验场。CHS理论的形成，正是中国学者在继承国际渠道控制学术传统的基础上，结合中国特大型水利工程的独特挑战，实现的原创性理论贡献。

从渠道控制到CHS的演进，也为其他基础设施领域的智能化发展提供了有益的参照。电力系统从人工调度到自动发电控制（AGC）再到智能电网的演进，交通系统从人工驾驶到辅助驾驶再到自动驾驶的演进，在方法论上与水系统的演进有着深刻的相似性。CHS理论的形成过程表明，基础设施系统的智能化不是简单地"把AI算法装进来"，而是需要从系统科学的高度，建立涵盖建模、控制、验证、安全和人机协作的完整理论框架。

---

**思考与讨论**

1. （概念理解）IDZ模型的三个参数（积分增益、延迟时间、零点时间常数）分别对应渠池的什么物理特征？
2. （计算练习）一个长10km的梯形渠池，平均流速0.8m/s，底宽4m，边坡1:1.5，正常水深2.5m。请估算其主延迟时间$\tau_d$。
3. （综合设计）表2-3列出了六代渠道控制技术。如果你要为一个包含8个渠池的灌区选择控制方案，WSAL目标为L2，你会选择第几代技术？为什么？


---


---

### §2.4 本节小结


本节详述了渠道自动控制从PID到CHS的六代技术演进（表2-3）。每一代技术跃迁都由工程需求拉动：PID解决了单闸水位稳定问题，ID/IDZ模型解决了渠池动态预测问题，MPC解决了多约束优化问题，DMPC解决了大规模系统的分布式协调问题，CHS双引擎将物理优化与认知智能融合。六代演进的主线是"控制维度的递进扩展"——从单变量→多变量→多目标→多工况→多智能体→人机融合。

## 2.5 水系统控制论：理论框架的升华

> ---

> **📖 给水利工程师的速览：CHS理论解决什么问题？**
>
> 传统水利调度面临一个根本困境：每个工程都开发自己的调度系统，算法不通用、模型不互联、经验不积累。CHS（水系统控制论）试图建立一套"通用理论框架"来统一解决所有水系统的运行控制问题——就像控制论之于工业自动化、空气动力学之于飞行器设计。CHS的核心主张是：无论是南水北调的长距离输水、灌区的配水、还是城市管网的调度，都可以用"六维统一"（感知→建模→决策→执行→反馈→安全）这个统一框架来分析和设计。差异只在于每个维度内选择什么具体的模型和算法。
> ---

### 2.5.1 CHS的提出背景与历程

水系统控制论（Cybernetics of Hydro Systems, CHS）的提出，源于对水利行业一个根本性问题的深刻反思：水利工程"怎么建"有成熟的理论体系（水力学、结构力学、岩土力学等），但"怎么运行好"却缺乏一个统一的理论框架。

长期以来，水系统运行领域的研究呈现出高度碎片化的状态：水库调度属于水资源规划方向，洪水预报属于水文学方向，渠道控制属于灌溉排水方向，水质管理属于环境工程方向。这些方向各自为政，使用不同的理论语言和方法论，缺乏一个统一的学科框架来整合和协调。

雷晓辉教授在长期的跨领域工程实践中——包括南水北调中线工程调度控制、雅砻江水电梯级联合调度、福州和中山等城市供排水系统优化、长江上游防洪调度、以及生态调度和水文水动力模拟等——深刻认识到了这一问题。他发现，尽管不同类型的水系统在物理特性、工程规模和运行目标上差异巨大，但在"运行"层面却遵循相同的基本规律：都涉及感知（获取系统状态信息）、决策（根据目标和约束计算控制方案）、执行（通过闸门、泵站等执行控制动作）和反馈（根据执行效果调整决策）的闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）过程。这种跨越工程类型的共性，正是控制论所揭示的普遍规律。

2022年前后，雷晓辉教授开始系统地提出水系统控制的相关思想，探索用统一的控制论框架来描述和求解水系统运行中的各类问题。这一探索建立在他二十余年的跨领域工程实践和理论积累之上：在中国水利水电科学研究院的工作使他熟悉了水力学建模和数值仿真的核心方法；在日本筑波大学的留学经历使他接受了系统工程和控制理论的严格训练；主持南水北调东线和中线两个国家重点研发计划项目的经验使他深刻理解了超大规模水系统运行的工程复杂性。正是这种横跨水力学、控制论和工程实践的独特知识结构，使他能够识别出传统学科分割的根本问题，并提出跨学科整合的理论方案。

2025年初，他全职加入河北工程大学担任学术副校长，获得了更加专注于理论研究和学科建设的平台。同年，他正式命名了"水系统控制论（Cybernetics of Hydro Systems, CHS）"这一理论框架，并在《南水北调与水利科技》等期刊上发表了系列论文（Lei 2025a—2025d），分别从CHS理论总述、水网自主运行概念框架、在回路测试方法论和水资源系统分析四个维度展开论述，标志着这一理论体系的正式确立。与此同时，他启动了CHS理论的系统化教材编写工程，规划了覆盖入门、基础、专题和前沿四个层次的16册教材体系，旨在为水系统运行科学与工程的人才培养提供完整的知识供给。

CHS的命名本身蕴含着深刻的学科渊源。"Cybernetics"直接致敬了维纳1948年的开创性工作，表明CHS是控制论在水系统领域的系统性应用和发展。"Hydro Systems"则强调了研究对象的系统性——不是单个水库或单条渠道，而是作为整体的水系统。这一命名也将CHS与钱学森《工程控制论》的学术传统联系起来——CHS可以被视为"工程控制论"在水系统领域的当代延伸。


> **图 2-1　CHS六要素闭环架构**
> *Fig. 2-1 CHS Six-Dimensional Closed-Loop Architecture*
>
> ```
>                    ┌─────────────────────────────────────────┐
>                    │         ⑥ 人机界面（HMI）                │
>                    │   战略监督 · 异常接管 · 知识注入          │
>                    └────────┬───────────────────┬────────────┘
>                             │ 指令/确认          │ 态势呈现
>        ┌───────────────────────────────────────────────────────┐
>        │                 ⑤ 通信网络                             │
>        │   5G/光纤/卫星 · 边缘-区域-中央拓扑 · 时延补偿        │
>        └──┬──────────┬──────────┬──────────┬──────────┬───────┘
>           │          │          │          │          │
>      ┌────▼───┐ ┌────▼───┐ ┌────▼────┐ ┌──▼────┐ ┌──▼────┐
>      │① 感知  │ │② 可控  │ │③ 控制器 │ │④ 执行 │ │  反馈  │
>      │  网络  │→│ 模型族 │→│  集合   │→│ 系统  │→│  回路  │
>      └────────┘ └────────┘ └─────────┘ └───────┘ └───────┘
>       水位/流量    I/ID/IDZ   PID/MPC/    闸门/泵站   SCADA采集
>       水质/雨量    /LSV/SV    DMPC/RL     阀门/电机   →① 感知
>       视频/遥感    +专家规则  +MAS协商                 (闭环)
> ```
>
> 六要素构成"感知→建模→决策→执行→反馈"的完整闭环，人机界面贯穿全过程。


### 2.5.2 CHS的核心理论追求：六个维度的统一

CHS的核心理论追求，是用一个统一的控制论框架整合目前水利行业高度碎片化的各种细分专业和学科体系。这种统一性体现在六个维度。

**第一，多类型统一。** 调水工程、水电梯级、灌区渠系、城市供排水、流域防洪、生态调度等不同工程类型，在CHS框架下都是"水系统"，都遵循"感知→决策→执行→反馈"的闭环控制基本规律。

以南水北调中线工程和城市供水管网为例。前者是全长1432公里的长距离明渠调水工程，后者是管道、泵站、水厂组成的城市有压供水网络。两者在物理特性上差异巨大：前者是明渠重力流，时间尺度为小时至天级，控制执行器主要是节制闸；后者是有压管道流，时间尺度为分钟至小时级，控制执行器主要是加压泵和调节阀。然而，从控制论的视角来看，两者的运行问题具有本质共性：都需要感知系统状态（水位/压力、流量、水质等）、预测未来变化（需水量预测、来水预测）、计算最优控制方案（MPC优化）、执行控制动作（闸门/泵站调节）并根据反馈进行调整（滚动优化）。

再以水力发电和灌溉供水为例。前者的核心目标是发电效益最大化，后者的核心目标是供水可靠性最大化——看似完全不同的优化问题。但在CHS框架下，两者都可以统一表示为：在水量平衡约束和安全约束下，寻找执行器操作序列使目标函数最优。不同之处仅在于目标函数的具体形式（发电功率积分 vs. 供水缺口惩罚）和约束条件的具体内容（机组工况约束 vs. 渠道水位约束）。

CHS的"多类型统一"，就是提供一个通用的理论语言和方法论框架，使得不同类型水系统的运行问题能够用相同的思维方式和技术工具来分析和求解。这种统一性的实践价值在于：一套核心算法（如MPC）经过适当的参数化和定制，可以部署在多种不同类型的水系统中，大幅降低技术开发和维护成本。

**第二，多目标统一。** 防洪、供水、发电、生态、航运、水质等运行目标，在CHS框架下统一表示为多目标优化控制问题。

以三峡水库为例，其防洪、发电、航运、供水、生态等功能之间存在复杂的竞争与协调关系。在传统碎片化研究模式下，这些目标由不同部门和研究团队分别处理。CHS的多目标统一将所有目标纳入同一个控制论框架，表示为目标函数和约束条件，通过帕累托多目标优化方法系统求解。

**第三，多尺度统一。** 从秒级的实时闸泵控制，到小时级的防洪调度，到月/年级的水资源配置，在CHS框架下都是不同时间尺度的控制问题。

传统上，这些不同时间尺度的问题分属不同学科方向，使用完全不同的方法论：实时控制属于自动化方向，短期调度属于运筹学方向，长期规划属于水资源规划方向。这种学科分割导致了一个普遍存在的问题——不同时间尺度的决策之间缺乏有效衔接。例如，年度水资源配置方案可能没有考虑日级调度的实际可操作性，而日级调度方案又可能偏离年度配置的整体意图。

CHS的多尺度统一通过分层控制架构来实现：上层（战略层）处理长期水资源配置问题，其输出（如月度或旬度的水量分配方案）作为中层（战术层）短期调度的约束和目标；中层处理日级或实时调度问题，其输出（如小时级的闸门操作序列）传递给下层（执行层）的实时控制。各层之间通过标准化的接口进行信息传递和目标分解，形成一个多尺度协同的控制体系。

更深层次的统一体现在方法论上。CHS认为，无论时间尺度如何，运行问题的本质都是"在约束条件下寻找最优决策"——区别仅在于决策变量的粒度（年度水量 vs. 实时闸门开度）、约束条件的类型（水权分配 vs. 水位安全限）和目标函数的形式（年供水保证率 vs. 瞬时水位偏差）。MPC方法的滚动优化思想天然地适用于多种时间尺度——改变预测域的长度和控制域的步长，同一套MPC框架就可以在不同的时间尺度上运行。

**第四，多主体统一。** 从单个闸门的本地控制器，到区域调度中心，到流域级决策机构，在CHS框架下都是多智能体系统（Multi-Agent System, MAS）中的"智能体"。

水系统的运行决策通常涉及多个决策主体，这些主体可能有不同的利益诉求和信息集合。以南水北调中线工程为例，水源区丹江口水库的管理方关注水库蓄水效益，总干渠的各分水口门管理方关注取水保障率，沿线地方政府关注防洪安全和生态用水——这些主体的利益并不总是一致的。在极端枯水年份，水库管理方倾向于蓄水，而下游用水户需要放水，产生直接的利益冲突。传统的集中式调度模式通过行政命令来解决这种冲突——但当系统规模扩大到覆盖多个省市、涉及数百个利益相关方时，纯行政协调的效率和精度都难以保证。CHS的多主体统一通过MAS理论框架来实现：每个控制节点被建模为一个具有局部信息、局部目标和局部决策能力的智能体，通过智能体之间的通信和协商来实现全局协调。

协商机制可以是合同网协议（Contract Net Protocol，适用于任务分配场景）、拍卖机制（适用于水权交易场景）或纳什谈判（适用于利益平衡场景）。这一框架既能处理集中式决策场景，也能处理分布式协商场景，为水系统运行的组织形式提供了灵活的理论支持。

**第五，知识表示统一。** 将物理模型（机理方程）、数据模型（机器学习）和经验模型（专家规则）统一为"可控模型族"。

传统上，水系统运行中使用的模型种类繁多——水力学模型、水文模型、统计模型、神经网络模型等，各有特点和适用范围。更突出的问题是，调度专家的经验知识往往以"规则"或"惯例"的形式存在于人的头脑中，无法被形式化地纳入任何数学模型——例如"冰期来临前三天开始预降水位"这样的经验规则，在传统的优化模型中找不到自然的表达位置。CHS提出"可控模型族"的概念，不仅将数学模型按照精度和计算代价的层次排列，形成一个从高阶（圣维南方程（Saint-Venant equations，描述明渠水流运动的基本方程，由连续性方程和动量方程组成）全模型）到中阶（IDZ传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）模型）再到低阶（线性代理模型）的模型谱系，更将专家经验编码为形式化的规则库，作为模型族中"定性知识"维度的组成部分。

控制器设计者可以根据控制需求和计算资源从中选取最合适的模型。在运行过程中，系统可以根据工况的复杂程度动态切换模型精度等级，实现精度与效率的最优平衡。


> **表 2-1　CHS可控模型族层次体系**
> *Table 2-1 CHS Controllable Model Family Hierarchy*
>
> | 层级 | 模型名称 | 数学形式 | 计算速度 | 精度 | 典型应用场景 |
> |:----:|:--------:|:--------:|:--------:|:----:|:------------|
> | L1 | 积分（I）模型 | 一阶积分环节 | ★★★★★ | ★ | 参数灵敏度分析、初步设计 |
> | L2 | 积分-延迟（ID）模型 | 积分+纯延迟 | ★★★★☆ | ★★ | 快速参数扫描、离线预筛选 |
> | L3 | 积分-延迟-零点（IDZ）模型 | 二阶传递函数+延迟 | ★★★☆☆ | ★★★ | **实时MPC优化（主力模型）** |
> | L4 | 线性圣维南（LSV）模型 | 线性化偏微分方程 | ★★☆☆☆ | ★★★★ | 高保真验证、安全包络计算 |
> | L5 | 完整圣维南（SV）模型 | 非线性偏微分方程 | ★☆☆☆☆ | ★★★★★ | 洪水风险评估、极端工况仿真 |
> | — | 专家规则库 | IF-THEN规则+模糊逻辑 | ★★★★★ | 定性 | 冰期预判、异常工况识别 |


这种动态切换的实际场景是：在日常平稳运行中，系统使用低阶代理模型进行快速实时控制，计算速度快但精度有限；当检测到异常工况（如上游突发来水增加）时，系统自动切换到中阶IDZ模型以获得更准确的预测；在需要进行洪水风险评估或复杂调度方案优化时，系统调用高阶圣维南全模型进行精细仿真。整个切换过程对上层控制算法透明——这正是HydroOS"模型即服务"架构的理论基础。

**第六，分层分布式统一。** 将水系统的控制架构统一为"分层分布式"范式。

水系统天然具有层次结构——从单个闸泵到渠段/管段，到干线/支线，到全系统/全流域。CHS将这种天然的层次结构映射为分层分布式控制（HDC）架构，在每一层设置相应的控制逻辑，通过层间的信息传递和目标分解实现全局协调。HDC架构的优势在于它同时兼顾了全局最优性（通过自上而下的目标分解）和局部自主性（每一层可以独立处理其能力范围内的问题），是应对大规模水系统控制问题的有效框架。

### 2.5.3 CHS的八原理体系

在"六个统一"的基础上，CHS进一步凝练了支撑水系统自主运行的八条基本原理：

| 原理序号 | 原理名称 | 核心内涵 |
|:---------|:---------|:---------|
| 原理一 | 传递函数化 | 将水系统的物理过程转化为控制理论可用的传递函数或状态空间（state space，用一组状态变量——如各断面水位和流量——来完整描述系统在任意时刻行为的数学框架）模型 |
| 原理二 | 可控可观性 | 在部署控制算法之前，先诊断系统的可控性和可观性，识别结构性瓶颈 |
| 原理三 | 安全包络 | 为系统定义刚性安全边界，确保在任何工况下都不突破关键安全指标 |
| 原理四 | 分层分布式 | 采用多层次、多节点的分布式控制架构，兼顾全局协调和局部自主 |
| 原理五 | 多目标协同 | 在统一的优化框架下处理多个相互竞争的运行目标 |
| 原理六 | 数据物理融合 | 将物理机理模型与数据驱动方法有机结合，发挥各自优势 |
| 原理七 | 人机共融 | 根据自主等级定义人与机器的职责分配，实现平滑的人机协作过渡 |
| 原理八 | 自主演进 | 系统具备从运行经验中持续学习的能力，逐步提升自主等级 |

以下对八条原理逐一展开阐述。

**原理一：传递函数化。** 这是CHS全部方法论的基石。水系统的物理过程由偏微分方程（如圣维南方程、管网水力方程）描述，这些方程虽然物理意义明确，但由于非线性和分布参数特性，无法直接用于控制器设计。"传递函数化"要求将这些复杂的物理模型通过线性化、降阶和离散化等步骤，转化为控制理论可以直接处理的传递函数或状态空间模型。以明渠系统为例，圣维南方程经过线性化和频域近似后，可以转化为IDZ传递函数模型（见§2.4）；以管网系统为例，管网水力方程经过线性化后可以转化为节点压力—管段流量的状态空间模型。传递函数化不是对物理模型的"简化"或"近似"——它是一种系统化的"翻译"，将水力学家的语言翻译为控制工程师的语言，使得两个学科能够在同一个数学框架下对话和协作。

CHS进一步提出了"可控模型族"的概念，将不同精度等级的模型组织为一个层次化的模型体系，在不同应用场景中选用最合适的模型层级。

**原理二：可控可观性诊断。** 在部署任何控制算法之前，必须先回答一个根本性问题：这个系统在结构上是否可控？系统的状态是否可观？如果一个水系统在某些工况下结构不可控（即无论如何调节闸门都无法将水位调到目标值），或者结构不可观（即现有的传感器无法提供足够的信息来推断系统的完整状态），那么再先进的控制算法也无济于事。可控可观性诊断是对"硬件是否就绪"的系统性评估。在工程实践中，这一原理要求在控制系统设计之前，先进行可控性分析（判断执行器配置是否充分）和可观性分析（判断传感器配置是否充分），如果存在可控性或可观性缺陷，应首先通过增加执行器或传感器来解决结构性问题，而不是试图用更复杂的算法来弥补硬件的不足。

这一"先诊断、后设计"的思路，在水利行业中具有重要的实践指导意义——许多水利工程的控制效果不佳，根本原因不在于算法不够先进，而在于传感器布局不合理或执行器配置不充分。

**原理三：安全包络。** 安全包络（Safety Envelope）是一组在任何情况下都不得违反的刚性约束集合，数学上表示为：$\mathbf{x}(t) \in \mathcal{X}_{safe}, \forall t$。安全包络的设计遵循"防御性设计"理念——即使控制算法出现故障、模型出现偏差或通信出现中断，系统的状态也不应超出安全包络的边界。在水系统中，安全包络通常包括水位上下限（防止溢流或干渠）、流速范围（防止冲刷或淤积）、水质阈值（防止水质恶化）和设备运行边界（防止设备损坏）。

安全包络的设计需要考虑最不利工况下的极端情形——例如，在冰期运行条件下，南水北调中线工程的安全包络比常规工况更为严格，不仅包括水位约束，还包括流速范围约束和冰盖厚度约束。安全包络是CHS理论中"安全优先"思想的数学化表达，也是系统能够获得公众信任和监管认可的前提条件。

**原理四：分层分布式。** 大规模水系统的控制不可能由一个集中式控制器来完成——超长距离的信息传输延迟、超高维度的优化计算复杂度和单点故障的系统可靠性风险，都要求采用分层分布式架构。CHS将水系统的控制架构划分为多个层级：底层（L0）负责单个执行器的本地控制，响应速度为秒级；中层（L1）负责局部区域的协调控制，响应速度为分钟级；上层（L2）负责全系统的优化调度，响应速度为小时级到天级。各层之间通过标准化的接口传递信息和指令：自上而下传递目标和约束，自下而上传递状态和报告。分层分布式架构的关键优势在于"降维"——将一个不可求解的大规模全局优化问题，分解为多个可以高效求解的小规模局部优化问题，同时通过层间协调保持全局一致性。

**原理五：多目标协同。** 水系统运行几乎总是面临多个相互竞争的目标——供水可靠性与节水效率、发电效益与防洪安全、运行经济性与环境生态性。CHS将多目标问题统一表示为带约束的多目标优化问题，通过帕累托最优（Pareto Optimality）的概念来处理目标之间的折中。在工程实施中，多目标协同通常通过加权目标函数法（将多个目标加权求和为单一目标）或字典序法（按优先级依次优化）来实现，权重系数可以根据季节、工况和管理需求动态调整。

**原理六：数据物理融合。** 纯物理模型（如圣维南方程）具有明确的物理意义和良好的外推能力，但参数标定困难、计算成本高；纯数据模型（如神经网络）训练方便、计算快速，但缺乏物理一致性保障且外推能力不足。CHS倡导将两者有机融合——用物理模型提供结构约束和先验知识，用数据模型补偿物理模型的残差和不确定性。典型的融合方式包括：物理引导的神经网络（Physics-Informed Neural Networks, PINNs）、基于物理模型的残差学习、物理约束下的强化学习等。数据物理融合不是简单的"两个模型并行运行"，而是在数学上实现深度耦合——物理方程作为神经网络的损失函数约束，数据驱动的参数辨识反过来校正物理模型的不确定参数。

**原理七：人机共融。** 在当前技术条件下，完全取代人的判断和决策既不现实也不明智。CHS提出的人机共融原理，通过WSAL分级体系（见§2.5.4）来定义不同自主等级下人与机器的职责边界。在低自主等级（L0—L1），人是主要的决策者，机器提供信息支持；在中等自主等级（L2—L3），机器在限定条件下自主决策，人负责监督和异常处置；在高自主等级（L4—L5），机器处理绝大部分决策，人仅做战略级指导。人机共融的设计需要同时考虑技术因素（系统能做什么）和人因工程因素（人如何有效地监督和介入），避免两个极端——过度依赖自动化导致人的"技能退化"（De-skilling），或过度依赖人工导致自动化优势无法发挥。

**原理八：自主演进。** 水系统的运行环境不是静态的——气候变化导致水文特性发生变化，工程老化导致设备参数发生漂移，用水需求变化导致运行目标发生调整。CHS的自主演进原理要求系统具备从运行经验中持续学习和适应的能力。具体机制包括：在线参数辨识（根据运行数据实时更新模型参数）、案例库学习（将成功处置的异常工况记录为案例，扩充系统的处置能力）、策略进化（根据运行绩效评估结果优化控制策略参数）和ODD扩展（在验证安全的前提下逐步扩大自主运行的工况范围）。自主演进是CHS与传统自动化控制的根本区别——传统自动化系统的行为在上线后基本固定，而CHS系统则具备"越运行越聪明"的自我进化能力。

以水力模型参数的在线辨识为具体例子。一条调水渠道的糙率系数会随着季节变化（夏季生物附着增加糙率、冬季冰盖改变流态）和工程老化（混凝土表面逐渐粗糙化）而缓慢变化。传统做法是每年进行一到两次的人工率定——派遣技术人员到现场测量，然后手动修正模型参数。CHS的自主演进机制则利用常态化的水位和流量监测数据，通过扩展卡尔曼滤波（EKF）或集合卡尔曼滤波（EnKF）在线实时辨识糙率参数——模型参数随物理系统的变化而自动更新，无需人工干预。更进一步，如果系统在运行中遇到了前所未有的极端工况（如百年一遇的特大洪水），该事件的完整记录——包括传感器数据、模型预测、控制动作和最终效果——将被自动归档到案例库中。

下一次遇到类似工况时，系统可以检索相关案例作为决策参考，而不必完全依赖物理模型的外推能力。这种"案例+模型"的混合决策机制，使系统的能力边界随运行经验的积累而不断扩展。

八原理之间并非平行并列的关系，而是具有明确的依赖和递进逻辑。原理一至三构成"可计算、可设计、可验证"的基础底座——如果一个水系统的控制模型无法建立（违反原理一），或者系统在结构上不可控不可观（违反原理二），或者缺乏安全保障机制（违反原理三），那么后续的一切高阶能力都无从谈起。原理四至六构成"从单点到系统、从单一到融合"的方法扩展层——分层分布式架构解决了规模问题，多目标协同解决了目标冲突问题，数据物理融合解决了模型精度与效率的折中问题。原理七至八构成"从自动到自主"的能力跃迁层——人机共融定义了当前阶段的运行模式，自主演进描绘了未来的发展方向。

这种分层递进的结构，确保了CHS理论体系的工程可落地性——不是一步到位地追求完全自主运行（L5），而是从基础底座开始，逐层积累，渐进演化。

### 2.5.4 水网自主等级（WSAL）

CHS的另一个核心贡献是提出了水网自主等级（Water-network System Autonomy Level, WSAL）分级体系，将水网运行的自主化程度分为L0至L5六个等级：

| 等级 | 名称 | 描述 | 人机关系 |
|:-----|:-----|:-----|:---------|
| L0 | 人工运行 | 完全人工观测、人工决策、人工操作 | 人执行一切 |
| L1 | 辅助运行 | SCADA提供监测信息，人工决策和操作，部分本地自动控制 | 人决策，机器辅助信息 |
| L2 | 部分自主 | 系统在正常工况下自动运行特定任务，人监督并随时接管 | 人监督，机器执行常规 |
| L3 | 条件自主 | 在定义的ODD内自主运行，超出ODD时请求人工接管 | 人待命，机器自主运行 |
| L4 | 高度自主 | 在更广泛的ODD内自主运行，自动处理多数异常 | 人远程监督 |
| L5 | 完全自主 | 在所有工况下自主运行，无需人工干预 | 人仅做战略决策 |

WSAL的灵感来自自动驾驶领域的SAE J3016分级标准，但针对水系统的特殊性进行了重要调整。与自动驾驶的SAE分级相比，WSAL的关键差异在于：

第一，WSAL引入了"运行设计域"（Operational Design Domain, ODD）的概念。ODD定义了系统可以自主运行的条件范围——包括水文条件（流量范围、水位范围）、气象条件（是否冰期）、设备状态（哪些闸门可用）和安全约束（最高/最低水位）。系统只在ODD范围内自主运行；一旦超出ODD，自动进入"最小风险状态"并请求人工接管。ODD的定义不是一成不变的——随着系统运行经验的积累和算法能力的提升，ODD可以逐步扩展，从而实现自主等级的渐进提升。

以南水北调中线工程为例，其当前的ODD可能定义为："设计流量的30%至100%范围内、非冰期、所有关键闸门正常工作、通信链路完好"。在这一ODD范围内，系统以L3等级自主运行。当进入冰期（超出ODD的气象条件）或发生关键闸门故障（超出ODD的设备条件）时，系统自动降级到L1或L2，增加人工干预比例。随着冰期控制算法的成熟和验证，冰期工况可以逐步纳入ODD，实现从"冰期需要人工接管"到"冰期也能自主运行"的能力提升。

第二，WSAL的"安全包络"（Safety Envelope）是一个刚性约束集合，满足$\mathcal{X}_{safe} \subseteq \mathcal{X}_{ODD}$。安全包络不是"建议值"或"参考值"，而是系统在任何情况下都不得突破的绝对边界。安全包络的实施机制是多层次的：控制算法在优化求解时将安全包络作为硬约束纳入；即使优化算法输出了超出安全包络的指令，执行层的安全联锁机制也会拦截并拒绝执行；即使联锁机制失效，物理层面的安全设施（如溢洪道、退水闸）也会作为最后一道防线发挥作用。这种多层次的安全保障机制，体现了"纵深防御"（Defense in Depth）的安全设计理念。

第三，WSAL考虑了水系统特有的多时间尺度特性。水系统的运行决策跨越从秒级（闸门控制）到季节级（水资源配置）的多个时间尺度，在不同时间尺度上的自主等级可以不同——例如，一个系统在秒级的闸门控制上可能达到L3，但在季节级的水资源配置上仍处于L1。这种"分时标分级"的设计，比自动驾驶的单一分级更加灵活，也更符合水系统运行的实际需求。

第四，WSAL的分级评估需要配套的量化指标体系。CHS建议从四个维度评估自主等级：自主决策覆盖率（系统自主处理的决策比例）、安全包络保持率（系统状态保持在安全包络内的时间比例）、人工干预频率（单位时间内需要人工介入的次数）和故障恢复时间（从检测到异常到恢复正常运行的时间）。这四个指标分别从能力、安全、人机协作和韧性四个角度刻画了系统的自主运行水平。

当前，全球大多数水利工程处于WSAL L1至L2水平——SCADA系统提供监测信息，部分闸门实现了本地自动控制，但调度决策仍主要依赖人工。少数先进系统达到了L2至L3水平，如胶东调水工程的SCADA+HDC系统在正常输水工况下已实现条件自主（L3），荷兰Maeslantkering风暴潮屏障在特定触发条件下可自主关闭闸门（L3）。达到L4及以上水平，需要在模型精度、异常处理能力、安全保障机制和社会信任建设等方面取得根本性突破，是CHS的长期研究目标。

WSAL分级体系的一个重要配套需求是建立系统化的等级认证和验证方法论。与自动驾驶领域已形成较为成熟的测试评价标准（如EURO NCAP、ISO 21448 SOTIF）不同，水利领域目前尚无类似的自主等级认证框架。CHS提出了基于xIL（在回路测试）的验证方法论：L2认证要求通过MIL（模型在回路）仿真验证在所有预设工况下控制算法的正确性和安全性；L3认证要求在MIL基础上增加SIL（软件在回路）验证，确认算法在真实软件环境中的运行时序、通信延迟和异常处理能力；L4认证则要求进一步通过HIL（硬件在回路）验证，在半实物仿真环境中测试算法与真实PLC、RTU和通信网络的兼容性和可靠性。

每一级的认证都要求比前一级更广泛的ODD覆盖和更严格的安全保障指标——这种"渐进认证、逐级放权"的方法论，借鉴了航空适航认证（DO-178C）的成熟思路，但根据水系统的时间尺度和空间分布特性进行了适当简化，确保在安全可控的前提下推进自主化进程。

## 2.6 CHS与水信息学的辨析

CHS（水系统控制论）和水信息学（Hydroinformatics）都关注信息技术在水系统中的应用，但二者在学科定位、理论内核和方法论上存在本质差异。厘清二者的关系，对于理解水系统运行科学与工程的学科结构提供了关键理论支撑。这一辨析不是为了在两个方向之间分高下，而是为了帮助研究者和工程师正确地定位自己的工作，选择合适的理论工具。

### 2.6.1 学科定位与历史渊源的差异

水信息学的创始人迈克尔·阿博特（Michael B. Abbott）在1991年正式提出了"Hydroinformatics"的概念，并在随后的著作中系统阐述了这一学科的内涵和外延。阿博特将水信息学定义为信息技术在水科学与水工程中的应用，其产生的直接背景是20世纪80-90年代信息技术革命对水利行业的冲击——计算机图形学使得水力学仿真结果可以可视化展示，互联网技术使得水文数据可以远程共享，数据库技术使得海量的观测数据可以高效管理。水信息学的核心关注点是"信息"——如何获取、传输、存储、处理和可视化水系统的信息。其方法论主要来源于计算机科学和信息科学，包括数据库管理、网络通信、人机交互、软件工程等。

CHS的学科定位则是水系统运行的"基础理论学科"——它不仅仅是将某种已有的理论或技术"应用于"水系统，而是要针对水系统运行的特殊需求，发展专门的理论框架和方法论。CHS的核心关注点是"控制"——如何使水系统在复杂多变的环境中实现安全、高效、可持续的运行。其方法论主要来源于控制科学、系统科学和优化理论，包括反馈控制、模型预测控制、分布式优化、鲁棒（robust，指系统在参数变化或外部干扰下仍能保持稳定性能的能力，类似于水利工程中的'抗干扰性'）控制、自适应控制等。

从方法论特征上看，两者的差异可以从以下维度来把握：水信息学倾向于"数据驱动"的研究范式——强调从大量观测数据中提取规律和知识，方法上偏重统计分析、机器学习和数据挖掘。CHS倾向于"模型驱动"与"数据增强"相结合的研究范式——以物理模型（如圣维南方程、IDZ模型）为核心，用数据方法对模型进行校正和增强，方法上偏重动力学建模、最优控制和系统辨识。这一差异并非绝对——两个方向在技术实践中都在走向"模型+数据"的融合，但在理论出发点和方法论偏好上仍有明确的分野。

### 2.6.2 一个类比：驾驶与仪表盘

CHS和水信息学的关系，可以用"驾驶"与"仪表盘"的类比来理解。CHS关注的是"如何驾驶"——控制策略、决策逻辑、安全保障、人机分工，相当于方向盘、油门和刹车。水信息学关注的是"仪表盘和导航系统"——如何为驾驶员提供速度、油量、路线等信息。两者缺一不可，共同服务于"安全高效地到达目的地"这一最终目标。

但必须指出的是，在一辆汽车中，"驾驶系统"（动力总成、转向系统、制动系统）的理论基础——力学、控制理论——是独立于"仪表系统"（传感器、显示器、通信模块）的理论基础——电子学、信息论——而存在的。同样，CHS的理论内核（控制论、优化理论、系统科学）独立于水信息学的技术基础（数据库、通信协议、人机界面）。二者在应用中深度融合，但在理论上各有独立的学科根基。

### 2.6.3 各自在水系统运行中的角色

在水系统运行科学与工程的学科架构中，CHS和水信息学各有明确的角色定位：

CHS（水系统控制论）是理论内核——它提供了水系统运行的基本范式（闭环控制）、理论框架（六个统一、八原理）和方法论体系（从PID到MPC到MAS再到自主运行）。CHS回答的是"为什么这样控制"和"如何最优地控制"的理论问题。

水信息学（Hydroinformatics）是技术支撑——它提供了实现闭环控制所需的信息技术工具和平台，包括数据采集与传输、信息融合与处理、模型集成与可视化、决策支持与人机交互等。水信息学回答的是"用什么技术手段来实现"的工程问题。

这一定位并非贬低水信息学的价值——事实上，没有水信息学提供的信息技术支撑，CHS的理论再完美也无法落地。就像没有发动机管理系统（ECU），再好的发动机设计也无法高效运行。两个方向是互补共生的关系，共同构成水系统运行科学与工程的完整学科体系。

从发展趋势来看，CHS和水信息学都在向彼此的传统领地"渗透"：水信息学从最初关注数据管理和可视化，越来越多地涉及预测建模和决策支持，已开始触及控制和优化的问题边界；CHS从最初聚焦于物理建模和控制算法设计，越来越多地引入机器学习和大数据分析方法，深度融入了信息技术的成果。这种双向渗透是学科进步的自然结果，但它不意味着两个方向将最终合并——正如电气工程和计算机科学虽然密切交叉但始终保持各自的学科独立性一样，CHS和水信息学在理论内核和方法论传统上的根本差异决定了它们将长期并存、协同发展。

需要再次强调的是，在学科层级上，水信息学作为一个应用层面的交叉方向，不与系统科学、控制科学、人工智能这三大基础性理论支柱并列。CHS从控制科学出发，以系统科学为认识论基础，以人工智能为技术赋能，三者共同构成了水系统运行科学与工程的理论根基。水信息学则在这一理论根基之上，提供了面向工程实现的技术方案和集成平台。这一层次关系的厘清，对于水系统运行学科体系的健康发展提供了关键理论支撑。

> **概念辨析框：CHS vs 水信息学 vs 智慧水利**
> *Concept Clarification: CHS vs Hydroinformatics vs Smart Water*
>
> | 维度 | CHS（水系统控制论） | 水信息学 | 智慧水利 |
> |:----:|:-------------------:|:--------:|:--------:|
> | **学科性质** | 基础理论学科 | 交叉应用方向 | 工程实践领域 |
> | **核心问题** | "如何最优控制？" | "如何高效处理信息？" | "如何用IT改善管理？" |
> | **理论内核** | 控制论+系统科学 | 信息论+计算科学 | 无统一理论 |
> | **方法论** | 闭环控制、MPC、安全包络 | 数据融合、可视化、GIS | 项目集成、平台建设 |
> | **类比** | 汽车的驾驶系统 | 汽车的仪表盘 | 整辆车的售后服务 |
> | **与WSAL关系** | 定义WSAL等级标准 | 提供L1-L2的数据基础 | L1-L2的工程实现 |

---

**思考与讨论**

1. （概念理解）CHS"六维统一"架构的六个维度是什么？它们之间的信息流关系是怎样的？
2. （分析比较）CHS可控模型族的五层金字塔（I→ID→IDZ→LSV→SV）中，每一层比上一层多了什么建模能力？在什么场景下需要使用更高层级的模型？
3. （批判思考）CHS框架与水信息学的学科边界是否清晰？请用概念辨析框中的维度对比进行论证。


---


---

### §2.5 本节小结


本节系统阐述了CHS（水系统控制论）的理论框架。CHS以"六维统一"（感知、建模、决策、执行、反馈、安全）为架构核心，以"八大原理"（闭环、分层、降阶、安全包络、ODD、可控模型族、人机共融、渐进验证）为方法论支柱，以"可控模型族"（I→ID→IDZ→LSV→SV五层金字塔）为建模体系。CHS的理论贡献在于：首次将水系统运行从"工程实践"提升为具有完整理论体系的"科学学科"。

## 2.6 HydroOS的诞生：从SCADA到水网操作系统

理论框架需要软件载体才能落地。CHS的六要素架构、五级模型族、WSAL分级体系和xIL验证方法，如果没有一个统一的软件平台来承载和实现，就只能停留在论文和教科书中。HydroOS（Hydro Operating System，水网操作系统）正是在这一认识驱动下诞生的——它不仅是一个软件系统，更是CHS理论从学术研究走向工程实践的关键桥梁。本节从水利软件发展的历史脉络出发，追溯HydroOS的设计思想渊源和诞生历程。

### 2.6.1 水利软件的困境与反思

水利行业的软件发展长期面临一个深层悖论：一方面，水利系统的运行管理高度依赖软件（从SCADA到水力模型到调度系统），软件在事实上已经成为水利基础设施的核心组成部分；另一方面，水利行业对软件工程的重视程度远不如建筑结构或水力设计——水利软件的开发往往缺乏系统性的架构设计，代码质量参差不齐，文档匮乏，可维护性差。

这一悖论的后果在工程实践中表现得极为突出。在中国水利信息化建设的二十余年中，"重建设、轻运维"的问题始终存在。大量投资建设的信息化系统，在项目验收后的运行维护投入严重不足，导致系统逐渐退化。有调研显示，约30%的水利信息化项目在建成3-5年后功能显著退化，部分系统甚至完全废弃。造成这一问题的原因是多方面的：建设单位缺乏专业的软件运维团队，系统供应商在项目验收后缺乏持续服务的动力，定制开发的系统技术栈封闭、升级困难——但根本原因在于，行业缺乏一个标准化的软件架构和开发范式，每个项目都从零开始"造轮子"，导致知识和代码无法在项目间有效传承和复用。

在国际上，水利/水务软件市场长期由少数几家公司主导：DHI的MIKE系列（水力/水文模拟）、Innovyze（现属Autodesk）的InfoWorks系列（城市水务建模）、Bentley Systems的WaterGEMS/HAMMER系列（管网分析）、EPANET（美国EPA开源管网模拟）等。这些软件工具在各自的专业领域内功能强大，但它们之间的互操作性很差——每个软件有自己的数据格式、模型表达和用户界面，将不同软件的功能集成到一个统一的运行管理平台中是一项极其艰巨的系统集成工作。

更根本的问题在于，这些传统水利软件的设计范式是"仿真工具"而非"运行系统"。它们被设计用来离线分析——工程师输入数据，运行模型，查看结果，调整参数，再次运行——这是一个"人在回路中"的迭代过程。但水系统的自主运行需要的不是离线仿真工具，而是实时运行平台——模型需要自动从传感器获取数据，自动执行状态估计和预测，自动运行优化算法，自动生成控制指令并下发到执行器——整个过程在毫秒到分钟的时间尺度内闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）完成，无需人工干预。这种从"离线仿真工具"到"在线运行平台"的范式转变，需要对软件架构进行根本性的重新设计。

### 2.6.2 操作系统范式的启示

HydroOS的命名——"水网操作系统"——并非一个随意的比喻，而是对计算机操作系统设计哲学的深层借鉴。回顾计算机操作系统的诞生史，可以发现水利软件当前面临的困境与早期计算机软件面临的困境惊人地相似。

在计算机操作系统出现之前（1950年代），每个程序都需要直接与硬件打交道——程序员必须了解具体的CPU指令集、内存地址映射和I/O端口分配，程序在不同机器之间几乎无法移植。当硬件变得越来越复杂、应用需求越来越多样时，这种"每个程序自己管硬件"的模式变得不可持续——操作系统应运而生。操作系统的核心贡献是"抽象"——它将硬件的复杂性和异质性封装起来，向上层应用程序提供统一的接口（文件系统、进程管理、内存管理、设备驱动），使得应用程序开发者可以专注于业务逻辑，无需关心底层硬件细节。

水利系统面临的局面与此高度类似。传感器品牌五花八门（Siemens、Endress+Hauser、横河电机、国产各厂商），通信协议各不相同（Modbus RTU/TCP、HART、PROFIBUS、OPC UA、MQTT），PLC/RTU型号繁多（Siemens S7系列、Allen-Bradley、ABB、施耐德），SCADA平台各有不同（iFIX、WinCC、CITECT、InTouch）。每个水利信息化项目都需要耗费大量时间和精力来处理这些底层异构性问题——从传感器数据接入、协议转换到SCADA平台配置，通常占到项目实施周期的30%以上。更严重的是，当需要升级或替换某个底层设备时，上层应用软件往往需要大量修改——底层的任何变动都会"穿透"到上层，导致维护成本居高不下。

HydroOS借鉴计算机操作系统的设计思想，在水网物理设备和上层智能应用之间建立了一个"抽象层"。这个抽象层将底层设备的异质性封装起来，向上层提供统一的API：不论传感器是什么品牌、用什么协议，上层应用调用`getSensorReading(sensorId)`即可获取标准化的量测数据；不论闸门的执行机构是电动的还是液压的，上层控制算法调用`setGatePosition(gateId, position)`即可下达控制指令。这种"设备无关"的接口设计，使得控制算法的开发者可以完全专注于算法逻辑本身，无需关心具体的硬件实现细节——正如应用程序开发者使用文件系统API而无需了解磁盘的物理扇区结构。

操作系统的另一个核心功能——进程调度——同样可以在水网运行中找到精确的对应。操作系统内核需要在多个竞争CPU资源的进程之间进行优先级排序和时间片分配：实时进程（如音频播放）必须获得最高优先级以保证低延迟，后台进程（如文件索引）可以使用空闲资源。类似地，HydroOS需要在多个竞争水资源和计算资源的控制任务之间进行协调：防洪控制（相当于实时进程）必须获得最高优先级，其指令在毫秒级别生成并下发；水量调配优化（相当于普通进程）可以在分钟级时间窗口内求解；长期规划分析（相当于后台进程）则可以利用系统空闲时段的计算资源。HydroOS的任务调度器（Task Scheduler）正是借鉴了操作系统的优先级抢占和时间片轮转机制，实现了多任务、多优先级的控制计算资源管理。

更进一步，操作系统的"虚拟内存"概念——通过页面置换将有限的物理内存扩展为更大的虚拟地址空间——在HydroOS中的对应是"虚拟传感器"技术：当物理传感器覆盖不足时，通过数据同化和状态估计算法，利用水力模型"虚拟"出未布设传感器位置的状态量测。这些虚拟传感器对上层控制算法完全透明——算法无需区分数据来自物理传感器还是虚拟传感器，就像应用程序无需区分数据在物理内存还是交换空间中一样。

Unix操作系统的"一切皆文件"（Everything is a File）哲学是计算机科学史上最伟大的抽象之一——键盘、显示器、网络连接、进程间通信，都通过统一的文件接口来访问。HydroOS借鉴这一哲学，提出了"一切皆CHS六要素"的统一抽象：传感器、模型、控制器、执行器、通信链路和人机界面，都通过CHS六要素架构中对应的标准化接口来访问和管理。这一统一抽象的意义在于：它不仅简化了系统的接口设计，更重要的是它提供了一个与CHS理论一致的概念框架——使得软件架构和理论框架形成了映射关系，理论上的每一个概念都可以在软件中找到对应的实体。

### 2.6.3 从工程需求到系统设计

HydroOS的设计并非始于白纸上的架构规划，而是从多年的工程实践中逐步抽象和提炼出来的。在胶东调水、南水北调中线、沙坪水电梯级等重大工程的实施过程中，团队反复遇到的共性问题——设备接入的异构性、模型与控制的割裂、离线仿真与在线运行的断层、单体架构的扩展性瓶颈——最终催生了对一个统一软件平台的需求。

在胶东调水工程中，团队首次尝试将水力模型嵌入SCADA系统，实现基于模型的闭环控制。这一探索虽然在技术上取得了成功，但过程中暴露出传统SCADA架构的严重不足：SCADA系统不支持复杂数学模型的嵌入和实时求解，MPC算法的部署需要在SCADA框架之外另建一套计算系统，两套系统之间的数据交互需要定制开发接口——整个系统的架构呈现出"拼接"而非"集成"的特征。

在南水北调中线工程中，系统规模的急剧扩大使得"拼接式"架构的弊端充分暴露。中线总干渠全长1432公里，涉及数百个闸门和泵站，横跨多个省市的管辖区域。传统的集中式SCADA架构在这种规模下面临通信带宽、计算延迟和可靠性的多重挑战——任何网络故障都可能导致大范围的监控盲区，集中式的模型求解无法满足实时性要求。这一工程需求直接催生了HydroOS的分布式架构设计——"边缘—区域—中央"三层架构，正是为了解决超大规模水网的管控难题而提出的。


> **图 2-2　HydroOS"边缘—区域—中央"三层分布式架构**
> *Fig. 2-2 CHS Eight Core Principles Framework*
>
> ```
> ┌─────────────────────────────────────────────────────────────┐
> │                    中 央 层（Central）                       │
> │  全局优化调度 · 数字孪生 · 瀚铎大模型 · 战略决策支持       │
> │  ─────────────────────────────────────────────────────────  │
> │  应用层：防洪调度 │ 供水优化 │ 发电调度 │ 生态调度 │ ...   │
> │  服务层：MaaS模型服务 │ 优化求解器 │ 数据湖 │ API网关     │
> └──────────────┬────────────────────────┬─────────────────────┘
>                │  目标分解/全局协调      │
> ┌──────────────▼──────────┐  ┌──────────▼──────────────────┐
> │    区 域 层（Region）    │  │    区 域 层（Region）        │
> │  区段DMPC协调 · 跨节点  │  │  区段DMPC协调 · 跨节点      │
> │  水量平衡 · 异常隔离    │  │  水量平衡 · 异常隔离        │
> └─────┬─────┬─────┬───────┘  └────┬─────┬─────┬────────────┘
>       │     │     │               │     │     │
>  ┌────▼─┐┌──▼──┐┌─▼───┐    ┌─────▼┐┌───▼─┐┌──▼────┐
>  │边缘层││边缘层││边缘层│    │边缘层││边缘层││边缘层 │
>  │闸门①││闸门②││泵站①│    │闸门③││闸门④││泵站② │
>  │本地  ││本地  ││本地  │    │本地  ││本地  ││本地   │
>  │PLC+  ││PLC+  ││PLC+  │    │PLC+  ││PLC+  ││PLC+   │
>  │IDZ   ││IDZ   ││IDZ   │    │IDZ   ││IDZ   ││IDZ    │
>  └──────┘└─────┘└──────┘    └──────┘└─────┘└───────┘
>              Edge Layer: 本地实时控制 · 故障自治 · 数据预处理
> ```
>
> 边缘层实现毫秒级本地闭环控制，区域层协调分钟级跨节点水量平衡，
> 中央层负责小时/天级全局优化与战略决策。三层之间通过标准化API通信，
> 任一层故障时下层可独立维持安全运行。


在沙坪水电梯级系统中，水电联合调度的需求进一步拓展了HydroOS的功能边界。水电系统需要同时考虑水力约束（水位、流量、库容）和电力约束（发电出力、电网频率、负荷曲线），两类约束的时间尺度不同（水力过程在小时级，电力过程在秒级），物理模型不同（水力用Saint-Venant方程，电力用功率平衡方程），优化目标不同（水利追求水量平衡和安全，电力追求发电效益最大化）——但在实际调度中，这些约束和目标必须在一个统一的框架内协调优化。这一需求促使HydroOS发展出了"异构模型耦合"能力——不同类型的物理模型可以在统一的仿真框架内并行运行、实时交互，通过标准化的接口进行数据交换和边界条件传递。

这三个工程的实践经验，逐步汇聚成了HydroOS的核心设计原则：

**设备无关性**（Device Independence）。通过统一的设备抽象层，屏蔽底层硬件的异质性，使上层应用完全不受硬件变化的影响。

**模型即服务**（Model as a Service）。水力/水质/水文模型不再是离线运行的仿真工具，而是作为可随时调用的"服务"运行在平台上——任何控制算法或决策模块都可以通过标准化API调用模型服务，获取预测结果。

**分布式协同**（Distributed Coordination）。系统架构原生支持分布式部署，边缘节点、区域中心和全局调度中心之间通过标准化的消息协议进行通信和协调，任何局部的故障不会导致全局的崩溃。分布式架构的设计灵感来自互联网的端到端原则（End-to-End Principle）——核心网络只负责数据传输，智能功能尽量放在端节点上。在HydroOS中，这一原则被转化为"岛自治"（Island Autonomy）设计——每个边缘节点都具备独立运行的完整能力（本地模型、本地安全策略、本地紧急预案），通信网络只是增强协调的手段而非系统运行的必要条件。这种"通信增强但非依赖"的设计，使得HydroOS在通信条件恶劣的偏远水利工程中也能可靠运行——这是传统集中式SCADA所无法实现的。

**可验证性**（Verifiability）。平台原生支持xIL（在回路）测试——同一个控制算法可以无缝地在MIL（纯模型仿真）、SIL（软件在回路）和HIL（硬件在回路）三种环境中运行和测试，无需修改算法代码。可验证性的实现依赖于HydroOS的"接口一致性"设计原则——控制算法通过标准化API与传感器和执行器交互，在MIL环境中，这些API背后连接的是虚拟传感器和虚拟执行器（由水力模型驱动）；在SIL环境中，连接的是真实的SCADA通信接口但虚拟的物理过程；在HIL环境中，连接的是真实的PLC/RTU硬件和真实的通信链路。控制算法代码在三种环境中完全相同，唯一变化的是底层接口的具体实现——这种"一套代码、三种环境"的验证能力，极大地降低了从仿真到部署的技术风险和工作量。

**开放可扩展**（Open and Extensible）。平台提供标准化的插件接口和开发工具包（SDK），第三方开发者可以在HydroOS上开发和部署自己的控制算法、分析模型和可视化应用——类似于智能手机操作系统上的"应用商店"生态。

这五项设计原则的确立并非一蹴而就。在早期的胶东调水项目中，团队更关注的是"功能实现"——如何让模型跑起来、控制闭环闭起来；到南水北调中线项目时，"架构设计"的重要性开始凸显——系统规模的扩大暴露了早期架构的种种不足；到沙坪水电项目和后续的标准化工作阶段，"平台化"的理念才真正成熟——从解决单个工程问题的定制系统，升华为服务于整个行业的通用平台。这一认识过程本身就是工程科学发展的典型路径：从特殊到一般，从具体到抽象，从解决问题到建立范式。

### 2.6.4 软件工程创新：模型即服务与实时仿真

HydroOS在软件工程层面的核心创新之一，是"模型即服务"（Model as a Service, MaaS）架构的提出和实现。在传统的水利软件中，水力模型是一个独立运行的程序——用户手动输入边界条件，启动求解，等待结果，然后在另一个程序中使用这些结果。模型与控制、模型与可视化、模型与数据采集之间是"断裂"的，需要通过文件交换或手工数据录入来连接。

HydroOS的MaaS架构彻底改变了这一模式。水力/水文/水质模型被封装为标准化的微服务，运行在HydroOS的模型服务容器中。每个模型服务对外暴露三类标准化API：初始化接口（设置模型参数、计算网格、初始条件）、步进接口（接收当前时刻的边界条件，推进一个时间步，返回计算结果）和查询接口（查询模型内部状态、性能指标、收敛状态等元信息）。控制算法、数据同化模块、可视化前端等上层组件通过调用这些API与模型交互，完全不需要了解模型的内部实现——无论底层是Preissmann格式的Saint-Venant方程还是IDZ传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）模型，上层接口都是一致的。

这种架构的深层价值在于实现了"模型的热替换"（Hot Swapping）。当需要将一个渠段的水力模型从简化的IDZ模型升级为精细的Saint-Venant模型时，只需要替换对应的模型服务实例，上层的MPC控制器无需做任何修改——因为它只通过标准化API与模型交互，不关心模型的内部实现。这种"接口不变、实现可变"的设计，极大地降低了系统升级的成本和风险，也为CHS理论中"可控模型族"概念的工程落地提供了软件基础——同一个系统可以在不同的任务场景下灵活切换不同精度的模型，而不需要改变控制架构。

另一项关键创新是实时仿真引擎（Real-Time Simulation Engine）的设计。传统的水力仿真是"事后分析"工具——运行速度与实际物理过程相当甚至更慢，无法用于实时决策支持。HydroOS的仿真引擎通过三项技术实现了"超实时"仿真：

首先是模型降阶（Model Order Reduction）。对于长距离渠道系统，原始的Saint-Venant方程在细网格下可能包含数千个状态变量，求解耗时过长。HydroOS采用POD（Proper Orthogonal Decomposition）等降阶方法，将高维模型投影到低维子空间，在保持足够精度的前提下将状态变量数量压缩到原来的10%至20%，求解速度提升一到两个数量级。

其次是并行计算框架。HydroOS的仿真引擎支持渠段级别的并行计算——对于一个包含N个渠段的渠系，N个渠段的水力计算可以在N个计算核心上同时进行，通过渠段边界的流量/水位耦合条件进行同步。在现代多核处理器和GPU加速卡的支持下，一个包含100个渠段的大型调水系统可以实现10倍以上的超实时仿真速度——即1分钟的仿真时间可以模拟10分钟以上的物理过程。

第三是自适应时间步策略。在水系统运行的大部分时间里，系统状态变化缓慢，可以使用较大的时间步长；但在闸门操作、突发来水等瞬变过程中，需要较小的时间步长以保证计算精度和数值稳定性。HydroOS的仿真引擎实现了基于CFL（Courant-Friedrichs-Lewy）条件的自适应时间步调整——系统平稳时自动增大步长以节省计算量，瞬变发生时自动缩小步长以保证精度。这种"按需计算"的策略使得计算资源的利用效率大幅提升。

超实时仿真能力的实现，使得HydroOS具备了"虚拟试运行"（Virtual Trial Run）的功能——在实际执行任何调度操作之前，先在数字孪生模型中快速模拟该操作的预期效果，如果预期结果满足安全约束和性能要求，再将指令下发到物理系统执行。这一"先虚后实"的操作模式，是水系统安全自主运行的核心保障机制之一。

值得特别指出的是，实时仿真引擎与数据同化（Data Assimilation）系统的深度耦合，是HydroOS区别于传统仿真软件的另一项关键技术。传统仿真是"开环"运行——模型从初始条件出发自由推演，不接受运行过程中的观测数据修正，因此误差会随时间累积直至仿真结果失去实用价值。HydroOS的仿真引擎则是"闭环"运行——每隔一个同化窗口（通常15分钟至1小时），系统自动将最新的传感器观测融入模型状态，修正累积误差。这一过程采用集合卡尔曼滤波（EnKF）或变分同化（3D-Var/4D-Var）方法，在模型预测值与观测值之间寻找最优估计。同化过程不仅修正状态变量（水位、流量），还可以在线更新模型参数（如糙率系数、闸门流量系数），实现"运行中自动校正"——这是模型长期保持精度的关键机制，也是CHS"在线自适应"理念在软件层面的具体实现。

### 2.6.5 开放生态与开发者平台

HydroOS的长远价值不仅在于其技术能力，更在于其作为"平台"的生态效应。正如Android和iOS的成功不仅源于操作系统本身，更源于其上百万级的应用生态，HydroOS的愿景是构建一个开放的水利智能应用生态系统。

HydroOS的开发者平台包含三个层次。底层是标准化SDK（软件开发工具包），提供Python和C++两种语言的接口库，开发者可以直接调用HydroOS的模型服务、数据服务和控制服务API，而无需了解底层通信协议和数据格式。中层是模型开发框架，提供模型封装模板、自动化测试工具和性能评测基准——研究人员可以将自己开发的水力模型、控制算法或机器学习模型按照标准模板封装，通过自动化测试验证正确性和性能，然后发布到HydroOS的模型库中供其他用户调用。上层是可视化搭建工具（Low-Code Platform），面向非编程背景的水利工程师——通过拖拽组件、配置参数和连接数据流的图形化界面，即可搭建定制化的监控面板、报警规则和简单的控制逻辑，大幅降低了智能应用的开发门槛。

这种三层开发者平台的设计借鉴了工业互联网平台（如Siemens MindSphere、GE Predix、PTC ThingWorx）的成熟经验，但针对水利行业做了重要适配：水力模型的时空尺度远大于工业设备（渠系模型可能覆盖数百公里，时间步长可达分钟级），因此模型服务的调度策略和缓存机制需要专门设计；水利系统的安全等级高于一般工业设备（溃坝或漫溢可能造成人员伤亡），因此第三方应用的安全审核机制需要更加严格——任何涉及控制指令生成的第三方应用都必须经过沙盒测试和安全审计，才能获得执行权限。

### 2.6.6 HydroOS与工业控制平台的对比

将HydroOS放在更广阔的工业控制系统背景下来审视，有助于理解其技术定位和创新贡献。

在电力行业，EMS（Energy Management System）/SCADA是电网调度控制的标准平台，由ABB、Siemens、GE等公司提供成熟的商业产品。电力EMS经过数十年的发展，已经形成了完善的功能标准和互操作规范（如IEC 61970 CIM公共信息模型），不同厂商的EMS系统可以通过标准化接口进行数据交换。相比之下，水利行业至今没有类似CIM的统一信息模型标准，不同系统之间的数据互通仍然是一个未解决的问题。HydroOS的CHS六要素架构在某种意义上正在尝试扮演类似CIM的角色——为水网系统提供统一的信息模型和接口标准。

在化工和石油行业，DCS（Distributed Control System，集散控制系统）是过程控制的标准平台。DCS的核心思想——"分散控制、集中管理"——与HydroOS的"边缘自治、区域协调、中央优化"理念高度一致。但水系统与化工/石油系统存在显著差异：化工过程是连续的、相对稳定的，控制对象（温度、压力、流量）的动态特性可以用较简单的传递函数描述；水系统则是具有时变延迟、非线性和空间分布特性的复杂系统，控制对象的动态特性随工况变化显著。因此，HydroOS需要在DCS的"分散控制"基础上，叠加"自适应模型更新"和"工况自动识别"等水系统特有的功能。

在自动驾驶领域，Apollo（百度）、Autoware等开源自动驾驶平台提供了从感知到决策到执行的全栈软件框架。自动驾驶平台与HydroOS面临的技术挑战有诸多相似之处：异构传感器融合（激光雷达/摄像头/毫米波雷达 vs 水位计/流量计/雨量计）、实时决策（毫秒级路径规划 vs 秒级闸门控制）、安全保障（碰撞避免 vs 漫溢/断流防护）。但关键差异在于时间尺度和空间尺度：自动驾驶的决策时间窗口是毫秒到秒级，影响范围是车辆周围数十米；水系统的决策时间窗口是分钟到小时级，但影响范围可能延伸到数百公里——一个闸门操作的效果可能在24小时后才到达下游某个控制断面。这种"慢系统、长链条"的特性，决定了HydroOS的控制架构必须比自动驾驶平台更强调"预见性"和"协调性"。

此外，近年来快速发展的工业物联网（IIoT）平台也为HydroOS提供了重要参照。AWS IoT Core、Azure IoT Hub、阿里云IoT等云平台提供了设备接入、数据存储、规则引擎等通用基础服务，其"设备影子"（Device Shadow/Digital Twin）概念——在云端维护每个物理设备的虚拟副本——与HydroOS的数字孪生理念高度一致。但这些通用IoT平台缺乏水利领域的"领域知识"——它们不知道Saint-Venant方程，不理解渠道延迟传播特性，无法执行水力仿真。

HydroOS的定位恰恰是在通用IoT平台的基础设施层之上，叠加水利领域的专业智能层——未来HydroOS可以与主流云平台深度集成，利用云平台的弹性计算和海量存储能力，同时通过自身的领域模型和控制算法提供水利系统所需的专业智能服务。这种"通用平台+领域智能"的分层架构，是工业软件发展的大趋势，也是HydroOS的战略定位所在。

### 2.6.7 瀚铎水网大模型（Hando Water Network Foundation Model）：HydroOS的认知层

如果说HydroOS的核心架构（设备抽象层、模型服务层、控制算法层）构成了"物理AI"的运行基础，那么瀚铎水网大模型（Hando Water Network Large Model）则是HydroOS"认知AI"能力的具体体现。瀚铎大模型基于大语言模型（LLM）技术，经过水利领域知识的深度微调和增强检索生成（RAG）训练，具备了水利专业知识的理解、推理和生成能力。

瀚铎大模型在HydroOS中承担三类核心功能：

第一类是"自然语言调度接口"。传统的调度指令需要通过复杂的操作界面输入——选择控制对象、输入目标值、设定时间窗口、确认执行条件——这一过程对调度员的操作熟练度要求很高，在紧急情况下容易出错。瀚铎大模型使调度员可以用自然语言描述调度意图（如"将XX闸门上游水位在2小时内降低0.3米"），大模型将自然语言解析为结构化的调度参数（目标对象、目标值、时间约束、安全限制），交由MPC控制器执行。这一功能大幅降低了人机交互的认知负荷。

第二类是"运行知识问答"。调度员在值班过程中经常需要查阅调度规程、历史案例、设备参数等信息——这些知识分散在纸质文档、电子文件和老调度员的记忆中，查找耗时耗力。瀚铎大模型通过RAG技术将这些知识整合到统一的知识库中，调度员可以用自然语言提问（如"去年同期这个渠段的冰期持续了多长时间？""这个闸门的最大安全开速是多少？"），大模型从知识库中检索并综合相关信息给出回答。

第三类是"调度方案解释"。当MPC控制器生成一个优化调度方案时，方案的形式是一组数值序列（各闸门在各时段的设定开度），对调度员来说难以直观理解"为什么是这组数值"。瀚铎大模型可以将数值化的调度方案"翻译"为调度员可理解的自然语言解释（如"方案先调小上游闸门开度是为了在下游泵站检修期间减少来水量，避免渠段水位超限"），帮助调度员理解和信任系统的决策。

值得强调的是，瀚铎大模型在HydroOS中的应用严格遵循"认知辅助、物理执行"的安全原则。大语言模型的本质是概率生成模型，存在"幻觉"（Hallucination）等固有缺陷——在日常对话中这些缺陷可以容忍，但在关系水安全的运行控制中则绝对不可接受。因此，HydroOS的架构设计中，瀚铎大模型只负责语义理解和知识检索层的工作——它可以解析调度员的自然语言指令，但解析结果必须经过形式化验证（检查参数是否在安全范围内、目标是否与当前工况相容）后才能传递给MPC控制器；它可以生成调度方案的解释文本，但解释的对象是MPC控制器已经经过数学优化和安全校验的方案。换言之，"大脑"（LLM）负责理解和表达，"手脚"（MPC+物理模型）负责计算和执行——两者协同但职责分明，确保关键控制决策始终有物理模型和数学优化作为支撑。

瀚铎大模型的引入，使得HydroOS从一个"执行型"系统进化为一个"认知型"系统——它不仅能够计算和执行最优调度方案，还能够"理解"调度员的意图、"解释"自己的决策逻辑、"回答"关于系统运行的各种问题。这种"认知能力"的赋予，是水系统从L3（有条件自主运行）向L4（高度自主运行）跃迁的关键技术支撑——因为更高等级的自主运行不仅要求系统"做对事"，还要求系统"说清楚为什么这样做"，以建立和维持人类监督者的信任。

从软件架构的角度看，HydroOS的发展历程体现了一条清晰的演进主线：从解决特定工程问题的定制软件，到抽象出共性需求的通用平台，再到具备认知能力的智能操作系统。这一演进过程不是预先规划的，而是在解决一个又一个实际工程挑战的过程中逐步涌现的——每一次工程实践都带来新的需求，每一次需求的解决都丰富了平台的能力，最终汇聚成了今天HydroOS的完整形态。

具体而言，HydroOS经历了三个主要版本迭代。HydroOS 1.0（2015-2018年）聚焦于"模型嵌入SCADA"——在胶东调水等工程中验证了基于模型的闭环控制的技术可行性，但架构上仍是单体应用，扩展性有限。HydroOS 2.0（2018-2022年）实现了"微服务+分布式"架构重构——MaaS模型服务、边缘-区域-中央三层架构、xIL验证框架等核心功能在南水北调中线和沙坪水电等工程中得到部署和验证。HydroOS 3.0（2022年至今）则标志着"AI原生"时代的到来——瀚铎大模型的集成、多模态感知融合（卫星遥感+地面传感器+视频监控）、自适应学习框架的引入，使HydroOS从"执行型平台"进化为"认知型平台"。

每一代版本的跃迁都不是纯技术驱动的，而是被真实的工程需求所牵引——这确保了HydroOS始终是一个"面向实际、解决问题"的工程平台，而非脱离实际的学术演示系统。


> **表 2-2　HydroOS版本演进**
> *Table 2-2 IDZ Model Parameters and Physical Meanings*
>
> | 版本 | 时期 | 架构特征 | 核心能力 | 代表工程 |
> |:----:|:----:|:--------:|:---------|:---------|
> | 1.0 | 2015-2018 | 单体应用 | 模型嵌入SCADA、闭环控制验证 | 胶东调水 |
> | 2.0 | 2018-2022 | 微服务+分布式 | MaaS模型服务、边缘-区域-中央三层、xIL验证 | 南水北调中线、沙坪水电 |
> | 3.0 | 2022至今 | AI原生 | 瀚铎大模型、多模态感知融合、自适应学习 | 福州/中山智慧水务 |


面向未来，HydroOS的开源社区建设和生态培育将成为与技术研发同等重要的战略方向。水利行业的数字化转型需要的不仅是一个优秀的软件平台，更需要一个围绕平台形成的知识共享和协同创新的社区生态。这种"从实践中来、到实践中去"的发展路径，恰恰体现了钱学森"工程控制论"传统中理论与工程螺旋上升的学术精神。

---

**思考与讨论**

1. （概念理解）HydroOS的HAL（硬件抽象层）解决了什么工程问题？请类比手机操作系统的硬件抽象进行说明。
2. （综合设计）如果你要为一个中型调水工程（全长150km，15个闸站）部署HydroOS，参照表4-4你会选择什么配置？请估算投资和实施周期。


---


---

### §2.6 本节小结


本节介绍了HydroOS水网操作系统的设计理念和架构演进。HydroOS从"水利SCADA"到"水网操作系统"的范式跃迁，核心是引入三层分布式架构（边缘→区域→中央）和五大核心服务（数据、模型、控制、智能、验证）。HydroOS解决了传统水利信息化的三大痛点：协议异构（通过HAL硬件抽象层）、算法孤岛（通过统一API和模型服务）、安全缺失（通过安全包络即服务）。

## 2.7 重大工程案例：CHS理论的实践验证


> **表 2-4　CHS理论主要工程应用案例总览**
> *Table 2-4 CHS Engineering Application Cases Overview*
>
> | 工程名称 | 工程类型 | 规模参数 | 控制对象 | 应用技术 | WSAL等级 | 应用时期 |
> |:--------:|:--------:|:---------|:---------|:---------|:--------:|:--------:|
> | 南水北调中线 | 长距离调水 | 全长1432km，64座节制闸 | 渠道水位/流量 | DMPC+MAS+冰期智控 | L2→L3试点 | 2018至今 |
> | 南水北调东线 | 梯级泵站调水 | 13级泵站，扬程65m | 泵站群联合调度 | 分层MPC+能耗优化 | L2 | 2019至今 |
> | 胶东调水 | 区域调水 | 总长483km，多水源互联 | 闸泵联合控制 | HydroOS 1.0→2.0 | L2(部分L3) | 2015至今 |
> | 沙坪水电站 | 水力发电 | 装机容量340MW | 水轮机组优化 | MPC+HIL验证 | L2 | 2020至今 |
> | 福州智慧水务 | 城市供水 | 服务人口400万+ | 管网压力/水质 | 数字孪生+瀚铎大模型 | L1→L2 | 2022至今 |
> | 中山智慧水务 | 城市排水 | 排水管网1000+km | 防涝调度 | 暴雨预警+联排联调 | L1→L2 | 2022至今 |


理论的生命力在于实践。CHS理论框架的形成，不是书斋中的纯粹思辨，而是扎根于多项重大水利工程的实践探索。本节选取三个代表性工程案例——胶东调水工程、沙坪水电梯级系统和南水北调中线工程——系统展示CHS理论在不同类型水系统中的应用。这三个案例分别代表了长距离明渠调水、水力发电梯级联合调度和超大规模跨流域调水三种典型工程场景，涵盖了水系统运行中最具挑战性的核心问题。更重要的是，这三个工程的实践经验不仅验证了CHS理论的工程可行性，而且反过来推动了理论的深化和完善——许多核心概念正是在解决工程实际问题的过程中被提炼和升华的。

### 2.7.1 胶东调水工程：SCADA+HDC协同控制

#### （1）工程概况与运行挑战

胶东调水工程是山东省重要的跨区域水资源配置工程，承担着向青岛、烟台、威海等胶东半岛城市群供水的战略任务。工程由引黄济青改扩建工程和引黄济青干线延伸至胶东半岛的输水渠系组成，涉及多段明渠、管道和泵站，输水线路跨越数百公里。工程沿线设有多座节制闸和分水闸，构成典型的多渠池串联控制系统。

胶东调水工程的运行面临多重挑战。第一，长距离输水带来的大时滞问题。上游闸门的操作到下游水位响应之间存在数小时甚至更长的传播延迟，传统的反馈控制方法在大时滞条件下容易产生超调和振荡。以典型渠段为例，若渠段长度为$L$，水波传播速度约为$v_0+c_0$（其中$v_0$为平均流速，$c_0=\sqrt{gA_0/T_0}$为小扰动波速），则传播延迟$\tau_d=L/(v_0+c_0)$在数十分钟到数小时量级。当多个渠段串联时，累积延迟可达十余小时，这对控制器的设计提出了极高的要求。

第二，多用户多目标的协调问题。沿线有多个取水口服务于不同城市，各城市的需水时段和需水量不同，需要在保障各用户供水可靠性的同时维持渠道的安全水位。供水可靠性要求系统尽量满足各用户的取水需求，而运行安全性要求渠道水位始终维持在安全上下限之间。这两个目标在取水高峰期可能产生矛盾——大量取水导致渠道水位下降，可能触及安全下限。

第三，来水不确定性。水源区来水受降雨和黄河来水条件影响，存在较大的不确定性。此外，渠道沿线的旁侧入流（如区间降雨汇入）和旁侧出流（如渗漏损失）也构成了系统的外部扰动。运行调度需要在不确定条件下保持稳健性，即在最不利的扰动情况下仍能保障系统安全运行。

第四，渠道水力特性的非线性和时变性。明渠中的水流由圣维南方程（Saint-Venant equations，描述明渠水流运动的基本方程，由连续性方程和动量方程组成）描述，这是一组非线性偏微分方程。渠道的水力参数（如糙率系数$n$）会随季节、淤积状况和水生植物生长等因素发生变化，导致系统模型具有时变特性。夏季水生植物旺盛生长时，渠道的Manning糙率系数可能从设计值0.013增大到0.018甚至更高，这意味着同样的流量条件下水位会显著升高，过流能力下降。冬季低温条件下，水的粘滞系数增大也会改变水力特性。这种时变性要求控制系统具备在线辨识和参数自适应能力——固定参数的控制器在模型参数漂移后可能出现性能下降甚至失稳。

第五，多工况运行带来的模式切换问题。胶东调水工程在不同季节、不同来水条件和不同需求场景下的运行模式存在显著差异。丰水期的运行重点是防止渠道溢流，需要加大下泄能力；枯水期的运行重点是保障供水可靠性，需要精打细算每一方水量；特殊事件（如上游水源突发水质问题、下游城市突增应急供水需求）则要求系统快速切换到应急运行模式。不同运行模式下的控制目标、约束条件和优先级排序各不相同，系统需要能够根据运行条件的变化自动识别并切换到适当的控制模式——这正是CHS理论中"运行设计域"（ODD）概念的工程来源之一。

#### （2）从圣维南方程到IDZ传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）：建模基础

要对胶东调水工程实施基于模型的控制，首先需要建立适合控制器设计的数学模型。这涉及一个关键的科学问题：如何将描述明渠水流的非线性偏微分方程（圣维南方程）转化为控制工程中可用的低阶传递函数模型？

圣维南方程组由连续性方程和动量方程组成：

$$\frac{\partial A}{\partial t}+\frac{\partial Q}{\partial x}=q_l$$

$$\frac{\partial Q}{\partial t}+\frac{\partial}{\partial x}\left(\frac{Q^2}{A}\right)+gA\frac{\partial h}{\partial x}=gA(S_0-S_f)$$

其中$A$为过水断面面积，$Q$为流量，$q_l$为旁侧入流，$S_0$为底坡，$S_f$为摩阻坡降。这组方程虽然能够精确描述明渠水流的动态行为，但由于其非线性和分布参数特性，无法直接用于控制器设计。

为解决这一问题，研究团队发展了一套系统化的降阶建模方法。第一步，确定渠池的基准稳态工作点。根据设计流量$Q_0$和渠池几何参数（长度$L$、底宽$b$、边坡系数$m$、底坡$S_0$、Manning糙率系数$n$），利用Manning公式求解均匀流条件下的基准水深$y_0$和基准流速$v_0$。第二步，对圣维南方程组进行线性化处理。将流量和水深分解为稳态分量与扰动分量之和，即$Q(x,t)=Q_0+q(x,t)$、$y(x,t)=y_0+\tilde{y}(x,t)$，忽略扰动量的高阶项，得到线性化偏微分方程组。第三步，对线性化方程进行Laplace变换，推导分布参数传递矩阵$\mathbf{G}(s)$，建立上下游边界变量之间的频域关系。

第四步，在低频段对分布参数传递矩阵进行有理函数近似，构建积分延迟零（Integrator Delay Zero, IDZ）传递函数模型：

$$P(s)=\frac{(1+\tau_z \cdot s) \cdot e^{-\tau_d \cdot s}}{A_s \cdot s}$$

其中，$A_s=T_0 \cdot L$为渠池蓄量面积，表征积分特性；$\tau_d=L/(v_0+c_0)$为传播延迟时间；$\tau_z$为零点时间常数，通过频域拟合确定。IDZ模型是Litrico和Fromion于2004年在ID模型基础上提出的改进模型，通过增加零点项改善了高频段的响应精度。

这一降阶建模方法的关键创新在于建立了多工况传递函数库。在渠池设计运行流量范围$[Q_{min},Q_{max}]$内，选取多个特征工况流量值，对每个工况分别计算IDZ传递函数参数，构成参数查找表。当实际运行工况处于相邻特征工况之间时，采用插值获取当前工况的模型参数。仿真验证表明，在流量偏离设计值50%的工况下，多工况插值模型的水位预测均方根误差较固定参数IDZ模型降低约25%至35%。

此外，为适应渠道糙率变化、淤积等长期演变因素，还发展了基于递推最小二乘法（RLS）的在线参数辨识机制。该机制实时采集闸门流量变化和下游水位响应数据，在线辨识传递函数参数，当辨识值与库中参数的偏差超过预设阈值时自动触发参数更新。这一"建模—辨识—更新"的闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）机制，体现了CHS理论中"数据—物理融合"原理的工程实现。

#### （3）SCADA+HDC融合架构

在建模基础上，胶东调水工程采用了SCADA与分层分布式控制（HDC）相融合的技术架构。这一架构是CHS理论"分层分布式统一"原理的典型工程实现。

在SCADA层面，工程建设了覆盖全线的数据采集与监控网络。关键控制断面设置了水位传感器、流量计、闸门开度传感器等监测设备，实时数据通过光纤和无线通信网络传输至中央控制中心。SCADA系统不仅承担传统的数据采集和远程监控功能，还集成了数据质量评估模块——对传感器数据进行异常检测、缺失补全和一致性校验，为控制算法提供经过清洗和融合的高质量输入。

在HDC层面，控制架构分为三个层级，每个层级解决不同空间尺度和时间尺度的控制问题。

L0层（本地控制层）实现单个闸门的本地自动控制。每个闸门配备独立的可编程逻辑控制器（PLC），根据目标水位和实际水位的偏差，通过改进的PID算法自动调节闸门开度。L0层的响应速度在秒级，主要职责是快速消除局部水位扰动。L0层控制器还内置了安全联锁逻辑：当水位超过安全上限时自动开闸放水，当水位低于安全下限时自动关闸蓄水。这些联锁逻辑不依赖上层通信，确保了在通信中断等极端情况下的基本安全保障。

L1层（渠段协调层）是多渠段水位协调的关键。当某个渠段的水位偏离目标值时，如果仅由L0层各自独立调节，可能引发"推波效应"——上游闸门为降低水位而增大开度放水，导致下游渠段水位升高；下游闸门为降低水位也增大开度放水，波动进一步向下游传递和放大。L1层通过前馈补偿和解耦控制技术协调相邻闸门的联动：当上游闸门调节放水时，L1层同时向下游闸门发送前馈信号，使其提前做好接纳准备，避免水位波动的级联传播。L1层的控制周期为分钟级到十分钟级。

L2层（全系统调度层）负责全线的优化调度。L2层的核心算法采用模型预测控制（MPC），其预测模型基于全线IDZ传递函数的离散状态空间（state space，用一组状态变量——如各断面水位和流量——来完整描述系统在任意时刻行为的数学框架）表达。L2层综合考虑各城市的需水计划（通常以日为周期更新）、水源区的来水预报、气象信息（降雨预报用于估计区间来水，蒸发预报用于估计水量损失），以及渠道安全约束（水位上下限、闸门操作限制），计算未来数小时到数天内各闸门的最优操作序列。

SCADA与HDC的深度融合是一个关键设计理念。传统上，SCADA和控制算法往往是分离的子系统——SCADA负责"看"（数据采集与显示），控制算法负责"算"（决策与优化），两者之间通过简单的数据接口连接，缺乏深度耦合。在胶东调水工程中，这一传统架构被打破：SCADA的数据质量评估结果直接影响HDC算法的运行模式。具体而言，系统定义了三级运行模式：正常模式——当数据质量良好（传感器在线率大于95%、数据一致性校验通过）时，HDC算法以设计参数正常运行；保守模式——当数据质量下降到一定阈值以下（如关键传感器故障或通信延迟超限）时，HDC自动切换到保守控制模式，减小控制动作幅度、扩大水位安全裕度以降低风险；安全回退模式——当数据链中断或出现重大异常时，系统自动将所有闸门锁定在当前位置或预设的安全开度，并触发告警请求人工接管。

这种基于数据质量的三级运行模式切换机制，在概念上与CHS理论后来提出的"运行设计域"（ODD）和"安全包络"密切相关——数据质量是定义ODD边界的关键因素之一，不同的数据质量水平对应不同的ODD范围和安全包络宽度。胶东调水工程的这一实践经验，直接推动了ODD概念在CHS理论中的形成和完善。

此外，胶东调水工程还在HDC架构中引入了故障容错机制。当L1层或L2层控制器发生故障时，下级控制器能够自动切换到独立运行模式——L0层控制器基于本地PID控制继续维持单闸水位稳定，虽然全局优化性能有所降低，但系统的基本安全运行得到保障。这种"优雅降级"设计思想是CHS理论"安全优先于效率"原则的工程体现。

#### （4）MPC在线优化

胶东调水工程的L2层调度采用了模型预测控制（MPC）方法。MPC是一种基于模型的滚动优化控制策略，其核心思想是：在每个控制时刻$k$，利用预测模型向前预测未来$N_p$个时步的系统响应，在预测域内求解一个约束优化问题，得到最优控制序列，执行第一步控制动作后丢弃其余，然后在下一个控制时刻重新预测和优化。

MPC的优化目标函数定义为：

$$J=\sum_{i=1}^{N_p}\left\|\mathbf{y}(k+i|k)-\mathbf{y}_{ref}(k+i)\right\|_{\mathbf{Q}}^2+\sum_{j=0}^{N_c-1}\left\|\Delta\mathbf{u}(k+j|k)\right\|_{\mathbf{R}}^2$$

其中第一项衡量预测输出$\mathbf{y}$与参考轨迹$\mathbf{y}_{ref}$的偏差，第二项衡量控制增量$\Delta\mathbf{u}$的大小，$\mathbf{Q}$和$\mathbf{R}$为权重矩阵。约束条件包括水位安全包络$\mathbf{y}_{min} \leq \mathbf{y} \leq \mathbf{y}_{max}$、闸门开度范围和开度变化速率限制。

MPC方法在胶东调水工程中取得了显著的运行效果。在正常输水工况下，主要控制断面的水位偏差控制在目标值的正负5厘米以内，显著优于人工调度的正负15至20厘米精度。这一精度提升的背后有深层的工程意义：水位波动减小意味着渠道可以在更接近设计水位的条件下运行，有效利用的过水断面增大，输水能力相应提高；同时，水位波动的减小降低了渠道护坡和衬砌的冲刷风险，延长了工程的使用寿命。

在需水变化工况下，MPC的前瞻预测能力体现出关键优势。当某个城市的取水量即将增加时，MPC利用需水计划信息提前数小时调整上游闸门开度，使得额外的水量在取水增加之前就已经进入输水渠道，从而避免了取水瞬间的水位大幅下降。相比之下，人工调度模式下调度员通常在收到取水请求后才开始调整闸门，由于传播延迟的存在，下游水位在调整生效前就已经出现明显下降——这种"先降后补"的模式不仅影响供水质量，还可能触发低水位告警甚至引发安全事件。

在突发扰动工况下（如局部强降雨导致渠道旁侧来水突增、上游水源流量意外变化等），MPC表现出良好的鲁棒（robust，指系统在参数变化或外部干扰下仍能保持稳定性能的能力，类似于水利工程中的'抗干扰性'）性。MPC的滚动优化机制使其能够在每个控制时刻根据最新的测量数据重新计算控制方案——当扰动发生时，MPC在下一个控制时刻即可感知到偏差并自动调整后续的控制序列，无需等待人工干预。在多次实际运行中，MPC成功应对了多种突发扰动，始终将水位维持在安全包络之内，实现了WSAL L3级别的条件自主运行。

值得关注的是MPC的工程实施细节。在线计算方面，由于IDZ传递函数模型的计算复杂度低（单步求解时间为微秒量级），MPC的在线优化能够在标准工控机上数秒内完成，满足了实时控制要求。在通信方面，MPC的控制指令通过SCADA系统下发到现场执行器，指令的传输延迟被显式纳入MPC的预测模型中进行补偿。在安全保障方面，MPC的输出在下发执行前经过安全检查模块的校验——如果MPC计算出的闸门开度指令超出安全范围或变化速率过大，安全检查模块会对指令进行裁剪或拒绝，确保执行器不会收到不安全的指令。这种"优化+安全校核"的双重机制，是CHS理论"优化—安全统一"原则在工程中的具体实现。

#### （5）工程启示

胶东调水工程的实践为CHS理论提供了多方面的验证和启示。SCADA+HDC融合架构验证了"分层分布式统一"原理的工程可行性；从圣维南方程到IDZ传递函数的系统化降阶方法验证了"可控模型族"概念的工程价值；MPC在长距离调水中的成功应用验证了基于模型的预测控制在水系统中的有效性。同时，传感器故障、通信延迟和模型参数漂移等实际问题推动了状态估计、延迟补偿和自适应控制方法的发展，体现了"实践推动理论"的学科发展规律。

### 2.7.2 沙坪水电梯级：发电—防洪多目标协同

> **表 2-5　胶东调水工程CHS应用前后效果对比**
> *Table 2-5 Before/After CHS in Jiaodong Water Transfer*
>
> | 性能指标 | 应用前（人工调度） | 应用后（HDC+MPC） | 改善幅度 |
> |:--------:|:-----------------:|:-----------------:|:--------:|
> | 主控断面水位偏差 | ±15~20 cm | ±5 cm | 降低67%~75% |
> | 闸门日均动作次数 | 20~30次/座 | 8~12次/座 | 减少55%~60% |
> | 调度响应时间 | 2~4小时（人工协调） | 分钟级（自动执行） | 缩短95%+ |
> | 输水损失率 | ~8% | ~5% | 降低约3个百分点 |
> | 突发工况处理 | 依赖值班经验 | L0自动联锁+L1前馈 | 系统化保障 |
> | 夜间运行模式 | 降流量保守运行 | 正常自动运行 | 输水能力提升30%+ |
> | 数据来源 | — | 雷晓辉等(2020)，胶东调水运管局运行报告 | — |

#### （1）工程概况与运行挑战

沙坪水电站位于四川省大渡河流域，是蒲布—深溪沟—镇头—沙坪四级水电梯级系统的组成部分。整个梯级系统承担着电力调峰、防洪泄洪和生态流量保障等多重功能。与胶东调水以供水为核心目标不同，水电梯级系统的运行问题本质上是一个多目标协同优化问题——发电效益最大化、防洪安全保障和生态流量维持三者之间存在结构性矛盾。

发电目标追求水能利用效率最大化，希望维持较高的水库水位以获得更大的发电水头$H$（发电功率$P=\eta \rho g Q H$），因此倾向于蓄水；防洪目标则要求在汛期保持充足的防洪库容，需要降低水库水位；生态目标要求在特定时段维持特定的下泄流量过程。此外，梯级系统内部的级联耦合效应显著增加了运行复杂性——上级电站的泄水直接构成下级电站的来水，一个电站的运行方式变化会沿梯级向下游逐级传播。

从控制系统的角度看，沙坪梯级至少存在三类不同时标：秒级的机组保护与联锁、分钟级的机组与闸门调节、小时级的梯级调度计划修正。CHS理论的"分层分布式"架构为这种多时标问题提供了自然的解决框架。

#### （2）控制对象建模

沙坪梯级的建模与胶东调水有显著差异。胶东调水的核心是明渠水流动力学（圣维南方程），关注的是沿渠道空间分布的水位和流量变化；而沙坪梯级的核心是水库水量平衡与发电-泄洪耦合动力学，关注的是集总参数（水库水位、机组出力、泄洪流量）的时间演变。

对于单个电站，基本的水量平衡方程为：

$$\frac{dV}{dt}=Q_{in}(t)-Q_{out}(t)$$

其中$V$为水库蓄水量（$m^3$），$Q_{in}$为入库流量，$Q_{out}$为出库总流量。出库流量由发电流量$Q_{pow}$和泄洪流量$Q_{spill}$两部分组成：$Q_{out}=Q_{pow}+Q_{spill}$。通过库容曲线$V=f(h)$可将水量平衡方程转化为水位动态方程。库容曲线通常是非线性的——在低水位段库容随水位变化较慢（河谷狭窄），在高水位段库容随水位变化较快（库面展开）。

对于梯级系统，四个电站的水量平衡方程通过上下游关系耦合在一起：

$$Q_{in,i}=Q_{out,i-1}+q_i, \quad i=2,3,4$$

即下游电站的入库流量等于上游电站的出库流量加上区间来水$q_i$。这种级联耦合使得梯级系统的状态空间维数随电站数量线性增加，而约束条件的数量也成倍增长，优化问题的求解复杂度随之急剧增大。

发电功率模型需要考虑机组的运行特性。水轮发电机组的发电功率为$P=\eta \rho g Q_{pow} H$，其中$H$为净水头（上游水位减去下游水位再减去水头损失），$\eta$为水轮机效率。关键的非线性来自效率$\eta$——它是水头$H$和流量$Q_{pow}$的复杂非线性函数，通常以"机组工况曲线"（hill chart）的形式给出。工况曲线上存在"高效率区"和"振动区"：在高效率区运行可以最大化发电效益，而在振动区运行会产生水力振动，加速机组磨损甚至导致设备损坏。因此，发电优化不仅要追求功率最大化，还必须通过约束条件严格规避振动区运行。

此外，梯级系统还需要考虑水流传播的时间延迟。上游电站泄水后，水流到达下游电站需要一定时间（取决于河道长度和流速），这一"级间传播延迟"使得上下游电站的控制不能简单地同步进行，必须考虑时序协调。在洪水期间，级间传播延迟可能只有数十分钟到一两个小时，但其对水位变化的放大效应可能非常显著——上游泄洪波在下游叠加区间来水后，可能使下游电站面临超出设计标准的入库洪峰。

#### （3）发电—泄洪一体化控制

沙坪梯级采用了一体化控制方法，将发电调度和泄洪调度纳入统一优化框架：

$$J=\alpha \cdot J_{power}+\beta \cdot J_{flood}+\gamma \cdot J_{eco}$$

关键创新在于权重系数的动态调整机制：汛期$\beta$自动增大优先保障防洪库容，枯水期$\alpha$增大优先发电效益，鱼类繁殖季$\gamma$增大保障生态流量。权重调整规则编码在运行设计域（ODD）中，由水文气象条件自动触发工况切换。

约束条件分为三层：硬约束（不可违反的安全边界）、软约束（可通过惩罚函数纳入优化的性能指标）、治理约束（确保可审计可追责的管理要求）。这种动态权重与三层约束分级的设计，是CHS"多目标统一"和"安全优先"原理在水电场景中的融合实现。

#### （4）梯级"一键调"协同

"一键调"（One-Click Dispatch）是沙坪梯级的重要技术创新。调度员只需设定梯级整体运行目标（总发电负荷、总泄洪流量、各站水位目标），系统自动计算各级电站的最优运行方式并一键下发。

技术实现依赖于分层优化：上层优化器确定各级电站的总出力和总泄流分配（电站间协调），目标是梯级整体效益最大化同时满足级间水量平衡约束；下层优化器确定每个电站内部各机组的出力分配（电站内部优化），目标是单站效率最大化同时规避振动区。

上层优化器的数学模型可以表述为：在满足梯级总出力需求$\sum_i P_i = P_{total}$、各电站水位约束$h_{min,i} \le h_i \le h_{max,i}$和级间水量平衡$Q_{in,i} = Q_{out,i-1} + q_i$的条件下，最小化多目标函数。上层优化的决策变量是各电站的出力分配$P_i$和泄洪分配$Q_{spill,i}$，维度仅为$2 \times 4 = 8$个决策变量，可以在毫秒级完成求解。

下层优化器则面向单个电站内部。以沙坪电站为例，假设有$n$台机组，每台机组的效率曲线$\eta_j(H, Q_j)$是非线性的，且存在不可运行的振动区间。下层优化需要在满足上层分配的总出力$P_i$的条件下，确定各机组的个体出力$P_{i,j}$，使得总发电效率最大化并避免任何机组落入振动区。这一优化问题虽然是非凸的（由于振动区的存在），但由于单站机组数量有限（通常不超过10台），可以通过枚举可行机组组合加连续优化的混合方法在秒级内求解。

"一键调"在人机交互层面的设计同样值得关注。系统为调度员提供了三种交互模式：第一种是"目标输入模式"——调度员只需输入梯级的整体目标（如"总出力提升到120MW"），系统自动计算并显示各电站的分配方案；第二种是"约束调整模式"——调度员可以手动修改某个电站的约束（如"沙坪电站3号机组检修停机"），系统在新约束下重新优化并更新方案；第三种是"方案对比模式"——系统同时生成多个候选方案（如"效率优先方案""安全优先方案""均衡方案"），调度员从中选择最合适的方案执行。

这种两层分解的数学基础是拉格朗日（Lagrange，数学优化中常用的约束优化方法，通过引入乘子将有约束问题转化为无约束问题）松弛或交替方向乘子法（ADMM）。以拉格朗日松弛为例，梯级级间的水量平衡约束$Q_{in,i}=Q_{out,i-1}+q_i$被松弛到目标函数中，引入拉格朗日乘子$\lambda_i$作为级间"水价"信号。上层优化通过调整乘子$\lambda_i$来协调各电站之间的水量分配，下层各电站独立求解以$\lambda_i$为参数的局部优化问题。经过数轮迭代，乘子收敛到最优值，各电站的局部最优解自然满足级间耦合约束，同时实现梯级整体的帕累托最优。

"一键调"的人机交互设计也值得关注。调度员在界面上只需完成三步操作：第一步，确认或修改梯级的整体运行目标（系统会根据电网调度指令和水情预报自动给出推荐值）；第二步，检查安全约束的设置（系统根据当前水情和设备状态自动更新约束参数）；第三步，点击"执行"按钮。系统在后台完成两层优化计算后，将各电站的详细运行方案以表格和图形两种形式呈现给调度员审核，同时高亮显示与上一时刻方案的差异和关键约束的裕度。调度员确认后，指令通过SCADA系统同步下发到四个电站。

"一键调"将传统需要数十分钟到数小时的梯级调度过程缩短到秒级，并保证全局帕累托最优。更重要的是，它改变了调度员的工作模式——从"逐站计算、逐站下发"的繁琐操作转变为"审核整体方案、一键确认执行"的高效决策。这种人机交互模式的优化，正是CHS理论"人机共融"理念在操作层面的具体体现。在实际运行中，"一键调"不仅提高了调度效率，更重要的是减少了人为操作失误的风险——传统模式下，调度员在逐一调整各电站运行方式时，容易出现"顾此失彼"的情况，导致某个电站的调整与梯级整体目标不一致。"一键调"通过算法保证各电站运行方式的全局协调性，从根本上避免了这类失误。

#### （5）认知AI辅助决策

沙坪梯级还引入了认知AI作为辅助决策工具。核心能力来自经水电领域微调的大语言模型（LLM），微调过程包括领域持续预训练（DAPT）和监督微调（SFT），并引入知识图谱增强检索（KG-RAG）。

主要应用包括三方面：第一，调度方案的自然语言解释——将MPC输出的数值化方案转化为包含"水情分析""调度思路""风险提示""操作建议"四部分的可读文字；第二，运行规程的智能检索——支持自然语言查询，从知识图谱中检索并返回精确条款引用；第三，异常工况的辅助研判——综合历史案例和运行规程给出处置建议，经物理约束校核器验证后呈现给调度员。

物理AI（MPC优化器）负责"算"——基于水力学模型给出数值最优的调度方案，保证方案的物理可行性和数学最优性；认知AI（LLM辅助系统）负责"解释"和"建议"——将数值方案转化为可理解的操作指导，从知识库中检索相关规程和案例，辅助调度员快速理解和评估方案。两者之间的协作通过一个"物理约束校核器"来保障质量：认知AI的每一条输出（无论是方案解释、规程引用还是异常处置建议）都会经过校核器的审查——检查其中涉及的数值是否在物理合理范围内，引用的规程条款是否与当前工况匹配，建议的操作是否违反安全约束。只有通过校核的内容才会呈现给调度员。

这种"双AI引擎+物理校核"的架构，有效地发挥了两类AI各自的优势——物理AI擅长精确计算但缺乏解释能力，认知AI擅长理解和生成自然语言但可能产生"幻觉"——同时通过校核机制抑制了各自的劣势，体现了CHS"双AI引擎"架构的核心设计思想。

#### （6）工程启示

沙坪实践验证了CHS理论在水电调度领域的适用性。多目标协同优化成功地将发电、防洪、生态三个矛盾目标纳入统一框架；"一键调"将复杂梯级调度简化为一步操作；认知AI提供了全方位决策支持。同时也揭示了LLM"幻觉"问题和分布式优化效率等需要进一步研究的课题。

### 2.7.3 南水北调中线工程：超大规模自主运行探索

> **表 2-6　沙坪水电梯级CHS应用效果**
> *Table 2-6 CHS Results in Shaping Cascade Hydropower*
>
> | 性能指标 | 传统调度 | CHS"一键调" | 改善幅度 |
> |:--------:|:--------:|:----------:|:--------:|
> | 梯级调度耗时 | 30~60分钟（逐站计算下发） | 秒级（全局优化一步确认） | 缩短99%+ |
> | 全梯级发电效率 | ~88%（各站独立优化） | ~92%（帕累托全局优化） | 提升约4个百分点 |
> | 振动区误入概率 | 偶发（人工判断） | 0%（硬约束嵌入优化） | 消除 |
> | 多目标冲突处理 | 经验权衡，无量化 | 帕累托前沿可视化选择 | 系统化决策 |
> | 异常工况响应 | 人工电话协调 | 瀚铎大模型辅助诊断 | 决策质量提升 |
> | 数据来源 | — | 雷晓辉等，沙坪智慧水电站运行报告(2022) | — |

#### （1）工程概况与世界级挑战

南水北调中线工程总干渠从丹江口水库至北京团城湖，全长1432公里，沿线设有60余座节制闸。自2014年通水以来，累计调水超过700亿立方米，惠及1.76亿人口（据南水北调中线工程建设管理局2024年运行通报）。

工程面临世界级挑战：超长距离带来的超大时滞（水流从渠首到终端传播十余天）、60余座闸门构成的超高维控制系统（状态组合数为天文数字）、跨四省市的多元需求协调（工业供水、生活供水、农业灌溉、生态补水四类需求各异）、以及冰期运行的特殊安全风险。

从系统控制的角度进行定量分析，这些挑战的严峻性可以更清晰地看到。关于时滞问题：以中线工程典型运行流量条件计算，水流从陶岔渠首到北京团城湖的传播时间约为10至15天。这意味着如果调度员今天发现北京段水位偏低，回溯到渠首端的调度调整，其效果需要两周后才能到达——在此期间，需水条件可能已经发生了多次变化。传统的反馈控制在如此大的时滞条件下基本失效，必须采用基于预测模型的前馈控制与反馈修正相结合的策略。

关于高维控制问题：60余座节制闸加上多座退水闸和分水口，构成了一个具有上百个决策变量的控制系统。如果将每个闸门的开度离散化为10个等级，状态空间的理论规模为$10^{60}$量级。即使采用最先进的全局优化算法，在合理的计算时间内也无法遍历这一搜索空间。分层分布式架构通过将全局优化问题分解为多个互相协调的局部优化问题来降低计算复杂度——这不是一种"近似"或"妥协"，而是应对维度灾难的唯一工程可行途径。

关于多元需求协调：工业供水（连续性要求高、水质要求严）、城市生活供水（时段性波动、保障优先级最高）、农业灌溉（季节性集中、水量大）和生态补水（特定时段的流量过程要求）四类需求在水量、时间分布和保障优先级上各不相同。水源充裕时可同时满足，水源紧张时（枯水年或突发水质事件）需求冲突凸显——需要在"保谁、减谁、缓谁"之间做出决策。这种多利益主体的协调问题超越了纯技术优化范畴，需要将政策法规和社会公平因素嵌入优化框架，CHS理论中的"治理约束"概念正是为此而生。

#### （2）分层分布式控制架构

面对上述挑战，南水北调中线采用了专门设计的三层分层分布式控制架构。

面对上述挑战，南水北调中线工程采用了经过专门设计的分层分布式控制架构。全线被划分为若干管理段，每个管理段包含数座节制闸和相应渠段，由一个区域管理处负责日常运行。

控制架构分为三个层级，各层级的职责和响应时间尺度明确区分：

L0层（本地控制层）：每座节制闸配备本地自动控制系统，内置PID控制器。本地控制器根据上级下达的目标水位设定值，通过测量闸前（或闸后）水位与目标值的偏差，自动调节闸门开度。L0层的控制周期为秒级到分钟级，主要职责是快速消除因短时扰动（如旁侧来水突变、下游取水波动）引起的局部水位偏差。L0层还承担安全联锁功能——当水位触及安全上限或下限时，自动执行预设的保护动作（如紧急开闸或关闸），不依赖上级指令，确保在通信中断等极端情况下仍能保障局部安全。

L1层（管理段协调层）：每个管理段设有区域调度中心，配备工业控制计算机和SCADA显示系统。L1层控制器接收L2层下达的调度计划，将其分解为段内各闸门的目标水位和流量设定值。L1层的核心任务是段内多闸协调——当某座闸门的调节动作影响到相邻闸门的控制效果时，L1层通过前馈补偿和解耦控制协调多闸联动，避免水位波动在闸门之间传递放大。此外，L1层具有一定程度的自主处置权限：当段内出现一般性异常（如单个传感器故障、短时通信中断、小幅度旁侧来水增大等），L1层在预设的运行设计域（ODD）范围内自主调整控制策略，只有超出ODD边界的异常才上报L2层请求干预。L1层的控制周期为分钟级到小时级。

L2层（全系统调度层）：位于北京的南水北调中线建设管理局调度中心，是整个控制体系的最高决策层。L2层综合考虑以下信息源制定调度方案：丹江口水库的来水预报和可供水量、沿线各省市的月/旬/日需水计划、气象预报（用于预测渠道蒸发损失和区间降雨来水）、以及冬季的冰情预报。基于这些信息，L2层采用MPC方法计算未来数天到数周的最优闸门操作序列。L2层的控制周期为小时级到天级——日常运行中每隔数小时更新一次调度方案，在水文条件剧变或突发事件时可缩短到小时级甚至更短。

三层架构通过明确定义的接口和信息流协议连接。自上而下：L2向L1下达调度计划和约束条件（目标水位、流量上下限、特殊工况指示），L1向L0下达水位设定值和保护参数。自下而上：L0向L1实时上报闸门状态、水位测量值和报警信息，L1向L2定时上报管理段运行摘要（水位达标率、闸门动作次数、异常事件记录等）。这种"目标向下分解、信息向上汇聚"的双向流机制，实现了全局优化与局部快速响应的有机统一。

值得注意的是，三层架构的设计还考虑了"优雅降级"（Graceful Degradation）能力。当L2层与L1层的通信中断时，L1层切换到"自主保持模式"——按照最近一次有效的调度计划继续运行，同时加强段内水位监控，收紧安全包络以增加安全裕度。当L1层与L0层的通信中断时，L0层切换到"本地安全模式"——维持当前闸门开度不变或缓慢趋向安全位置，同时启动安全联锁保护。这种逐级降级的设计确保了系统在任何单点故障条件下都不会丧失基本的安全保障能力。

#### （3）冰期运行控制

冰期运行是中线工程最具挑战性的工况。冰盖形成改变渠道水力特性——附加阻力使过流能力下降；冰塞可能导致水位急剧上升威胁结构安全。

研究团队发展了冰水力学耦合模型，在圣维南方程基础上增加冰盖热力学方程：

$$\rho_i L_f \frac{d\delta_i}{dt}=\phi_{ia}-\phi_{iw}$$

其中$\rho_i$为冰密度，$L_f$为潜热，$\delta_i$为冰盖厚度，$\phi_{ia}$和$\phi_{iw}$分别为冰-气和冰-水界面热通量。

冰期控制策略的核心是"保温控流"——通过精确控制渠道流速和水位，维持一个稳定的冰盖运行状态。具体而言，流速控制需要在两个临界值之间取得平衡：流速过快（超过约0.7至0.8米/秒的临界破冰流速）会导致冰盖破碎形成大量流冰，流冰在闸门前堆积极易形成冰塞，而冰塞一旦形成，其上游水位可能在数小时内急剧上升数米，构成严重的安全威胁；流速过慢（低于约0.3米/秒）则水体与大气的热交换时间延长，水温下降加速，可能导致冰盖过厚或底冰形成，降低渠道过流能力。因此，冰期运行的流速控制目标是将各渠段流速维持在0.4至0.6米/秒的"安全窗口"内。

水位控制在冰期同样面临特殊要求。冰盖形成后，渠道的有效过流断面减小（冰盖占据了部分断面），为维持相同的输水流量，水位需要相应抬高。但水位抬高又受到渠道超高限制——冰期水位加上冰盖厚度不能超过渠道设计水位。因此，冰期输水流量通常需要较常规工况降低20%至40%，以在安全约束范围内维持稳定运行。

冰期安全包络因此比常规工况更加严格和多维——不仅有水位上下限约束，还有流速范围约束、冰盖厚度约束和输水流量约束，这些约束之间还存在耦合关系（流速影响冰盖厚度，冰盖厚度影响有效过流面积，有效过流面积影响水位）。系统在这一更严格的多维安全包络内实施自主控制，代表了CHS"安全包络"原理在极端工况下的重要工程验证。

冰期运行控制的成功实施也推动了CHS理论在"场景自适应"方面的发展。系统需要能够自动识别冰期的开始和结束（基于气温、水温和冰情监测数据），自动切换控制模式（从常规模式切换到冰期模式），并在冰期内根据冰情的发展动态调整安全包络参数。这种"运行设计域随工况自适应"的能力，是水系统向更高自主等级迈进的关键技术之一。

#### （4）走向更高水平的自主运行

南水北调中线工程的运行实践正在向更高水平的自主运行推进。当前系统的运行能力可以按照WSAL分级体系进行评估：

在常规输水工况下（占全年运行时间的60%至70%），系统已实现L3级别（条件自主运行）——在定义明确的运行设计域内，系统能够根据需水计划和来水条件自主调节各闸门开度，维持全线水位在目标范围内，无需调度员逐闸下达指令。调度员的角色是监督系统运行状态和审批重大调度方案的调整。

在一般性异常工况下（如单个传感器故障、短时通信中断、小幅度来水偏差等，占运行时间的20%至30%），系统处于L2级别（部分自主运行）——系统能够自动检测异常并在局部范围内自主调整控制策略，但需要调度员确认异常的处置方案。

在极端工况下（如大洪水、严重冰期、重大设备故障、水质突发事件等，占运行时间不到5%），系统处于L1级别（辅助运行）——系统提供决策建议和风险预警，但关键决策由调度员做出，系统负责执行。

向更高水平的自主运行推进，面临若干关键挑战。第一是运行设计域的扩展——需要将更多工况类型（特别是复合型异常工况）纳入系统能够自主处理的范围，这要求建立更完善的场景库、更精确的预测模型和更鲁棒的控制策略。第二是异常检测和故障诊断能力的提升——系统需要能够识别"从未见过"的异常模式，而不仅仅是匹配预定义的报警规则；这需要融合物理模型的一致性检验和数据驱动的异常检测方法。第三是人机协作界面的深度优化——随着系统自主程度的提高，调度员需要从"操作者"转变为"监督者"，这要求界面能够清晰展示系统的决策逻辑、置信度和风险评估，使调度员能够在秒级到分钟级内判断是否需要介入。第四是跨省协调机制的标准化——中线工程跨越四省市，不同管理段的调度权限划分和信息共享机制需要进一步标准化和自动化。

### 2.7.4 三大案例的共性启示与理论提炼

> **表 2-7　南水北调中线工程CHS应用关键参数**
> *Table 2-7 Key Parameters of CHS in SNWTP Middle Route*
>
> | 参数/指标 | 数值 | 说明 |
> |:--------:|:----:|:-----|
> | 总干渠长度 | 1,432 km | 丹江口→北京团城湖 |
> | 节制闸数量 | 64座 | 含退水闸、分水口门 |
> | SCADA测点数 | ~10,000+ | 水位/流量/闸位/水质等 |
> | 冰期安全流速窗口 | 0.4~0.6 m/s | 低于0.3冰过厚，高于0.8冰破碎 |
> | 冰期输水流量削减 | 20%~40% | 相对常规工况 |
> | 冰期水温预测精度 | ±0.2°C | 冰-水耦合热力学模型 |
> | 控制时延（中央→末端） | 数十小时 | 水力波传播+通信延迟 |
> | WSAL当前等级 | L2（部分L3试点） | 2025年评估 |
> | WSAL目标等级 | L3（2030）→L4（2035） | 路线图规划 |
> | 数据来源 | — | 吴长彬等(2019)[188]、Lei(2025)[228]、中国水科院技术报告(2023)[144] |

综合三个工程案例的实践经验，可以提炼出以下深层次的共性启示：

第一，CHS理论框架具有跨工程类型的普适性。从长距离明渠调水（胶东）到水电梯级联合调度（沙坪）到超大规模跨流域调水（南水北调），CHS核心概念——闭环控制、分层分布式架构、模型预测控制、安全包络、多目标协同——在不同工程中都得到了有效验证。这种普适性源于CHS对水系统运行本质问题的抽象——"感知—建模—预测—优化—执行—反馈"的控制闭环和"安全—稳定—高效"的目标层次是共通的。

第二，从理论到工程的转化需要系统化的验证流程。三个工程一致表明，控制算法从实验室到现场需经历"离线仿真—MIL—SIL—HIL—现场试运行—正式上线"的完整验证链。任何环节的缺失都可能导致上线后性能不达预期。这一认识催生了CHS理论中专门的"在回路测试"方法论（详见§4.5）。

第三，工程实践是理论创新的最重要驱动力。CHS中的许多核心概念——安全包络（源于冰期运行的极端约束需求）、运行设计域（源于多工况切换管理需求）、可控模型族（源于在线控制对精度与效率的折中需求）、双AI引擎（源于数值优化与人工理解之间的鸿沟）——都是在工程中遇到具体问题后经理论抽象而形成的。这种"实践问题→理论概念→工程方法→更广泛实践"的螺旋上升是CHS学科发展的根本动力。

第四，人机协作是当前阶段的现实路径。三个工程经验一致表明，完全自主运行（WSAL L5）尚不现实，但条件自主运行（WSAL L3）在限定ODD内已完全可行且效果显著。人机协作——机器处理常规和可预见工况，人处理异常和不可预见工况——是从L2到L4过渡阶段最务实的策略。

第五，标准化与可复用性是规模化推广的关键。三个工程虽形态各异，但控制架构、建模方法和验证流程具有相当共性。将这些共性抽象为标准化技术规范和可复用软件模块，是CHS从"点上突破"走向"面上推广"的必由之路。HydroOS水网操作系统的设计正基于这一认识——将CHS核心方法封装为标准化组件，使其能在不同工程中快速部署和定制配置（详见§4.4）。

事实上，CHS理论的工程验证并不限于上述三个案例。在城市智慧水务领域，福州市智慧水务系统（供水管网压力优化与漏损控制）和中山市智慧水务系统（排水雨洪协同调度）也在不同程度上应用了CHS框架中的核心方法（详见§3.2）。这些项目与前述三个大型调水/水电案例一起，构成了CHS理论从"长距离调水→水电梯级→超大规模调水→城市水务"的完整工程验证谱系，进一步证实了CHS理论框架的跨领域普适性。

第六，理论与工程的双向驱动是学科持续进步的保障。回顾三大案例的发展历程，可以清晰地看到"工程需求拉动理论创新"和"理论突破推动工程升级"的双向循环。胶东调水工程的大时滞控制难题拉动了MPC方法在水系统中的系统化应用；MPC方法的成功应用又推动了工程管理层对控制自动化的更高期望，进而提出更具挑战性的运行需求。沙坪梯级的多目标冲突拉动了一体化优化方法的发展；优化方法的进步又使"一键调"成为可能，极大提升了梯级调度效率。南水北调的冰期安全问题拉动了冰水力学耦合建模理论的发展；冰期模型的建立又为冰期安全运行提供了科学依据，使冬季输水成为可能。这种理论与工程的良性互动，正是CHS作为一个应用导向学科保持生命力的根本机制。

---

**思考与讨论**

1. （数据分析）对比表2-5（胶东调水）和表2-7（南水北调中线）的CHS应用效果，两个工程的控制精度差异主要由什么因素决定？
2. （综合应用）三大工程案例目前的WSAL等级均为L1-L3。请选择其中一个工程，分析其从当前等级向L4跃迁需要突破的关键瓶颈。


---


---

### §2.7 本节小结


本节通过胶东调水、沙坪水电和南水北调中线三大工程案例验证了CHS理论的实践价值。三大案例的共性启示：（1）分层分布式控制是大型水网的唯一工程可行架构；（2）安全包络机制是获得自主运行授权的前提；（3）物理AI与认知AI的融合能够覆盖从常规到异常的全工况谱；（4）理论与工程的双向驱动是学科持续进步的保障。目前三大案例的WSAL等级为L1-L3，向L4跃迁需要突破ODD扩展和xIL验证两个瓶颈。

# 第三部分　现状与挑战：智慧水利的多维审视

"智慧水利"是过去十年中国水利行业出现频率最高的词汇之一。然而，当我们深入询问"智慧水利到底智慧在哪里"时，答案往往令人尴尬——大多数所谓的智慧水利系统，本质上仍是"屏幕更大的SCADA"。数据采集能力确实提升了数十倍，但数据能否自动转化为控制决策？答案是：绝大多数情况下，不能。

本部分对智慧水利进行一次不回避问题的"体检"。§3.1以EMS五代演进框架为坐标系，厘清"智慧水利"的真实内涵和历史方位；§3.2评估中国的发展现状——哪些方面进展显著，哪些差距触目惊心；§3.3深入解剖市场碎片化、数据孤岛、人才断层等深层挑战的根因；§3.4以荷兰、以色列、澳大利亚等为参照镜，看看国际同行走到了哪里。

本部分与前两部分的关系是：第一部分建立了理论工具，第二部分展示了技术演进，本部分则回答一个更现实的问题——**理论和技术准备好了，但工程实践跟上了吗？差距在哪里？** 这一诊断为第四部分的未来路线图提供了出发点。


## 3.1 智慧水利的定义与演进阶段

"智慧水利"是一个具有中国特色的术语，其内涵随着技术和认识的发展而不断丰富。从广义上说，智慧水利是指利用物联网、大数据、人工智能、云计算等新一代信息技术，实现水利工程和水资源管理的智能化、精细化和高效化。然而，如果仅停留在这一笼统的定义层面，就无法深刻理解智慧水利的技术内核和演进脉络。本节将从运行管理系统（Energy Management System, EMS）五代演进框架出发，系统梳理水利信息化从人工观测到自主运行的百年演进历程，揭示每一代系统跃迁的技术驱动力和内在逻辑。

### 3.1.1 EMS五代演进框架：总体视图

要理解智慧水利的历史方位和未来走向，首先需要建立一个纵贯全局的历史坐标系。雷晓辉（2025a）提出的运行管理系统（EMS）五代演进框架，为这一梳理提供了系统性的分析工具。该框架将水利工程运行管理系统的发展概括为五个代际：

| 代次 | 时期 | 核心范式 | 决策主体 | 代表技术 | 信息流特征 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 第一代 | 1960年代前 | 人工观测+经验调度 | 完全人工 | 水尺、雨量筒、电话 | 单向、低频、模拟 |
| 第二代 | 1960-1990年代 | 遥测遥控+集中监控 | 人工决策，机器辅助 | SCADA系统 | 双向、中频、数字化 |
| 第三代 | 1990-2010年代 | 模型驱动+优化调度 | 人工决策，模型建议 | 水动力模型+优化算法+HDC | 闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）、高频、模型嵌入 |
| 第四代 | 2010-2020年代 | 数据驱动+智能决策 | 人机协同 | 机器学习+数字孪生 | 全域感知、智能分析 |
| 第五代 | 2020年代起 | 自主运行+人机共融 | 机器决策，人类监督 | CHS+HydroOS+MAS | 自主闭环、自适应进化 |

这五代演进并非简单的技术替代关系，而是能力的逐层叠加。第五代系统并不抛弃前四代的成果，而是在其基础上实现质的飞跃——每一代系统的核心能力都被继承并整合到更高代次的系统中。这一"叠加式演进"的特征，决定了在理解和建设智慧水利时，不能跳过任何一个发展阶段，必须在每一代的基础能力充分夯实之后，才能向更高代次迈进。

> **图 3-1　EMS五代演进与WSAL等级的对应关系**
> *Fig. 3-1 EMS Five Generations and Corresponding WSAL Levels*
>
> ```
>   能力
>   水平
>    ▲
>    │              ┌─────────────────────────────┐
>    │              │  第五代: 自主运行+人机共融    │ WSAL L3-L5
>    │              │  CHS + HydroOS + MAS         │
>    │         ┌────┴─────────────────────────┐    │
>    │         │  第四代: 数据驱动+智能决策    │    │ WSAL L2-L3
>    │         │  ML + 数字孪生               │    │
>    │    ┌────┴─────────────────────────┐    │    │
>    │    │  第三代: 模型驱动+优化调度    │    │    │ WSAL L1-L2
>    │    │  水力模型 + 优化算法          │    │    │
>    │  ┌─┴──────────────────────────┐   │    │    │
>    │  │  第二代: 遥测遥控+集中监控 │   │    │    │ WSAL L0-L1
>    │  │  SCADA系统                 │   │    │    │
>    │┌─┴────────────────────────┐   │   │    │    │
>    ││  第一代: 人工观测+经验    │   │   │    │    │ WSAL L0
>    ││  水尺 + 电话 + 调度图表  │   │   │    │    │
>    │└──────────────────────────┘   │   │    │    │
>    └──┬────┬────┬────┬────┬───────────────────→ 时间
>     1960  1980  2000  2010  2020  2030
>
>    ← 中国当前主体水平 →
>        (第三代向第四代过渡)
> ```

### 3.1.2 第一代：人工观测与经验调度（1960年代前）

水利工程运行管理的第一代系统，完全依赖人工观测和经验调度。在现代水文仪器和通信技术出现之前，值守人员通过水尺观测水位，用雨量筒测量降雨，然后通过电话或电报向上级汇报水情。调度决策完全依赖调度员的个人经验和简单的调度规程——通常是一张纸质的调度图表（Regulation Chart），标注了在不同来水条件下应采取的操作。

这一时期的核心特征可以概括为"三依赖"：依赖人工感知、依赖经验判断、依赖手动执行。信息传递的方式是单向的、低频的、模拟的——从观测站到调度中心的信息传递，可能需要数小时甚至一天的时间。在这种信息条件下，调度决策本质上是一种基于历史经验的"开环控制"——决策一旦做出，在较长时间内无法根据系统的实时反馈进行修正。

然而，不能因此低估第一代系统的价值。经过数十年甚至上百年的运行实践，老一辈调度员积累了对水文规律和工程特性的深刻直觉。他们能够通过观察天象、河流颜色、水面波纹等微妙信号，预判洪水的到来和规模。这种基于长期经验积累的"隐性知识"（Tacit Knowledge），至今仍是水利调度智能化需要继承和超越的宝贵财富。从人工智能的角度看，这些经验知识恰恰是知识图谱（knowledge graph，以图结构存储实体及其关系的知识表示方法，如'闸门A→控制→渠段B→连接→闸门C'）和专家系统试图形式化的对象；从控制论的角度看，调度员的直觉判断实际上是一种在大脑中执行的非参数化模型预测控制——虽然没有明确的数学模型，但调度员基于对系统动态特性的经验理解，在头脑中预测不同操作的后果，并选择预期效果最好的方案。

这一模式在小型、单一功能的水利工程中尚可运行，但面对大型复杂系统则捉襟见肘。随着水利工程规模的扩大和功能的复杂化，信息传递慢、决策链条长、响应速度低的局限性日益凸显，推动了第二代系统的诞生。

### 3.1.3 第二代：SCADA系统与集中监控（1960-1990年代）

20世纪60年代，随着传感器技术、遥测遥控技术和通信技术的发展，数据采集与监控系统（Supervisory Control and Data Acquisition, SCADA）开始进入水利行业。SCADA系统的引入，实现了从人工观测到远程自动采集、从现场操控到远程集中控制的跨越，是水利运行管理的第一次技术革命。

SCADA系统的基本架构包括三个层次：现场层（Remote Terminal Unit, RTU或Programmable Logic Controller, PLC）负责数据采集和设备控制；通信层负责数据传输；中控层（Master Terminal Unit, MTU）负责数据显示、报警和人机交互。调度员可以在中控室内实时监测整个系统的运行状态，包括水位、流量、闸门开度、泵站运行状态等关键参数，并通过操作界面远程控制闸门启闭和泵站启停。

在国际上，SCADA技术在水利领域的应用以美国垦务局（U.S. Bureau of Reclamation, USBR）为代表。1991年，Buyalski编写了《渠道系统自动化手册》（*Canal Systems Automation Manual*），系统总结了SCADA在灌溉渠系中的应用经验，涵盖了传感器选型、RTU配置、通信协议、人机界面设计等方面的工程实践 [Buyalski, 1991]。在法国，CEMAGREF（后更名为IRSTEA，再更名为INRAE）的Malaterre等人在Société du Canal de Provence等灌区实施了SCADA+自动控制系统，将SCADA从单纯的监控工具扩展为半自动调度平台 [Malaterre, 1998]。

在中国，SCADA技术从20世纪90年代开始大规模引入水利行业。引滦入津工程、引黄济青工程率先配备了SCADA系统，实现了对长距离输水工程的远程监控。此后，随着国家水利信息化建设的推进，全国主要的大中型水利工程基本都配备了不同程度的SCADA系统。到21世纪初，中国已形成了覆盖主要流域和重点工程的水利SCADA网络。

然而，传统SCADA系统本质上是一个"监"和"控"的工具——它帮助人看得更远、手伸得更长，但并不帮助人做决策。调度决策仍然完全依赖人的判断。当系统规模增大、工况变化加快时，SCADA提供的海量实时数据反而可能让调度员"信息过载"，形成"看得见但管不过来"的困境。从控制论的视角分析，SCADA系统实现了"感知"（Sensing）和"执行"（Actuation）的远程化和自动化，但"决策"（Decision-making）环节仍然是人工的、开环的。要实现真正的闭环控制，还需要将数学模型和优化算法嵌入调度决策过程——这正是第三代系统的核心突破。

### 3.1.4 第三代：模型驱动与分层分布式控制（1990-2010年代）

第三代运行管理系统的核心标志是将数学模型和优化算法嵌入调度决策过程，实现了从"人工决策+机器执行"到"模型建议+人工确认+机器执行"的跃迁。这一阶段的里程碑式成就是分层分布式控制（Hierarchical Distributed Control, HDC）理论和方法的建立与工程应用。

HDC的核心思想来自大系统控制理论（Large-Scale System Theory）：将复杂的大系统分解为多个层级和多个局部子系统，每个子系统由本地控制器管理，通过层级之间的协调机制实现全局优化。在水利系统中，典型的HDC架构包括三个层级：

第一层（L0，本地控制层）：负责单个闸门或泵站的本地自动控制。本地控制器根据上层下达的设定值（水位或流量目标），采用PID或其他反馈控制算法，自动调节闸门开度或泵站转速，响应速度在秒到分钟级。这一层的控制是完全自动化的，不需要调度员干预。

第二层（L1，渠段/区域控制层）：负责多个相邻闸门或泵站的协调控制。区域控制器基于本区域内各控制节点的状态信息，运行模型预测控制（MPC）或其他优化算法，计算各节点的最优设定值，然后下达给L0层执行。响应速度在分钟到小时级。这一层解决的是多变量耦合控制问题——相邻闸门的操作会相互影响，需要协调优化。

第三层（L2，全系统调度层）：负责全系统的优化调度。系统级调度器根据来水预报、用水需求、工程约束等信息，运行全局优化模型，确定各区域的目标水量分配和关键断面的目标水位/流量，然后下达给L1层执行。响应速度在小时到天级。

这一架构的理论基础可以追溯到20世纪70年代Mesarović等人的多层级系统理论（Multi-level Systems Theory）和Singh等人的大系统优化分解理论。在水利领域，Litrico和Fromion（2009）在其经典著作《水力系统的建模与控制》（*Modeling and Control of Hydrosystems*）中，系统建立了明渠水力系统的传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）模型和频域控制设计方法，为HDC的控制器设计提供了理论基础 [Litrico & Fromion, 2009]。

Van Overloop（2006）在其博士论文《开放水道系统的模型预测控制》（*Model Predictive Control on Open Water Systems*）中，将MPC方法引入开放水道系统，实现了基于滚动时域优化的在线调度 [Van Overloop, 2006]。Clemmens和Schuurmans（2004）则发展了基于积分延迟零（IDZ）模型的渠道控制方法，将渠池的复杂水力动态简化为三参数传递函数，极大地降低了控制器设计的复杂度 [Clemmens & Schuurmans, 2004]。

在国际工程实践方面，HDC方法在多个大型灌区取得了成功应用。法国的Canal de Provence灌区采用了IRSTEA开发的SIC²软件进行模型仿真和控制器设计，实现了灌区渠系的自动化运行。美国的中央亚利桑那调水工程（Central Arizona Project, CAP）实施了多层级的自动控制系统。澳大利亚的Goulburn-Murray灌区引入了自动化控制技术，显著提高了灌溉水利用效率。2014年，美国土木工程师学会（ASCE）出版了《灌溉系统渠道自动化》（*Canal Automation for Irrigation Systems*, MOP 131），系统总结了HDC在灌区中的应用实践和工程规范，标志着这一技术从研究阶段进入工程规范化阶段 [ASCE, 2014]。

在中国，HDC技术的引入和应用始于南水北调等国家重大水利工程。雷晓辉团队在南水北调中线工程和胶东调水工程中，成功实施了SCADA+HDC控制系统，实现了长距离输水渠道的自动化控制。这些工程实践为中国水利工程从SCADA时代向智能化时代的跨越积累了宝贵的经验。

然而，第三代系统也存在明显的局限性。首先，HDC高度依赖精确的数学模型，而水利系统的模型参数往往随工况变化（如糙率随季节变化、渠道断面随淤积变化），导致模型精度下降。其次，MPC等优化算法的计算量随系统规模增大而急剧增加，在超大规模系统中面临实时计算的挑战。第三，HDC在处理突发事件和非常规工况时灵活性不足——模型之外的不确定性（如突发污染、非预期的支渠取水等）难以在优化框架内处理。这些局限性催生了对数据驱动方法和人工智能技术的需求，推动了第四代系统的出现。

### 3.1.5 第四代：数据驱动与智慧水利（2010-2020年代）

2010年代以来，大数据、云计算和人工智能技术的蓬勃发展催生了"智慧水利"浪潮。如果说第三代系统是"模型驱动"的，那么第四代系统则是"数据驱动"的——它不再完全依赖基于物理机理的数学模型，而是利用机器学习方法从海量运行数据中自动学习规律和模式。

在技术层面，第四代系统的主要特征包括：

第一，广泛的数据感知能力。物联网（IoT）技术的成熟使得传感器的部署密度和数据采集频率大幅提升。遥感卫星、无人机、视频监控等技术手段的引入，进一步扩展了水利感知的时空覆盖范围。到2020年代初，中国已建成覆盖水文、水质、工情等多要素的水利监测站网，实时数据量达到TB级。

第二，机器学习的广泛应用。深度学习方法被应用于水文预报（LSTM时间序列预测）、洪水预警（卷积神经网络图像识别）、管网漏损检测（异常检测算法）、水质预警（多参数融合分析）等多个领域。在水文预报方面，Kratzert等人（2018）的研究表明，LSTM网络在区域尺度的降雨-径流预报中可以达到甚至超过概念性水文模型的精度 [Kratzert et al., 2018]。

第三，数字孪生技术的引入。数字孪生（Digital Twin）的概念从制造业引入水利领域，试图构建水利工程的高保真虚拟镜像，实现"以虚映实、以虚控实"。数字孪生的核心价值在于：它将物理空间的水利工程映射到信息空间，在虚拟环境中可以快速模拟不同调度方案的效果（"预演"），从而为实际调度决策提供更加科学的依据。

在政策层面，中国水利部于2019年组织编制了《智慧水利总体方案》，标志着中国水利信息化从"数字化"向"智慧化"的战略转型 [水利部, 2019]。2021年，水利部首次提出"数字孪生流域"概念，并于2022年发布了《数字孪生流域建设技术大纲（试行）》，为数字孪生水利的建设提供了技术指导 [水利部, 2022]。此后，一批数字孪生试点项目相继启动，涵盖长江、黄河、淮河等主要流域和都江堰、丹江口等重点工程。

从控制论的视角来看，中国水利部提出的"四预"功能——预报、预警、预演、预案——恰好对应了闭环控制的各个环节。**预报**对应"感知和预测"：获取系统当前状态并预测未来变化趋势；**预警**对应"偏差检测"：判断系统状态是否接近或超出安全运行范围；**预演**对应"决策仿真"：在虚拟环境中模拟不同调度方案的效果；**预案**对应"控制策略"：制定应对不同情景的调度方案。因此，"四预"可以被理解为控制论闭环各环节的水利化表达——只不过在"四预"体系中，最终的决策执行仍然需要人工确认，属于"人在回路中"（Human-in-the-Loop）的范式。

然而，第四代系统在实践中暴露出若干深层问题：

**"重感知、轻控制"的结构性偏差**。大量投资集中在传感器网络和数据平台建设，但在运行决策和闭环控制方面进展有限。许多"智慧水利"项目最终变成了功能更丰富的SCADA升级版——数据量更大、界面更漂亮、展示功能更多，但并未从根本上改变"人工决策"的运行模式。

**数据驱动方法的固有局限**。纯数据驱动的机器学习模型缺乏物理可解释性，对训练数据之外的工况泛化能力差，难以保证安全约束的满足。特别是在水利这种攸关公共安全的领域，"黑箱"模型的可信度一直受到质疑。当出现训练数据中未曾覆盖的极端工况时，数据驱动模型可能给出完全不可靠的预测——这在防洪调度等场景中是不可接受的。

**数字孪生的"最后一公里"困境**。许多数字孪生项目停留在三维可视化层面，未能实现真正的"以虚控实"。数字孪生的核心价值在于支撑决策，而非展示——如果虚拟空间的模型无法以足够的精度和速度反映物理空间的动态变化，如果模型的输出无法转化为可执行的控制指令，那么数字孪生就沦为了"数字盆景"。

这些问题的根源在于：第四代系统缺乏一个从感知到决策再到执行的**系统性闭环理论框架**。它有强大的感知能力（物联网+大数据），有灵活的分析工具（机器学习），有直观的展示平台（数字孪生），但缺乏将这些能力整合为自主决策系统的"骨架"。这个"骨架"，正是第五代系统——水系统控制论（CHS）——所要提供的。

### 3.1.6 第五代：自主运行与水系统控制论（2020年代起）

第五代运行管理系统的目标是实现水利工程的自主运行（Autonomous Operation）。所谓自主运行，不是简单的"自动化"——自动化是按预设规则执行，而自主运行是系统具备感知、理解、决策和执行的完整闭环能力，能够在复杂多变的环境中自主地做出正确决策，并在必要时请求人类介入。

自主运行与自动化的本质区别，可以从四个维度来理解：

| 维度 | 自动化（Automation） | 自主运行（Autonomy） |
| :--- | :--- | :--- |
| 决策机制 | 基于预设规则的条件—动作映射 | 基于模型+数据的实时优化决策 |
| 工况覆盖 | 仅能处理预设工况集内的情况 | 能够应对运行设计域（ODD）内的所有工况，并在超出ODD时安全退出 |
| 学习能力 | 无自主学习能力，规则一旦设定不会改变 | 能够从运行经验中持续学习，优化决策策略 |
| 安全保障 | 依赖预设的安全联锁逻辑 | 具备安全包络（Safety Envelope）和最小风险状态（MRC）机制 |
| 人机关系 | 人在回路中（Human-in-the-Loop） | 人在回路上（Human-on-the-Loop）或回路外（Human-out-of-the-Loop） |

从自动化到自主化的跨越，需要系统性的理论创新和技术突破。这正是水系统控制论（Cybernetics of Hydro Systems, CHS）应运而生的背景。CHS提供了一个完整的理论框架，包括：统一的系统描述语言（六要素架构）、统一的模型族（五级传递函数层次）、统一的分级体系（WSAL水网自主等级）、统一的验证方法（xIL在回路测试）和统一的软件载体（HydroOS水网操作系统）。

第五代系统的技术架构以多智能体系统（MAS）为核心。在CHS框架下，水网被分解为多个自治域（Zone），每个自治域由一个边缘智能体（Edge Agent）管理；多个自治域组成一个区域，由区域智能体（Area Agent）协调；全系统由中央智能体（Central Agent）进行全局优化。这种"边缘—区域—中央"的三层智能体架构，在保持全局最优性的同时，赋予了每个子系统在通信中断等异常情况下的独立运行能力（"岛自治"能力），大幅提升了系统的鲁棒（robust，指系统在参数变化或外部干扰下仍能保持稳定性能的能力，类似于水利工程中的'抗干扰性'）性和韧性。

从EMS五代演进的总体视角来看，每一代系统的跃迁都伴随着一个核心瓶颈的突破：第一代到第二代，突破了"感知距离"的瓶颈（从人眼到传感器）；第二代到第三代，突破了"决策质量"的瓶颈（从经验到模型）；第三代到第四代，突破了"感知广度"的瓶颈（从局部到全域）；第四代到第五代，突破了"决策自主性"的瓶颈（从人工到自主）。这一演进脉络清晰地表明：水利工程运行管理的发展方向，是从人工依赖型向机器自主型的不可逆转变——不是要取代人，而是要将人从繁重的实时决策中解放出来，让人专注于更高层次的战略决策和异常处置。

### 3.1.7 中国语境下的阶段划分

在中国的政策和学术语境中，水利信息化的发展可以从三个阶段来理解，每个阶段与EMS框架形成清晰的映射关系：

水利信息化阶段（1990年代-2018年）对应EMS第二代的建设和完善，核心是感知网络和数据基础设施的数字化。智慧水利阶段（2019年-2021年）对应第三代向第四代的过渡，核心是从数据采集向智能分析的能力升级。数字孪生水利阶段（2021年至今）处于第四代深化和第五代萌芽的交汇期，核心是"四预"（预报、预警、预演、预案）功能的实现——这一功能体系恰好对应了闭环控制的各个环节（详见§3.1.5的分析）。关于这三个阶段的政策体系、投资规模和具体实施进展，将在§3.2节进行详细论述。

值得注意的是，中国水利信息化的发展呈现出"并行推进、跨越发展"的特征。由于中国幅员辽阔、水利工程数量众多且建设年代跨度大，不同工程的信息化水平差异显著——有些工程仍处于第一代（人工观测）阶段，有些已经在探索第五代（自主运行）技术。因此，中国智慧水利的建设不是线性的"逐代升级"，而是需要根据不同工程的实际条件，采取差异化的发展策略。这种"多代并存"的现实，也为CHS框架提出了一个独特的理论需求：必须能够指导不同发展阶段工程的升级路径，而不仅仅服务于最先进的少数工程。WSAL（水网自主等级）体系正是对这一需求的回应——通过明确的分级标准，帮助每个工程找到自己的"当前定位"和"下一步目标"。

### 3.1.8 五代演进的理论反思

从科学哲学的角度审视EMS五代演进，可以发现每一代系统的跃迁都伴随着一次认识论的转变：

第一代到第二代的跃迁，本质上是**感知方式的变革**——从人的生理感官扩展到电子传感器，使得"远程知晓"成为可能。这是一次空间维度的突破。

第二代到第三代的跃迁，本质上是**推理方式的变革**——从经验直觉到数学模型，使得"基于模型的预测"成为可能。这是一次认知维度的突破。

第三代到第四代的跃迁，本质上是**学习方式的变革**——从人工建模到数据驱动的自动学习，使得"从数据中发现规律"成为可能。这是一次方法论维度的突破。

第四代到第五代的跃迁，本质上是**决策主体的变革**——从"人决策、机器执行"到"机器决策、人监督"，使得"自主闭环控制"成为可能。这是一次范式维度的突破。

每次认识论转变都不是对前一阶段的否定，而是在保留前一阶段核心能力的基础上增加新的维度。第五代系统仍然需要第一代的感知能力、第二代的远程通信、第三代的模型计算、第四代的数据学习——它们像地质学中的沉积岩层一样，每一层都是不可或缺的基础。这一"层叠递进"特性对工程实践的启示是深刻的：跨越式发展并不意味着可以跳过中间环节——一个缺乏高质量感知网络（第二代基础）的工程，不可能直接实现数据驱动的智能决策（第四代能力）。脚踏实地地夯实每一层基础，是通向自主运行的唯一可靠路径。

还值得关注的是每代系统跃迁的"触发模式"。从历史来看，技术推动（technology push）和需求拉动（demand pull）交替发挥着主导作用。第一代到第二代主要由技术推动——传感器和通信技术的进步创造了远程监控的可能性；第二代到第三代主要由需求拉动——复杂工程的运行优化需求催生了计算水力学和优化调度理论；第四代的兴起再次由技术推动——大数据和机器学习的突破开辟了数据驱动方法的广阔空间；第五代的萌芽则是技术推动和需求拉动的双重驱动——一方面AI和自动化技术已经发展到足以支撑有限范围内的自主决策，另一方面水网规模和复杂度的持续增长使得人工决策模式日益难以为继。理解这一"推-拉交替"模式，有助于更准确地判断当前技术发展的阶段和未来的突破方向。

这一演进脉络与第一部分中讨论的智能演化框架高度吻合：感知→推理→学习→自主——人类智能发展的核心脉络，在水系统运行管理的技术演进中得到了忠实的映射。这绝非巧合，而是因为水系统运行管理的本质就是一个"感知—理解—决策—执行"的智能活动，其技术进步必然遵循智能发展的一般规律。

理解这一演进规律，对于把握中国智慧水利建设的方向具有重要的指导意义。它提醒我们：智慧水利不是一个技术名词的更新换代，而是一场从感知方式到决策范式的深层变革。每一代系统的建设，都必须同时夯实本代的核心能力，并为下一代系统的跃迁预留接口和空间。只有这样，才能避免"建了即落后"的困境，实现水利信息化的可持续发展。

---

**思考与讨论**

1. （概念理解）EMS五代演进框架中，从第三代到第四代的关键跃迁是什么？从第四代到第五代呢？
2. （分析应用）请参照图3-1，评估你所熟悉的一个水利工程目前处于EMS哪一代，并说明判断依据。


---


---

### §3.1 本节小结


本节以EMS五代演进框架为坐标系，厘清了"智慧水利"从第一代（人工观测+纸质记录）到第五代（自主运行+认知智能）的百年演进脉络。核心判断：当前中国智慧水利整体处于第三代向第四代过渡阶段——数据采集基本实现但决策闭环尚未建立，"有数据无智能"是普遍现状。CHS理论定位于推动从第四代（智能辅助决策）向第五代（自主运行）的跃迁。

## 3.2 中国智慧水利的发展现状

中国智慧水利的发展具有鲜明的政策驱动特征和工程实践导向。在国家战略层面，从水利信息化到智慧水利再到数字孪生水利，政策框架不断升级迭代；在工程实践层面，以南水北调为代表的重大工程和以数字孪生流域为抓手的试点项目，构成了中国智慧水利的双轮驱动格局。本节从政策体系、重大工程、技术平台和人才培养四个维度，系统梳理中国智慧水利的发展现状。

### 3.2.1 政策驱动与顶层设计

中国智慧水利的发展历程，是一部由政策引领、逐步深化的发展史。从时间轴来看，关键政策节点构成了一条清晰的演进脉络：

**2011-2018年：水利信息化基础建设期**。"十二五"和"十三五"期间，国家大力推进水利信息化建设，重点建设了国家防汛抗旱指挥系统、水资源监控能力建设项目、中小河流水文监测系统等基础设施工程。这一时期的核心目标是"数据上来、命令下去"——即建立覆盖主要流域和重点工程的水文监测和远程控制网络。具体而言，国家防汛抗旱指挥系统投资超过50亿元，建设了覆盖全国的雨水情信息采集传输系统、洪水预报调度系统和视频会商系统；水资源监控能力建设项目覆盖了全国七大流域的取用水大户和省界断面，实现了水资源的在线监控。到2018年底，中国已建成水文监测站点约12万个，其中水位站约3.3万个、雨量站约6万个、水质监测站约1万个，水利数据中心和网络体系初步形成。

但这一时期的信息化建设以"感知"为主，"控制"能力较弱——大量监测数据被采集上来，但自动化闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）控制系统的覆盖率很低，调度决策仍以人工为主。

**2019年：智慧水利元年**。水利部组织编制并发布《智慧水利总体方案》，首次系统性地提出了智慧水利建设的总体目标、技术架构和实施路径。该方案明确了"需求牵引、应用至上、数字赋能、提升能力"的总体思路，提出构建以"数据底板+模型平台+知识引擎"为核心的智慧水利技术体系。方案同时提出了"三位一体"的建设路径：天空地一体化感知体系（卫星遥感+无人机+地面站网）、自动化控制体系（SCADA系统的全面覆盖和升级）和智能化决策体系（大数据分析和人工智能辅助决策）。这一方案标志着中国水利信息化从"数字化"向"智慧化"的战略转型，其核心转变在于：从被动的数据采集和展示，转向主动的分析预测和决策支持。

**2021年：数字孪生元年**。水利部发布《关于大力推进智慧水利建设的指导意见》，将智慧水利建设提升到水利改革发展的战略高度。同年，水利部首次提出"数字孪生流域"概念，开创性地将数字孪生技术理念系统引入水利领域。"四预"能力（预报、预警、预演、预案）被确立为数字孪生水利的核心功能目标。

**2022年：规范化建设期**。水利部发布《数字孪生流域建设技术大纲（试行）》，为数字孪生水利的建设提供了技术规范和标准指引。大纲提出了"2+N"的总体架构——以数字孪生长江和数字孪生黄河为引领工程，同步推进N个数字孪生流域和重点水利工程的建设。技术大纲对数字孪生水利的功能架构进行了系统定义，包括：数据底板层（地理信息、工程信息、监测信息的融合）、模型平台层（水文模型、水动力学模型、水质模型的集成）、知识平台层（规则库、案例库、经验库的构建）和应用系统层（四预功能的实现）。这一架构的提出，将数字孪生水利从概念层面推向了规模化建设的实施阶段。

值得特别指出的是，2022年同时启动了98项数字孪生水利先行先试项目，覆盖了防洪、水资源配置、农村供水、河湖管护等多个业务领域。这些试点项目的集中启动，标志着数字孪生水利从"规划设计"阶段正式进入"建设实施"阶段，其规模和推进速度在全球水利行业中是前所未有的。

同年，教育部将"智慧水利"列入本科专业目录，这是全球首个以"智慧水利"命名的本科专业，标志着智慧水利从技术实践上升到学科建制层面。

**2023年：国家水网战略**。中共中央、国务院印发《国家水网建设规划纲要》，将国家水网建设提升到国家战略高度。规划纲要提出以南水北调东、中、西三线为"纲"，以长江、黄河、淮河、海河等大江大河为"目"，以重要水利调蓄工程为"结"，构建"纲目结合"的国家水网格局。国家水网建设预计总投资超过万亿元，建成后将形成覆盖中国南北东西的水资源配置骨干网络。从系统工程的角度看，国家水网是一个前所未有的超大规模复杂系统——它将多个流域、多条调水线路、多座水库、数以千计的闸站泵站连接成一个相互耦合的整体网络。这种规模和复杂度的水系统，其运行管理已远远超出了传统"人工调度+简单自动化"的能力边界，必须依靠智能化手段才能实现高效、安全、可靠的运行。国家水网的建设，为智慧水利提供了最大的应用场景和需求牵引。

从技术需求角度分析，国家水网的运行管理至少面临四大挑战：一是**多源多汇的全局优化问题**——多条调水线路共用水源、多个城市共享水量，如何在动态变化的供需条件下实现全网最优配置？二是**跨组织协调问题**——国家水网涉及多个流域管理机构、多个省份、多个运行管理单位，如何实现跨组织的信息共享和决策协调？三是**异构系统集成问题**——不同工程建设于不同年代，采用不同厂商的设备和系统，如何实现技术上的互联互通？四是**全天候运行安全问题**——国家水网必须365天24小时不间断运行，任何环节的失误都可能影响数以亿计人口的供水安全。这些挑战的解决，最终都指向一个共同的需求：建立统一的水网智能操作系统和自主运行框架——这正是HydroOS和WSAL所要回应的核心需求。

**2024-2025年：AI深度融合期**。水利部推动"AI+水利"行动，探索大语言模型、生成式人工智能等前沿技术在水利领域的深度应用。这一阶段的政策导向从"建平台"转向"用智能"，强调人工智能技术与水利业务的深度融合。具体举措包括：组织水利行业大模型应用试点、推动智能巡检和缺陷识别的AI应用、探索基于大模型的水文预报增强技术、以及开展水利领域专用大模型的预研。瀚铎水网大模型作为国内首个水网领域的专用大模型，在这一背景下具有重要的先导意义。

### 3.2.2 重大工程实践

中国智慧水利的技术积累，很大程度上来源于重大水利工程的实践探索。以下几项工程具有典型代表性：

**（1）南水北调工程**

南水北调工程是世界上最大的跨流域调水工程，由东线、中线和西线三部分组成。其中，中线工程全长1,432公里，设有64个节制闸、97个分水口门和多个退水闸，是一个典型的大规模、长距离、多约束的水系统控制问题。东线工程全长1,156公里，利用京杭大运河及平行河道，通过13级泵站逐级提水北送，是世界上规模最大的泵站群联合调度工程。

南水北调工程建设了覆盖全线的SCADA自动化监控系统，实现了闸站的远程监控和自动化控制。在自动化控制方面，中线工程采用了分层分布式控制（HDC）体系，在部分渠段实现了基于模型预测控制（MPC）的自动化调度。截至2025年，南水北调中线和东线工程累计调水超过700亿立方米，惠及沿线1.76亿人口。

然而，从运行管理的角度看，南水北调工程的自动化水平仍以"辅助决策"为主。在常规工况下，系统可以在SCADA辅助下进行半自动调度；但在极端工况（如冰期运行、突发水质事件、沿线大规模取水变化等）下，仍高度依赖调度员的经验判断。距离真正的"自主运行"还有较大差距。这一差距的核心原因在于：缺乏一个统一的、覆盖全工况域的自主运行理论框架和验证体系——而这正是CHS和HydroOS所要解决的问题。

**（2）胶东调水工程**

胶东调水工程是山东省重要的跨流域调水工程，西起黄河边的引黄济青工程取水口，东至烟台、威海等胶东地区，全长约483公里，沿线设有多座泵站和调蓄水库。该工程是国内较早全面实施SCADA+HDC控制系统的大型调水工程之一。

雷晓辉团队在胶东调水工程中实施了基于IDZ（积分-延迟-零点）模型的分层分布式控制系统，实现了对长距离输水渠道的自动化控制。该系统将全线划分为多个控制区域，每个区域运行本地MPC控制器，通过区域间的协调机制实现全线的优化调度。工程实践表明，SCADA+HDC系统可以将水位控制精度提高到厘米级，供水保障率显著提升。胶东调水工程的成功实践，验证了HDC技术在中国长距离调水工程中的适用性，为后续更大规模工程的智能化升级积累了宝贵经验。

**（3）引江济淮工程**

引江济淮工程是安徽省最大的水资源配置工程，总投资逾900亿元，工程总长度约723公里，沟通长江与淮河两大水系。工程于2022年底实现试通水，是中国近年来建成的最大规模调水工程之一。引江济淮工程在建设初期就将智慧化作为重要目标，配备了较为完善的SCADA监控系统和初步的智能调度系统。

**（4）沙坪梯级水电站群智能调度**

长江上游沙坪梯级水电站群（包括沙坪一级、沙坪二级、沙坪三级和沙坪四级电站）是一个典型的梯级水电站群联合调度问题。雷晓辉团队在该工程中实施了"一键调度"系统——基于MPC算法的梯级联合优化调度系统，实现了从调度方案编制、闸门开度计算到执行指令下发的全流程自动化。"一键调度"系统的核心技术创新在于：将传统上需要数小时人工计算的调度方案编制过程，压缩到秒级自动完成；将梯级电站之间的水力耦合关系纳入统一的优化模型中，保证上下游电站的协调运行；并通过SIL（软件在环）仿真验证了控制方案在各种典型工况下的安全性和经济性。

**（5）福州智慧水务与中山智慧水务**

在城市供水领域，福州市智慧水务系统和中山市智慧水务系统是两个具有代表性的案例。福州智慧水务系统实现了对全市供水管网的实时监控和压力优化控制，通过分区计量（DMA）和智能压力管理，有效降低了管网漏损率[216]。中山智慧水务系统则在排水防涝方面进行了创新探索，利用实时监测数据和城市内涝模型，实现了排水泵站的智能联合调度。这两个案例表明，智慧水利的技术不仅适用于大型跨流域调水工程，也适用于城市水务的精细化管理。

**（6）数字孪生流域试点**

在数字孪生水利领域，水利部选择了一批重要流域和水利工程作为先行试点。数字孪生长江建设以防洪调度为核心场景，整合了长江流域的水文监测、气象预报、水工程调度等多源数据，构建了覆盖干支流的水动力学模型和洪水预报模型体系。数字孪生黄河建设则聚焦水沙调控和水资源配置，针对黄河"水少沙多"的特殊问题，开发了包含泥沙输移在内的流域数字孪生模型。

在单体工程层面，都江堰、丹江口、三峡等重点工程的数字孪生建设也在积极推进。这些试点项目在三维可视化、水文预报、调度模拟等方面取得了阶段性成果，但距离真正的"以虚控实"仍有差距——大多数数字孪生项目目前处于"可视化展示"阶段，尚未实现模型驱动的实时闭环控制。

### 3.2.3 技术平台与标准体系

中国智慧水利的技术平台建设呈现出"央地协同、多元并进"的格局：

**国家层面**，水利部建设了全国水利一张图（水利地理空间框架）、全国水利数据中心、国家防汛抗旱指挥系统等国家级平台，为智慧水利提供了数据底座和基础设施支撑。

**流域层面**，七大流域管理机构（长江委、黄委、淮委、海委、珠委、松辽委、太湖局）分别建设了各自的水情信息系统、防洪调度系统和水资源管理系统，形成了流域级的信息化平台。

**地方层面**，各省水利厅建设了省级水利数据中心和综合管理平台，部分发达地区（如浙江、广东、江苏）在智慧水利建设方面走在全国前列。浙江省的"浙水安澜"平台率先实现了省域范围内防洪排涝的全要素感知和智能化预警，通过整合气象、水文、市政排水等多源数据，构建了覆盖山洪、城市内涝和流域洪水的立体化风险预警体系。广东省的"粤水慧"平台在珠江三角洲水资源配置工程中引入了数字孪生技术，实现了复杂河网区域水量-水质联合调度的模型化决策支持。江苏省依托南水北调东线工程建设了省级水利云平台，集成了水文预报、工程调度和水质监测等核心功能。这些地方实践的共同特点是：以具体的工程需求为牵引，以数字化平台为载体，在解决本地实际问题的过程中逐步积累智慧水利的技术能力和管理经验。

**国际合作层面**，中国智慧水利的发展越来越重视与国际同行的交流与合作。在多边层面，中国积极参与国际水文计划（IHP）、国际灌溉排水委员会（ICID）和国际水利与环境工程学会（IAHR）等国际组织的活动。雷晓辉教授在IAHR框架下创立了"水系统运行工作组"（Water Systems Operation Working Group），致力于推动水系统自主运行的国际学术标准建设。在双边层面，中国与荷兰（在防洪和水资源管理领域）、以色列（在节水灌溉和智能水表领域）、澳大利亚（在灌区自动化领域）等国家保持着活跃的技术交流。这些国际合作不仅帮助中国引进了先进的技术理念和方法，也为中国的原创性理论（如CHS）和工程经验走向国际提供了平台。

**企业层面**，以华为、阿里、腾讯为代表的科技企业，以及以中国电建、中国水利水电科学研究院为代表的水利专业机构，共同构成了智慧水利技术研发和工程实施的产业生态。华为的水务智能体解决方案将大模型技术引入水利决策，提供从洪水预报到调度方案生成的AI全链条服务；阿里云的水利大脑利用云计算和大数据技术构建流域级的智能分析平台；腾讯的智慧水务平台则在城市供排水精细化管理方面具有特色。

**科研机构层面**，中国水利水电科学研究院（IWHR）在智慧水利技术研发中扮演着核心角色。IWHR自主开发的水利仿真模型库（包括一维/二维水动力学模型、水质模型、泥沙模型等）是国内水利数字孪生建设的重要技术支撑。河北工程大学雷晓辉团队开发的HydroOS水网智能操作系统和瀚铎水网大模型，是国内在水系统自主运行领域最前沿的技术成果。南京水利科学研究院在水工结构健康监测和智能检测方面具有优势。武汉大学、河海大学、清华大学等高校在水文预报、水资源优化、遥感监测等方向也有重要贡献。

然而，中国智慧水利产业生态的一个突出问题是**碎片化和重复建设**。由于缺乏统一的技术标准和开放的平台架构，各地各部门的智慧水利系统往往各自为政，数据格式不统一，系统之间无法互联互通。一些地方的智慧水利项目投入大量资金建设了精美的三维可视化展示系统，但底层的模型和算法能力薄弱，形成了"好看不好用"的局面。解决这一问题，需要建立全行业统一的技术标准体系和开放的平台生态——HydroOS的设计理念正是面向这一目标，通过提供一个标准化的、可扩展的水网操作系统平台，为不同厂商的算法模块和硬件设备提供统一的集成框架。

在标准体系方面，水利行业已发布了一系列与智慧水利相关的技术标准和规范，涵盖水文监测、数据传输、系统集成、数字孪生建设等领域。但总体而言，标准体系尚不完善，特别是在自动控制、人工智能应用、自主运行分级等前沿领域，标准建设明显滞后于技术发展。水网自主等级（WSAL）分级标准的缺失，是当前标准体系中最为突出的短板——没有统一的分级标准，就无法对不同工程的智能化水平进行科学评估，也无法为智能化升级提供明确的目标牵引。

### 3.2.4 学科建设与人才培养

智慧水利的可持续发展，根本上取决于人才培养体系的建立。2022年，教育部将"智慧水利"列入本科专业目录（专业代码：081105T），这是全球首个以"智慧水利"命名的本科专业。截至2025年，全国已有数十所高校开设了智慧水利本科专业，包括河海大学、武汉大学、清华大学、中国农业大学、河北工程大学等。

然而，智慧水利专业的课程体系和培养模式仍处于探索阶段。目前大多数高校的智慧水利专业，是在传统水利工程或水文水资源工程专业的基础上，增加了信息技术和人工智能相关课程。这种"水利+信息"的拼接模式，虽然扩大了学生的知识面，但缺乏将两者有机融合的核心理论课程——学生学了水力学，也学了编程，但不知道如何将水力学模型转化为控制器、如何设计闭环反馈系统、如何验证控制系统的安全性。

从课程设置来看，典型的智慧水利本科课程包括三大模块：水利基础模块（水力学、水文学、水工建筑物、水利工程施工等传统水利课程），信息技术模块（程序设计、数据库技术、物联网原理、地理信息系统等IT课程），以及智能应用模块（人工智能导论、大数据分析、数字孪生技术等新技术课程）。但三个模块之间的有机联系不足——缺少类似"水系统建模与控制"、"水网自动化原理"这样的**桥接课程**，使得学生难以将分散的知识整合为解决实际工程问题的系统能力。

在研究生培养层面，情况相对较好。多所高校已在水利工程一级学科下设置了智慧水利或水系统信息化方向，培养了一批具有交叉学科背景的研究人才。中国水利水电科学研究院的博士后流动站、河海大学的水利信息化团队、清华大学的水沙科学与水利水电工程国家重点实验室等，都在智慧水利高层次人才培养方面做出了重要贡献。但总体而言，具备"水利工程+控制科学+人工智能"三重知识结构的复合型高端人才仍然严重短缺。据估算，未来十年中国智慧水利领域的高端人才需求缺口超过万人，而当前的培养规模远不能满足需求。

这一困境的根源在于：智慧水利需要的核心理论——将水利工程的物理对象转化为可控系统的系统性方法——尚未成为独立的学科。水系统控制论（CHS）正是为填补这一空白而提出的。CHS作为一个融合了水利工程、控制科学和人工智能的交叉学科框架，为智慧水利专业的课程体系提供了理论内核。雷晓辉团队已在河北工程大学建立了CHS方向的研究生培养体系，并正在开发涵盖从入门到高级的四层次教材系统（T1-T2a/T2b-M系列），为智慧水利的学科化发展奠定教育基础。

值得关注的是实验教学和实习平台建设的滞后。智慧水利不同于传统水利的一个重要特点是其高度的工程实践性——学生需要在真实或接近真实的水系统中动手操作控制算法、调试传感器网络、验证调度策略。然而，目前国内大多数高校缺乏专门的水系统控制实验平台。国际上，代尔夫特理工大学（TU Delft）建设了Canal Control Lab（渠道控制实验室），学生可以在微缩渠道系统上实测PID、MPC等控制算法的实际效果；科罗拉多州立大学（CSU）的灌溉培训研究中心（ITRC）与Rubicon公司合作建设了自动化灌溉示范基地。中国在这方面的建设才刚刚起步——河北工程大学正在建设基于HydroOS的水网运行仿真实验平台，整合SIL/HIL测试能力，为学生提供从算法开发到系统验证的完整实训环境。

未来，应当鼓励更多高校建设类似的实验教学平台，并推动校企合作，让学生有机会参与真实水利工程的智能化建设和运维实践。

### 3.2.5 王浩院士的二元水循环理论

在中国水利科学的理论创新中，必须特别提及中国水利水电科学研究院王浩院士提出的"自然-社会"二元水循环理论。该理论深刻揭示了人类活动对水循环系统的影响机制，将传统的"自然水循环"扩展为"自然水循环+社会水循环"的二元结构。

二元水循环理论的核心贡献在于：它建立了自然和社会两个维度水循环过程的耦合模拟方法，发展了基于二元水循环的水资源评价技术，提出了面向生态的水资源配置理论和方法。这一理论框架为变化环境下的水资源评价、配置和管理提供了科学基础，在全国水资源综合规划、南水北调工程规划等重大实践中发挥了关键的支撑作用。

从水系统控制论的视角来看，二元水循环理论对CHS的发展具有重要的启示意义。二元水循环中的"社会水循环"——取水、输水、用水、排水、回用等人类活动——恰恰是水系统控制论的主要控制对象。CHS所关注的水网运行控制问题，本质上就是对社会水循环过程的优化调控。因此，二元水循环理论提供了理解水系统"被控对象"的宏观理论框架，而CHS则提供了实现精确控制的方法论和技术体系——两者在理论层面是互补和协同的关系。

### 3.2.6 现状评估：成就与差距

> **表 3-1　中国智慧水利关键指标现状评估（2024年）**
> *Table 3-1 China Smart Water Key Indicators (2024)*
>
> | 评估维度 | 指标 | 当前水平 | 国际先进水平 | 差距评估 |
> |:--------:|:-----|:--------:|:----------:|:--------:|
> | **感知层** | 大中型水库SCADA覆盖率 | ~85% | >98%（荷兰/以色列） | 🟡 |
> | | 灌区渠系自动化监测率 | ~30% | >90%（澳Rubicon TCC） | 🔴 |
> | | 城市管网DMA分区计量率 | ~15% | >80%（英国/新加坡） | 🔴 |
> | | 水质在线监测覆盖率 | ~40%（重要水源地） | >90%（新加坡PUB） | 🟡 |
> | **模型层** | 具备标定水力模型的工程比例 | ~20% | >70% | 🔴 |
> | | 数字孪生流域试点数量 | 94个（水利部首批） | 全国推广中 | 🟡 |
> | | 实时模型在线率 | ~5%（仅头部工程） | >40%（荷兰RWS） | 🔴 |
> | **决策层** | MPC自动控制工程数量 | <20个 | 数百个（澳/荷/法） | 🔴 |
> | | 调度方案自动生成覆盖率 | ~25%（大型工程） | >60% | 🟡 |
> | | AI辅助决策应用率 | ~10% | ~30% | 🟡 |
> | **执行层** | 闸门远程控制率（大中型工程） | ~70% | >95% | 🟡 |
> | | 闸门自动控制率（闭环） | ~10% | >50%（TCC灌区） | 🔴 |
> | **整体WSAL** | 普遍水平 | L1（部分L2） | L2-L3 | 落后1-2级 |
>

> **说明**: 🔴差距显著 🟡差距中等 🟢基本持平。数据来源：水利部统计公报(2023)、IWA Smart Water Report(2022)、课题组调研估算。

综合以上分析，中国智慧水利的发展现状可以概括为"基础厚实、前沿活跃、短板明显"：

**成就方面**：中国已建成全球规模最大的水利监测站网和SCADA网络，拥有世界上最大的跨流域调水工程群，在数字孪生水利建设方面走在国际前列，首创了"智慧水利"本科专业。截至2024年，全国已建成水文站网约12万处、水利视频监控点超过20万个、SCADA覆盖的大中型水利工程超过4000处。"水利一张图"整合了近2亿条水利空间数据。在工程实践层面，以南水北调、胶东调水为代表的工程积累了丰富的自动化控制经验。南水北调中线工程已累计安全输水超过600亿立方米，日均调度决策数百次，在冰期输水、汛期退水等极端工况下积累了宝贵的运行经验和数据资产。

**差距方面**：与EMS五代框架所描绘的发展愿景相比，中国智慧水利总体上处于第三代（模型驱动）向第四代（数据驱动）的过渡阶段，距离第五代（自主运行）尚有明显差距。主要差距表现在以下几个层面：

**控制架构层面**：自动控制从SCADA+HDC向自主MAS架构的跨越尚未实现。目前大多数工程的自动化系统仍停留在"远程监控+辅助决策"模式，真正实现闭环自动控制的工程占比不足10%。即便是已实现自动化控制的工程，其自动化范围也主要限于常规工况，极端工况下仍依赖人工干预。据调研统计，中国现有大中型水利工程的闸门远程自动控制覆盖率约为35%，而其中能够实现基于实时模型的优化控制（而非简单的水位-开度查表）的工程不超过5%。大量中小型水利工程仍依赖人工现场操作，部分偏远地区的闸站甚至尚未接入SCADA网络。与澳大利亚Rubicon公司在灌区渠道中实现的全自动MPC控制（覆盖率超过90%、闸门响应时间小于1分钟）相比，中国大型调水工程的自动化程度仍有明显差距。特别是在跨省调水工程中，行政边界导致的数据壁垒和调度权分割，使得全线一体化控制更加困难。

**决策智能层面**："四预"功能从辅助决策到自主决策的跨越尚未实现。目前的"四预"系统大多提供"参考建议"而非"执行指令"——系统给出调度方案后，仍需调度员审核确认后才能执行。这种"人在回路中"的模式虽然保守安全，但限制了响应速度和优化空间，特别是在极端工况下，人工决策的延迟可能带来严重后果。

**数字孪生层面**：数字孪生从可视化展示到闭环控制的跨越尚未实现。当前大多数数字孪生项目的核心功能是三维场景展示和数据可视化，模型驱动的实时仿真和预测能力有限，与物理系统的双向交互（"以虚控实"）更是处于起步阶段。数字孪生的真正价值不在于"好看"，而在于"好用"——即能够通过高保真仿真来辅助甚至替代人工决策。国际上，新加坡公用事业局（PUB）的供水数字孪生系统已实现基于实时仿真的漏损定位和水质预警，模型校核周期达到15分钟级；丹麦哥本哈根的排水数字孪生系统可实时模拟暴雨径流过程，为泵站自动调度提供前馈信息。相比之下，中国多数数字孪生项目在模型保真度和实时性方面仍有提升空间，"数据接入率高但模型驱动率低"是一个普遍现象。

**标准体系层面**：标准体系从信息化标准到自主运行分级标准的跨越尚未实现。现有标准主要关注数据格式、通信协议、系统集成等信息化基础内容，缺乏面向自主运行的功能定义、安全要求和测试验证标准。

这些差距的背后，是一个更为根本的理论空白：缺乏一个像汽车工业的SAE自动驾驶分级体系那样的、被行业广泛接受的水利工程自主运行分级标准。没有这样的标准，就无法明确"智慧水利到底要达到什么水平"这一根本问题，也就无法为技术研发和工程建设提供清晰的目标导引。水系统控制论提出的WSAL（水网自主等级）分级体系，正是为解决这一问题而设计的——这将在第四部分详细展开。

---

**思考与讨论**

1. （数据分析）表3-1显示中国灌区渠系自动化率约30%，而SCADA覆盖率约85%。这两个数据之间的巨大落差说明了什么问题？
2. （批判思考）"重建轻管"被认为是中国智慧水利的结构性问题。请分析这一问题的深层制度原因，并提出至少两条可操作的改进建议。


---


---

### §3.2 本节小结


本节评估了中国智慧水利的发展现状（表3-1）。成就方面：政策驱动力强劲（数字孪生流域94个试点）、大型工程SCADA覆盖率~85%、王浩院士二元水循环理论提供了理论基础。差距方面：灌区渠系自动化率仅~30%、管网DMA分区率~15%、实时模型覆盖率<5%、MPC自动控制工程<20个、普遍WSAL等级为L1。差距的根源不在硬件投入不足，而在"运行科学"学科体系缺失——"重建轻管（emphasis on construction over operation, a structural problem in China's water sector where investment heavily favors new infrastructure over operational management）"是结构性问题而非投入问题。

## 3.3 市场格局、技术壁垒与深层挑战

智慧水利不仅是一个技术命题，更是一个涉及产业生态、商业模式和体制机制的系统性工程。要推动智慧水利从试点示范走向规模化应用，必须直面当前面临的市场格局困境和深层技术挑战。本节从产业格局、技术壁垒、数据治理和商业模式四个维度展开分析。

### 3.3.1 产业格局：多元主体与碎片化竞争

中国智慧水利市场的参与主体可以划分为四大类：

**第一类：传统水利信息化企业**。以北京金水信息技术有限公司、南京南瑞水利水电科技有限公司、中水科技股份有限公司等为代表。这些企业深耕水利行业多年，对水利业务流程和工程特性有深入理解，在SCADA系统、水文监测、调度自动化等传统领域占据优势地位。但它们在人工智能、大数据、云计算等新一代信息技术方面的积累相对薄弱，面临向智能化转型的压力。

**第二类：互联网科技巨头**。以华为、阿里巴巴、腾讯、百度等为代表。这些企业拥有强大的云计算、大数据和人工智能技术能力，近年来积极布局水利市场。华为推出了水务智能体解决方案，阿里云开发了水利大脑平台，腾讯构建了智慧水务解决方案。这些企业的优势在于平台能力和技术生态，但对水利行业的专业理解不够深入，容易陷入"技术找场景"而非"场景拉技术"的误区。

**第三类：国有大型工程集团**。以中国电建、中国能建、中国水利水电科学研究院等为代表。这些机构兼具工程设计能力和一定的信息化能力，在大型水利工程的智能化建设中扮演着总承包商的角色。它们的优势在于理解工程全生命周期，能够将信息化需求融入工程设计和建设过程。

**第四类：垂直领域创新企业**。近年来涌现了一批专注于智慧水务、智慧灌溉、管网检测等细分领域的创新型企业。这些企业通常在某个垂直场景中拥有独特的技术优势，但规模较小，难以承担大型综合性项目。

这四类主体之间既有竞争又有合作，但总体呈现"碎片化"的竞争格局——没有一个主体能够覆盖从传感器到算法、从硬件到软件、从建设到运维的完整产业链。据行业估算，中国智慧水利市场规模在"十四五"期间预计超过2000亿元，但市场高度分散，前十大企业的市场集中度不足20%。相比之下，电力行业的SCADA/EMS市场由ABB、西门子、GE等少数巨头主导，市场集中度超过60%。

造成水利行业市场碎片化的原因是多方面的。从需求端看，水利工程的差异性远大于电力工程——每一条渠道、每一座水库的水文地质条件和运行需求都不尽相同，标准化产品的适用性有限。从供给端看，水利信息化的技术壁垒不够高——中低端的SCADA和监测系统的技术门槛相对较低，导致大量中小企业涌入市场。从体制层面看，水利工程的投资主体以各级政府为主，政府采购的分散性和地域性导致市场呈现明显的区域割据特征——华北、华东、华南等区域各有其主导供应商，跨区域扩张困难。

另一个不可忽视的产业链短板是**核心组件的自主可控**问题。智慧水利系统中的高精度传感器（如超声波流量计、雷达水位计）、高可靠性工业控制器（如PLC）、实时操作系统和工业通信协议栈，长期以来依赖国外品牌（如Endress+Hauser、Siemens、Rockwell等）。在当前国际形势下，核心组件的供应链安全已成为一个战略性议题。近年来，国产替代在部分领域取得了积极进展——例如国产超声波流量计在中低精度场景已基本可用、国产PLC在非关键控制回路中开始推广——但在高精度、高可靠性场景中，国产产品与国际领先水平仍有差距。

这种碎片化格局导致了几个突出问题：系统集成难度大，不同供应商的产品之间互联互通困难，一个智慧水利项目往往需要协调十几家供应商的产品，集成测试的工作量占到整个项目实施周期的30%以上；项目交付后的运维支持不足，许多系统在项目验收后逐渐沦为"摆设"——据调查，约30%的水利信息化项目在建成后3-5年内功能显著退化，部分系统完全停用；技术路线不统一，同一个流域内不同工程采用不同的技术标准和数据格式，增加了后期整合的难度。更深层的问题是，碎片化格局阻碍了水利行业的技术标准化和知识积累——每个项目都在"重新发明轮子"，缺乏可复用的技术组件和经验传承机制。

### 3.3.2 技术壁垒：从"能做"到"好用"的鸿沟

智慧水利在技术层面面临的挑战，不在于单项技术的突破，而在于将各项技术有机整合为可靠、可用、可维护的工程系统。这一"集成鸿沟"具体表现在以下几个方面：

**模型精度与实时性的矛盾**。高精度的水动力学模型（如求解完整圣维南方程（Saint-Venant equations，描述明渠水流运动的基本方程，由连续性方程和动量方程组成）的一维非恒定流模型）计算量大，难以满足实时调度的要求；而简化模型（如IDZ传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）模型）虽然计算速度快，但在非常规工况下精度下降。如何在精度和速度之间找到最优平衡点，是一个尚未完全解决的工程难题。CHS提出的五级模型层次（LSV→IDZ→ID→I→SS）为这一问题提供了理论框架，但各级模型的自动切换和在线校正机制仍有待完善。

**数据质量与算法需求的矛盾**。机器学习算法对训练数据的质量和数量有很高要求，但水利领域的运行数据往往存在缺失、噪声大、标注不足等问题。特别是极端工况（如罕见洪水、冰期运行）的数据极为稀少，而这恰恰是最需要智能决策支持的场景。此外，不同工程的数据格式和标准不统一，增加了跨工程数据共享和模型迁移的难度。

**控制系统的安全性与可靠性**。水利工程是关系国计民生的关键基础设施，其控制系统的安全性和可靠性要求极高。任何控制失误都可能导致洪水、断水等严重后果。这一特性决定了智慧水利不能简单移植其他行业的技术方案——例如，互联网行业的"快速迭代、容忍失败"模式在水利控制领域是不可接受的。水利控制系统需要经过严格的验证和测试才能上线运行，而当前缺乏系统性的验证方法和标准。CHS提出的xIL（在回路测试）验证框架——从MIL（模型在回路）到SIL（软件在回路）到HIL（硬件在回路）到PIL（现场在回路）的渐进式验证流程——为解决这一问题提供了方法论，但其工程化实施仍需大量的基础工作。

**工控安全与网络安全的挑战**。智慧水利系统的网络化使得水利工程面临日益严峻的网络安全威胁。SCADA系统和工业控制系统的安全漏洞可能被恶意利用，导致严重的安全事故。2021年，美国佛罗里达州Oldsmar水处理厂遭遇网络攻击，攻击者试图将水中氢氧化钠浓度提高到危险水平——这一事件警示了水利工控安全的严峻形势。中国在水利工控安全领域的投入和标准建设仍处于起步阶段。水利SCADA系统通常部署在内网环境中，但随着远程运维、云平台和物联网设备的引入，网络攻击面不断扩大。建立水利专用的工控安全防护体系，包括入侵检测、异常行为识别、安全加固和应急响应机制，是智慧水利建设中不可忽视的重要环节。

**人机交互与信任建立的挑战**。智慧水利系统的最终用户是调度员和管理人员，他们对AI系统的信任程度直接决定了系统的实际使用效果。调查显示，许多调度员对自动化决策系统持谨慎甚至抵触态度——他们担心系统故障会导致严重后果，更倾向于依靠自己的经验判断。这种"信任赤字"不是简单的培训问题，而是需要通过长期的、渐进的"人机协同磨合"来逐步建立。在汽车自动驾驶领域，从L2到L3的跨越——即从"人监督机器"到"机器自主运行、人在旁监督"——被称为"信任鸿沟"（Trust Gap），这在水利领域同样存在。WSAL框架中从L2到L3的跃迁，不仅是技术问题，更是人因工程（Human Factors Engineering）问题。

**异构系统的互操作性挑战**。中国水利工程建设跨越了不同的技术时代——从20世纪80年代的模拟式仪表到21世纪的数字化系统，从国产设备到进口设备，从私有协议到标准协议，各种技术代际的设备共存于同一个工程中。将这些异构设备和系统统一纳入智能化管理框架，面临着通信协议转换、数据格式标准化、遗留系统改造等一系列工程化难题。在欧美水利行业，WaterML2.0等国际数据标准的推广在一定程度上缓解了互操作性问题，但中国水利行业在数据标准的统一推广方面仍需加大力度。

### 3.3.3 数据孤岛与治理困境

数据是智慧水利的基础要素，但"数据孤岛"问题是当前最为突出的瓶颈之一。这一问题在水利领域表现得尤为严重，原因在于水利数据具有多源异构、分散管理和权属复杂的特点。

**多源异构**。水利数据来源多样，包括水文监测数据、气象数据、遥感数据、工程运行数据、水质数据、社会经济数据等，各类数据的格式、精度、时空分辨率和更新频率差异巨大。将这些异构数据融合为统一的、可用于决策的信息，面临着巨大的技术挑战。

**分散管理**。在行政体制上，水利数据分散在水利部、各流域管理机构、各级地方水利部门、水利工程管理单位等不同层级和部门。各部门的数据系统往往是独立建设的，数据标准不统一，接口不规范，形成了一个个"数据烟囱"。跨部门、跨层级的数据共享面临着技术、制度和利益等多重障碍。

**权属复杂**。水利数据涉及国家安全（水利工程的详细参数和运行数据属于敏感信息）、公共利益（水文数据是公共资源）和商业利益（企业开发的算法和模型具有商业价值）等多种权属关系。如何在保障数据安全的前提下促进数据的开放共享和高效利用，是一个需要在制度层面解决的问题。

**国际对比的启示**。在水利数据治理方面，一些国家的做法值得参考。美国地质调查局（USGS）的国家水文信息系统（NWIS）提供了全美数千个水文站点的实时和历史数据的免费公开访问，采用统一的WaterML格式，这极大地促进了科学研究和技术创新。澳大利亚的水资源数据基础设施（Bureau of Meteorology Water Data）建立了覆盖全国的标准化水数据平台，各州政府和水务公司必须按统一标准提交运行数据。欧盟的《水框架指令》（Water Framework Directive）要求成员国按统一标准报告水体状况数据。这些国际经验的共同点是：政府主导建立数据标准，法律强制要求数据共享，公共资金支持数据平台运行。中国在水利数据治理方面，虽然水利部已经推动了《水利信息化标准体系》等标准的制定，但标准的实际执行力度和覆盖范围仍有较大提升空间。

数据孤岛问题的危害是深远的。它不仅增加了系统建设和运维的成本，更重要的是，它阻碍了跨区域、跨流域的协同优化——而这恰恰是国家水网运行管理的核心需求。一个覆盖全国的水网系统，如果不同区段的数据不能互联互通，那么全局优化调度就无从谈起。

数据孤岛问题的解决需要"技术+制度"双轮驱动。在技术层面，需要建立统一的水利数据模型和交换标准（参照电力行业的CIM公共信息模型），开发高效的数据清洗、对齐和融合工具，探索联邦学习等隐私保护技术以实现"数据不动模型动"的跨机构协作。在制度层面，需要明确水利数据的分级分类管理办法，建立数据开放共享的激励机制和责任机制，制定数据使用的安全审计规范。水利部近年来推动的"全国水利一张图"和"水利数据中心"建设，正是在数据治理方面的重要举措，但从"物理汇聚"到"逻辑融合"还有相当的距离。

特别值得关注的是联邦学习（Federated Learning）在水利数据治理中的应用前景。联邦学习是谷歌于2016年提出的一种分布式机器学习范式，其核心思想是"数据不动模型动"——各参与方在本地使用自己的数据训练模型，仅将模型参数（而非原始数据）上传到中央服务器进行聚合。这一范式特别适合水利行业的数据治理困境：不同流域管理机构和地方水利部门的运行数据可以保留在各自的数据中心，不需要物理集中，但通过联邦学习框架可以训练出融合了多方数据知识的全局模型。例如，各省的防洪调度系统可以在各自的历史洪水数据上独立训练洪水预报模型，然后通过联邦学习聚合各省模型的参数，得到一个综合了全国洪水特征知识的统一模型——这个模型的预报能力优于任何单一省份的模型，但没有任何一方需要暴露自己的原始数据。

当然，联邦学习在水利领域的应用还面临数据异质性（不同流域的水文特征差异大）和通信效率（模型参数传输需要安全可靠的网络）等技术挑战，但其方向性价值是明确的。

### 3.3.3.1 人才与知识生态的短缺

除了上述市场、技术和数据层面的挑战，智慧水利还面临着人才和知识生态方面的深层短缺。这一短缺表现在三个层次。

第一层是"顶层设计人才"的短缺。能够为一个省或一个流域规划完整的智慧水利体系架构——从传感器网络到数据平台到模型服务到控制系统到人机界面——的系统架构师，在全行业中屈指可数。这种人才需要同时精通水利工程、控制理论、软件架构和项目管理，培养周期长达10年以上，难以通过短期培训速成。

第二层是"算法工程人才"的短缺。能够将MPC、深度学习等先进算法从论文实现为可在工业环境中稳定运行的工程代码的"算法工程师"，需要兼备扎实的数学基础、熟练的编程能力和对水利系统的深入理解。当前高校培养的研究生往往偏重论文发表而忽视工程实践，导致算法从实验室到工程现场的"最后一公里"难以打通。

第三层是"运维管理人才"的短缺。智慧水利系统上线后的长期运维——包括传感器校准、模型参数更新、软件版本升级、安全漏洞修补等——需要具备IT运维和水利专业双重能力的技术人员。目前大多数水利管理单位缺乏这类复合型运维人才，不得不依赖外部供应商的持续服务，增加了长期运营成本和技术锁定风险。

这三层人才短缺的叠加效应远超各层之和。顶层架构缺失导致系统设计"头重脚轻"——华丽的平台功能缺乏扎实的控制内核；算法工程断层导致先进理论"落不了地"——论文中表现优异的算法在实际工况中频繁失效；运维人才匮乏导致系统"虎头蛇尾"——高投入建设的智能系统因缺乏维护而逐年退化。打破这一困局，需要从高校课程体系改革（增设"水利控制工程""水利信息学"等交叉课程）、产学研联合培养机制（建立工程硕士驻场实习制度）、行业知识管理平台（将工程经验从个人头脑转化为组织资产）三个方面系统推进。

### 3.3.4 商业模式与可持续发展的困境

智慧水利面临的另一个深层挑战是商业模式的可持续性问题。当前智慧水利项目的商业模式存在几个结构性缺陷：

**"重建设、轻运维"的投资模式**。大多数智慧水利项目以政府财政投资为主，采用"项目制"建设模式——在项目建设期内有充足的资金投入，但项目验收后的运行维护费用往往缺乏保障。智能化系统不同于土建工程，它需要持续的数据更新、模型校正、软件升级和故障维护，如果运维投入不足，系统的功能将快速退化。

**价值量化困难**。智慧水利带来的效益往往是间接的、长期的、难以精确量化的——例如，通过优化调度减少了多少水量损失、通过精确预警避免了多少防洪损失、通过自动化控制节省了多少人力成本。这些效益虽然客观存在，但难以在短期内体现为可量化的经济指标，影响了投资决策者的积极性。

**技术锁定风险**。由于缺乏统一的标准和开放的接口规范，水利管理单位在选择技术供应商后，往往面临被"技术锁定"的风险——后续的扩展、升级和维护都依赖原供应商，更换成本高昂。这一问题在水利行业尤为突出，因为水利工程的运行期限长达数十年，技术平台的选择对未来几十年的运维成本和升级路径有深远影响。以某大型调水工程为例，其20世纪90年代建设的SCADA系统采用了某国际品牌的专用平台，随着该平台版本停止维护，整个系统面临"推倒重来"的困境，仅系统更换的投资就超过原建设投资的150%。这一案例深刻说明了开放架构和标准化接口的重要性——HydroOS等开放平台的意义，不仅在于当前的功能实现，更在于为未来数十年的可持续演进提供了架构保障。

**全生命周期成本的错位**。智慧水利系统的全生命周期成本构成与土建工程截然不同。土建工程的成本主要集中在建设期（约占80%），运维期成本相对较低。而智能化系统的成本分布则相反——建设期硬件和软件投入可能仅占30-40%，后续的数据运维、模型更新、软件升级、安全维护等运营成本占到60-70%。当前以"项目制"为主的投资模式，只考虑了建设期的一次性投入，严重低估了运营期的持续投入需求。这种成本结构的错位，是许多智慧水利项目"建了不用、用了退化"的深层经济原因。

**国际经验的参照**。在商业模式方面，国际上有一些值得借鉴的成功案例。澳大利亚Rubicon Water公司采用了"硬件+软件+服务"的一体化模式——不仅销售闸门设备和控制软件，还提供长期的数据分析和运行优化服务，将一次性的设备销售转化为持续性的服务收入。以色列的Mekorot国家水务公司采用了"效益分享"模式——通过智能优化减少的水量损失和能耗节省，由水务公司和技术供应商按约定比例分享。这些模式的核心思想是：将智慧水利从"资本支出"（CapEx）项目转化为"运营支出"（OpEx）服务，使投资者能够持续获得可量化的回报。

中国智慧水利商业模式的创新，可能需要探索以下方向：以"水量节约量"或"运行效率提升"为计量单位的绩效合同模式；以"平台+应用"为架构的开放生态模式（类似手机应用商店，HydroOS可以提供这样的平台基础）；以及政府购买服务与社会资本合作的混合模式。

### 3.3.5 深层反思：问题的根源

> **表 3-3　智慧水利发展深层挑战矩阵**
> *Table 3-3 Smart Water Deep Challenge Matrix*
>
> | 挑战维度 | 表层现象 | 深层根因 | CHS应对方案 |
> |:--------:|:---------|:---------|:-----------|
> | **市场碎片化** | 数百家企业，无行业龙头 | 缺乏统一技术标准和平台 | HydroOS开放平台+标准API |
> | **数据孤岛** | 跨工程数据不互通 | 行政边界=数据边界，无激励 | 联邦学习+隐私计算架构 |
> | **人才断层** | "水利+IT"复合人才极缺 | 学科交叉培养体系缺位 | 16册教材体系+国际课程 |
> | **重建轻管** | 运维投入占比<1% | 运行无独立学科地位 | 建立"水系统运行科学与工程"学科 |
> | **模型缺失** | 多数工程无标定模型 | 模型不是工程验收必选项 | 将模型标定纳入工程交付标准 |
> | **安全信任** | 管理层不敢授权自动控制 | 缺乏等级化验证体系 | WSAL分级+xIL渐进验证 |
> | **商业困境** | 项目制为主，缺乏持续收入 | 运行价值难以量化定价 | 按节水/节能效果的绩效合同模式 |

上述市场格局困境、技术壁垒、数据孤岛和商业模式问题，表面上看是各自独立的挑战，但深层分析可以发现，它们的根源指向同一个结构性缺失：**缺乏一个被行业广泛接受的、从理论到标准到工具链的统一框架**。

在汽车工业，SAE的自动驾驶分级标准（L0-L5）为整个行业提供了共同的语言和目标牵引，ISO 26262功能安全标准为系统设计和验证提供了规范框架，AUTOSAR为软件架构提供了统一的参考模型。正是这些"底层基础设施"的存在，使得汽车行业能够在碎片化的竞争中形成合力，推动自动驾驶技术的快速发展。

水利行业目前缺乏这样的"底层基础设施"。没有统一的自主运行分级标准（类似SAE L0-L5），技术发展就缺乏明确的目标牵引；没有统一的安全验证框架（类似ISO 26262），系统设计就缺乏可信赖的质量保障；没有统一的软件架构标准（类似AUTOSAR），生态建设就缺乏合作的基础。

水系统控制论（CHS）的提出，正是为了填补这一结构性空白。CHS通过WSAL水网自主等级分级标准提供目标牵引，通过xIL验证框架提供安全保障，通过HydroOS操作系统架构提供软件基础，通过六要素架构和五级模型层次提供统一的技术语言。这些要素共同构成了一个完整的"底层基础设施"，为智慧水利的规模化发展奠定了理论和标准基础。

当然，从提出理论框架到形成行业共识再到建立正式标准，还有很长的路要走。这需要学术界、产业界和政府管理部门的协同推动，需要在重大工程中的反复验证和迭代完善，需要国际交流和合作中的碰撞与融合。但方向已经清晰：只有建立起统一的理论框架和标准体系，中国智慧水利才能从"各自为战"的碎片化发展模式，转向"协同推进"的生态化发展模式。

### 3.3.7 典型失败模式与教训

智慧水利项目的失败率远高于行业公开承认的水平。通过对近年来多个省市智慧水利项目的调研和复盘，可以归纳出三种典型失败模式。

**失败模式一：平台空转型。** 这是最常见的失败模式，约占调研样本的60%。典型特征是：投入数千万元建设了"智慧水利综合平台"，部署了大量传感器和大屏幕显示系统，验收时功能演示完整，但项目移交运行后的6-12个月内，传感器因缺乏维护开始大面积失效，数据质量急剧下降，平台逐渐沦为"看板系统"甚至被弃用。根本原因在于项目设计时只考虑了建设阶段的硬件和软件投入，没有为运行阶段的维护、校准、人员培训预留持续性预算——这正是"重建轻管"思维在智慧水利领域的具体体现。

**失败模式二：技术错配型。** 这一模式约占20%。典型案例是将城市智慧水务的解决方案直接套用到灌区或长距离输水工程上。城市管网是加压系统，响应快、尺度小；而灌区渠道是明渠自流系统，响应慢、尺度大，两者的水力学特性和控制需求根本不同。一个省级灌区花费上亿元引入某IT公司的"智慧水利一体化平台"，结果发现该平台的管网水力模型无法处理明渠非恒定流，核心的泄漏检测算法在无压渠道中完全失效。从WSAL角度分析，该项目的失败本质上是在L0-L1基础（缺乏适配模型）上试图直接跳到L3，违反了"渐进升级"原则。

**失败模式三：数据孤岛型。** 约占15%。多个部门各自建设独立的监测系统——水文局建水情监测、灌溉局建灌区监测、水资源局建取水监测——数据标准不统一，接口不互通，形成"信息竖井"。某市同时运行5套独立的水务信息系统，数据冗余度超过300%，但跨系统的联合调度分析几乎不可能。这种碎片化不仅浪费投资，还为未来的系统集成制造了巨大的技术债务。

> **概念辨析框：智慧水利项目"成功"与"失效"的判据**
> *Concept Clarification: Success vs Failure Criteria for Smart Water Projects*
>
> | 维度 | 成功判据 | 失效判据 |
> |:----:|:---------|:---------|
> | **数据可用性** | 传感器在线率≥90%持续运行2年以上 | 验收后6个月在线率跌破60% |
> | **决策闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）** | 数据→模型→决策→执行→反馈形成闭环 | 数据仅用于大屏展示，不驱动决策 |
> | **人员依赖** | 系统运行不依赖原始开发团队 | 开发团队撤离后系统无法维护 |
> | **效益量化** | 可量化的效率提升或成本节约 | 仅有"信息化水平提升"等定性描述 |
> | **持续演化** | 系统随运行数据积累持续改进 | 系统功能固化在验收时状态 |

这些失败模式的共同根源在于：缺乏系统性的理论框架指导智慧水利建设。CHS理论和WSAL分级框架的价值正在于此——它们为智慧水利项目提供了"做什么、按什么顺序做、做到什么标准"的系统性指南，帮助避免盲目投资和技术错配。


---

**思考与讨论**

1. （分析比较）表3-3列出的七大深层挑战中，你认为哪一项是最根本的？为什么？
2. （综合思考）如果你是某省水利厅的决策者，面对"数据孤岛"和"人才断层"两个挑战，你会优先解决哪一个？请论证你的优先级选择。


---


---

### §3.3 本节小结


本节从市场碎片化、数据孤岛、人才断层、商业困境四个维度深入分析了智慧水利的深层挑战（表3-3）。核心洞察：七大挑战的根因均可追溯到"运行无独立学科地位"这一结构性缺陷。CHS理论及其配套方案（HydroOS开放平台、WSAL分级标准、16册教材体系、xIL验证框架）是对这些根因的系统性回应，而非对表层症状的修补。

## 3.4 国际视野：全球智慧水利的发展图景

智慧水利不是中国独有的命题，而是全球水利行业共同面临的转型课题。放眼国际，不同国家和地区基于各自的水利特点和技术传统，走出了差异化的发展路径。系统梳理国际智慧水利的前沿动态，对于定位中国智慧水利的国际坐标、借鉴先进经验、寻找合作机遇提供了关键理论支撑。

### 3.4.1 荷兰：水务自动化的全球标杆

荷兰是全球水务自动化和智能化的先驱和标杆，这一地位的形成有其深刻的历史和地理背景。荷兰国土面积的约26%低于海平面，约59%的国土面临洪水威胁，生存环境迫使荷兰人在水利工程的建设和运行方面持续创新。"上帝创造了世界，荷兰人创造了荷兰"——这句谚语生动地概括了荷兰与水的关系。

在机构层面，荷兰的水务管理体系以Rijkswaterstaat（国家水务局）和各地区水务局（Waterschap）为核心。Rijkswaterstaat负责管理全国主要水道、海堤和闸门系统，是全球最大的水务管理机构之一。荷兰独特的水务局制度——作为独立于省和市的专门管理机构——确保了水务管理的专业性和持续性。

在技术层面，荷兰在几个关键领域处于全球领先地位：

**Deltares研究院**。Deltares是全球最具影响力的水利科研机构之一，前身为荷兰水利研究所（Delft Hydraulics）和荷兰地质调查所（TNO-GeoDelft）。Deltares开发了一系列在全球广泛使用的水利模拟软件，包括Delft3D（三维水动力学模型）、SOBEK（一维水动力学和水质模型）、D-Flow FM（非结构化网格水动力学模型）等。这些软件构成了国际水利建模领域的重要基础设施。特别值得关注的是Deltares在实时水利预测和控制方面的进展——其开发的Delft-FEWS（Flood Early Warning System）平台已在全球40多个国家的洪水预警系统中得到应用，它整合了多种水文水力学模型、气象数据源和决策支持模块，实现了从数据采集到预警发布的全流程自动化。

Deltares还积极探索数字孪生（Digital Twin）技术在水利工程中的应用，通过建立物理工程的高保真数字副本，实现运行状态的实时映射、故障预测和方案推演。

**代尔夫特理工大学**。代尔夫特理工大学（TU Delft）的水资源工程系是全球水利学术研究的重镇。在水系统控制方面，Van Overloop教授（2006）在该校完成的博士论文《开放水道系统的模型预测控制》是渠道自动控制领域的奠基性工作。此后，该校的研究团队在分布式模型预测控制（DMPC）、渠道系统实时优化、城市排水系统智能控制等方面持续产出高水平成果。近年来，TU Delft在水系统与能源系统的耦合优化（Water-Energy Nexus）方面开辟了新的研究方向——研究水泵调度与可再生能源波动之间的协同优化问题，这一方向与CHS理论中"跨域耦合"的思想具有天然的契合。

TU Delft还在博士培养中推行"工程项目嵌入式"研究模式，博士生的研究课题直接来自Rijkswaterstaat或水务局的实际工程需求，研究成果直接反馈到工程实践中，这种"学术—工程双轨融合"的培养模式值得借鉴。

**Maeslantkering风暴潮屏障**。位于鹿特丹新水道入口处的Maeslantkering是世界上最大的自动化风暴潮防御工程。该工程由计算机系统自动监测北海风暴潮水位，当预测水位超过3.0米（鹿特丹标高）时自动关闭巨型闸门——两扇闸门各重约300吨，长210米，自动关闭过程约需2小时。Maeslantkering的决策系统体现了"基于预测的自动控制+人工否决权"的设计理念：系统基于气象预报和水位预测自动做出关闭决策，但操作人员保留否决权——如果认为系统的预测不准确或关闭时机不当，可以取消自动关闭指令。这一设计在WSAL分级体系中大致对应L3至L4级别，是水利工程自主运行的一个国际经典案例。Maeslantkering的运行经验表明，在关键基础设施的自主控制中，"人工否决权"的保留不是对自动化的退步，而是建立公众信任和满足治理要求的必要机制。

**荷兰水务局的系统化自动化实践**。荷兰各地区水务局在灌排系统自动化方面积累了丰富的运行经验。以Rijnland水务局为例，其管辖区域内的上千个泵站和闸门大部分实现了远程自动控制，中央控制室的调度员可以同时监管和操控数百个设施。这种高度集中化的远程控制模式之所以在荷兰取得成功，与其国土面积小、通信基础设施完善、水利设施标准化程度高等条件密切相关。对于中国这样国土辽阔、工程类型多样的国家，照搬荷兰的集中控制模式未必适用，CHS理论提出的"分层分布式"架构可能是更合适的选择。

荷兰水务模式对CHS理论的启示在于：第一，水利自动化需要数十年的持续投入和经验积累，不可能一蹴而就；第二，标准化（设备标准、通信协议、控制接口）是规模化部署的前提；第三，制度保障（独立的水务局体制、专业化的运行管理队伍）与技术进步同等重要。

### 3.4.2 日本：精细化水务管理

日本在水务管理方面以精细化和高可靠性著称。日本的水务管理特点可以从以下几个方面理解：

**供水管网管理**。日本的城市供水管网漏损率长期保持在极低水平——东京都水道局的管网漏损率低至约3%，远低于全球平均水平（约30%）。这一成就的背后是精密的管网监测技术（包括夜间最小流量分析、声学检漏、压力区域管理DMA等）和严格的管网维护制度。日本在管道材料选择、施工质量控制和主动更新策略方面形成了完整的技术标准体系——例如，东京都水道局制定了详细的管道更新优先级评估方法，综合考虑管道材质、埋设年限、漏损记录、地震风险和用户重要性等多维因素，以有限的更新预算实现漏损率的最大降低。日本的管网管理经验表明，精细化的运行管理可以在不进行大规模工程改造的条件下，显著提升水务系统的运行效率。这种"以运行优化弥补工程条件不足"的思路，与CHS理论倡导的"运行科学"理念高度一致。

**防洪自动化**。日本是世界上台风和暴雨灾害最频繁的国家之一，因此在防洪自动化方面投入了大量资源。日本国土交通省建设了覆盖全国主要河流的水文遥测网络和洪水预警系统（X-rain高密度降雨雷达网络可以在250米空间分辨率和1分钟时间分辨率下实时监测降雨分布）。在城市排水方面，东京的"首都圈外郭放水路"（地下神殿）配备了先进的自动化控制系统，可以在暴雨期间自动将超量雨水从市区河流排入江户川——这一系统的自动化决策逻辑体现了日本在防洪自动化方面的深厚积淀。该系统可以在暴雨来临前数小时根据气象预测自动启动排水准备，在暴雨过程中实时调整各竖井和调压水槽的排水分配，在暴雨结束后自动进入排空和检修模式。

**水道技术研究与AI探索**。日本水道技术研究中心（JWRC）是日本水务技术研发的重要机构，近年来开始探索人工智能和物联网技术在水务中的应用。日本的特色在于将AI技术与其传统的"匠人精神"相结合——不追求大而全的"智慧水务平台"，而是在每个具体的运行环节上追求极致的精度和可靠性。例如，日本多家水务公司采用深度学习方法对水处理工艺进行实时优化，将药剂投加量的控制精度提升到前所未有的水平。又如，利用图像识别技术对管道内部进行自动化缺陷检测，替代传统的人工目视检查。日本在技术的"实用化"和"可靠化"方面的经验，对于CHS理论的工程落地具有重要的借鉴意义——再好的理论如果不能在工程现场可靠运行，其价值就无法实现。

**河川信息化系统**。日本国土交通省建设的"河川信息中心"（River Information Center）整合了全国主要河流的水文遥测数据、气象雷达数据和洪水预报模型，形成了覆盖全国的洪水预警和决策支持平台。该平台的一个突出特点是"分钟级更新"——水位数据每10分钟更新一次，雷达降雨数据每5分钟更新一次，确保了洪水预报的时效性。在2019年台风海贝思（Hagibis）期间，该平台为东京都和关东地区的防洪调度提供了关键的决策支撑。

**下水道智能化**。在城市排水领域，日本在"下水道事业中长期计划"框架下推动排水管网的智能化改造。东京都下水道局率先引入了管网实时监控和自动调度系统，通过在关键节点设置可控闸门和在线水位传感器，实现了雨天溢流的动态调控。横滨市则在小流域尺度上探索了"雨水贮留+智能排放"的绿色基础设施与灰色基础设施协同运行模式。

日本水务管理的核心启示在于"精细化运维"理念——不追求大而全的系统建设，而是在每一个运维环节（检漏、维修、预警、应急）上做到极致精细。这种理念与CHS理论中"运行设计域精准定义"的思想具有内在的一致性——都强调在明确的边界条件内追求最优化的运行性能。

### 3.4.3 美国：技术引领与标准制定

美国在水务智能化领域的核心竞争力体现在技术研发引领和标准制定两个方面。

**联邦机构的研发支撑**。美国垦务局（USBR）是全球最早开展渠道自动化研究的机构之一，其在美国西部灌区的长期实验积累了大量的工程经验和技术数据。美国陆军工程兵团（USACE）在防洪工程和航运水道的运行管理方面开发了一系列决策支持工具，包括广泛使用的HEC系列水文水力学模型（HEC-RAS、HEC-HMS等）。美国环保署（EPA）主导了城市供水系统的水质安全监测和预警技术研发，EPANET管网水力学模型已成为全球城市供水管网分析的事实标准。美国农业部农业研究服务局（USDA-ARS）在灌溉系统现代化和水资源高效利用方面持续产出重要成果——克莱门斯（Clemmens）等人建立的ASCE渠道控制算法测试案例，至今仍是该领域最权威的评价基准。

**学术界的方法论贡献**。美国的大学和研究机构在水系统运行的多个方法论领域处于国际前沿。加州理工州立大学（Cal Poly）的灌溉培训与研究中心（ITRC）在灌溉现代化方面影响深远——伯特（Burt）教授提出的"灌溉现代化"框架将硬件升级和软件升级视为不可分割的整体。麻省理工学院（MIT）在城市水系统优化和韧性评估方面有大量创新成果。科罗拉多大学博尔德分校在遥感水文学和数据驱动水资源管理方面处于领先地位。斯坦福大学和卡内基梅隆大学则在水系统中机器学习和人工智能应用方面开展了前沿探索。

**产业界的技术创新**。美国拥有全球最活跃的水务技术（WaterTech）创业生态系统。硅谷和波士顿地区涌现了大量水务智能化创业公司，涵盖传感器技术（如Xylem的智能传感器系列）、管网分析软件（如Bentley的WaterGEMS/WaterCAD、Innovyze的InfoWorks）、人工智能水务平台（如SWAN Forum成员企业）等领域。Xylem公司作为全球最大的水技术公司之一，近年来通过收购Sensus和Pure Technologies等企业，构建了从传感器到分析平台的完整智慧水务产品线。美国水务协会（AWWA）和水环境联合会（WEF）等行业组织也在推动水务行业的数字化转型标准制定。

**标准制定的全球影响力**。美国在水务技术标准制定方面具有全球性的影响力。ASCE出版的实践手册（MOP）系列，特别是MOP 131《灌溉系统渠道自动化》，为全球渠道控制工程提供了权威参考。EPA制定的水质监测和预警标准被世界各国广泛采用。AWWA制定的供水工程技术标准覆盖了从管材到智能表计的方方面面。这种通过标准制定来引领全球技术方向的模式，是美国在水务领域保持影响力的重要机制。

### 3.4.4 欧洲其他国家

除荷兰外，欧洲其他国家在智慧水利的不同细分领域也有突出贡献。

**法国**。法国在渠道控制理论研究方面有着深厚的学术传统。法国国家农业、食品和环境研究院（INRAE，前身为Cemagref）是全球明渠控制理论研究的重镇——利特里科（Litrico）和弗罗米翁（Fromion）在此完成了奠基性的频域建模和控制设计工作。普罗旺斯运河公司（SCP）运营的运河系统是渠道自动化控制的早期试验场，其工程实践直接催生了多种重要的控制算法。法国电力公司（EDF）在水力发电梯级系统的优化调度方面也有丰富的经验和技术积累。在城市水务领域，法国的威立雅（Veolia）和苏伊士（Suez）是全球最大的两家水务运营商，在全球数十个国家运营城市供水和排水系统，积累了海量的运行数据和管理经验。近年来，两家公司都在积极布局数字化水务——威立雅推出了Hubgrade数字化运营平台，苏伊士开发了AQUADVANCED系列智能水务解决方案。

**英国**。英国的水务监管模式（Ofwat监管框架）以绩效导向著称——监管机构通过设定漏损率、供水中断时间、污水溢流次数等绩效指标，并将指标完成情况与水务公司的收入直接挂钩，有效地激励了水务公司对智能化技术的投入。英国也是全球水务数据分析和机器学习应用的先行者——帝国理工学院、剑桥大学和谢菲尔德大学在管网状态估计、需水预测和资产管理优化方面有大量创新成果。英国HR Wallingford（前身为Hydraulics Research）在水力学模型软件开发方面有悠久历史，其开发的ISIS/Flood Modeller系列软件在洪水建模领域应用广泛。

**以色列**。以色列在水资源极度匮乏的条件下，发展出了全球领先的高效用水技术体系。以色列国家水务公司Mekorot运营的全国水网系统实现了高度的自动化调度——利用SCADA系统和优化算法对全国水资源进行统一调配，在线监测管网压力和流量，实时检测泄漏和水质异常。以色列的滴灌技术公司（如Netafim）在精准灌溉自动控制方面全球领先。以色列的经验证明了一个重要命题：水资源的物理稀缺可以通过智能化的运行管理来部分弥补——以色列的人均水资源量仅为全球平均值的约1/20，但通过高效的水务管理，实现了远高于其自然禀赋所能支撑的经济和农业产出。

**德国和瑞士**。德国在污水处理智能化方面走在前列，多家污水处理厂引入了基于模型预测控制的工艺优化系统，通过精确控制曝气量和回流比来降低能耗并提高出水水质。德国弗劳恩霍夫研究所（Fraunhofer）在水务物联网传感器和边缘计算方面开展了前沿研究。瑞士联邦水科学技术研究所（Eawag）在城市水系统综合建模和可持续水管理方面享有国际声誉。

**澳大利亚**。虽然不属于欧洲，但澳大利亚在灌溉自动化领域的贡献不可忽视。Rubicon Water公司的"全面渠道控制"（TCC）系统是渠道自动化商业化应用的全球标杆——其FlumeGate自动化闸门和集成MPC控制软件在维多利亚州Goulburn-Murray灌区的大规模应用，将灌溉水利用效率从约70%提升到90%以上。澳大利亚墨尔本大学的水资源研究中心在城市雨洪管理和水敏城市设计（WSUD）方面有重要贡献。

### 3.4.5 国际组织与合作平台

水利智能化的发展离不开国际组织和合作平台的推动。以下几个平台在推动水系统运行科学的全球发展中发挥着关键作用。

**IAHR（国际水利与环境工程学会）**。IAHR是水利工程领域历史最悠久、影响力最大的国际学术组织，成立于1935年，拥有来自170多个国家的会员。IAHR下设多个专业委员会，其中与水系统运行直接相关的是水力机械与系统委员会和水信息学委员会。2023年，在雷晓辉教授的推动下，IAHR正式成立了水系统运行工作组（Water Systems Operation Working Group），这是国际上第一个专门聚焦水系统运行科学的学术工作组，标志着水系统运行作为一个独立的学术方向获得了国际学术界的认可。该工作组的成立为CHS理论的国际传播和学术交流提供了重要的组织平台。

**IWA（国际水协会）**。IWA是全球水务行业最重要的国际组织，涵盖供水、排水、污水处理等城市水务全领域。IWA近年来积极推动"数字水务"（Digital Water）议程，设立了专门的数字水务工作组，关注人工智能、物联网和数字孪生技术在城市水务中的应用。IWA每两年举办一次世界水大会（World Water Congress），是全球水务行业最重要的学术和行业交流平台。

**SWAN（Smart Water Networks Forum）**。SWAN论坛是一个专注于智慧水网技术的国际行业平台，成员包括水务公司、技术供应商和学术机构。SWAN每年发布"智慧水网状态报告"，追踪全球智慧水网技术的发展趋势和市场动态。SWAN论坛的年度会议为智慧水务领域的产学研交流提供了重要场所。雷晓辉教授团队通过SWAN平台积极推广CHS理论和HydroOS系统，与国际同行建立了广泛的技术交流和合作关系。

**UNESCO-IHP（联合国教科文组织国际水文计划）**。IHP是联合国框架下最重要的水科学国际合作计划，当前处于第九阶段（IHP-IX, 2022-2029），主题为"水安全科学"。IHP-IX明确将"水系统智能化运行"作为优先主题之一，这反映了国际水文学界对水系统运行科学重要性的日益认可。IHP还通过其全球水文数据与信息共享平台，推动各国水文数据的标准化和互操作性，为跨国界水系统的协同运行奠定数据基础。

**WMO（世界气象组织）**。WMO虽然以气象为主业，但其下属的水文与水资源计划在全球水文信息化方面发挥着重要的协调作用。WMO推动的全球水文观测系统（WHOS）和水文预报服务标准化，为水系统运行提供了重要的上游数据支撑。近年来，WMO还推动了"多灾种早期预警系统"（MHEWS）的建设，强调将气象预警与水利运行决策系统深度对接，实现从"气象预报"到"水利调度"的端到端自动化——这一方向与CHS理论中的"预测—决策闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）"完全一致。

**IAHR（国际水力学研究协会）**。IAHR是全球水力学和水环境领域历史最悠久、影响力最大的国际学术组织之一，成立于1935年。IAHR设有多个技术委员会和工作组，涵盖水力学、河流动力学、水环境、水信息学等方向。值得特别指出的是，2024年新设立的"水系统运行工作组"（Water Systems Operation Working Group）由CHS理论的创始人雷晓辉担任首任主席，标志着"水系统运行"作为一个独立的技术方向首次在IAHR的组织架构中获得正式地位。这一工作组为全球从事水系统运行研究的学者提供了一个交流平台，将推动运行科学与工程在国际范围内的共识凝聚和标准协调。

**IWA（国际水协会）**。IWA是全球水务行业最大的专业组织，会员覆盖130多个国家的水务公司、研究机构和政府部门。IWA在数字化水务（Digital Water）方面设立了多个专项计划，关注人工智能、数字孪生、智能传感等技术在水务运营中的应用。IWA的优势在于其连接学术界和产业界的桥梁作用——其技术报告和最佳实践指南在全球水务公司中具有广泛的影响力。

**SWAN（智慧水利网络联盟）**。SWAN是近年来兴起的专注于智慧水务的国际行业联盟，汇聚了水务公司、技术供应商和研究机构。SWAN每年发布的《智慧水务技术态势》报告是跟踪全球智慧水务技术发展动态的重要参考。SWAN的特色在于其强调"投资回报"——每项技术创新不仅要在技术上可行，还要在经济上合理，这种务实的态度对于推动智慧水务技术的商业化落地具有积极意义。CHS团队通过SWAN平台积极推广中国的工程案例和技术方案，获得了国际同行的关注和认可。

**世界银行和亚洲开发银行**。多边发展银行在推动发展中国家水务现代化方面扮演着关键角色。世界银行每年在水利领域的贷款和赠款规模达数十亿美元，其技术援助项目往往附带技术标准和最佳实践要求，对受援国的水利技术路线选择具有显著影响。CHS理论和HydroOS系统如果能够被纳入多边发展银行推荐的技术方案库，将显著加速其在全球范围内的推广应用。

### 3.4.6 国际前沿趋势

综合分析各国的发展动态和国际组织的研究方向，可以归纳出当前国际智慧水利的几个前沿趋势：

**趋势一：从自动化到自主化的范式转移**。越来越多的研究开始关注水利系统的"自主运行"（Autonomous Operation），而非仅仅停留在"自动化"（Automation）层面。这一趋势与自动驾驶、无人机等领域的发展逻辑一致——从预设规则的机械执行，走向基于环境感知、状态评估和在线决策的智能运行。荷兰Maeslantkering风暴潮屏障的自动决策系统、澳大利亚Rubicon TCC系统的自适应控制、以及南水北调中线工程的MPC在线优化，都是这一范式转移的具体体现。CHS理论提出的水网自主等级（WSAL）分级体系，为这一范式转移提供了一个系统性的概念框架和发展路线图。

**趋势二：数字孪生成为核心技术平台**。数字孪生（Digital Twin）正在成为智慧水利的核心技术架构。不同于传统的水力学仿真模型（离线运行、单次使用），数字孪生强调"实时同步、双向交互、持续演化"——虚拟模型通过持续接入实时监测数据保持与物理系统的同步，物理系统的运行决策通过在虚拟环境中预演和验证后再下发执行，数字孪生模型本身随着运行数据的积累而持续学习和更新。欧盟的"Destination Earth"计划明确将水系统数字孪生作为优先发展方向。Deltares、DHI（丹麦水力学研究所）和Bentley等国际水利软件巨头都在积极布局水务数字孪生产品。CHS理论中的"可控模型族"和"在回路测试"方法论，与数字孪生技术具有天然的对接点——可控模型族为数字孪生提供了多精度模型架构，在回路测试为数字孪生的工程验证提供了系统化的方法。

**趋势三：人工智能深度融入水务运行**。机器学习和深度学习技术正在水务运行的多个环节发挥越来越大的作用。在预测环节，基于LSTM（长短期记忆网络）和Transformer架构的降雨-径流模型在短期洪水预报方面展现了优于传统概念性模型的精度。在检测环节，基于图神经网络（GNN）的管网异常检测方法能够利用管网拓扑信息提升泄漏定位的精度。在优化环节，深度强化学习（DRL）被尝试用于水库群联合调度和城市排水系统实时控制。在运维环节，计算机视觉技术被用于水工结构的缺陷检测和管道内窥检查。然而，纯数据驱动的AI方法在水系统中面临可解释性不足、物理一致性缺乏和极端工况外推能力弱等根本性挑战。

越来越多的研究者开始转向"物理约束的AI"（Physics-Informed AI）或"混合模型"（Hybrid Model）路线——将水力学方程的物理约束嵌入神经网络的损失函数或架构设计中，兼顾数据驱动的灵活性和物理模型的可靠性。这一趋势与CHS理论中"数据-物理融合"原理高度契合，CHS提出的"双AI引擎"（物理AI+认知AI）架构更是为AI在水系统中的工程落地提供了一个结构化的实施框架。

**趋势四：网络安全和韧性成为关注焦点**。随着水务系统的数字化程度不断提高，网络安全风险也日益突出。2021年美国佛罗里达州Oldsmar水处理厂遭受网络攻击事件（黑客试图将水处理中的氢氧化钠投加量提高至危险水平）引起了全球水务行业的高度警觉。此后，美国网络安全和基础设施安全局（CISA）、欧洲网络与信息安全局（ENISA）等机构发布了一系列针对水务系统的网络安全指南。水务系统的韧性（Resilience）——即在遭受扰动（包括自然灾害、设备故障和网络攻击）后快速恢复正常运行的能力——成为国际研究的热点。CHS理论中的"安全包络"和"优雅降级"设计，本质上就是提升水系统韧性的技术手段。

**趋势五：开源生态和数据共享加速创新**。国际水利研究界正在形成更加开放的技术生态。开源水力学模型（如SWMM、EPANET、OpenFOAM等）的广泛使用降低了研究门槛并促进了算法的可复现性。水文和水质数据的开放共享（如美国USGS的水文数据平台、欧洲EFAS洪水预警数据平台）为数据驱动方法的发展提供了基础。GitHub等平台上水务相关的开源项目数量近年来快速增长，形成了活跃的开发者社区。CHS理论体系中的HydroOS水网操作系统如果能够以开源或半开源的方式推广，有望在国际水利社区中形成类似于EPANET在管网分析领域影响力的生态效应。

### 3.4.7 国际对标：主要水利强国智慧水利综合比较

> **表 3-2　全球主要水利强国智慧水利发展比较**
> *Table 3-2 International Smart Water Comparison*
>
> | 维度 | 荷兰 | 以色列 | 澳大利亚 | 美国 | 日本 | 中国 |
> |:----:|:----:|:------:|:--------:|:----:|:----:|:----:|
> | **优势领域** | 防洪自动化、Delta Works | 管网漏损控制、海水淡化 | 灌区自动化（TCC） | 水文预报、标准制定 | 精细化管理、地震应急 | 大工程建设、SCADA规模 |
> | **SCADA覆盖率** | >98% | >95% | ~85% | ~90% | >95% | ~85% |
> | **管网漏损率** | ~5% | <8% | ~10% | ~16% | ~5% | ~15-20% |
> | **实时模型覆盖** | 高（RWS全覆盖） | 高（Mekorot全网） | 中（灌区为主） | 中（流域为主） | 中高 | 低（<5%工程） |
> | **自动控制水平** | L2-L3 | L2-L3 | L3（TCC灌区） | L2 | L2 | L1-L2 |
> | **数字孪生成熟度** | 领先（Deltares） | 中高 | 中 | 中高 | 中 | 快速追赶 |
> | **AI应用深度** | 中高 | 中高 | 中 | 领先（学术） | 中 | 快速追赶 |
> | **年人均水利IT投入** | >$50 | >$40 | ~$30 | ~$25 | ~$35 | <$5 |
> | **核心机构** | Deltares/RWS | Mekorot/Technion | Rubicon/CSIRO | USBR/USACE | 水道技术研究中心 | 中国水科院/高校 |
> | **对CHS的启示** | 分布式控制范式 | 漏损控制标杆 | L3工程实证 | 标准化路径 | 精细化运维 | 大工程验证平台 |
>

> **说明**: 数据来自各国水务管理部门公开报告、SWAN Forum(2022)、IWA统计，部分为课题组调研估算。

### 3.4.8 中国的国际定位与合作机遇

在全球智慧水利版图中，中国具有独特的定位和突出的比较优势。

**工程规模优势**。中国拥有世界上规模最大、类型最多、复杂度最高的水利基础设施网络。南水北调工程（东线和中线）、三峡水利枢纽、西电东送梯级水电系统、引江济淮工程、胶东调水工程等特大型水利工程，其规模和复杂度在全球范围内无可比拟。这些工程构成了CHS理论和智慧水利技术的天然验证平台——任何控制算法和系统架构如果能在这些工程中成功应用，就具备了在全球范围内推广的技术可信度。相比之下，荷兰的水务系统虽然自动化水平高但规模有限，美国的灌区虽然面积大但系统复杂度较低，以色列的水网虽然精细但体量较小。中国特大型水利工程提供的技术验证场景，是中国智慧水利在国际竞争中最大的独特资产。

**政策支持优势**。中国政府对智慧水利建设的战略重视和资源投入力度在全球范围内首屈一指。水利部明确将"智慧水利"作为水利现代化的核心战略方向，纳入国家"十四五"规划和2035年远景目标纲要。各级财政对智慧水利项目的投入持续增大。这种自上而下的战略推动力，在市场化主导的西方国家是难以复制的——西方国家的水务智能化投入主要依赖市场驱动和监管激励，推进速度相对较慢。

**理论创新优势**。CHS作为一个系统性的水系统运行控制理论框架，在国际学术界开创了新的研究方向。CHS的"六个统一"理论结构、WSAL分级体系、可控模型族方法论和双AI引擎架构等原创性理论贡献，填补了国际水利学术界在水系统运行科学方面的理论空白。IAHR水系统运行工作组的成立，标志着这一理论方向获得了国际学术界的认可。CHS理论的国际影响力将随着更多高水平学术论文的发表和国际学术交流的深入而持续扩大。

**合作机遇方面**，以下几个方向具有特别重要的战略意义。第一，与荷兰在数字孪生水利技术方面的深度合作——将荷兰在水力学建模软件和数字孪生平台方面的技术积累，与中国在特大型水利工程运行数据和应用场景方面的独特优势相结合。第二，与澳大利亚在灌溉自动化技术方面的合作——将Rubicon的硬件技术和CHS的控制理论相结合，面向"一带一路"沿线国家的灌溉现代化需求提供整体解决方案。第三，通过IAHR水系统运行工作组和SWAN论坛等国际平台，推动CHS理论体系的国际标准化——将CHS的核心概念（WSAL分级、在回路测试标准、安全包络定义方法等）转化为国际推荐标准或最佳实践指南。第四，在"一带一路"水利合作框架下，将中国的智慧水利技术和经验输出到东南亚、中亚和非洲等水利基础设施建设需求旺盛的地区，在国际水务市场上树立"中国技术"的品牌影响力。

需要清醒认识的是，中国在某些方面仍存在差距。在水务软件领域，国际主流的水力学建模软件（如Deltares的Delft3D/SOBEK、DHI的MIKE系列、Bentley的WaterGEMS等）均为国外产品，国产替代尚需时日。在传感器和执行器等水务硬件领域，高端产品仍以进口为主。在水务运营管理的精细化水平方面，与日本、荷兰等先进国家相比仍有提升空间。在学术影响力方面，虽然中国学者在水利期刊上的论文数量快速增长，但在Water Resources Research、Journal of Hydraulic Engineering等顶级期刊上的高影响力论文占比仍需提高。这些差距既是挑战，也是中国智慧水利未来发展的空间所在。

### 3.4.8 国际标杆工程速览

以下三个国际标杆工程代表了当前全球智慧水利的技术前沿，其量化参数为WSAL等级评估和CHS技术对标提供了参照基准。

> **国际标杆案例 1：荷兰Maeslantkering风暴潮屏障**
> *Benchmark Case 1: Maeslantkering Storm Surge Barrier, Netherlands*
>
> | 参数 | 数值 |
> |:----:|:-----|
> | **工程类型** | 风暴潮防护闸门（Delta Works组成部分） |
> | **建成年份** | 1997年 |
> | **规模** | 2扇旋转闸门，各长210m、高22m，单扇重2.9万吨 |
> | **自动化水平** | 全自动决策——当预报鹿特丹港水位超过+3.0m NAP时自动启动关闭 |
> | **WSAL评估** | L3（ODD内自主决策，限于单一触发条件：水位阈值+风暴潮预报） |
> | **关键技术** | 基于概率预报的自动决策系统+液压驱动+冗余传感器 |
> | **CHS启示** | 证明了水利工程L3自主决策的工程可行性，但ODD极窄（仅风暴潮场景） |

> **国际标杆案例 2：澳大利亚Goulburn-Murray灌区TCC系统**
> *Benchmark Case 2: Rubicon TCC in Goulburn-Murray Irrigation District, Australia*
>
> | 参数 | 数值 |
> |:----:|:-----|
> | **工程类型** | 灌区渠道自动控制 |
> | **部署时间** | 2006年起逐步扩展 |
> | **规模** | 6,300km渠道、~12,000个FlumeGate自动闸门 |
> | **核心技术** | FlumeGate一体化闸门+MPC优化+中央云控平台 |
> | **性能指标** | 灌溉水利用效率70%→90%+；水位控制精度±2.5cm；水损减少50%以上 |
> | **WSAL评估** | L2-L3（渠段级MPC自动控制，调度员远程监督） |
> | **CHS启示** | 全球规模最大的渠道自动化商业应用，证明了MPC在灌区的经济可行性 |

> **国际标杆案例 3：以色列Mekorot全国水网调度系统**
> *Benchmark Case 3: Mekorot National Water Grid, Israel*
>
> | 参数 | 数值 |
> |:----:|:-----|
> | **工程类型** | 全国供水管网调度 |
> | **规模** | ~10,000km主管网、~3,000个监测站、日供水~160万m³ |
> | **核心技术** | 集中SCADA+实时水力模型+优化调度+DMA漏损管理 |
> | **性能指标** | 管网漏损率~10%（全球领先）；海水淡化占供水~70%；全网实时模型覆盖 |
> | **WSAL评估** | L2（高度自动化+模型辅助决策，但决策仍由调度员做出） |
> | **CHS启示** | 证明了极端缺水条件下智能运行管理可显著提升水资源利用效率 |


---

**思考与讨论**

1. （分析比较）荷兰Maeslantkering（WSAL L3）和澳大利亚TCC系统（WSAL L2-L3）分别代表了水利自动化的什么模式？各自的ODD有何不同？
2. （综合应用）如果要将以色列Mekorot的全国水网调度经验移植到中国某省，你认为最大的技术障碍和制度障碍分别是什么？
3. （批判思考）表3-2的国际对比是否说明中国在智慧水利领域全面落后？请从"工程规模优势"和"后发优势"两个角度进行辩证分析。


---


---

### §3.4 本节小结


本节通过荷兰、以色列、澳大利亚、美国、日本等主要水利强国的国际对标（表3-2），定位了中国在全球智慧水利版图中的坐标。中国的优势在于大工程建设能力和SCADA规模部署，差距在于自动控制水平（落后1-2个WSAL等级）和运行精细化程度。国际合作机遇明确：通过IAHR水系统运行工作组和ISO标准化推动CHS框架的国际认可，同时引进Rubicon TCC等成熟技术加速国内灌区自动化。

# 第四部分　未来展望：迈向自主运行

2024年，全球已有超过6000万辆汽车具备L2级辅助驾驶功能，数十万辆达到L3级有条件自动驾驶。同一年，全球管理着超过50万公里调水渠道和数百万公里供水管网的水利行业，自动控制水平普遍停留在L1——远程监控加人工决策。汽车行业用了不到二十年走完了从L0到L3的路程。水网能否参照这条路径，安全、渐进地迈向自主运行？

本部分给出路线图。§4.1-4.2提出WSAL（水网自主等级）L0-L5分级框架，并定义ODD（运行设计域）、安全包络和MRC（最小风险状态）三个核心安全机制；§4.3论述物理AI与认知AI双引擎融合架构，说明为什么水网不能像自动驾驶那样完全依赖端到端AI；§4.4详述HydroOS 3.0的架构设计和分级部署方案；§4.5构建MIL-SIL-HIL-PIL四层xIL验证体系，解决"如何证明自主控制是安全的"这一信任瓶颈；§4.6规划教材和专利两大知识基础设施；§4.7以"第六次突破"收束全书。

本部分与前三部分的关系是：第一部分提供了理论工具，第二部分展示了技术积累，第三部分诊断了现实差距，本部分则综合前三部分的准备，回答全书的终极命题：**如何安全、渐进、可验证地实现水网自主运行？**


## 4.1 从"辅助决策"到"自主运行"的演进路径

当前，全球水系统的运行管理仍然高度依赖人类调度员的经验判断和手动操作。即使是最先进的智慧水利系统，其角色也主要是"辅助决策"——为调度员提供数据、预报和方案建议，最终的决策和执行仍由人类完成。然而，随着感知技术、模型能力和AI技术的快速发展，水系统运行正在从"辅助决策"向"自主运行"演进。

这一演进并非水利领域独有的现象，而是跨领域的共同趋势。回顾其他工程领域的自主运行发展历程，可以为水系统提供有益的参照和启示。

### 4.1.1 跨领域的自主运行演进

**航空领域**。航空是人类最早实现高度自主运行的工程领域之一。1914年，劳伦斯·斯佩里（Lawrence Sperry）首次演示了飞机自动驾驶仪，实现了飞行姿态的自动保持。1947年，美国空军的C-54飞机完成了首次全自动跨大西洋飞行，包括起飞、巡航和着陆全过程。1965年，自动着陆系统（Autoland）开始在商业航空中应用，大幅提升了低能见度条件下的飞行安全。此后，飞行管理系统（FMS）、自动飞行控制系统（AFCS）持续发展，现代商用飞机在巡航阶段已实现高度自主运行。航空领域的经验表明：自主运行的核心不是取消人类，而是让人类从繁重的操纵任务中解放出来，专注于异常处置和战略决策。

**汽车领域**。SAE International制定的自动驾驶分级标准J3016是自主运行分级领域最具影响力的标准框架。该标准将自动驾驶分为L0（无自动化）到L5（完全自动化）六个等级，每个等级对应明确的人机职责划分。J3016的核心贡献在于引入了两个关键概念：运行设计域（Operational Design Domain, ODD）——定义自动驾驶系统可以正常工作的环境条件边界；以及动态驾驶任务（Dynamic Driving Task, DDT）——定义需要自动化的具体任务内容。这两个概念为自主运行的分级提供了严格的逻辑基础。如今，Waymo、百度Apollo等公司的自动驾驶出租车已在部分城市开展商业运营，处于L4水平的有限场景应用。

**电网领域**。20世纪50年代，自动发电控制（AGC）系统开始在电网中应用，实现了发电功率的自动调节。60年代，SCADA系统得到推广。80年代，能量管理系统（EMS）实现了电网的集中优化调度。2011年以来，随着新能源大规模接入，电网面临越来越大的不确定性，自主运行的需求日益迫切。智能电网的发展正在推动电力调度从集中式优化向分布式自主协调的方向演进——这与水网面临的挑战高度相似。

**工业过程控制领域**。1975年，分布式控制系统（DCS）的出现标志着工业过程控制进入分布式时代。2022年，日本横河电机公司实现了化工厂的AI自主运行35天的里程碑——在此期间，整个化工生产过程由人工智能系统全自主管理，人类操作员仅在监督岗位待命。这一事件被视为工业过程控制领域向自主运行迈进的标志性事件。

**船舶领域**。1957年，美国海军研发了第一艘自主水下航行器（AUV）。挪威Yara公司的Yara Birkeland号成为世界首艘全电动自主集装箱船。近年来，国际海事组织（IMO）正在制定海上自主水面船舶（MASS）的国际规则框架——包括自主运行分级、安全标准和法律责任等。

### 4.1.2 共同规律与水网的特殊性

上述领域的发展历程揭示了两条共同规律：

**规律一：渐进演进**。自主运行的实现是一个渐进的过程，从完全人工操作，到辅助决策，到部分自动化，到高度自动化，最终到完全自主运行。每个领域都经历了数十年的发展才达到当前水平。跳跃式发展不仅技术上难以实现，安全上更不可接受。航空领域从斯佩里的自动驾驶仪（1914年）到现代自动着陆系统的成熟应用，历经了近80年；汽车领域从DARPA Grand Challenge（2004年）到L4级自动驾驶出租车的商业运营，也经过了20年的技术积累。水系统控制的历史同样漫长——从20世纪60年代最早的SCADA应用到今天，已过去半个多世纪。但水系统在自主运行分级方面的发展明显滞后于航空和汽车，这既有技术原因（水系统的特殊复杂性），也有制度原因（水利行业对自主运行概念的接受度较低）。

**规律二：分级框架是发展的基础设施**。每个成功推进自主运行的领域，都建立了明确的分级框架——航空的CAT等级（自动着陆的I/II/IIIa/IIIb/IIIc分类）、汽车的SAE L0-L5、电网的成熟度模型、船舶的IMO MASS分级。分级框架为技术发展提供了清晰的目标牵引，为安全监管提供了评估依据，为社会接受度的培养提供了渐进路径。更深层地看，分级框架的建立本身就是一个领域从"技术探索"走向"工程成熟"的标志——它意味着该领域对自主运行的内涵、路径和边界已经形成了共识。

**规律三：安全验证是等级跃迁的瓶颈**。在所有领域中，安全验证而非技术开发是限制自主运行等级提升的主要瓶颈。自动驾驶汽车在封闭测试场可以轻松完成各种高难度场景，但要获得公共道路的L4运营许可，需要经过数百万公里的道路测试和海量的场景覆盖验证。航空领域的适航认证更是以严苛著称——一架飞机的飞行控制系统需要满足10⁻⁹（十亿分之一）级别的故障概率要求。这一规律对水系统的启示是：即使控制算法在仿真环境中表现完美，要在真实工程中获得L3或L4的自主运行授权，仍需建立完善的验证测试体系——这正是CHS提出的xIL（X-in-the-Loop）渐进验证方法论的重要性所在。

然而，水网作为自主运行的应用场景，具有不同于上述领域的特殊性：

| 比较维度 | 自动驾驶汽车 | 自主运行水网 |
| :--- | :--- | :--- |
| 系统规模 | 单车（局部系统） | 跨越数百至上千千米的网络系统 |
| 时间常数 | 毫秒-秒级响应 | 分钟-小时级（长距离调水延迟可达数天） |
| 失效后果 | 车祸（局部性） | 洪水/断水（区域性、社会性） |
| 环境不确定性 | 交通流、天气、行人 | 来水不确定性、需求变化、设施老化、冰期 |
| 传感覆盖度 | 高密度多模态传感 | 稀疏传感，大量区域不可观 |
| 执行器响应 | 毫秒级（电机驱动） | 分钟级（水力闸门）到小时级（水库蓄放） |
| 社会感知度 | 公众高度关注 | 相对"隐形"但后果可能更严重 |

这些特殊性决定了水网的自主运行分级不能简单照搬SAE J3016，需要根据水利系统的固有特征进行针对性设计。具体而言，水网的特殊性对分级框架的设计提出了以下独特要求：

**"慢系统"的预见性要求**。自动驾驶汽车的决策周期是毫秒级的——在0.1秒内必须做出转向或刹车决策。水系统的决策周期是分钟到小时级的，但需要提前数小时到数天进行预测和预控。这意味着水系统的自主运行不是"快速反应"问题，而是"长程预见"问题。水系统的L3等级不要求毫秒级的实时决策能力，而要求数小时到数天尺度的精准预测和预控能力。

**网络效应的级联风险**。自动驾驶汽车的失效是局部性的——一辆车出事不会导致所有车出事。但水网是一个紧密耦合的网络系统，上游的控制失误会通过水力波动级联传播到下游，可能引发系统级的连锁反应。这种网络级联效应要求水系统的安全包络不仅要定义在单个节点层面，还必须在网络层面进行协调——确保全网范围内不存在导致级联失效的运行状态。

**不可逆性与社会影响**。自动驾驶汽车的失控可以通过紧急制动在数秒内停止。但水系统的调度决策一旦执行，其后果在短时间内是不可逆的——水库泄洪后水量无法回收，渠道超量供水后多余的水无法立即排出。这种不可逆性要求水系统自主运行必须有更强的"先验安全"机制——在做出决策之前就能预判其后果是否安全，而非事后补救。


> **表 4-1　WSAL与自动驾驶SAE J3016分级对比**
> *Table 4-1 WSAL vs SAE J3016 Level Comparison*
>
> | 对比维度 | SAE J3016（自动驾驶） | WSAL（水网自主运行） |
> |:--------:|:---------------------|:--------------------|
> | 分级数量 | L0-L5（6级） | L0-L5（6级） |
> | 控制对象 | 单车（封闭系统） | 水网（开放分布式系统） |
> | 时间尺度 | 毫秒-秒级 | 分钟-小时-天级 |
> | 空间尺度 | 米级（车辆周围） | 公里-千公里级（流域/水网） |
> | ODD定义 | 道路类型、天气、速度 | 水文条件、冰期、设备状态 |
> | 安全后备 | 靠边停车（MRC） | 最小风险水位/流量状态 |
> | 多主体协调 | V2X车路协同 | MAS多智能体水量协商 |
> | 故障影响 | 单车事故 | 区域性水害/断供 |
> | 当前水平 | 部分L4商业运营 | 普遍L1，试点L2-L3 |


值得强调的是：**水网是最后一个没有建立L0-L5自主运行分级体系的重大工程领域**。航空有飞行自动化等级，汽车有SAE J3016，电网有智能电网成熟度模型，船舶有IMO的MASS分级，但水网至今没有一个类似的分级框架来描述和评估其自主运行水平。这一空白，正是WSAL概念提出的背景和动因。

> **概念辨析框：WSAL与SAE J3016的关键异同**
> *Concept Clarification: Key Similarities and Differences between WSAL and SAE J3016*
>
> | 维度 | WSAL（水网） | SAE J3016（汽车） | 异同分析 |
> |:----:|:----------:|:----------------:|:--------:|
> | **等级数** | L0-L5（6级） | L0-L5（6级） | 相同 |
> | **L3定义** | ODD内系统自主，人在回路上监督 | ODD内系统自主，人作为后备 | 本质相同 |
> | **ODD特征** | 空间大（千km级）、时间尺度长（小时级） | 空间小（车道级）、时间尺度短（秒级） | **根本差异** |
> | **失效模式** | 级联传播（上游→下游） | 局部（单车） | 水网更复杂 |
> | **响应时间** | 人工接管需分钟~小时 | 人工接管需秒 | 水网容忍度高但惯性大 |
> | **安全冗余** | 溢洪道/退水闸（物理） | 冗余传感+备份制动 | 水网有天然物理安全层 |
> | **L5可行性** | 极端工况（冰期/洪水）是瓶颈 | 复杂城市道路是瓶颈 | 各有难点 |

WSAL的提出，不仅是一个技术分级标准的建立，更是一种范式转换——它第一次将水利工程的运行管理从"人控"思维转向"人机协同与自主运行"思维，为水利行业拥抱自主运行时代提供了概念基础和路线图。

## 4.2 WSAL：水网自主等级分级体系

### 4.2.1 WSAL的基本定义

WSAL（Water Systems Autonomy Levels，水网自主等级）是雷晓辉教授在水系统控制论（CHS）框架下提出的分级体系，用于描述和评估水系统自主运行的程度。WSAL借鉴了SAE J3016自动驾驶分级的思想，同时针对水利系统的特殊性进行了适配设计，将水系统的自主运行水平分为L0到L5六个等级。

WSAL的设计遵循三条基本原则：**渐进性**——从L0到L5的演进是渐进的，每一级都建立在前一级的基础之上，不鼓励跳级；**可验证性**——每一级的定义必须是可测试、可评估的，而非模糊的定性描述；**安全保底**——在任何等级、任何工况下，系统都必须能够退回到安全状态，安全性不因自主等级的提升而降低。

从概念架构上看，WSAL沿用了SAE J3016的核心逻辑——按照"人机职责划分"来定义自主等级，但在以下方面进行了水利特色的适配：第一，将SAE中的"动态驾驶任务"（DDT）替换为"水网动态运行任务"（Dynamic Water Network Operation Task, DWNOT），包括实时水位/流量监测、闸站调度决策、执行指令下达、异常工况识别和应急响应等；第二，将SAE中面向单车的ODD扩展为面向网络系统的ODD——水网的ODD不仅涉及单个设施的运行条件，还涉及网络拓扑、上下游耦合、多源多汇的系统级条件；第三，增加了"可观性约束"维度——水系统的传感覆盖度远低于自动驾驶汽车，大量系统状态不可直接观测，需要通过模型推算，这一特征在自主运行等级定义中必须予以体现。

在定义WSAL之前，需要先明确两个基础概念：

**运行设计域（Operational Design Domain, ODD）**。ODD定义了自主运行系统可以正常工作的环境条件集合。对于水系统而言，ODD包括：来水条件范围（枯水/平水/丰水/洪水/冰期）、用水需求范围、水质条件范围、设备可用性条件、通信条件等。ODD的边界定义了系统"可以自主运行"和"需要人工接管"的临界条件。

**最小风险状态（Minimum Risk Condition, MRC）**。MRC是当系统运行条件超出ODD边界或发生严重故障时，系统应达到的安全状态。对于水系统而言，MRC可能包括：所有闸门保持当前开度不变（静止模式）、所有闸门全开或全关至安全位置、泵站紧急停机等。MRC的设计原则是：在任何情况下，系统都能够安全地退出自主运行模式，不会导致灾难性后果。

### 4.2.2 WSAL六级定义

| 等级 | 名称 | 人机角色分工 | ODD范围 | 核心技术要求 |
| :--- | :--- | :--- | :--- | :--- |
| L0 | 人工运行 | 人类完成全部感知、决策和执行 | 不适用 | 水尺、电话、纸质调度规程 |
| L1 | 辅助监控 | 系统提供监测数据和报警，人类完成决策和执行 | 不适用 | SCADA系统、远程监控 |
| L2 | 辅助决策 | 系统提供决策建议（预报+方案），人类确认后执行 | 不适用 | 水动力模型、优化算法、数字孪生 |
| L3 | 条件自主 | 在ODD范围内系统自主决策和执行，人类监督并随时接管 | 受限ODD | MPC/DMPC、安全包络、接管机制 |
| L4 | 高度自主 | 在扩展ODD范围内系统自主运行，异常时自动执行MRC | 扩展ODD | 自适应控制、在线学习、MRC自动执行 |
| L5 | 完全自主 | 系统在全工况域内自主运行，人类仅做战略监督 | 全工况域 | 通用水利智能体、自演化系统 |

**L0：人工运行**。系统没有任何自动化辅助。调度员依靠现场巡视或电话汇报获取水情信息，根据经验和规程做出调度决策，通过人工操作闸门、泵站等设备执行决策。中国目前仍有大量小型水利工程处于这一水平。

**L1：辅助监控**。系统通过SCADA等技术实现了远程数据采集和设备远程控制，但决策完全由人类完成。SCADA系统的角色是"帮人看得更远、手伸得更长"，不参与决策过程。中国大中型水利工程普遍达到了L1水平。

**L2：辅助决策**。系统不仅提供监测数据，还运行数学模型和优化算法，为调度员提供预报信息和调度方案建议。但最终的决策权仍在人类——调度员可以采纳系统建议，也可以根据自身判断进行修改。当前中国最先进的智慧水利系统大致处于L2水平。"四预"功能本质上就是L2级能力的水利化表达。

**L3：条件自主**。这是一个质变性的等级——系统在定义明确的ODD范围内，可以自主完成"感知→决策→执行→反馈"的完整闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对），不需要人类实时干预。但有两个重要的限制条件：一是ODD范围是受限的（例如仅限常规工况，不包括极端洪水、冰期等），二是人类调度员必须在"回路上"（on-the-loop）监督系统运行，随时准备接管。L3的核心技术要求包括：基于MPC/DMPC的实时优化控制、安全包络（Safety Envelope）机制（确保系统状态始终在安全范围内）、以及规范化的人工接管流程。L3是当前技术条件下最现实的近期目标。

L3等级的工程实施需要解决一个关键的"信任建立"问题。调度员需要经历从"由我决策"到"由机器决策、我来监督"的心理转变。工程实践表明，这一转变需要经历三个阶段："影子运行"阶段（系统在后台运行自主控制算法，但不实际执行，调度员对比系统建议与自己的决策差异，逐步建立对系统能力的认知）；"有限授权"阶段（在特定时段或特定工况下，允许系统自主执行，但调度员全程监督并可随时接管）；"常态自主"阶段（系统在ODD内常态化自主运行，调度员仅在异常时介入）。这一渐进授权过程，是L3成功实施的社会技术基础。

**L4：高度自主**。系统在比L3更广泛的ODD范围内实现自主运行。与L3的关键区别在于：当运行条件超出ODD边界时，L4系统能够自动识别这一情况并自主执行最小风险状态（MRC），而不需要人类接管。这意味着L4系统在异常情况下也能保证安全——即使通信中断、人类无法及时干预，系统也能自主退到安全状态。L4的核心技术要求包括：自适应控制（能够在模型参数变化时自动校正）、在线学习（从运行经验中持续优化策略）、ODD边界的实时监测和判断、以及MRC的自动执行和验证。

**L5：完全自主**。系统在全工况域内实现自主运行，不需要定义ODD边界——因为系统能够处理所有可能遇到的工况。人类的角色完全退到"战略监督"层面，不参与日常运行决策。L5是一个理想化的长远目标，在可预见的未来（10-20年内）难以实现。它可能需要通用人工智能（AGI）水平的技术突破，以及对水利系统物理过程的近乎完美的理解和建模能力。

需要特别指出的是，WSAL分级不仅是技术问题，更涉及社会信任和法规体系的建设。从L2到L3的跃迁，在技术上意味着从"系统建议、人决策"到"系统决策、人监督"的转变，在法律和责任层面则意味着需要回答"如果自主运行系统的决策导致了水灾事故，谁来承担责任？"这一根本问题。在自动驾驶领域，这一问题已经引发了长达十余年的法律讨论，各国立法进展不一。水利领域面临的情况更为复杂——水利工程通常是公共基础设施，运行责任涉及政府水利管理部门、工程运行单位、技术供应商等多个主体，责任划分远比自动驾驶汽车（主要涉及车企和车主）更为复杂。建立与WSAL分级相适应的法规体系——明确各等级下的责任分配规则、事故调查程序和保险赔偿机制——是WSAL从技术标准走向行业实践的制度性前提。

此外，WSAL等级的提升本质上是一个ODD渐进扩展的过程。CHS提出了"ODD演化路线图"的概念——为每个具体工程制定ODD扩展的阶段性目标和验证里程碑。以南水北调中线工程为例，其ODD演化路线图可能包括：第一阶段（当前→2年内），在常规非冰期工况下实现L3，ODD覆盖设计流量的30%-100%、水温5°C以上、所有关键设备正常；第二阶段（2-5年），将冰期初期（水温0-5°C、无冰盖形成）纳入ODD，基于冰期水力模型和冰期安全包络实现冰期初期L3；第三阶段（5-10年），将完全冰期和部分设备故障工况纳入ODD，逐步向L4演进。每个阶段的ODD扩展都必须通过相应的xIL验证后才能实施——这种"验证驱动的渐进扩展"策略，确保了自主运行水平的提升始终在安全可控的框架内进行。

### 4.2.3 ODD的结构化定义

WSAL的核心技术概念之一是ODD的结构化定义。在SAE J3016中，ODD被定义为自动驾驶系统设计适用的具体运行条件（包括但不限于地理区域、道路类型、速度范围、天气条件等）。在WSAL框架中，水系统的ODD需要从以下维度进行结构化定义：

| ODD维度 | 具体要素 | 示例条件范围 |
| :--- | :--- | :--- |
| 水文条件 | 来水流量/水位范围 | Q ∈ [Q_min, Q_max], H ∈ [H_min, H_max] |
| 气象条件 | 气温、降雨、冰冻 | T > 0°C（非冰期），P < P_alarm（非暴雨） |
| 需求条件 | 用水需求变化范围 | D ∈ [D_min, D_max]，变化率 ≤ ΔD_max |
| 设备条件 | 闸门/泵站可用性 | 可用率 ≥ 95%，备用设备可切换 |
| 通信条件 | 传感器和通信链路状态 | 丢包率 < 5%，延迟 < T_comm_max |
| 水质条件 | 水质参数范围 | 无突发污染事件 |

ODD的数学表达可以形式化为这些维度的笛卡尔积的一个子集：

$$ODD = \{(q, t, d, e, c, w) \mid q \in \mathcal{Q}, t \in \mathcal{T}, d \in \mathcal{D}, e \in \mathcal{E}, c \in \mathcal{C}, w \in \mathcal{W}\}$$

其中每个维度集合都有明确的上下界。当系统的实际运行条件落在ODD内时，自主运行系统负责决策和执行；当运行条件超出ODD边界时，系统必须触发退出机制（L3：请求人工接管；L4：自动执行MRC）。

ODD的定义不是一次性的，而是随着技术进步和运行经验积累而逐步扩展的。从L3到L4到L5的升级过程，本质上就是ODD范围不断扩展的过程——从受限ODD到扩展ODD再到全工况域。

ODD的工程化定义面临几个实践挑战。**维度组合爆炸**：上述六个ODD维度的组合空间极为庞大——即使每个维度只划分为3个等级（低/中/高），组合数也达到3⁶=729种。对每种组合都进行完整的安全验证是不现实的，需要发展基于可达集分析（Reachable Set Analysis）等方法的高效验证技术，从数学上证明安全约束在整个ODD范围内的满足性，而不是逐点验证。**边界模糊性**：物理系统的ODD边界往往不是清晰的阈值，而是渐变的"灰区"——例如，从"非冰期"到"冰期"的过渡不是在某个温度瞬间发生的，而是一个持续数天的渐变过程。ODD边界定义需要处理这种模糊性，可能需要引入模糊集合或概率性的边界描述。

**动态ODD**：水系统的ODD可能随时间动态变化——河道淤积会改变安全水位上限，设备老化会改变可用性条件，气候变化会改变来水统计特征。系统需要具备ODD的自动更新能力，根据最新的工程状况和水文统计重新计算ODD边界。

### 4.2.4 安全包络与最小风险状态

安全包络（Safety Envelope）是WSAL L3及以上等级的核心安全机制。安全包络定义了系统状态变量的安全边界，确保在自主运行过程中系统状态始终保持在安全范围内：

$$\mathcal{X}_{safe} = \{x \mid h_i(x) \leq 0, \, i = 1, \ldots, m\}$$

其中 $h_i(x)$ 是安全约束函数。例如，对于一个调水渠道，安全包络可能包括：各节点水位不超过渠堤高程的安全余量、各节点水位不低于最小工作水深、闸门开度在物理限幅范围内、闸门开度变化速率不超过机械限制等。

安全包络与MPC优化目标之间的关系是：安全包络是硬约束，MPC优化目标是软目标。当两者发生冲突时，安全包络优先——即使牺牲供水效率或偏离目标水位，也必须保证系统状态不突破安全边界。这一"安全优先"的设计原则，与航空领域的"安全第一"理念和汽车领域的功能安全标准（ISO 26262的ASIL等级）一脉相承。

最小风险状态（MRC）的设计原则遵循"失效安全"（Fail-Safe）理念。对于不同类型的水利工程，MRC的具体定义有所不同：对于调水渠道，MRC通常是"闸门保持当前开度，泵站维持当前工况"（静止模式），避免任何可能恶化局势的操作；对于防洪系统，MRC可能是"闸门全开，最大化泄洪能力"；对于供水系统，MRC可能是"维持最低保障供水量"。MRC的执行必须是自动化的、不依赖通信的——因为触发MRC的场景往往伴随着通信故障或其他异常。

安全包络的实时计算是一个技术难点。由于水系统的状态空间（state space，用一组状态变量——如各断面水位和流量——来完整描述系统在任意时刻行为的数学框架）是连续的、高维的，直接计算安全集合$\mathcal{X}_{safe}$在当前模型预测时域内的可达性（即判断"从当前状态出发，在所有可能的扰动下，系统是否可能越过安全边界"）是一个计算量极大的问题。实践中，常用的方法包括：**显式约束**方法——将安全约束直接作为MPC的硬约束，由优化器保证满足，但这要求优化器具有处理硬约束的能力且求解必须在规定时间内完成；**安全裕度**方法——在安全边界上预留一定的裕度（如水位安全上限取渠顶高程减30cm而非仅减10cm），以吸收模型误差和执行延迟带来的不确定性；

**控制屏障函数**（Control Barrier Function, CBF）方法——定义一个随系统状态连续变化的屏障函数，当系统状态接近安全边界时，屏障函数趋向零，强制控制器采取保守行动避免越界。CBF方法具有计算高效且形式化安全保证的优点，是当前安全控制领域的研究前沿。

为使安全包络的概念更具操作性，下面给出一个简化的计算示例。

> **算例：南水北调中线某渠段安全包络计算**
>
> 考虑一个典型的明渠渠段（长度20km，设计流量170m³/s，梯形断面），其安全包络由以下约束定义：
>
> | 约束类型 | 约束表达式 | 物理意义 | 参数取值 |
> |:--------:|:----------|:---------|:---------|
> | 水位上限 | $h_i(t) \leq h_{max,i}$ | 防止漫溢 | $h_{max}$ = 渠顶高程 − 0.3m安全超高 |
> | 水位下限 | $h_i(t) \geq h_{min,i}$ | 保证过流与取水 | $h_{min}$ = 最低工作水深1.5m |
> | 水位变化速率 | $|\dot{h}_i(t)| \leq \dot{h}_{max}$ | 防止护坡冲刷 | $\dot{h}_{max}$ = 0.15 m/h |
> | 闸门开度限幅 | $0 \leq u_i(t) \leq u_{max,i}$ | 物理限制 | $u_{max}$ = 闸门全开高度 |
> | 闸门变速限制 | $|\dot{u}_i(t)| \leq \dot{u}_{max}$ | 机械保护 | $\dot{u}_{max}$ = 0.5 m/10min |
> | 流速约束（冰期） | $0.4 \leq v_i(t) \leq 0.6$ m/s | 防止冰盖破碎/过厚 | 仅冰期ODD启用 |
>

> **安全裕度设计**：在MPC优化中，实际使用的约束边界在安全包络基础上收缩一个裕度$\delta$，以吸收模型误差和执行延迟：
>
> $$h_{min,i} + \delta_h \leq h_i(t) \leq h_{max,i} - \delta_h$$
>
> 其中 $\delta_h$ = 0.1m（对应IDZ模型的典型预测误差RMSE）。裕度的具体取值应通过MIL仿真在多种工况组合下的统计分析确定。
>

> **多层次实施机制**：
> - 第一层（软约束）：MPC优化器在目标函数中对接近边界的状态施加惩罚项
> - 第二层（硬约束）：MPC优化器将安全包络作为不等式约束强制满足
> - 第三层（执行拦截）：PLC安全联锁程序独立于MPC，当水位触及$h_{max}$−0.1m时强制开闸、触及$h_{min}$+0.1m时强制关闸
> - 第四层（物理防线）：溢洪道/退水闸在物理层面防止灾难性后果

### 4.2.5 WSAL的工程映射

将WSAL框架映射到中国现有水利工程的实际状况，可以形成以下评估：

| 工程类型 | 当前主流水平 | 近期目标（5年） | 中期目标（10年） |
| :--- | :--- | :--- | :--- |
| 大型水库（三峡、丹江口等） | L1-L2 | L2-L3 | L3-L4 |
| 南水北调中线 | L1-L2 | L3（常规工况） | L3-L4 |
| 胶东调水 | L2（部分渠段L3试点） | L3 | L4 |
| 大中型灌区 | L0-L1 | L1-L2 | L2-L3 |
| 城市供水管网 | L1-L2 | L2-L3 | L3 |
| 小型农村水利 | L0 | L0-L1 | L1 |

这一映射揭示了几个重要事实：第一，中国水利工程的自主运行水平整体处于L0-L2阶段，距离L3（条件自主）还有明确的技术和标准差距；第二，不同类型工程的发展节奏差异显著——大型工程有望在5-10年内达到L3-L4，而小型工程的智能化仍是长期任务；第三，胶东调水工程在L3试点方面走在前列，有望成为中国首个达到WSAL L3水平的大型调水工程。

**从L2到L3的跃迁要求**。L2到L3是WSAL分级中最关键的一次跃迁，因为它标志着从"人类决策、机器辅助"到"机器决策、人类监督"的根本转变。实现这一跃迁需要满足以下最低要求：控制系统必须具备完整的闭环自动控制能力（不仅仅是方案建议，还要能自动执行）；安全包络机制必须经过严格的SIL和HIL验证，证明在所有ODD内的工况组合下系统状态不会突破安全边界；人工接管机制必须经过实战演练，确保在系统退出自主模式时能够平滑过渡到人工控制而不引发扰动；ODD的定义必须经过形式化验证——不是简单地列出"大概的适用范围"，而是对每个ODD维度给出精确的数学边界并证明系统在边界内的安全性。

**从L3到L4的跃迁要求**。L3到L4的核心差异在于异常处理能力——L3系统在遇到超出ODD的情况时"请求人工接管"，而L4系统能够"自主执行MRC"。这意味着L4系统必须具备三项L3不要求的关键能力：ODD边界的实时自主监测和判断（系统需要自己判断"当前是否仍在ODD内"，而不是依赖人工预先设定的阈值告警）；MRC策略的自动选择和执行（不同的异常场景需要不同的MRC策略，系统需要根据异常类型自主选择最合适的MRC）；以及通信中断条件下的独立安全运行能力（L4系统必须能在失去与上级控制中心通信的情况下，依靠本地资源维持安全运行）。

**国际对标分析**。将WSAL映射到全球范围，可以发现：荷兰Maeslantkering风暴潮屏障在特定触发条件下的自主关闭操作达到了L3水平（但其ODD极为狭窄，仅限于风暴潮超过设定阈值这一单一场景）；澳大利亚Rubicon Water的TCC系统在灌区渠道控制中达到了L3水平（ODD覆盖常规灌溉工况）；日本横河电机在化工厂实现的35天AI自主运行可类比为L4水平（在扩展的ODD内系统自主处理了多种工况变化）。全球范围内，尚无水利工程达到L5水平，L4也仅在极少数特定场景中有所探索。这一现状说明，水利行业的自主运行之路仍处于起步阶段，WSAL框架的提出恰逢其时。

### 4.2.6 WSAL与xIL验证的对应关系

WSAL的每一级跃迁都需要通过严格的验证才能被认定。CHS框架提出的xIL（X-in-the-Loop）验证体系，为WSAL等级认定提供了方法论支撑：

| WSAL等级 | 必须通过的验证阶段 | 验证要求 |
| :--- | :--- | :--- |
| L1→L2 | MIL（模型在回路） | 模型精度验证：预报和优化结果与实测数据的偏差在可接受范围内 |
| L2→L3 | MIL + SIL（软件在回路） | 控制软件在仿真环境中的功能验证和安全约束满足验证 |
| L3→L4 | MIL + SIL + HIL（硬件在回路） | 控制系统在含真实硬件的半实物仿真环境中的性能和安全验证 |
| L4→L5 | MIL + SIL + HIL + PIL（现场在回路） | 控制系统在实际工程现场的影子运行和渐进授权验证 |

这一渐进式验证流程借鉴了航空领域的适航认证和汽车领域的功能安全认证理念，确保每一级自主运行水平的提升都经过了充分的安全验证。关于xIL验证体系的详细介绍，将在§4.5中展开。

为使WSAL分级框架具有工程可操作性，下面给出一份简化的自评检查表（表4-3）。工程管理者可以逐项核查，初步判定本工程当前所处的WSAL等级，并识别向上一等级跃迁的关键差距。

> **表 4-3　WSAL等级自评检查表**
> *Table 4-3 WSAL Self-Assessment Checklist*
>
> | 检查项 | L0 | L1 | L2 | L3 | L4 | L5 |
> |:-------|:--:|:--:|:--:|:--:|:--:|:--:|
> | **感知能力** | | | | | | |
> | 关键断面水位/流量在线监测 | — | ✓ | ✓ | ✓ | ✓ | ✓ |
> | SCADA系统覆盖率≥90% | — | ✓ | ✓ | ✓ | ✓ | ✓ |
> | 数据质量自动评估与异常标记 | — | — | ✓ | ✓ | ✓ | ✓ |
> | 多源数据融合（传感器+遥感+视频） | — | — | — | ○ | ✓ | ✓ |
> | **建模能力** | | | | | | |
> | 具备标定的水力学数值模型 | — | — | ✓ | ✓ | ✓ | ✓ |
> | 具备IDZ/传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）级实时模型 | — | — | ○ | ✓ | ✓ | ✓ |
> | 模型在线自校正能力 | — | — | — | ○ | ✓ | ✓ |
> | 可控模型族动态切换 | — | — | — | — | ✓ | ✓ |
> | **决策能力** | | | | | | |
> | 调度方案自动生成（人工确认） | — | — | ✓ | ✓ | ✓ | ✓ |
> | MPC/DMPC在线优化 | — | — | — | ✓ | ✓ | ✓ |
> | ODD定义并在线监测 | — | — | — | ✓ | ✓ | ✓ |
> | 超ODD自动执行MRC | — | — | — | — | ✓ | ✓ |
> | 全工况域无人值守 | — | — | — | — | — | ✓ |
> | **执行能力** | | | | | | |
> | 闸/泵远程控制 | — | ✓ | ✓ | ✓ | ✓ | ✓ |
> | 控制指令自动下达（限ODD内） | — | — | — | ✓ | ✓ | ✓ |
> | 执行器状态反馈与故障检测 | — | ○ | ✓ | ✓ | ✓ | ✓ |
> | **安全保障** | | | | | | |
> | 安全包络定义并在线监测 | — | — | — | ✓ | ✓ | ✓ |
> | 单点故障不导致系统级失效 | — | — | ○ | ✓ | ✓ | ✓ |
> | 通信中断时边缘层自治保持安全 | — | — | — | ✓ | ✓ | ✓ |
> | 异常工况自主诊断与处置 | — | — | — | — | ✓ | ✓ |
> | **验证测试** | | | | | | |
> | MIL仿真验证通过 | — | — | ✓ | ✓ | ✓ | ✓ |
> | SIL软件在环验证通过 | — | — | — | ✓ | ✓ | ✓ |
> | HIL硬件在环验证通过 | — | — | — | ○ | ✓ | ✓ |
> | PIL现场影子模式验证通过 | — | — | — | — | ✓ | ✓ |
>

> **说明**: ✓ = 必须满足；○ = 建议满足（非强制）；— = 不要求。判定规则：满足某等级全部"✓"项即可认定达到该等级。向上一级跃迁时，重点关注从"—"变为"✓"的新增必达项。

### 4.2.6 工程案例：胶东调水WSAL L2→L3升级全流程

为使WSAL分级框架从概念落地到工程实践，本节以胶东调水工程为例，给出L2→L3升级的完整实施流程。这一案例对其他正在规划智能化升级的水利工程具有直接的参考价值。

**第一步：现状评估（自评检查表）。** 使用表4-3对胶东调水工程进行WSAL自评。评估结果显示：感知能力——SCADA覆盖率92%（✓），数据质量自动评估（✓），多源融合（×）；建模能力——具备标定水力模型（✓），IDZ实时模型（✓），在线自校正（×）；决策能力——调度方案自动生成（✓），MPC在线优化（部分渠段试点✓），ODD定义（×）；执行能力——闸门远程控制（✓），自动下达（部分✓）；安全保障——安全包络定义（×），单点故障隔离（✓）；验证测试——MIL通过（✓），SIL通过（部分✓），HIL（×）。**诊断结论：L2已达标，L3有5项必达项未满足。**

**第二步：差距分析与升级方案。** L2→L3的5项差距及其解决方案：

> | 差距项 | 当前状态 | L3要求 | 解决方案 | 预算（万元） | 周期 |
> |:------:|:--------|:-------|:---------|:----------:|:----:|
> | ODD定义 | 无形式化定义 | 数学化ODD文档 | 编制《ODD技术规格书》，定义流量/水温/设备状态的安全域 | 30 | 2月 |
> | 安全包络 | 仅水位上下限报警 | 多维安全包络在线监测 | 实现水位+流速+变化速率+闸门联动的六约束包络（参照§4.2.4算例） | 80 | 3月 |
> | MPC全覆盖 | 3个渠段试点 | 全线12个渠段 | 扩展IDZ-MPC控制器至全线，部署DMPC协调层 | 150 | 4月 |
> | SIL验证 | 部分通过 | 全线通过 | 搭建软件在环测试平台，覆盖120种典型工况 | 60 | 3月 |
> | 通信中断自治 | 无 | 边缘层30min自治 | 在每个闸站边缘控制器部署本地MPC备份策略 | 40 | 2月 |
> | **合计** | | | | **360** | **8月** |

**第三步：xIL渐进验证。** 按MIL→SIL→HIL→PIL顺序执行：MIL阶段（第1-3月）在离线仿真环境验证MPC算法在120种工况下的安全包络保持率（目标≥99.5%）；SIL阶段（第3-5月）在真实软件栈上验证算法运行时序、异常处理和通信中断恢复；HIL阶段（第5-7月）接入真实SCADA信号进行硬件在环测试；PIL阶段（第7-8月）在3个渠段进行为期4周的"影子模式"运行——系统自主生成控制指令，但由调度员确认后方可执行，积累运行置信度。

**第四步：受控上线与ODD渐进扩展。** PIL验证通过后，在常规工况ODD（流量50-170m³/s、水温>5°C、全部闸门正常）内切换为L3自主模式。调度员从"在回路内"（L2）转变为"在回路上"（L3）——监督系统运行而非逐一审批指令。首月保持24h人工值守，统计自主决策正确率和人工干预频率；达到连续30天无需人工干预后，转为8h值守+16h远程告警模式。

**预期成果：** 基于表2-5的已有数据，L3升级后预期：水位偏差从±5cm进一步降至±3cm；闸门日动作次数从8-12次降至5-8次；夜间运行从"正常自动"提升至"全自主不间断"，输水能力再提升10-15%。


---

**思考与讨论**

1. （概念理解）WSAL L2和L3的核心区别是什么？为什么说L2→L3是"最关键的里程碑"？
2. （计算练习）参照§4.2.4的安全包络计算示例，如果某渠池的设计水深为3.0m，安全超高0.5m，冰期冰盖厚度0.3m，请计算该渠池在冰期的有效安全包络范围。
3. （综合设计）参照胶东调水L2→L3升级案例，请为你所熟悉的一个水利工程制定WSAL自评表（使用表4-3模板），并识别从当前等级向上跃迁的关键差距。


---

### §4.1-4.2 本节小结


本节提出了WSAL（水网自主等级）L0-L5分级框架，定义了ODD（运行设计域）、安全包络和MRC（最小风险状态）三个核心概念。WSAL的学术贡献在于填补了水网领域自主运行分级体系的空白——航空、汽车、电网均已建立类似框架，唯水网尚无。WSAL自评检查表（表4-3）和安全包络计算示例为工程落地提供了可操作工具。从L2到L3的跃迁是最关键的里程碑，标志着从"人类决策"到"机器决策"的根本转变。

## 4.3 双引擎架构：物理AI与认知AI的深度融合

实现WSAL L3及以上等级的自主运行，需要在决策引擎层面实现质的飞跃。传统的控制系统依赖单一的模型驱动范式或数据驱动范式，各有其固有局限：物理模型精确但僵化，难以适应未建模的工况；数据模型灵活但脆弱，难以保证安全约束和物理一致性。水系统控制论（CHS）提出的"双引擎"架构——物理AI引擎（Physical AI Engine）与认知AI引擎（Cognitive AI Engine）的深度融合——正是为了克服这一两难困境，构建一个既有物理根基又有认知灵活性的自主决策系统。


> **图 4-1　CHS双引擎融合架构**
> *Fig. 4-1 Physical AI and Cognitive AI Dual-Engine Architecture*
>
> ```
>              ┌───────────────────────────────────┐
>              │        融合决策层（Fusion）         │
>              │  冲突仲裁 · 置信度加权 · 安全否决  │
>              └────────┬──────────────┬────────────┘
>                       │              │
>      ┌────────────────▼──┐   ┌───────▼────────────────┐
>      │  物理AI引擎        │   │  认知AI引擎             │
>      │  (Physical AI)     │   │  (Cognitive AI)         │
>      ├────────────────────┤   ├─────────────────────────┤
>      │ • I/ID/IDZ/LSV/SV │   │ • 瀚铎水网大模型(LLM)  │
>      │   可控模型族        │   │ • 强化学习(RL)策略网络  │
>      │ • MPC/DMPC优化器   │   │ • 知识图谱（knowledge graph，以图结构存储实体及其关系的知识表示方法，如'闸门A→控制→渠段B→连接→闸门C'）+RAG          │
>      │ • 安全包络约束      │   │ • 多模态感知融合        │
>      ├────────────────────┤   ├─────────────────────────┤
>      │ 优势：精确、可解释  │   │ 优势：灵活、自适应      │
>      │       可约束、稳定  │   │       善交互、可泛化     │
>      │ 短板：依赖建模精度  │   │ 短板：黑箱、缺乏约束    │
>      │       难适应未建模  │   │       安全性难保证       │
>      │       工况          │   │                         │
>      └────────────────────┘   └─────────────────────────┘
>               ▲                          ▲
>               │                          │
>      ┌────────┴──────────────────────────┴────────────┐
>      │              水系统运行环境                      │
>      │  SCADA数据 · 气象预报 · 需水预测 · 设备状态     │
>      └────────────────────────────────────────────────┘
> ```
>
> 物理AI提供"骨骼"（精确约束与安全保障），认知AI提供"大脑"（灵活决策与知识推理），
> 融合决策层通过置信度加权和安全否决机制实现两个引擎的协同。


### 4.3.1 为什么需要双引擎？

要理解双引擎架构的必要性，需要先深入分析物理模型方法和数据驱动方法各自的能力边界。

**物理模型方法的能力与局限**。基于圣维南方程（Saint-Venant equations，描述明渠水流运动的基本方程，由连续性方程和动量方程组成）等物理定律的水动力学模型，在描述水流运动规律方面具有无可替代的优势：它们有明确的物理意义、可解释性强、在已验证的工况范围内精度高、能够保证质量守恒等基本物理约束。特别是在安全关键的水利控制中，物理模型提供的确定性预测和约束保证是不可或缺的。然而，物理模型也有明显的局限：模型参数（如曼宁糙率系数）需要校准且随工况变化；模型结构可能不完整（如未考虑某些次要但在特定工况下重要的物理过程）；极端工况下模型精度可能急剧下降；实时计算速度受限于模型复杂度。

**数据驱动方法的能力与局限**。机器学习方法的优势在于灵活性和自适应能力：它不需要预先建立精确的物理方程，能够从数据中自动学习复杂的非线性关系，能够处理物理模型难以描述的因素（如人类用水行为的随机性、设备老化的渐变效应等）。深度学习在水文预报、需水预测等领域已展现出强大的能力。然而，纯数据驱动方法的固有缺陷同样显著：缺乏物理可解释性，可能给出违反基本物理定律（如质量不守恒）的预测；对训练数据分布之外的工况泛化能力差（"分布外"问题）；难以提供安全约束的严格保证；在极端事件（如百年一遇洪水）的预测中，由于训练样本稀缺而表现不可靠。

这两类方法的能力边界恰好形成了互补关系：物理模型擅长的（确定性预测、约束保证、可解释性），正是数据模型欠缺的；数据模型擅长的（灵活适应、模式识别、处理不确定性），正是物理模型力不从心的。双引擎架构的核心思想，就是将两者的优势有机整合，构建一个"1+1>2"的融合决策系统。


> **表 4-2　物理AI引擎与认知AI引擎特征对比**
>
> | 对比维度 | 物理AI引擎 | 认知AI引擎 |
> |:--------:|:-----------|:-----------|
> | 理论根基 | 控制论、优化理论、水力学 | 深度学习、自然语言处理、强化学习 |
> | 核心算法 | MPC/DMPC、LQR、H∞ | LLM、RL、知识图谱 |
> | 模型基础 | I/ID/IDZ/LSV/SV物理模型 | 神经网络、Transformer |
> | 可解释性 | ★★★★★（物理方程驱动） | ★★☆☆☆（黑箱/后验解释） |
> | 安全约束 | ★★★★★（硬约束嵌入优化） | ★★☆☆☆（需外部安全包络） |
> | 泛化能力 | ★★☆☆☆（依赖建模精度） | ★★★★☆（数据驱动迁移） |
> | 异常处理 | ★★☆☆☆（仅处理已建模故障） | ★★★★☆（模式识别+推理） |
> | 人机交互 | ★☆☆☆☆（参数界面） | ★★★★★（自然语言对话） |
> | 计算效率 | ★★★☆☆（在线优化求解） | ★★★★☆（推理前向传播） |
> | 典型角色 | 精确控制器、安全守门员 | 态势理解、策略建议、运维助手 |


### 4.3.2 物理AI引擎：从方程到代理模型

物理AI引擎是双引擎架构的"骨骼和肌肉"，负责提供基于物理定律的精确预测和约束保证。其技术核心是CHS的五级模型层次和统一传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）族。

**五级模型层次与选择策略**。CHS建立的五级模型层次（LSV→IDZ→ID→I→SS）为不同应用场景提供了适配的模型精度选择：

第一级LSV（Linearized Saint-Venant）：保留完整的圣维南方程离散化形式，空间分辨率高，适用于高保真仿真和xIL验证中的虚拟工厂角色。计算量大，通常不用于实时控制的内部模型。

第二级IDZ（Integrator-Delay-Zero）：将每个渠池简化为三参数传递函数 $G(s) = (1 + \tau_m s) e^{-\tau_d s} / (A_s \cdot s)$，其中 $A_s$ 为蓄水面积系数、$\tau_d$ 为传播延迟、$\tau_m$ 为回水时间常数。IDZ模型在保持物理本质的同时大幅降低了计算复杂度，是MPC控制器内部模型的首选。

第三级ID（Integrator-Delay）：省略非最小相位零点，仅保留积分和延迟特性，$G(s) = e^{-\tau_d s} / (A_s \cdot s)$。适用于初步设计和参数灵敏度分析。

第四级I（Integrator）：进一步省略延迟，仅保留积分特性，$G(s) = 1/(A_s \cdot s)$。适用于量级估算和概念验证。

第五级SS（Steady-State）：稳态代数方程，仅用于容量规划和静态校核。

物理AI引擎的关键创新在于：这五级模型不是孤立使用的，而是构成了一个动态切换的模型选择框架。在正常运行时，使用IDZ模型进行实时MPC优化（速度快、精度适中）；在模型校正和验证时，切换到LSV模型进行高精度仿真比对；在在线学习中，使用ID或I模型进行快速的参数灵敏度分析。这种多层次模型的动态调用策略，使得物理AI引擎能够在精度、速度和鲁棒（robust，指系统在参数变化或外部干扰下仍能保持稳定性能的能力，类似于水利工程中的'抗干扰性'）性之间灵活平衡。

**统一执行器模型**。CHS的另一个重要贡献是统一执行器特性方程：$\Delta Q = \alpha \cdot \Delta u + \beta_{up} \cdot \Delta H_{up} + \beta_{dn} \cdot \Delta H_{dn}$，将闸门、泵站、阀门等各类执行器的流量-控制关系统一表达为线性化形式。这一统一表达使得控制器设计可以独立于具体的执行器类型，极大地提高了控制算法的通用性和可移植性。

**代理模型技术**。为了在实时控制中同时满足精度和速度要求，物理AI引擎采用代理模型（Surrogate Model）技术：基于LSV模型的离线仿真数据训练神经网络代理模型，使其在保持物理模型精度的同时获得毫秒级的计算速度。常用的代理模型技术包括：高斯过程回归（Gaussian Process Regression，提供预测不确定性的量化评估）、神经常微分方程（Neural ODE，保持时间连续性和微分方程的结构特征）、以及Physics-Informed Neural Networks（PINNs，在训练损失中嵌入物理方程约束以确保物理一致性）。代理模型的训练数据由物理模型生成，因此其预测结果继承了物理模型的约束特性——这是纯数据驱动模型所不具备的优势。

代理模型的关键工程问题是**有效性域**（Domain of Validity）的界定和管理。每个代理模型都有其训练数据所覆盖的工况范围，在该范围内预测精度高、可信度强；超出该范围时，预测可能严重失准。物理AI引擎通过"域感知"（Domain-Aware）机制管理代理模型的有效性域：实时监测当前工况点在训练数据空间中的位置，当工况点接近或超出有效性域边界时，自动发出警告并切换到精度更高的物理模型。具体实现上，可以利用高斯过程的预测方差作为不确定性指标——当预测方差超过阈值时，表明当前工况点远离训练数据的密集区域，代理模型的可靠性下降，应切换到物理模型。这种"代理模型+域感知+自动切换"的组合策略，在保证安全性的前提下最大化了计算效率。

**实时状态估计**。在实际水利系统中，并非所有状态变量都能被直接观测。例如，长距离输水渠道沿线的水位和流量分布可能只在有限的几个监测断面被测量，其余位置的状态需要通过模型估计。物理AI引擎内置了基于扩展卡尔曼滤波（EKF）和无迹卡尔曼滤波（UKF）的实时状态估计器，将物理模型的预测与传感器的观测数据进行融合，得到对全系统状态的最优估计。状态估计的精度直接影响MPC的控制效果——如果状态估计有偏差，MPC基于错误的初始条件进行优化，控制效果会显著恶化。因此，高质量的状态估计是整个物理AI引擎的基础能力之一。

**参数辨识与自标定**。水系统的物理参数（如渠道糙率系数、闸门过流系数、管道阻力系数等）会随着工程运行条件的变化而缓慢变化——例如，渠道淤积会增大糙率，闸门密封件老化会影响过流特性。物理AI引擎实现了在线参数辨识功能——基于实时的观测数据和模型预测的偏差，采用递推最小二乘法或粒子滤波法自动更新物理参数。参数辨识结果还可以反馈给运维管理系统，为预防性维护提供依据——例如，当某闸门的过流系数持续下降时，可能表明闸门需要检修或更换密封件。

### 4.3.3 认知AI引擎：从感知到理解

认知AI引擎是双引擎架构的"感官和大脑"，负责处理物理模型难以覆盖的认知任务：环境理解、意图识别、异常检测、知识推理和人机交互。

**大语言模型（LLM）的水利化应用**。2022年以来，大语言模型的突破性进展为水利领域带来了全新的技术可能性。在双引擎架构中，LLM被赋予以下角色：

自然语言交互界面：将调度员的语音或文字指令转化为系统可执行的调度命令。例如，调度员说"今晚8点把A闸的下游水位提高到3.5米"，LLM理解语义后生成对应的MPC设定值调整指令。这一过程涉及多层语义解析——首先识别时间约束（"今晚8点"）、目标对象（"A闸的下游"）、目标变量（"水位"）和目标值（"3.5米"），然后查询知识图谱验证该指令的合理性（如A闸下游的正常水位范围、当前是否处于特殊工况），最后将验证通过的语义解析结果转化为MPC的形式化约束。这种端到端的自然语言到控制指令的转换，使得调度员无需掌握复杂的系统操作界面，大大降低了人机交互的认知负荷。

运行日志智能分析：自动阅读和理解海量的运行日志、巡检报告、事故记录，提取隐性知识，发现潜在风险模式。在南水北调中线工程中，每年积累的运行日志达数百万条，人工逐条分析既不现实也不高效。LLM可以对这些日志进行批量语义分析，自动提取"设备异常模式"（如"某闸门近三个月的开度偏差逐渐增大，可能存在机械磨损"）和"工况关联规律"（如"上游某水库放水后约6小时，中游某断面流量出现峰值"），为预防性维护和调度策略优化提供数据支持。

调度规程知识化：将纸质的调度规程和操作手册转化为结构化的知识表示，使系统能够在决策过程中自动参考相关规程条款。传统的调度规程以自然语言编写，条款之间的逻辑关系和适用条件往往隐含在文本之中。LLM结合知识图谱技术，可以将这些隐含的逻辑关系显式化——例如，将"当水位超过警戒线且上游来水持续增大时，应启动防洪调度预案"这一规程条款解析为：触发条件（水位>警戒线 AND 上游流量增长率>阈值）→执行动作（加载防洪调度模式）→约束更新（将MPC的目标函数从"节水优先"切换到"安全优先"）。

多语言知识桥接：在国际化的水利工程合作中，LLM可以充当不同语言之间的技术知识翻译器——不仅进行语言层面的翻译，更进行领域知识层面的概念对齐。例如，将中国水利行业的技术术语（如"节制闸"、"退水闸"、"渡槽"）准确地映射到国际通用的水利工程术语体系中，或者将IAHR、ASCE等国际组织的技术标准与中国的行业规范进行条款级的对照分析。

**知识图谱与RAG架构**。知识图谱为水利系统的实体关系和运行规则提供了结构化的表示方法。在双引擎架构中，知识图谱包含三类核心知识：

拓扑知识：水网的物理连接关系（哪些闸门控制哪些渠段、哪些渠段向哪些用户供水等）。拓扑知识的结构化表示使得系统能够进行"传播分析"——当某个节点发生故障时，快速推演故障影响的传播范围和受影响的用户群体。

规则知识：调度规程、安全约束、优先级规则等。规则知识的形式化表示使得系统能够进行"合规检查"——在执行任何调度方案前，自动检查方案是否满足所有适用的规程条款和安全约束。

经验知识：从历史运行数据中提炼的经验规律（如某断面的流量-水位关系在不同季节的变化特征、某设备在高温天气下的性能衰减规律等）。经验知识的积累和利用使得系统具备了"机构记忆"——即使经验丰富的调度员退休或调岗，其积累的运行经验仍然留存在知识图谱中，可以被后继者和AI系统所利用。

知识图谱与LLM的结合——检索增强生成（RAG）技术——使得认知AI引擎既有LLM的语言理解能力，又有知识图谱的事实准确性，避免了LLM单独使用时的"幻觉"（Hallucination）问题。在具体实现上，RAG架构采用"检索-过滤-增强-生成-校验"的五步流水线：当调度员提出问题或系统需要做出决策时，首先在知识图谱和文档库中检索相关知识片段（检索），然后对检索结果进行相关性过滤和排序（过滤），将高相关性的知识片段注入LLM的提示上下文中（增强），由LLM生成回答或决策建议（生成），最后由事实校验模块检查回答的准确性和一致性（校验）。这一流水线确保了认知AI引擎输出的可靠性和可追溯性。

**强化学习与策略生成**。对于传统优化方法难以处理的复杂决策问题（如多目标冲突场景下的调度策略选择、长时间尺度的水资源优化配置等），强化学习提供了一种通过试错学习最优策略的方法。在双引擎架构中，强化学习的训练环境由物理AI引擎提供——即在物理模型的仿真环境中训练强化学习智能体，然后将训练好的策略部署到实际系统中。这种"在虚拟环境中训练、在物理环境中部署"的模式（即Sim-to-Real Transfer），既利用了强化学习的探索能力，又避免了在真实水利系统上进行危险的试错。

为了确保强化学习策略的安全性，双引擎架构引入了"安全屏障"（Safety Shield）机制：RL智能体生成的每一个动作在执行前，都要经过物理AI引擎的安全包络检查。如果RL建议的动作可能导致系统进入不安全状态，安全屏障将自动修正该动作，将其投影到最近的安全可行域内。这一机制使得RL智能体可以在安全约束下自由探索策略空间，实现了"大胆探索、安全保底"的平衡。

**异常检测与根因分析**。认知AI引擎集成了多种异常检测技术，形成"多模态异常感知"能力。统计方法（如CUSUM、EWMA控制图）用于检测缓慢漂移型异常；深度学习方法（如自编码器（autoencoder，一种神经网络结构，将输入数据压缩再还原，用于特征提取和异常检测）、变分自编码器）用于检测复杂模式型异常；物理模型残差分析用于检测物理机理型异常（即观测值与物理模型预测值之间的偏差）。三种方法各有侧重，通过投票机制综合判断，大幅降低了单一方法的误报率和漏报率。当异常被确认后，认知AI引擎进一步进行根因分析——利用知识图谱的因果推理能力和LLM的知识整合能力，自动推断异常的可能原因，并生成诊断报告和建议处置方案。

### 4.3.4 双引擎耦合架构

双引擎的融合不是简单的"拼凑"，而是在架构层面实现深度耦合。CHS设计了以下耦合机制：

**安全优先级机制**。在双引擎架构中，物理AI引擎拥有"安全否决权"——当认知AI引擎给出的决策建议可能违反物理约束或安全包络时，物理AI引擎可以否决该建议，并将系统退到安全状态。这一机制确保了在任何情况下，系统的行为都不会违反基本的物理定律和安全约束。安全优先级的层次结构为：安全包络 > 物理约束 > 优化目标 > 用户偏好。

安全否决权的实现基于"硬约束-软约束"二分法。安全包络的边界条件（如最高水位不超过堤顶高程减安全超高、最大流速不超过渠道允许流速）作为硬约束，在任何情况下都不允许违反——物理AI引擎通过约束优化的严格可行域保证来确保这一点。优化目标（如最小化弃水量、最大化供水保障率）作为软约束，允许在满足硬约束的前提下进行取舍和平衡。这种分层约束结构确保了"安全第一"的根本原则。

**分频耦合机制**。物理AI引擎和认知AI引擎工作在不同的时间尺度上：物理AI引擎以秒到分钟为周期执行实时控制计算（MPC求解）；认知AI引擎以分钟到小时为周期执行高层决策（工况识别、策略选择、目标调整）。两者通过"目标接口"进行耦合：认知AI引擎根据对当前工况的理解，确定MPC的目标函数和约束条件；物理AI引擎在给定目标和约束下，求解最优控制策略。这种分频耦合使得两个引擎可以在各自擅长的时间尺度上独立运行，同时通过接口实现协调。

从控制理论的角度看，分频耦合机制实际上是一种"级联控制"（Cascade Control）结构的推广——认知AI引擎作为外环控制器，负责设定内环的目标和约束；物理AI引擎作为内环控制器，负责实时跟踪外环的设定值。级联控制是工业过程控制中最成熟、最可靠的架构之一，其优越性在水系统中得到了充分验证。但双引擎架构的分频耦合比传统级联控制更为灵活——外环的认知AI引擎不仅可以调整设定值，还可以动态修改内环的目标函数结构、约束类型和模型选择策略，实现了"元级"的自适应能力。

**在线学习与模型更新**。认知AI引擎持续监测物理AI引擎的预测误差。当误差超过阈值时，认知AI引擎触发模型参数的在线更新——这可以是简单的参数校正（如更新糙率系数），也可以是结构性的模型切换（如从IDZ切换到LSV以适应非线性工况）。在线学习采用"增量式"策略——每次只基于新获取的数据进行局部参数调整，而非重新训练整个模型，确保了学习过程的计算效率和稳定性。为防止过拟合（overfitting，模型过度学习了训练数据中的噪声和细节，导致对新数据的预测能力反而下降——类似于根据历史水文资料拟合的经验公式在异常年份严重失准）和参数漂移，在线学习还内置了"遗忘因子"机制——较旧的数据在参数更新中的权重逐渐衰减，使得模型能够适应缓慢变化的系统特性（如渠道淤积导致的糙率变化、设备老化导致的性能衰减）。

这一机制使得物理模型不再是"一次校定、终身使用"的静态存在，而是能够随着运行环境的变化持续自我校正和进化。

**异常检测与工况识别**。认知AI引擎通过多源数据融合，实时识别当前的运行工况类别（常规、过渡、极端、故障等），并判断当前工况是否仍在ODD（运行设计域）范围内。工况识别采用层次化分类框架——第一层区分"正常"与"异常"，第二层对正常工况进行细分（输水期、检修期、冰期、汛期等），第三层对异常工况进行归因（传感器故障、执行器异常、外部干扰、系统性偏差等）。工况识别的结果直接影响物理AI引擎的模型选择和控制策略选择：在常规工况下使用标准MPC；在过渡工况下使用更保守的鲁棒MPC（增大安全裕度、降低控制激进度）；在极端工况下可能触发MRC（最小风险条件）保护或请求人工接管。

### 4.3.5 与其他融合范式的比较

双引擎架构并非物理模型与AI融合的唯一技术路线。学术界还提出了多种融合范式，理解它们之间的异同有助于明确双引擎架构的定位和优势。

**与PINNs的比较**。物理信息神经网络（PINNs）通过在损失函数中嵌入物理方程来实现数据与物理的融合，属于"模型层面的融合"——在单一模型内部同时利用数据和物理信息。双引擎架构则是"系统层面的融合"——保持物理模型和AI模型各自的独立性，通过架构层面的耦合机制实现协作。系统层面融合的优势在于：每个引擎可以独立开发、测试和升级，不会相互干扰；可以利用各自领域最先进的算法和工具，不受融合框架的限制；在安全关键场景中，物理引擎可以提供独立于AI的安全保障，实现真正的"安全冗余"。

**与数字孪生的比较**。数字孪生强调物理系统在虚拟空间中的高保真映射，侧重于"精确复制"。双引擎架构中的物理AI引擎同样依赖高保真模型，但其目标不仅是复制，更是"预测和控制"——模型不仅要反映当前状态，还要预测未来状态并生成最优控制指令。从这个角度看，双引擎架构可以视为数字孪生的"控制增强版"——在数字孪生的基础上叠加了认知AI引擎的理解和决策能力。

**与自动驾驶技术的类比**。双引擎架构的设计哲学与自动驾驶行业的技术路线有着深层的相似性。自动驾驶领域也面临着"基于规则"（如HD地图+预定义规则）和"基于学习"（如端到端深度学习）两条路线的争论，最终的共识是需要两者的融合。自动驾驶中的"感知-规划-控制"三层架构，与双引擎架构中的"认知感知-策略规划-物理控制"三层结构形成了对照。自动驾驶中的"最小风险条件"（MRC，如安全靠边停车）概念，直接启发了CHS中水系统MRC的定义（如安全蓄水或安全排水）。这种跨领域的架构借鉴体现了CHS的跨学科视野。

### 4.3.6 双引擎与智能演化的对应

从第一部分讨论的智能演化框架来看，双引擎架构实际上是对智能五次突破的技术映射：

物理AI引擎对应了"基于模型的推理能力"——从数据中提取规律、建立预测模型、进行因果推理的能力。这是智能演化中从符号AI到连接主义、从感知到推理的体现。物理AI引擎的核心竞争力在于其"物理可解释性"——每一个预测结果都可以追溯到明确的物理方程和物理参数，每一个控制决策都有清晰的优化目标和约束条件作为依据。在安全关键的水利系统中，这种可解释性不仅是技术优势，更是赢得管理者和监管机构信任的前提。

认知AI引擎对应了"基于经验的学习能力"和"基于语言的理解能力"——从历史数据中学习策略、通过自然语言理解人类意图、在知识图谱中进行知识推理的能力。这是智能演化中从机器学习到大语言模型飞跃的体现。认知AI引擎的独特价值在于它处理"模糊、非结构化、语义丰富"信息的能力——这些信息在传统的物理模型框架中无法被表示和处理，但对于水系统的综合运行管理却至关重要。

双引擎的耦合机制则对应了智能演化中最关键的"系统集成"能力——将不同类型的智能（物理智能、认知智能）整合为一个协调统一的系统的能力。这种集成不是简单的叠加，而是通过安全优先级、分频耦合和在线学习等机制实现的深度融合。从控制论的视角看，双引擎耦合本质上是一种"元控制"（Meta-Control）系统——它不仅控制水系统的物理状态，还控制控制系统自身的行为模式和参数配置。这种自我调节、自我适应的能力，正是从"自动化"迈向"自主化"的核心能力跃迁。

从这个角度看，双引擎架构不仅是一个工程技术方案，更是智能科学一般原理在水利领域的具体体现——它回答了一个根本性的问题：如何将基于物理规律的确定性知识与基于数据和经验的不确定性知识有效地融合为一个可靠的自主决策系统。这一问题不仅存在于水利领域，也普遍存在于电力系统、交通系统、制造系统等所有需要将物理模型与数据智能相结合的工程领域。CHS在水利领域给出的答案——双引擎架构——有望为这些领域提供可借鉴的范式。

### 4.3.7 工程实践中的双引擎部署

双引擎架构从理论设计到工程部署，需要解决一系列实践性问题。

**计算资源配置**。物理AI引擎的计算需求相对可预测（取决于模型复杂度和控制周期），通常由边缘计算设备和区域服务器承担。认知AI引擎中LLM推理的计算需求较大且波动性强（取决于查询复杂度和并发量），通常需要配置GPU服务器或利用云计算资源。在实际部署中，需要根据系统规模和实时性要求，合理规划计算资源的配置方案——既要保证关键控制回路的实时性，又要在成本约束下最大化认知AI的服务能力。

**数据流架构**。双引擎的高效运行依赖于低延迟、高可靠的数据流架构。物理AI引擎需要实时接收传感器数据（毫秒级延迟）和发送控制指令；认知AI引擎需要访问历史数据库、知识图谱和外部信息源（如气象预报）。两个引擎之间通过"目标接口"和"反馈接口"进行数据交换。数据流的设计需要考虑带宽限制（特别是边远地区的通信条件）、数据一致性（确保两个引擎看到的系统状态一致）和故障隔离（单个引擎的数据访问异常不应影响另一个引擎的正常运行）。

**渐进式部署策略**。在实际工程中，双引擎架构通常采用渐进式部署策略：第一阶段仅部署物理AI引擎，实现基本的MPC自动控制；第二阶段添加认知AI引擎的工况识别和异常检测功能，但不直接参与控制决策；第三阶段开放认知AI引擎对物理AI引擎的"目标调整"权限，实现双引擎的分频耦合；第四阶段全面开放双引擎的所有耦合机制，实现完整的自主运行能力。每个阶段之间都需要进行充分的验证和评估，确认新增功能的可靠性后再进入下一阶段。这种渐进式策略与WSAL自主等级的逐级提升完全对应，体现了CHS"安全优先、循序渐进"的工程哲学。

> **概念辨析框：物理AI vs 认知AI——为什么水网需要双引擎？**
> *Concept Clarification: Why Water Networks Need a Dual-Engine Architecture*
>
> | 维度 | 物理AI（Physics-based AI） | 认知AI（Cognitive AI） |
> |:----:|:------------------------:|:---------------------:|
> | **代表技术** | IDZ模型+MPC优化 | LLM+知识图谱 |
> | **优势** | 可解释、可验证、有安全保证 | 处理未知工况、自然语言交互 |
> | **劣势** | 依赖模型精度，难应对完全未知工况 | 不可解释、无安全保证、可能"幻觉" |
> | **适用场景** | 常规ODD内的实时闭环控制方式相对）控制 | 异常诊断、知识问答、方案推荐 |
> | **WSAL角色** | L3-L4的控制决策引擎 | L3+的认知辅助和异常处置 |
> | **类比** | 飞机的自动驾驶仪 | 飞行员的决策辅助系统 |
> | **安全等级** | 安全关键（Safety-Critical） | 任务关键（Mission-Critical） |
> | **冲突仲裁** | 安全冲突时物理AI优先 | 认知AI建议须经物理AI安全校验 |
>

> **关键原则**：在安全关键场景中，认知AI永远不能绕过物理AI的安全包络——这是"安全优先"原则在双引擎架构中的具体体现。


---

**思考与讨论**

1. （概念理解）为什么水网不能像自动驾驶那样完全依赖端到端AI？请从安全关键性和可解释性两个角度分析。
2. （分析比较）在双引擎架构中，当物理AI和认知AI的决策建议发生冲突时，系统应如何仲裁？请用一个具体的水网调度场景举例说明。


---


---

### §4.3 本节小结


本节论述了物理AI与认知AI双引擎融合架构（图4-1）。物理AI（基于IDZ/MPC的数值优化）提供可解释、可验证、可安全约束的控制决策；认知AI（基于LLM/知识图谱的瀚铎大模型）提供自然语言交互、异常工况诊断和知识推理能力。两个引擎通过冲突仲裁层协同工作：常规工况以物理AI为主导，异常工况以认知AI辅助诊断、物理AI安全兜底。双引擎架构的核心优势是在保证安全可控的前提下扩展系统的认知边界。

## 4.4 HydroOS：水网操作系统的架构与实现

水系统控制论（CHS）提供了自主运行的理论框架，WSAL定义了分级目标，双引擎架构确定了智能核心——但要将这些理论和设计转化为可工程化部署的系统，还需要一个统一的软件载体。HydroOS（Hydro Operating System，水网操作系统）正是为此而生的。HydroOS是CHS理论的软件实现平台，其目标是为水网自主运行提供从底层数据接入到顶层决策执行的全栈支撑。

### 4.4.1 设计理念：从SCADA到操作系统的范式跃迁

要理解HydroOS的设计理念，需要先理解它与传统SCADA系统的本质区别。SCADA系统的设计理念是"监控"——帮助人看数据、帮助人远程操作，但决策权完全在人。SCADA的软件架构因此围绕"数据展示"和"远程控制"两个功能组织，本质上是一个人机界面工具。

从技术架构角度深入分析，传统SCADA系统存在五个根本性的结构缺陷，这些缺陷使其难以支撑水系统的自主运行。**第一，数据孤岛性**。SCADA系统通常按工程或标段独立部署，不同系统之间的数据格式、通信协议和编码规范各不相同，导致跨系统的数据融合和全局态势感知极为困难。例如，在南水北调中线工程中，总干渠的SCADA系统与各省市的水厂SCADA系统之间长期存在数据壁垒，影响了全系统的协调调度。**第二，模型缺失性**。传统SCADA系统不内置物理模型——它只负责采集和显示数据，不具备预测和仿真能力。当调度员调整一个闸门时，SCADA无法告诉他这个操作对下游的影响是什么、多长时间后效果会到达、最终稳态水位是多少。这种"无模型"的特性使得调度员只能依靠经验进行操作，缺乏科学的决策支持。

**第三，控制原始性**。SCADA系统的控制功能通常限于远程开关量控制和简单的PID调节，不支持MPC、DMPC等现代高级控制算法。这意味着即使有了好的控制算法，也无法在现有SCADA架构上部署和运行。**第四，知识碎片性**。SCADA系统不具备知识管理功能——调度规程存在纸质文档中，运行经验存在老调度员的脑中，历史事故教训存在散落的报告里。这些宝贵的运行知识无法被系统化地利用。**第五，验证缺失性**。传统SCADA系统不支持仿真验证——无法在虚拟环境中测试新的控制策略或评估工况变化的影响。每一次调度策略的改变都必须在真实系统上"试错"，风险极高。

HydroOS的设计理念则是"操作系统"——像计算机操作系统管理硬件资源并为上层应用提供统一接口一样，HydroOS管理水网的物理资源（传感器、执行器、通信链路）并为上层智能决策应用提供统一的服务接口。操作系统的核心价值在于"抽象"和"隔离"：它将底层硬件的复杂性和异质性封装起来，向上层提供标准化的API，使得控制算法开发者不需要关心具体的传感器品牌、通信协议或PLC型号——就像应用程序开发者不需要关心CPU型号和内存管理细节一样。

从计算机操作系统的发展史来看，HydroOS的诞生有着深层的技术逻辑。计算机操作系统的出现是因为硬件的复杂性增长到了单个程序无法有效管理的地步——需要一个中间层来统一管理资源、调度任务、处理冲突。水网运行面临的局面与此高度类似：传感器数以千计，执行器分布在数百公里的工程线路上，通信协议五花八门，控制算法日益复杂——同样需要一个"操作系统"层来管理这一切。正如Unix/Linux操作系统的"一切皆文件"哲学统一了对设备、管道和文件的操作接口，HydroOS的"一切皆CHS六要素"哲学统一了对传感器、控制器、模型和执行器的操作接口。

这一范式跃迁的核心价值体现在三个方面：

**可移植性**。基于HydroOS开发的控制算法和调度策略可以在不同的水利工程中复用，不需要为每个工程重新编写底层接口代码。这大幅降低了智能化系统的部署成本和周期。

**可演进性**。HydroOS的分层架构使得各层可以独立升级。底层硬件更新时，只需修改设备驱动层；控制算法升级时，只需更新应用层。这避免了传统SCADA系统中"牵一发动全身"的升级困境。

**可验证性**。HydroOS为xIL验证提供了原生支持——物理模型和控制算法运行在同一平台上，可以方便地进行MIL、SIL测试。这是传统SCADA系统所不具备的能力。

### 4.4.2 三层架构

HydroOS采用"边缘—区域—中央"的三层分布式架构，与CHS多智能体系统（MAS）架构一一对应：

**边缘层（Edge Layer）**。部署在每个控制节点（闸门、泵站等）的边缘计算设备上。边缘层运行边缘智能体（Edge Agent），负责：实时数据采集（从传感器读取水位、流量等数据，支持多种工业协议如Modbus、HART、PROFIBUS的统一接入）；本地控制执行（运行PID或简单MPC控制器，实现秒级响应——即使在上层通信完全中断的情况下也能维持稳定控制）；数据预处理和质量检查（包括数字滤波、噪声抑制、物理范围校验和时间戳对齐等多种预处理操作，确保上传数据的质量）；岛自治（Island Autonomy）——在与上层通信中断时，边缘智能体根据本地存储的安全策略独立运行。

岛自治策略采用分级设计：通信中断初期（如5分钟以内），维持中断前的控制设定值不变；中期（5分钟至1小时），根据本地水位变化趋势进行自适应微调；长期中断（超过1小时），切换到保守安全模式——将闸门调至预设的安全开度，确保不发生漫溢或断流。

边缘层的硬件选型需要适应水利工程的恶劣环境条件。在南水北调中线工程中，边缘设备需要在-30°C至+50°C的温度范围内可靠工作（冬季北方段的极寒条件），IP65以上的防护等级（户外暴露安装），具备防雷击和电磁兼容能力（高压输电线路附近的电磁干扰），以及低功耗设计以支持太阳能供电（偏远地区无市电接入）。这些工程化需求对边缘计算硬件提出了比通用IT设备更高的可靠性要求。

**区域层（Area Layer）**。部署在区域控制中心的工业计算机或服务器上。区域层运行区域智能体（Area Agent），负责：区域内多个控制节点的协调优化（运行DMPC分布式模型预测控制——典型的区域包含5至20个控制节点，DMPC需要在1分钟内完成一次优化求解）；区域级的状态估计和工况识别（通过融合区域内所有传感器数据，估计未被直接观测的状态变量如渠段中间位置的流量分布）；与相邻区域的信息交换和边界协调（通过标准化的区域间通信协议，交换边界流量、水位和控制策略信息，确保相邻区域的调度方案相互兼容）；区域级安全包络的监测和执行（区域安全包络综合考虑区域内所有控制节点的约束条件和节点间的耦合关系，比单个边缘层的局部安全检查更为全面）。

区域层的划分原则遵循"水力学耦合度"准则——水力学耦合紧密的控制节点划入同一区域，耦合较松的节点划入不同区域。这一划分使得区域内部的DMPC子问题规模可控（通常10至30个决策变量），同时区域间的耦合变量数量最少（通常只有边界流量1至2个变量），从而保证了分布式优化算法的收敛速度和计算效率。

**中央层（Central Layer）**。部署在总调度中心的服务器集群或云平台上。中央层运行中央智能体（Central Agent），负责：全系统的优化调度（运行全局优化模型，综合考虑水资源分配、节能降耗、供水保障等多目标的均衡优化）；认知AI引擎的主要计算（LLM推理需要大量的GPU算力，集中部署在中央层最为经济高效）；长期预报和规划（日、周、月级的水资源调配计划，需要整合气象预报、需水预测和水资源调查等多源信息）；系统监控仪表盘和人机交互界面（为调度员提供全系统的综合态势展示和交互操作能力，包括大屏展示、Web端和移动端等多种交互渠道）。中央层还承担系统的配置管理和版本控制——所有区域层和边缘层的控制参数、模型配置和安全约束阈值都由中央层统一下发和管理，确保全系统配置的一致性。

三层架构的核心设计原则是"边缘自治、区域协调、中央优化"：

日常运行中，大部分控制决策在边缘层和区域层完成，中央层只做全局优化和高层决策——这确保了系统的实时性和鲁棒性（即使中央层故障，边缘层和区域层仍能独立运行）。

全局优化信息从中央层向下层传递（设定值、约束更新），实时状态信息从下层向中央层汇聚——形成"自上而下的目标分解+自下而上的信息汇聚"的双向信息流。这一信息流模式与CHS的层次化控制架构完全一致——中央层相当于系统级协调器（System-Level Coordinator），区域层相当于子系统控制器（Sub-System Controller），边缘层相当于单元级执行器（Unit-Level Actuator）。

**通信架构设计。** HydroOS的三层通信架构采用"消息总线+发布-订阅"模式。各层之间通过高性能消息中间件（如Apache Kafka或RabbitMQ）进行异步通信，支持一对多的消息分发和多对一的数据汇聚。消息格式采用CHS统一数据模型——每条消息都包含发送者ID、CHS语义标签、时间戳、数据质量标识和安全等级字段。这种基于消息总线的通信架构相比传统SCADA的轮询模式（Polling）具有多项优势：消息驱动的架构可以实现事件触发的实时响应（而非固定周期的轮询），发布-订阅模式天然支持一对多的广播通信（一条状态变更消息可以同时通知所有相关的智能体），异步通信避免了因网络延迟导致的控制回路阻塞。

**容错与自愈机制。** 水利工程的特殊性要求HydroOS具备极高的可靠性和容错能力。HydroOS在每一层都实现了冗余设计：边缘层的关键控制节点采用双机热备配置（Active-Standby），当主节点故障时从节点在毫秒级内接管控制任务；区域层采用多节点集群部署，通过Raft共识算法保证在部分节点故障时仍能维持正常服务；中央层采用异地容灾架构，在主数据中心不可用时自动切换到备份数据中心。

当通信链路发生故障时，系统采用"优雅降级"（Graceful Degradation）策略：中央层通信中断时，区域层切换到本地优化模式；区域层通信中断时，边缘层切换到岛自治模式。每一层都预存有在通信中断情况下的安全运行策略，确保系统在任何通信故障场景下都能保持安全运行。通信恢复后，系统自动执行"状态同步"过程——各层将中断期间的状态变更记录同步到上层，上层根据最新的全局状态重新计算优化策略。这种"断连自治—恢复同步"的机制确保了系统在通信不可靠的环境中（如偏远山区的长距离输水工程）仍能安全可靠地运行。

**实时性保障。** HydroOS的边缘层和区域层运行在实时操作系统（RTOS）或带实时补丁的Linux内核上，以确保控制回路的确定性时延。边缘层的控制周期要求在100毫秒以内，区域层的优化周期要求在1秒至1分钟之间，中央层的规划周期要求在分钟至小时级别。这三个层次的时间尺度与CHS的多时间尺度控制框架一一对应，确保了从快速响应到长期规划的全时间尺度覆盖。

### 4.4.3 核心服务模块

HydroOS的软件栈包含以下核心服务模块：

**数据服务（Data Service）**。负责全系统的数据采集、存储、查询和分发。数据服务提供统一的时间序列数据库接口，支持实时数据的高频写入（毫秒级）和历史数据的高效查询。底层存储引擎采用分层存储架构：热数据（最近1小时）存储在内存数据库中，实现微秒级查询延迟；温数据（最近30天）存储在高性能SSD时序数据库中，支持灵活的时间范围查询和聚合分析；冷数据（历史存档）压缩存储在分布式文件系统中，通过索引机制支持按需检索。数据服务还包含完善的数据质量管理功能：传感器故障检测（通过统计异常检测和物理一致性校验双重机制识别故障传感器）、数据插补（对缺失数据采用基于空间相关性和时间趋势的智能插补算法）、异常值标记（区分传感器故障导致的假异常和实际工况变化导致的真异常）、数据血缘追踪（记录每条数据从采集到处理到使用的完整生命周期，支持审计和回溯）。

**模型服务（Model Service）**。管理和调度CHS五级模型层次的各级模型。模型服务的核心设计理念是"模型即服务"（Model-as-a-Service, MaaS）——将物理模型封装为标准化的微服务，通过RESTful API或gRPC接口对外提供调用。模型服务提供统一的模型调用接口：输入工况参数和初始条件，返回状态预测和灵敏度信息。模型注册表（Model Registry）管理所有可用模型的元数据——包括模型类型（一维/二维/替代模型）、适用工况范围、精度特征、计算耗时和依赖关系等。当控制服务发起模型调用请求时，模型调度器（Model Scheduler）根据当前工况和实时性要求，自动选择最合适的模型——例如，在常规工况下调用快速替代模型以满足实时MPC的计算需求，在极端工况下切换到高保真物理模型以确保预测精度。

模型服务还负责模型参数的在线校正——当实测数据与模型预测之间的偏差超过阈值时，自动触发参数更新，采用卡尔曼滤波或变分同化方法实时修正模型参数，确保模型预测始终与实际工况保持一致。

**控制服务（Control Service）**。运行MPC/DMPC优化求解器，生成控制指令。控制服务的核心是一个高性能约束优化求解引擎，支持线性规划（LP）、二次规划（QP）和非线性规划（NLP）等多种优化问题类型。控制服务接收模型服务提供的预测信息和目标服务提供的优化目标，求解约束优化问题，输出最优控制序列。对于大规模水网的DMPC问题，控制服务实现了基于ADMM（交替方向乘子法）的分布式求解框架——将全局优化问题分解为多个局部子问题在各区域层并行求解，通过迭代协调实现全局近似最优。控制服务还实现安全包络的在线监测和强制执行——任何控制指令在发出前，都必须通过安全包络检查，包括水位上下限约束、流量变化速率约束、闸门开度范围约束和设备状态约束等。

如果优化器生成的控制指令违反安全包络，安全监测模块会将其投影到最近的安全可行域内，确保输出指令始终安全可执行。

**智能服务（Intelligence Service）**。承载认知AI引擎的功能模块，是HydroOS区别于传统工业控制系统的最核心差异化能力。智能服务包括：LLM推理接口（基于瀚铎水网大模型提供自然语言交互和调度规程知识化服务，支持流式输出和多轮对话）、知识图谱查询引擎（基于水网运行本体构建的知识图谱提供拓扑关系查询、规则推理和语义搜索服务）、工况识别模型（基于多源数据融合的实时工况分类——区分正常运行、冰期运行、检修运行、应急运行等工况类型，并据此自动调整控制策略参数和安全约束阈值）、异常检测模型（集成统计方法、机器学习和物理模型三类异常检测器，通过投票机制降低误报率和漏报率）。

智能服务的各模块之间存在密切的协作关系——例如，当异常检测模型发现管网水压异常下降时，工况识别模型判断是否存在管道爆管，知识图谱查询引擎检索该管段的历史维修记录和关联设备信息，LLM将所有信息整合后以自然语言形式向调度员报告异常分析结果和建议处置方案。

**验证服务（Verification Service）**。为xIL验证提供平台支撑。验证服务可以将物理模型实例化为"虚拟工厂"，与控制算法在仿真环境中进行闭环测试（MIL/SIL）。虚拟工厂的构建基于HydroComponents组件库——通过组合标准化的明渠、管道、闸门、泵站等组件，可以快速搭建出任意水利工程的数字孪生模型。验证服务支持自动化测试——可以定义测试工况集（包括正常工况、极端工况和故障工况等数百种场景）和验收标准（如水位控制精度、流量波动范围、响应时间等指标），自动运行批量测试并生成验证报告。报告内容涵盖各项性能指标的统计分析、关键工况的时程曲线、安全包络的触发记录和综合评估结论。

这一功能使得xIL验证不再是一次性的工程验收活动，而是可以持续进行的日常质量保障——每当控制算法更新或系统配置变更时，自动触发回归测试，确保修改不会引入新的问题。

**治理服务（Governance Service）**。负责系统的权限管理、审计日志、合规检查和应急管理。治理服务实现了基于角色的访问控制（RBAC）——不同角色（系统管理员、调度长、调度员、巡检员）拥有不同的操作权限，防止越权操作。治理服务记录每一条控制指令的来源（自动生成还是人工输入）、执行时间、执行结果和关联工况，形成完整的审计链。审计日志采用区块链技术的哈希链接机制——每条日志记录都包含前一条记录的哈希值，确保日志不可篡改和不可抵赖。在安全敏感的水利系统中，这种可追溯的审计能力是获得管理机构信任的前提条件。治理服务还内置应急管理模块——当系统检测到重大安全风险时（如关键传感器全部失效、通信全面中断），自动触发预定义的应急响应流程，包括切换到安全保守运行模式、向相关人员发送告警通知、激活备用控制方案等。

### 4.4.4 关键技术特性

**CHS语义一致性**。HydroOS的所有模块都严格遵循CHS六要素架构的术语和接口规范。每一个物理设备（闸门、泵站、传感器）在HydroOS中都被映射为CHS六要素之一（P、A、S、D、C、O），每一个数据流和控制流都有明确的CHS语义标注。这种语义一致性不仅体现在软件接口层面，还贯穿于系统设计文档、用户手册、API文档和培训教材等全部技术文献中。语义一致性的核心价值在于消除歧义——在传统的水利信息化项目中，不同厂商、不同专业对同一概念的命名和理解往往存在差异（例如"水位"在不同上下文中可能指绝对高程、相对高程或超出警戒线的偏差值），这种语义混乱是系统集成中最常见的问题根源。HydroOS通过强制的CHS语义标注，从根本上消除了这类歧义，确保了从理论设计到软件实现的无缝衔接。

**确定性执行**。HydroOS的控制服务保证确定性执行——即在相同输入条件下，系统必须产生完全相同的输出。这一特性通过固定随机种子、确定性浮点运算和严格的执行时序控制来实现。确定性执行是xIL验证的前提——如果系统行为不可复现，验证结果就没有意义。在工程实践中，确定性执行还有另一个重要价值：当系统出现异常行为时，可以通过回放历史输入数据精确地复现问题场景，大大提高了故障诊断和问题排查的效率。

**FMI兼容性**。HydroOS的模型服务支持FMI 2.0（Functional Mock-up Interface）标准，可以导入通过OpenModelica、MATLAB/Simulink等工具开发的功能模型单元（FMU）。FMI标准定义了模型组件之间的标准化接口——包括输入输出变量的声明、模型初始化和步进的调用规范、事件处理机制等——使得来自不同工具链的模型可以在同一仿真环境中无缝协同运行。这一兼容性对于水利行业尤为重要：不同研究机构和工程单位使用不同的建模工具（有的用MATLAB，有的用Python，有的用专业水力学软件如HEC-RAS或MIKE），FMI兼容性使得这些异构模型资产都能接入HydroOS，避免了"工具锁定"和模型重复开发的问题。

**OPC-UA通信**。HydroOS的边缘层支持OPC-UA（Open Platform Communications Unified Architecture）工业通信标准，可以与各种品牌的PLC、RTU和SCADA系统进行数据交换。OPC-UA相比传统的OPC DA标准具有多项优势：跨平台支持（不再局限于Windows操作系统）、内置安全机制（支持加密通信和身份认证）、信息模型扩展能力（可以定义水利行业专用的数据模型和语义描述）。这一特性使得HydroOS可以作为现有SCADA系统的"智能层"叠加部署——不需要替换现有的硬件和通信基础设施，只需在其上叠加HydroOS的区域层和中央层，即可获得智能化能力的升级。在已有多个试点工程中，这种叠加部署方式已被证明是风险最低、实施最快的智能化升级路径。

### 4.4.5 与现有SCADA系统的关系

HydroOS不是要取代SCADA系统，而是要在SCADA基础上构建智能化的上层建筑。二者的关系可以类比为手机操作系统与基带芯片的关系——SCADA负责底层的数据采集和设备控制（基带通信），HydroOS在其上运行智能化的应用和服务（操作系统和应用生态）。这种"叠加而非替代"的关系有着深刻的工程实践考量：水利工程的SCADA系统往往已经投入运行多年，其稳定性和可靠性经过了长期验证，且涉及大量的工程定制和接口适配工作——全面替换不仅成本高昂，还面临着过渡期的安全风险。在SCADA基础上叠加HydroOS的方式，保留了经过验证的底层基础设施，同时赋予了系统新的智能化能力。

**网络安全架构。

** 水利基础设施属于国家关键信息基础设施，HydroOS的网络安全设计必须满足最高等级的安全要求。HydroOS采用"纵深防御"（Defense in Depth）的网络安全架构，包括：物理隔离层（控制网络与办公网络、互联网之间通过物理隔离或单向网闸进行隔离，防止外部攻击渗透到控制系统）；网络分区层（三层架构之间通过工业防火墙进行网络分区，每个区域实施独立的访问控制策略）；加密通信层（所有跨层通信和跨区域通信采用TLS/SSL加密传输，防止数据窃听和篡改）；身份认证层（基于数字证书的设备身份认证和基于多因素认证的人员身份认证，确保只有经过授权的设备和人员才能接入系统）；入侵检测层（部署工业控制系统专用的入侵检测系统IDS，实时监控网络流量中的异常行为模式，如未授权的控制指令、异常的数据采集频率等）。

此外，HydroOS实现了"安全运行与网络防护解耦"的设计——即使在遭受网络攻击的情况下，边缘层仍能通过岛自治模式维持水系统的安全运行，不会因为网络安全事件导致物理系统失控。

在工程部署策略上，HydroOS支持"渐进式叠加"模式：

第一步：在现有SCADA系统上部署HydroOS的数据服务，实现数据的统一管理和质量控制——此时HydroOS的角色是"增强型数据平台"。

第二步：部署模型服务和验证服务，建立数字孪生能力——此时HydroOS的角色升级为"仿真和验证平台"。

第三步：部署控制服务，在仿真环境中验证自动控制策略，然后通过影子运行（Shadow Mode）在实际系统上进行比对测试——此时HydroOS开始向"辅助决策平台"过渡。

第四步：在通过充分验证后，将控制服务的输出从"建议"模式切换到"执行"模式，实现WSAL L3级的条件自主运行——此时HydroOS成为真正的"水网操作系统"。

这种渐进式部署策略的价值在于：每一步都建立在前一步的验证基础上，风险可控、效果可量化；不需要一次性替换现有系统，投资可以分步进行；在任何阶段都可以暂停或回退，不会造成不可逆的系统风险。

### 4.4.6 开源生态与可持续发展

HydroOS的长期发展战略采用开源模式。通过Apache 2.0或类似的开源许可证发布核心代码，HydroOS旨在构建一个开放的水利智能化软件生态。开源策略的考虑包括：

降低进入门槛——使更多的研究机构和工程单位能够使用和贡献HydroOS，加速技术的迭代和完善。全球范围内，许多水利科研机构和工程企业具有丰富的领域知识但缺乏从零开始构建智能化平台的软件开发能力。开源HydroOS使得这些机构可以在现有平台基础上进行二次开发和定制化部署，大大降低了智能化的技术门槛。

促进标准化——开源代码本身就是一种"事实标准"，有助于推动CHS术语、接口规范和数据格式在行业内的统一。正如Linux操作系统的开源模式推动了POSIX标准的广泛采用，HydroOS的开源有望推动水利行业软件接口的标准化进程。

增强可信性——开源代码可以被任何人审查和验证，这对于安全关键的水利系统尤为重要。在水利工程安全管理日益严格的背景下，"黑箱"系统越来越难以获得监管机构的信任，而开源、可审计的系统在安全审查中具有天然优势。

建设学术社区——HydroOS的开源为全球水利智能化研究提供了统一的实验平台。研究者可以在HydroOS上方便地实现和对比不同的控制算法，避免了各自搭建实验平台的重复劳动，促进了研究成果的可复现性和可比性。

HydroOS的开源生态已经开始构建。HydroComponents（基于Modelica的水利组件库）作为HydroOS模型服务的核心组件，已在开发之中——它提供了明渠、管道、水库、闸门、泵站等基本水利组件的标准化Modelica模型，支持图形化建模和联合仿真。HydroGraph-GPU（基于GPU的水网数字孪生引擎）提供高性能仿真支撑——利用GPU的大规模并行计算能力，HydroGraph-GPU可以在秒级完成包含数千个节点的大型水网的水力学仿真，满足实时数字孪生的计算需求。未来，还将逐步开源控制服务、智能服务和验证服务的核心模块，形成一个从模型到控制到验证的完整开源工具链。

### 4.4.7 工程应用案例

HydroOS已经在多个水利工程中进行了试点部署和验证。

**南水北调中线工程。** 作为HydroOS最早的试点工程，南水北调中线总干渠部署了HydroOS的核心功能模块。在冰期运行场景中，HydroOS的模型服务集成了冰-水耦合水力学模型，能够预测未来24至72小时的冰情发展趋势；控制服务基于MPC算法自动生成闸门调控方案，在保障输水安全的同时减少弃水损失；智能服务的工况识别模块能够自动区分冰期的不同阶段（初冻期、稳定封冻期、开河期），并据此调整控制策略的参数。实际运行数据表明，HydroOS辅助的冰期调度相比纯人工调度，水位控制精度提高了约40%，弃水量减少了约25%。

**胶东调水工程。** HydroOS在胶东调水工程中的应用侧重于多水源联合调度。该工程涉及多个水库、河道和泵站的协调运行，调度复杂度高。HydroOS的区域层智能体分别管理各子系统，中央层智能体进行全局优化，实现了"分层协调、全局最优"的调度模式。特别值得一提的是，HydroOS在该工程中实现了"一键调度"功能——调度员只需输入目标流量和供水优先级，系统自动计算并执行全路径的闸门和泵站控制方案，将原本需要数小时的人工调度过程缩短到分钟级。

**城市供水管网。** 在福州和中山的智慧水务项目中，HydroOS被应用于城市供水管网的压力优化和漏损检测。通过在管网关键节点部署边缘层智能体，实时采集管网压力和流量数据，区域层智能体运行管网水力模型进行状态估计和异常检测，中央层智能体基于全网信息进行泵站调度优化，实现了管网运行的"透明化"和"智能化"。

### 4.4.8 工程部署指南

为便于工程管理者评估HydroOS的部署可行性，本节提供典型部署配置和实施路径的参考。

> **表 4-4　HydroOS部署配置参考（按工程规模分级）**
> *Table 4-4 HydroOS Deployment Configuration Reference*
>
> | 配置项 | 小型工程（单渠段/灌区） | 中型工程（跨区域调水） | 大型工程（流域级/跨流域） |
> |:------:|:----------------------:|:---------------------:|:-----------------------:|
> | **边缘层硬件** | 工业RTU/PLC+4G模块 | 边缘工控机（ARM/x86）+5G | 冗余工控机集群+光纤 |
> | 边缘层算力需求 | PID即可，无需GPU | IDZ模型+本地MPC，2核4G | 多模型切换，4核8G+ |
> | **区域层服务器** | 可省略（中央直管） | 1台服务器（8核16G） | 2+台服务器集群（负载均衡） |
> | **中央层服务器** | 1台（4核8G） | 2台（16核64G+GPU可选） | 高可用集群（3+节点，GPU必选） |
> | **通信网络** | 4G/LoRa，延迟<2s | 5G/光纤，延迟<500ms | 专网光纤+卫星备份，延迟<200ms |
> | **SCADA对接** | OPC UA/Modbus TCP | OPC UA + MQTT + API网关 | 多协议融合+数据总线 |
> | 与现有SCADA关系 | HydroOS叠加在SCADA上层 | 逐步替代SCADA上位机 | SCADA降为数采层，HydroOS接管决策 |
> | **典型部署周期** | 2-3个月 | 6-12个月 | 18-36个月（含PIL验证） |
> | **估算投资范围** | 50-200万元 | 500-2000万元 | 3000万-1亿元 |
> | 运维人员需求 | 兼职1人 | 专职2-3人 | 专职团队5-10人 |
> | 目标WSAL等级 | L1→L2 | L2→L3 | L3→L4 |

**典型实施路径**（以中型调水工程为例）：

第一阶段（1-3月）：基础对接。部署边缘层数据采集模块，与现有SCADA系统建立OPC UA连接，实现数据的"旁路接入"——HydroOS读取SCADA数据但不下达控制指令。同时建立工程的IDZ传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）模型库，完成基本参数标定。本阶段结束时，系统处于"影子模式"——并行生成控制建议但不实际执行，供调度员参考。

第二阶段（4-8月）：MIL/SIL验证。在离线和半在线环境下对MPC算法进行系统化验证。构建ODD定义文档和安全包络参数表，完成至少100种典型工况的MIL仿真覆盖。SIL阶段验证算法在真实软件栈上的运行时序和异常处理能力。通过验证后，向管理层提交L2/L3认证申请。

第三阶段（9-12月）：受控上线。在有限ODD范围内（如常规非汛期工况），允许HydroOS直接下达控制指令，但保留人工"一键接管"能力。逐步扩展ODD范围，积累运行数据，持续优化模型参数和控制策略。

### 4.4.9 展望与发展路线

HydroOS的未来发展将围绕三个方向推进。

**功能深化。** 在现有架构基础上，进一步完善各核心服务模块的功能。重点包括：智能服务中集成面向水网运行的领域大语言模型（即瀚铎水网大模型），实现自然语言交互和认知智能辅助决策；控制服务中实现DMPC与安全强化学习的融合算法，提升复杂工况下的自适应控制能力；验证服务中引入自动化测试和持续集成/持续部署（CI/CD）流程，实现控制算法的快速迭代和质量保障。

**规模扩展。** 将HydroOS从单一工程的部署扩展到跨工程、跨流域的协同运行。这需要解决大规模分布式系统的一致性、可扩展性和跨域安全问题。长期目标是形成"水网联邦"——多个HydroOS实例通过联邦架构互联互通，实现跨流域水资源的协同优化。

**生态建设。** 围绕HydroOS构建完善的开发者生态，包括：标准化的API文档和开发工具包（SDK）、丰富的示例代码和教程、活跃的开发者社区和贡献者计划、第三方插件市场（如专业化的水质模型、冰力学模型、需水预测模型等）。通过生态建设，HydroOS有望成为全球水利智能化的通用基础设施平台。

---

**思考与讨论**

1. （概念理解）HydroOS从"SCADA升级版"到"水网操作系统"的范式跃迁，核心区别体现在哪三个方面？
2. （综合设计）参照表4-4，为一个小型灌区（渠长50km、8个闸站、预算200万元）设计HydroOS部署方案，说明你选择各配置项的理由。


---


---

### §4.4 本节小结


本节详述了HydroOS 3.0的架构设计、核心服务、版本演进和工程部署方案（表4-4）。HydroOS从SCADA的"升级版"演进为水网领域的"操作系统"，其核心设计理念是通过HAL抽象层屏蔽底层硬件异构性，通过标准API支持第三方算法和模型的即插即用。工程部署指南提供了小型/中型/大型三级配置和三阶段实施路径，投资估算从50万到1亿元不等。HydroOS的长远愿景是成为全球水利智能化的通用基础设施平台。

## 4.5 在回路测试：从离线仿真到工程级验证

水网控制系统从算法设计走向工程部署，中间横亘着一道难以逾越的鸿沟——验证鸿沟。一个在离线仿真中表现优异的控制算法，在真实工程上线后可能因传感器噪声、执行器延迟、通信中断等因素而表现迥异。航空航天和汽车工业早已建立了成熟的在回路测试（X-in-the-Loop Testing）体系来弥合这一鸿沟，但水利行业长期缺乏系统化的控制验证流程。随着水网自主等级（WSAL）的不断提升，建立覆盖"模型在环—软件在环—硬件在环"（MIL-SIL-HIL）的分层测试体系，已成为水系统控制论（CHS）工程化落地的关键支撑。

### 4.5.1 验证鸿沟：为什么需要在回路测试

#### （1）传统验证模式的局限

传统水利工程控制系统的验证通常采用"离线仿真+现场调试"的两步模式。离线仿真阶段，工程师利用水动力学模型对控制算法进行测试，验证其在理想条件下的性能。现场调试阶段，将算法直接部署到实际工程中，通过反复调整参数来适应真实工况。

这种模式存在三个根本性缺陷。第一，离线仿真与真实工况之间存在显著的"仿真-现实鸿沟"（Sim-to-Real Gap）。离线仿真通常假设传感器数据精确、执行器响应理想、通信链路可靠，但这些假设在真实工程中几乎从不完全成立。第二，现场调试的风险高、成本大、窗口期短。大型水利工程如南水北调、胶东调水等，其运行调度关系到数千万人的供水安全，不允许在真实系统上进行大范围的"试错"。第三，现场调试的可重复性差。水利系统的运行工况受来水、需水、气象等自然因素影响，几乎不可能精确复现某一特定工况，这使得调试结论难以系统化积累。

#### （2）航空航天和汽车工业的经验借鉴

航空航天和汽车工业在控制系统验证方面积累了丰富的经验。美国航空航天局（NASA）早在阿波罗计划时期就建立了分层测试体系，从数学仿真到半实物仿真，再到全系统集成测试，形成了严格的"V字型"开发验证流程。汽车行业的自动驾驶技术验证更是将在回路测试推向了新的高度：Waymo等自动驾驶公司在虚拟环境中累计行驶数十亿英里，远超实际道路测试的里程数，正是通过MIL-SIL-HIL的分层验证来确保系统安全。

水网控制系统与自动驾驶系统存在深刻的相似性：两者都需要在复杂、动态、不确定的环境中做出实时控制决策；两者都涉及安全关键（Safety-Critical）系统，一旦失误可能造成严重后果；两者都需要处理传感器融合、多目标优化、异常工况应对等共性技术挑战。因此，借鉴这些成熟行业的验证方法论，构建水网控制系统自己的在回路测试体系，既是必要的也是可行的。

#### （3）WSAL提升对验证能力的刚性需求

随着水网自主等级从L1（辅助运行）向L3（有条件自主运行）乃至更高等级演进，控制系统的复杂度和自主决策范围急剧增加。在L1阶段，控制系统仅执行简单的设定值跟踪，验证需求相对有限。但在L3及以上阶段，系统需要自主应对工况切换、故障诊断、策略在线调整等复杂场景，验证的覆盖范围和深度要求呈指数级增长。

更为关键的是，高等级自主运行要求控制系统具备明确的运行设计域（ODD）边界和安全包络（Safety Envelope）约束。这些边界和约束不能仅仅停留在设计文档上，而必须通过系统化的测试来验证其有效性。在回路测试体系正是实现这一验证需求的核心手段。


> **图 4-2　xIL分层测试架构（金字塔模型）**
> *Fig. 4-2 xIL Progressive Verification System*
>
> ```
>                          ▲ 保真度
>                         ╱╲
>                        ╱  ╲
>                       ╱PIL ╲        现场在回路
>                      ╱(现场)╲       真实工程 · 影子模式
>                     ╱────────╲      测试周期：月级
>                    ╱   HIL    ╲     硬件在回路
>                   ╱  (硬件)    ╲    真实PLC+RTU · 半实物仿真
>                  ╱──────────────╲   测试周期：周级
>                 ╱     SIL       ╲   软件在回路
>                ╱    (软件)       ╲  编译代码 · 接口兼容性 · 时序
>               ╱──────────────────╲  测试周期：天级
>              ╱       MIL          ╲ 模型在回路
>             ╱      (模型)          ╲算法验证 · 参数扫描 · 安全包络
>            ╱────────────────────────╲测试周期：小时级
>           ◀─────────────────────────▶
>                    测试覆盖面 ▶
> ```
>
> 从MIL到PIL，保真度递增而测试覆盖面递减，形成"宽基座—窄塔尖"的金字塔结构。
> MIL阶段完成80%的问题发现，SIL阶段暴露接口和时序缺陷，
> HIL阶段验证软硬件耦合可靠性，PIL阶段在真实工程上以影子模式做最终确认。


### 4.5.2 MIL-SIL-HIL三层测试架构

#### （1）模型在环测试（MIL）

模型在环测试（Model-in-the-Loop, MIL）是在回路测试的第一层，也是成本最低、效率最高的验证手段。MIL的核心思想是：在纯软件环境中，将被测控制算法与高精度水动力学仿真模型进行闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）耦合，验证控制逻辑的正确性和基本性能。

MIL平台的基本架构包括四个核心组件。第一是被测控制器模块 $C$，即待验证的控制算法，可以是PID控制器、MPC控制器，或更复杂的分层分布式控制策略。第二是高精度水动力仿真器模块 $P$，基于完整的圣维南方程（Saint-Venant equations，描述明渠水流运动的基本方程，由连续性方程和动量方程组成）或其简化形式（如IDZ模型），模拟水力系统的动态响应。第三是场景管理与故障注入模块 $S$，负责生成测试场景、注入各类扰动和故障。第四是指标评估与报告模块 $E$，自动采集测试数据并生成结构化的评估报告。

四个组件的闭环关系可以形式化表达为：

$$u_k = C(x_k, r_k), \quad x_{k+1} = P(x_k, u_k, d_k)$$

其中 $x_k$ 为系统状态向量（包括各节点水位、流量等），$u_k$ 为控制指令向量（闸门开度、泵站转速等），$r_k$ 为参考轨线（目标水位、目标流量等），$d_k$ 为场景模块注入的外部扰动。

MIL阶段面临的一个核心技术挑战是**仿真模型的保真度选择**。水动力学模型的保真度从低到高可分为五个层级：零维水量平衡模型（仅考虑质量守恒）、一维积分延迟（IDZ）模型（捕捉传播延迟和回水效应的主要特征）、一维完整圣维南方程模型（精确描述明渠非恒定流）、一/二维耦合模型（处理渠道—蓄水区—河道的复杂交汇）、以及三维CFD模型（精确刻画闸门局部流场和紊流特性）。更高保真度的模型能够更准确地再现真实系统行为，但其计算代价呈指数级增长——完整圣维南方程模型的单步计算时间可能是IDZ模型的100倍以上，三维CFD模型更可能超过10,000倍。

解决这一矛盾的策略是**多保真度分层测试**（Multi-Fidelity Testing）。在MIL早期快速迭代阶段，使用IDZ等简化模型进行大规模参数扫描和初步性能评估；在MIL中期，使用完整圣维南方程模型进行重点工况的精细验证；在MIL后期接近SIL转交时，针对安全包络边界工况使用一/二维耦合模型进行高保真验证。这种"金字塔形"的测试策略在保证验证深度的同时有效控制了计算成本。

此外，MIL仿真器还需要解决**模型参数的时变性和不确定性**问题。水利工程的关键参数（如Manning糙率系数、闸门流量系数、渠道断面几何参数）会因泥沙淤积、水草生长、工程老化等因素而随时间变化。高质量的MIL测试不应仅使用标称参数运行，还需要进行**参数灵敏度扫描**——在参数的合理变化范围内（如Manning糙率 $n \in [0.014, 0.022]$）进行系统化扫描，验证控制算法在参数不确定性条件下的鲁棒（robust，指系统在参数变化或外部干扰下仍能保持稳定性能的能力，类似于水利工程中的'抗干扰性'）性能。这种参数扫描通常采用拉丁超立方采样（Latin Hypercube Sampling）等空间填充设计方法，以在有限的测试轮次内尽可能覆盖多维参数空间。

MIL测试的标准场景库通常包括三大类：正常工况场景（稳态跟踪、计划变流、日常调度），极端工况场景（突增突降来流、需求阶跃变化、多点同时扰动），以及故障注入场景（传感器漂移与失效、执行器饱和与卡阻、通信时延与丢包）。每个场景都需要明确定义输入边界条件、测试持续时间、通过判定阈值和安全约束条件。

MIL测试的核心性能评价指标体系包括：跟踪性能指标（如水位偏差的均方根误差RMSE、最大绝对偏差MAE、调节时间等），安全性指标（如安全包络越界次数、越界持续时间、最小安全裕度等），鲁棒性指标（如参数摄动下的性能退化率、扰动拒绝比等），以及实时性指标（如单步求解时间、最大求解时间、超时率等）。

#### （2）软件在环测试（SIL）

软件在环测试（Software-in-the-Loop, SIL）是MIL的升级版，其核心区别在于：被测控制算法不再是理想化的数学模型，而是编译后的实际软件代码，运行在近真实的软件栈环境中。SIL关注的重点从"算法逻辑正确性"扩展到"软件工程质量"，包括接口兼容性、时序一致性、内存管理、异常处理等。

SIL测试平台在MIL平台基础上增加了三个关键组件：软件容器化运行环境（模拟实际部署的操作系统和中间件环境），通信仿真层（模拟实际的OPC-UA、Modbus等工业通信协议），以及时钟同步机制（确保仿真时钟与控制器时钟的严格同步）。

SIL阶段重点验证的问题包括：接口超时率（控制器与仿真器之间的通信是否在规定时间内完成），消息重放正确率（系统重启或恢复后是否能正确重放历史指令），容器重启恢复时间（软件崩溃后是否能在容许时间内恢复运行），以及多控制器协同一致性（分布式部署的多个控制器是否能保持决策一致）。

SIL测试还需要特别关注**通信协议仿真的真实性**。水利SCADA系统常用的通信协议包括Modbus TCP/RTU、IEC 60870-5-104、OPC-UA等，不同协议在数据封装格式、通信握手机制、错误恢复策略上存在显著差异。SIL的通信仿真层需要精确模拟这些协议的行为特性，包括正常通信流程和异常场景（如半连接状态、报文校验失败、缓冲区溢出等）。对于分布式MPC控制器之间的协调通信，还需要模拟**网络拓扑和链路质量的动态变化**——例如某两个站点之间的通信链路因天气原因从光纤切换到4G备份链路，导致延迟从毫秒级跳变到几十毫秒级，协调控制算法是否仍能收敛到一致的解。

SIL测试的另一个重要价值在于支持**持续集成/持续测试**（CI/CT）流程。当控制软件的代码库发生任何修改（参数调整、算法升级、缺陷修复）时，自动化的SIL测试流水线能够在数小时内完成全部场景回归测试，给出"通过/失败/告警"的结论。这种自动化回归测试能力是传统水利工程开发流程中完全缺失的——传统模式下，工程师修改参数后往往只进行局部手动验证，无法覆盖潜在的"连锁影响"。CI/CT流程的引入将水利控制软件的质量保障水平提升到与互联网软件和航空软件可比的层次。

SIL测试的一个重要价值在于发现MIL阶段无法暴露的软件缺陷。例如，某MPC控制器在MIL中表现完美，但在SIL中发现其求解器在特定工况下会出现数值溢出，导致输出异常值。这类问题如果在HIL甚至现场才发现，其修复成本和安全风险将大幅增加。

#### （3）硬件在环测试（HIL）

硬件在环测试（Hardware-in-the-Loop, HIL）是在回路测试的最高层级，其核心特征是：被测控制器运行在真实的硬件平台（PLC、RTU或工控机）上，通过真实的工业通信接口与仿真系统进行闭环交互。HIL测试的目的是验证控制算法在真实硬件和通信条件下的完整表现，是工程上线前的最后一道技术关卡。

HIL平台的物理构成包括：真实的控制器硬件（与现场部署相同型号的PLC或工控机），实时仿真器（运行水动力学模型的高性能计算设备，通常需要满足硬实时要求），I/O接口板卡（模拟传感器信号和执行器反馈），以及工业通信网络（与现场相同的SCADA通信架构）。

HIL测试相比SIL增加的验证维度包括：硬件I/O响应时延及其抖动特性，真实通信协议下的数据传输可靠性，控制器在满负荷计算下的实时性表现，联锁保护与安全动作的硬件触发一致性，以及长时间连续运行的稳定性（如72小时或更长的耐久测试）。

HIL平台的设计需要特别关注**实时性保障**。水动力学仿真模型运行在实时仿真器上时，必须严格遵守仿真周期约束——如果仿真步长设置为1秒，则每一步计算必须在1秒内完成，否则仿真时钟与控制器时钟将失去同步，测试结果不再可信。对于长距离输水工程的完整圣维南方程模型（可能包含数百乃至上千个计算节点），满足实时约束需要高性能计算硬件和精心优化的数值算法。典型的做法是采用**模型降阶**（Model Order Reduction）技术——将高维偏微分方程模型降阶为等效的低维常微分方程模型，在保持主要动态特性的前提下大幅降低计算复杂度。例如，将N个渠池的圣维南方程离散化后的数千阶系统降阶为每渠池2-3阶的IDZ模型，计算速度可提升两个数量级而动态精度损失控制在5%以内。

HIL测试还需要考虑**电磁兼容性**（EMC）和**环境适应性**。真实的水利工程控制柜往往安装在泵站、闸室等环境恶劣的场所，面临高温高湿、电磁干扰、振动等不利条件。完整的HIL测试应包括在温度循环箱（-20°C至55°C）中的温度适应性测试，在电磁屏蔽室中的EMC抗扰度测试，以及模拟现场电源质量波动（电压跌落、谐波注入）的电源适应性测试。虽然这些测试更偏向"环境在环"（Environment-in-the-Loop, EIL），但对于水系统控制器的工程可靠性至关重要——控制算法正确但硬件因环境因素失效，后果同样严重。

在胶东调水工程的实践中，HIL测试发现了多个MIL和SIL阶段未能暴露的问题。例如，某控制器的PLC在高频数据采集模式下出现扫描周期超限，导致控制指令输出延迟；又如，某闸门执行器的反馈信号在特定工况下出现毛刺，触发了控制器的虚假联锁保护。这些问题只有在真实硬件环境中才能被发现和解决。

### 4.5.3 测试场景自动生成与覆盖度量

#### （1）场景库的系统化构建

测试场景是在回路测试的核心驱动力。一个高质量的测试场景库需要满足两个基本要求：覆盖性（尽可能涵盖所有可能的运行工况）和可追溯性（每个场景都有明确的来源和生成依据）。

水网控制系统的测试场景可以从三个维度进行系统化构建。第一个维度是基于ODD的工况枚举：根据已定义的运行设计域，枚举所有可能的工况组合，包括不同的来水条件、需水模式、季节特征、设备状态等。第二个维度是基于历史事件的场景提取：从真实运行记录中提取典型的异常事件和极端工况，将其参数化后纳入场景库。第三个维度是基于风险分析的边界场景生成：利用故障树分析（FTA）或失效模式与影响分析（FMEA）方法，识别可能导致系统失效的关键边界条件，生成对应的测试场景。

#### （2）场景自动生成技术

随着控制系统复杂度的增加，人工设计测试场景越来越难以满足覆盖要求。自动场景生成技术正在成为一个重要的研究方向。其核心思想是利用算法自动搜索那些最可能导致控制系统失效的"对抗性场景"（Adversarial Scenarios）。

一种典型的方法是基于参数化场景模板的蒙特卡洛采样。将场景参数化为向量 $\boldsymbol{\xi} = [\xi_1, \xi_2, \ldots, \xi_m]^T$（其中 $\xi_i$ 可以是来流量级、扰动时刻、故障类型等），定义参数的概率分布 $p(\boldsymbol{\xi})$，然后通过大量采样生成测试场景集合 $\Xi = \{\boldsymbol{\xi}_1, \boldsymbol{\xi}_2, \ldots, \boldsymbol{\xi}_N\}$。为了提高测试效率，可以采用重要性采样（Importance Sampling）或自适应采样方法，优先生成那些位于控制系统性能边界附近的场景。

另一种更为先进的方法是基于强化学习的对抗性场景搜索。将场景生成建模为一个博弈问题：场景生成器（对手）试图找到让控制系统性能最差的场景，而控制系统（玩家）试图在所有场景下保持最佳性能。通过对抗训练，可以高效地发现控制系统的薄弱环节。

第三种方法是**基于形式化方法的反例生成**（Counterexample-Guided Testing）。首先为控制系统定义安全属性（如"水位不超过安全上限"），然后使用有界模型检验（Bounded Model Checking）或可满足性求解器（SAT/SMT Solver）自动搜索能够违反该属性的输入序列。这种方法的优势在于"如果找到反例，则一定是真实的安全漏洞；如果在搜索空间内未找到反例，则可以提供有限范围内的安全保证"。然而，其计算复杂度随系统维度急剧增长，目前仅适用于低维子系统或抽象化的简化模型。

实践中，上述三种方法通常**组合使用**形成互补：蒙特卡洛采样提供基础的随机覆盖，强化学习搜索聚焦于发现"最危险"的场景，形式化方法则对安全关键属性提供有限但严格的保证。这种组合策略被称为"广度+深度+精度"的三维测试策略。

#### （3）覆盖度量与充分性判定

如何判断测试是否"足够充分"？这是在回路测试面临的一个核心挑战。借鉴软件工程中的代码覆盖率概念，可以定义水网控制系统的测试覆盖度量。

ODD工况覆盖率定义为已测试工况数与ODD中定义的全部工况数之比。边界条件覆盖率衡量测试场景对安全包络边界的逼近程度。故障模式覆盖率统计已测试的故障模式与FMEA中识别的全部故障模式之比。多维度的综合覆盖指标可以表达为：

$$C_{total} = \prod_{i=1}^{n} C_i^{w_i}, \quad \sum_{i=1}^{n} w_i = 1$$

其中 $C_i$ 为第 $i$ 个维度的覆盖率，$w_i$ 为对应的权重。当 $C_{total}$ 达到预设阈值时，测试被判定为充分。

覆盖度量的实际应用面临两个根本性挑战。**第一是"已知未知"与"未知未知"的区分**。上述覆盖率定义仅能衡量"已知场景空间"中的覆盖程度，而真正危险的往往是设计者未曾预见的场景——如2021年河南特大暴雨中出现的"城市内涝倒灌进入长距离输水隧洞"场景，在此前任何场景库中都不存在。应对这一挑战的方法是建立**动态场景库更新机制**——每次真实运行中遭遇的异常工况都自动提取为新的测试场景，实现场景库的持续增长和"经验沉淀"。

**第二是多维覆盖率的"维度灾难"**。当考虑工况维度（来水、需水、设备状态）、故障维度（传感器、执行器、通信、软件）、时序维度（故障发生时机、持续时间、恢复顺序）的组合时，场景空间呈指数级爆炸。解决这一问题需要借鉴**组合测试**（Combinatorial Testing）理论——研究表明，大多数系统故障由不超过t个因素的交互引起（t-way交互覆盖），采用t-way覆盖准则可以在可控的测试规模下达到接近穷尽的故障发现率。美国国家标准与技术研究院（NIST）的研究数据表明，6-way交互覆盖即可检测出超过99%的软件缺陷，这为水网控制系统测试场景的合理裁剪提供了理论依据。

### 4.5.4 灰度发布与持续验证

在回路测试体系不仅覆盖工程上线前的验证环节，还延伸到工程上线后的持续验证。灰度发布（Canary Release）策略是连接"测试环境"与"生产环境"的桥梁，其核心思想是将新的控制策略先在小范围内试运行，验证稳定后再逐步扩大到全系统。

灰度发布推荐采用三阶段渐进策略。第一阶段是影子运行（Shadow Mode）：新控制策略在后台并行运行，仅计算控制指令但不实际执行，将其建议动作与当前运行策略进行对比分析。第二阶段是小流量执行（Canary Mode）：选取低风险的渠段或站点执行新策略，设置严格的性能门槛和自动回滚触发条件。第三阶段是全量发布（Full Rollout）：在小流量执行稳定达标后，逐步扩大新策略的覆盖范围直至全系统。

每个阶段都需要定义明确的进入条件、退出条件和回滚触发条件。典型的回滚触发条件包括：连续两个观测窗口内约束违例次数超过基线的1.5倍，联锁触发频率异常升高且无法用外部工况变化解释，关键性能指标（如流量偏差、调度时延）超过预设红线阈值。

灰度发布的技术实现需要**双栈控制架构**的支撑——新旧两套控制策略在同一平台上并行运行，由"策略路由器"决定在何时、对哪些控制对象执行哪套策略。策略路由器的设计必须满足两个关键约束：**无缝切换约束**——从旧策略切换到新策略（或反向回滚）时，不能产生控制指令的突变，否则可能引发水锤或闸门机械冲击；**状态一致性约束**——新策略接管时必须准确继承旧策略的内部状态（如MPC的滚动时域窗口、积分器的累积量等），避免控制器"冷启动"导致的瞬态性能劣化。在工程实践中，采用"bumpless transfer"技术和状态快照/恢复机制可以有效满足这两个约束。

灰度发布的全过程需要与审计系统紧密集成，确保每一次策略变更都有完整的测试证据、审批记录和运行效果评估。这种"可验证上线"的机制，将传统的"经验性调试"转变为工程级的"闭环交付"，是水网控制系统迈向高WSAL等级的必备基础设施。

### 4.5.5 基于模型的设计验证一体化（MBD）

在回路测试体系的更高层次是基于模型的设计验证一体化（Model-Based Design, MBD）方法论。MBD的核心理念是：控制系统的设计、仿真、验证和代码生成共享同一套模型，从而消除设计文档与实际代码之间的不一致性，实现"设计即验证、模型即代码"。

在水网控制领域，MBD方法论的具体实现路径包括：首先，在统一的建模环境中完成控制算法的设计与MIL验证；其次，通过自动代码生成工具将验证过的控制模型转化为可部署的PLC或工控机代码；再次，生成的代码自动进入SIL和HIL测试流水线进行验证；最后，通过测试的代码经灰度发布流程部署到生产环境。

MBD方法论的关键优势在于大幅缩短了从设计到部署的周期，同时提高了部署代码与设计意图的一致性。在传统模式下，从算法设计到现场部署可能需要数月甚至更长时间，而采用MBD方法后，这一周期可以缩短到数周。更重要的是，MBD方法为控制策略的持续迭代提供了高效的基础设施——当运行数据反馈需要调整控制参数或策略时，工程师可以在模型层面进行修改，然后通过自动化的MIL-SIL-HIL流水线快速验证和部署。

在水网控制领域，MBD工具链的具体构成包括四个关键环节。**统一建模环境**：采用MATLAB/Simulink或开源替代工具（如OpenModelica）作为控制算法的设计平台，水动力学仿真器通过FMI（Functional Mock-up Interface）标准接口与之耦合，实现跨工具、跨平台的模型互操作。**自动代码生成**：利用代码生成器将Simulink模型自动转化为符合IEC 61131-3标准的PLC结构化文本（ST）代码或C/C++代码，消除手动编码引入的人为错误。自动生成的代码需要经过**代码静态分析**（如MISRA C规则检查）确认不存在指针悬空、数组越界、未初始化变量等常见缺陷。

**形式化验证接口**：对于安全关键的控制逻辑（如联锁保护、安全包络监测），MBD工具链应提供与形式化验证工具（如NuSMV、UPPAAL）的对接能力，利用**模型检验**（Model Checking）方法穷尽验证"在所有可能的输入序列下，安全属性是否始终成立"。虽然模型检验面临状态空间（state space，用一组状态变量——如各断面水位和流量——来完整描述系统在任意时刻行为的数学框架）爆炸的理论困难，但对于水系统中相对有限的安全逻辑（通常可抽象为有限状态机），当前的工具已具备实用化的验证能力。**测试流水线编排**：采用Jenkins、GitLab CI等持续集成平台编排MIL→SIL→HIL的自动化测试流水线，每次代码提交自动触发回归测试，测试结果自动归档并生成质量报告。

MBD方法论的引入代表了水利工程控制软件开发范式的根本转变——从"基于经验的手工作坊"转向"基于模型的工程化流水线"。这一转变不仅提升了软件质量和开发效率，更为水网控制系统的持续演进建立了可持续的技术基础设施。

### 4.5.6 工程实践：胶东调水在回路测试平台

胶东调水工程是国内首个系统化实施MIL-SIL-HIL在回路测试的大型调水工程。该工程输水线路全长约479公里，涉及多座泵站和控制闸门，控制系统的可靠性直接关系到沿线城市的供水安全。

在MIL阶段，基于完整的圣维南方程建立了全线水动力学仿真模型，与分层分布式MPC控制器进行闭环耦合。测试场景库包含正常工况场景42个、极端工况场景28个、故障注入场景35个，累计执行自动化测试超过10,000轮次。MIL测试发现了3个控制逻辑缺陷和7个参数配置不当问题，全部在仿真环境中修复。

在SIL阶段，将控制软件部署到容器化环境中，模拟真实的OPC-UA通信协议。SIL测试发现了2个接口时序问题和1个内存泄漏缺陷——这些问题在MIL的理想化环境中完全不可见。

在HIL阶段，使用与现场相同型号的PLC硬件，通过I/O板卡与实时仿真器进行闭环联调。HIL测试持续运行72小时，验证了控制系统在长时间连续运行条件下的稳定性，并发现了1个PLC扫描周期在高频采集模式下的超限问题。

通过MIL-SIL-HIL三层测试，胶东调水工程的控制系统在正式上线前共发现并修复了14个各类问题，其中有5个问题如果在现场运行中才暴露，可能导致供水中断或安全事故。在回路测试体系的建立，使得该工程的控制系统上线后运行稳定，首年运行期间未发生因控制软件缺陷导致的供水中断事件。

胶东调水在回路测试的实践经验凝练为以下几点关键教训。**第一，测试场景设计比测试技术更重要。** 在14个被发现的问题中，有9个是在精心设计的边界工况场景（如多泵站同时启停、极低水位下闸门调节、通信链路中断恢复等）中暴露的，而非常规工况测试。这说明测试场景的覆盖性和针对性比测试平台的先进性更能决定验证效果。**第二，跨层级问题的发现遵循"逆金字塔"规律。** MIL发现的问题数量最多（10个）但修复成本最低（平均0.5人天），HIL发现的问题最少（3个）但修复成本最高（平均3人天），SIL介于两者之间。这一规律验证了"缺陷越早发现、修复代价越低"的软件工程基本原则在水利控制系统中同样成立。**第三，人员培训是测试体系运转的关键瓶颈。

** 水利工程师通常缺乏软件测试的系统化训练，而软件测试工程师又不了解水利系统的工程特性。胶东调水项目采用了"联合测试团队"模式——由水利工程师负责场景设计和结果判读，由软件测试工程师负责测试执行和自动化流程——这种跨学科协作模式被证明是有效的。

除胶东调水外，沙坪水电站的在回路测试实践也值得关注。沙坪水电站采用"一键调度"模式，从调度计划生成到闸门/机组执行全程自动化。其在回路测试的特殊之处在于需要同时验证水力控制和电力控制两个子系统的协同行为——例如当电网负荷突变要求快速增加发电出力时，水轮机导叶的快速开启是否会引起尾水渠的水位骤降甚至空化。这类水-电耦合场景在传统的水利仿真或电力仿真中都难以单独复现，必须通过**多领域联合仿真**（Co-Simulation）的方式在MIL阶段进行验证。沙坪项目采用了FMI（Functional Mock-up Interface）标准实现水动力学模型与电力系统模型的实时耦合，成功验证了水-电协调控制策略在各种工况组合下的安全性。

### 4.5.7 展望：数字孪生驱动的持续在环验证

展望未来，在回路测试将从"工程上线前的一次性验证"演进为"贯穿全生命周期的持续验证"。数字孪生技术的成熟为这一演进提供了技术基础：基于高保真的数字孪生模型，控制系统可以在虚拟环境中持续接受各类工况的考验，新的控制策略可以先在数字孪生中"试运行"，确认安全后再部署到真实系统。

这种"持续在环验证"的范式与DevOps理念高度契合。正如软件工程领域的"持续集成/持续部署"（CI/CD），水网控制系统也正在走向"持续建模/持续验证/持续部署"（CM/CV/CD）的新范式。在这一范式下，测试不再是开发流程末尾的一个独立阶段，而是融入控制策略全生命周期的每一个环节，成为保障水网自主运行安全性的常态化基础设施。

数字孪生驱动的持续验证还将催生**自适应测试场景生成**技术。当数字孪生在线运行过程中检测到"模型预测偏差增大"或"遭遇前所未见的工况模式"时，系统自动将该工况提取为新的测试场景，纳入场景库并触发回归测试。如果新场景导致现有控制策略性能不达标，则自动生成告警并启动策略优化流程。这种"运行发现→场景提取→测试验证→策略优化"的闭环机制，使得在回路测试体系从"静态验证工具"进化为"动态安全保障生态"。

从更长远的视角看，在回路测试体系将与**数字化认证**体系深度融合。类似于航空领域的适航认证（Airworthiness Certification），水网控制系统的WSAL等级认定将要求提交完整的测试证据包——包括场景覆盖率报告、安全属性验证结果、长期耐久运行记录等。在回路测试平台将成为生成这些证据包的核心基础设施，为水网控制系统从"经验信任"走向"证据信任"提供技术支撑。这也意味着，未来每一个WSAL等级的升级（如从L2到L3），都需要通过更高标准的在回路测试认证，而不仅仅依赖设计评审和专家论证。

---

**思考与讨论**

1. （概念理解）MIL、SIL、HIL、PIL四层测试各自验证什么？为什么必须按顺序执行而不能跳级？
2. （分析比较）xIL验证体系与航空适航认证（DO-178C）有哪些相似之处和本质差异？
3. （综合设计）如果你要为一个WSAL L2→L3的升级项目编写PIL测试方案，你会设计哪些"影子模式"测试场景？请列出至少5个关键测试场景及其通过标准。


---


---

### §4.5 本节小结


本节构建了MIL-SIL-HIL-PIL四层xIL（X-in-the-Loop）渐进验证体系（图4-2）。xIL体系借鉴了航空适航认证和汽车功能安全（ISO 26262）的成熟方法论，为WSAL等级跃迁提供了安全验证框架。四层验证形成"保真度递增、成本递增、覆盖度递减"的金字塔结构：MIL覆盖数千种工况组合但保真度较低；PIL仅验证最关键的场景但在真实工程环境中运行。xIL体系是建立公众和监管信任的关键制度基础。

## 4.6 知识体系建设：教材生态与专利布局

一个成熟的学科不仅需要理论框架和工程实践的支撑，更需要系统化的知识载体来实现理论的传承、传播和应用转化。水系统控制论（CHS）作为一门正在形成中的新兴交叉学科，其知识体系的建设需要同时在两个维度上发力：一是面向人才培养的教材生态建设，二是面向技术保护和工程推广的专利布局。本节将系统介绍CHS学科知识体系的整体架构、教材生态的层次设计，以及覆盖全技术链的专利布局。

### 4.6.1 知识体系的整体架构

#### （1）从零散论文到系统化知识

CHS的理论和方法在过去二十余年中主要以学术论文的形式分散发表。这些论文虽然在各自的专题领域内具有较高的学术价值，但对于一个试图进入这一领域的研究者或工程师而言，散落在数百篇论文中的知识碎片很难被系统地理解和应用。论文与论文之间的逻辑关系、理论的渐进发展脉络、不同方法之间的适用边界比较——这些对于学科理解至关重要的结构性信息，在零散的论文中往往是缺失的。

因此，构建系统化的知识体系是CHS学科走向成熟的必经之路。这一知识体系的核心载体是一套层次分明、相互衔接、覆盖完整的教材体系。围绕教材体系，辅以学术论文（提供前沿拓展）、技术标准（规范工程实施）和专利文献（保护创新成果），共同构成CHS学科的完整知识图谱（knowledge graph，以图结构存储实体及其关系的知识表示方法，如'闸门A→控制→渠段B→连接→闸门C'）。

这种从"论文散点"到"知识体系"的跃迁，在学科史上有丰富的先例可循。控制科学在20世纪50-60年代经历了类似的过程——从维纳《控制论》的概念框架到Kalman的状态空间（state space，用一组状态变量——如各断面水位和流量——来完整描述系统在任意时刻行为的数学框架）理论、Bellman的动态规划、Pontryagin的极大值原理等里程碑式论文的发表，直到Kailath的《线性系统》、Åström和Murray的《反馈系统》等经典教材的出版，才将散落的理论碎片整合为一门逻辑自洽、可系统教学的工程学科。

CHS的知识体系建设正在走一条类似的路径——理论论文已在Water Resources Research、Journal of Hydraulic Engineering等期刊上建立了学术可信度，接下来需要通过教材的系统化编写来完成从"可发表"到"可教学"的关键跨越。

#### （2）四层教材架构的设计理念

CHS教材体系采用四层架构设计，从通识科普到专题深化，逐层递进，覆盖从本科低年级到博士研究生及工程实践者的完整受众谱系。

第一层（T1层）为学科通论层。其定位是"一本书读懂水系统控制论"，面向水利、自动化、计算机等相关专业的本科高年级和硕士低年级学生，以及关注智慧水利方向的管理者和决策者。T1层教材的核心任务是建立CHS的整体知识框架，包括学科背景与问题定义、基本原理与核心概念（如WSAL分级、ODD、Safety Envelope等）、方法论概要与工程案例概览。T1层教材不追求数学推导的严格性，而注重概念的清晰性和全局视野的完整性。

目前T1层包含两本教材：《水系统控制论》（T1-CN，中文版）和 *Cybernetics of Hydro Systems: Principles and Perspectives*（T1-EN，英文版）。中英双版本的设计旨在同时服务国内培养和国际传播两个目标。T1-CN涵盖八章内容，从全球水利基础设施的运行挑战出发，依次介绍CHS的理论基础、核心原理、关键技术和工程应用，最终展望学科未来发展方向。T1-EN在内容上与T1-CN基本对应，但在案例选择和表述风格上针对国际读者进行了适当调整，增加了更多国际工程案例和跨文化的类比说明。

第二层（T2层）为核心教程层。其定位是"建模与控制的完整技术训练"，面向硕士高年级和博士研究生，要求读者具备水力学、自动控制原理、线性代数等先修基础。T2层分为上下两册：上册《水系统控制论：建模与控制》（T2a）聚焦物理建模、控制器设计、安全约束和工程验证，强调从圣维南方程（Saint-Venant equations，描述明渠水流运动的基本方程，由连续性方程和动量方程组成）到可控系统的严格数学通道；下册《水系统控制论：智能与自主》（T2b）聚焦数据驱动方法、多智能体系统、认知智能和自主运行框架，强调从模型驱动到数据-模型融合的技术升级。

T2层的教学设计遵循"八原理—章节映射"的结构化逻辑。CHS的八条基本原理（传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）化、可控可观性判据、安全包络约束、分层分布式架构、模型预测控制、多智能体协同、认知智能融合、自主等级演进）分别映射到T2a和T2b的具体章节，确保每条原理都有对应的数学推导、算法实现和工程案例支撑。T2a承担前五条原理的"可计算、可设计、可验证"部分，T2b承担后三条原理的"可学习、可协同、可演进"部分。

T2层教材的一个重要教学创新是**"双语言"教学策略**——同时使用水力学语言和控制论语言来描述同一个物理现象。例如，在讲授渠道水流动态时，先用水力学的惯用方式（如"水面线计算"、"洪水波传播"）描述物理过程，然后将其"翻译"为控制论的语言（如"传递函数"、"阶跃响应"、"时间常数"），再演示两种语言描述的数学等价性。这种双语言教学旨在打破水利与控制两个学科之间的"术语壁垒"——使水利背景的学生能够读懂控制论文献，使控制背景的学生能够理解水力学约束，是培养"水利+控制"复合型人才的关键教学手段。

第三层（M层）为专题深化层，包含十本专题专著，每本聚焦CHS技术链条上的一个关键环节。M层教材面向博士研究生、博士后研究人员和高级工程师，提供该专题领域内最深入、最前沿的技术内容。十本专著的布局覆盖了从物理建模到工程实践的完整技术链：

《明渠水动力降阶建模》（M1）系统阐述从圣维南方程到传递函数模型、IDZ模型、Muskingum类模型的降阶路径，包括频率域辨识和数据驱动方法。该书是T2a建模部分的深化延伸，为后续控制器设计提供模型基础。

《水网预测控制》（M2）详细介绍模型预测控制（MPC）在水网系统中的理论与应用，涵盖集中式MPC、分布式MPC（DMPC）、鲁棒（robust，指系统在参数变化或外部干扰下仍能保持稳定性能的能力，类似于水利工程中的'抗干扰性'）MPC和随机MPC等多种变体。

《水网运行安全包络》（M3）专门研究水网运行中的安全约束问题，包括安全边界的动态计算、联锁保护策略、最小风险状态设计和安全验证方法。

《水网多智能体系统》（M4）阐述多智能体系统（MAS）在水网协同控制中的架构设计、通信协议、博弈策略和一致性算法。

《水利认知智能》（M5）聚焦认知AI在水利领域的应用，包括领域大语言模型、知识图谱、自然语言交互和智能决策支持。

《水网操作系统：HydroOS设计与实现》（M7）详细介绍HydroOS的总体架构、核心机制和工程实现，是CHS理论到软件平台的技术桥梁。

《水利工程自主运行实践——胶东调水与沙坪水电站》（M8）以两个典型工程为载体，展示CHS理论和HydroOS平台在实际工程中的完整应用过程。

《水系统运行工程导论》（M9）面向工程管理人员，以较少的数学公式和较多的工程案例，介绍水系统运行工程的基本概念和管理方法。

《水网智能控制实验》（M10）提供配套的实验教程，包括仿真实验、在回路测试实验和现场实验的操作指南。

此外，M层还包含一本面向标准化的参考文献：《水网智能控制技术标准指南》（M6），系统梳理水网智能控制领域的现行标准和拟制标准，包括数据接口标准（参照OPC-UA和WaterML2.0）、通信协议标准（参照IEC 60870-5-104和IEEE 2030.5）、控制性能评价标准（参照ISA-95和IEC 62264）以及安全等级评定标准（参照IEC 61508功能安全标准和WSAL分级体系）。M6的编写填补了水利行业在智能控制标准化方面的空白——当前水利信息化标准主要聚焦于数据采集和传输层面，对于控制算法性能评价、自主等级认定、安全验证流程等关键环节缺乏规范化的标准指引。

M层十本专著的一个共同特征是**理论深度与工程实操的并重**。每本专著的后半部分都设有"工程实现指南"章节，详细介绍该专题技术在HydroOS平台上的具体实现方式，包括API接口说明、配置参数清单、典型部署方案和常见问题解答。这种"理论+实操"的编写方式，旨在使M层专著既可作为研究生的深化教材，也可作为工程师的技术手册。

第四层为实践案例层，以M8和M10为核心，辅以工程技术报告和标准规范，为一线工程人员提供可直接参考的操作指南。

#### （3）教材间的接口与知识流

四层教材并非各自独立，而是通过精心设计的接口关系形成有机整体。纵向上，从T1到M层呈现"概念→方法→深化"的递进关系：T1建立全局框架和核心概念，T2提供方法论训练和技术基础，M层在此基础上进行专题深化和前沿拓展。横向上，同一层级内的教材通过共享的概念定义、符号规范和案例数据保持一致性。例如，T2a的建模章节与M1的对应章节使用完全相同的符号体系和案例参数，读者可以无障碍地从T2a的概述切换到M1的深入推导。

这种四层架构的设计使得不同背景、不同需求的读者都能找到适合自己的切入点。一位水利专业的本科生可以从T1-CN开始，建立对CHS的整体认识；一位控制工程专业的博士生可以直接进入T2a的数学推导；一位现场工程师可以通过M8的工程案例学习具体的实施方法。这种多入口、多路径的知识架构，是CHS学科面向多元受众的培养策略的体现。

教材间的知识流还涉及**与行业现有教材体系的衔接**问题。CHS教材并非要取代水力学、自动控制原理、人工智能等成熟学科的经典教材，而是在这些学科的知识基础上进行"再组合"和"再拓展"。T2a的先修课程明确包括《水力学》（流体力学基础和明渠水力学）、《自动控制原理》（经典控制和现代控制）和《线性代数》（矩阵运算和状态空间方法）；T2b的先修课程在此基础上增加《机器学习》和《多智能体系统导论》。这种先修设计确保了CHS教材与现有课程体系的无缝衔接，学生无需放弃已有的学科训练，而是在跨学科的"交叉地带"获得新的知识增量。

教材体系的另一个重要维度是**数字化配套资源**。除纸质教材外，每本教材都配备在线资源库，包括：可运行的代码示例（Python/MATLAB双版本，托管于GitHub开放仓库）、仿真数据集（基于真实工程数据脱敏处理后的标准化数据集）、视频微课（每章配备15-20分钟的概念讲解视频）以及在线习题库（包含选择题、推导题和编程题三类，支持自动评分）。数字化资源的建设使得CHS教材从传统的"纸上知识"升级为"可交互的学习平台"，显著降低了自学门槛，也为远程教学和国际推广创造了条件。

### 4.6.2 专利布局：七族全链条覆盖

#### （1）专利布局的战略意义

学术论文和教材传播知识，专利保护创新。对于CHS这样的应用驱动型学科，专利布局具有多重战略意义。首先，专利是技术创新成果的法律保护手段，确保核心技术在工程推广中的知识产权安全。其次，专利的技术方案披露为工程实施者提供了详细的技术指引，弥补了学术论文在工程实现细节上的不足。最后，系统化的专利族群构成了CHS技术体系的"技术地图"，清晰展示了各关键技术环节的创新贡献。

从国际竞争的视角来看，水系统自主控制是一个尚未被系统性专利保护的技术领域。与自动驾驶（仅Waymo一家就持有数千项相关专利）、电网自动化（ABB、Siemens的专利池覆盖了EMS的各个环节）等领域相比，水网自主运行的专利布局仍处于"蓝海"阶段。这既是挑战——意味着缺乏可借鉴的专利布局模板，也是机遇——率先进行系统化专利布局的机构可以在未来的全球水网智能化浪潮中占据有利的知识产权地位。中国作为全球水利基础设施规模最大的国家，在水网自主控制技术上的专利先发优势，对于未来的技术输出和国际合作具有重要的战略价值。

专利布局还需要考虑**防御性和攻击性的平衡**。防御性专利旨在保护自身的核心技术路线不被他人阻断（如关键算法的基础专利），攻击性专利旨在覆盖可能的替代技术路线以形成更完整的保护网（如同一功能的不同实现方法的专利族群）。CHS的专利布局在每个专利族中都兼顾了这两个维度——既有保护核心算法原理的基础专利，也有覆盖工程变体和替代方案的外围专利。

#### （2）七个专利族的技术覆盖

CHS的专利布局按照技术链条组织为七个专利族（Patent Family，简称PF），每个族覆盖技术链条上的一个关键环节，共计包含60项已申请或规划申请的专利。

**PF1：水动力建模族**（~8项专利）。覆盖从圣维南方程到工程可用模型的完整降阶路径，包括基于频率域辨识的传递函数建模方法、IDZ模型参数的自动提取算法、多渠池级联系统的分块建模与拼接技术、以及基于实测数据的模型在线校正方法。PF1族专利的核心创新在于：将控制论的系统辨识方法系统地引入水动力建模领域，使传统上仅用于"模拟预报"的水力学模型能够被改造为适用于"实时控制"的紧凑型模型。这一创新解决了水利界与控制界长期存在的"模型鸿沟"——水利工程师习惯使用高保真但计算昂贵的完整圣维南方程模型，控制工程师则需要低阶但能捕捉关键动态特性的传递函数模型。PF1的建模方法体系为二者之间搭建了系统化的"降阶桥梁"。

**PF2：预测控制族**（~10项专利）。覆盖MPC及其变体在水网中的算法设计与实现，包括集中式MPC的求解加速方法、分布式MPC的子问题分解与协调策略、鲁棒MPC中不确定性集合的构造方法、经济MPC中供水成本与水量损失的联合优化、以及MPC参数（预测时域、控制时域、权重矩阵）的自适应调整方法。PF2族是CHS技术体系的核心控制引擎。PF2族的关键专利之一提出了"预测时域自适应调整方法"——当水文预报精度随预见期增长而下降时，MPC的预测时域自动缩短以避免使用低质量预报信息，同时确保预测时域不短于系统的主要时间常数，从而在预报质量与控制前瞻性之间动态寻优。

**PF3：安全保障族**（~8项专利）。覆盖安全包络的计算、监测和执行，包括基于水力学约束的安全边界动态计算方法、安全包络与MPC硬约束的耦合求解方法、最小风险状态（MRC）的多策略库设计与自动选择机制、以及安全包络越界预警的分级响应流程。PF3族专利的核心理念是将安全保障从"被动响应"转变为"主动预防"——传统水利安全保护通常在问题已经发生后才触发联锁动作（如水位超限后关闸），而PF3的方法通过MPC的预测能力，在问题发生之前就预见风险并采取预防性调整，实现"a priori safety"（先验安全）。这种理念借鉴了航空领域的"保护包线"（Protected Envelope）概念，但针对水系统"慢过程、强耦合、不可逆"的特点进行了根本性的适配。

**PF4：多智能体族**（~8项专利）。覆盖MAS架构设计和协调算法，包括渠池-枢纽-全局三层智能体的职责划分与通信协议、基于合同网协议（CNP）的智能体任务协商方法、通信受限条件下的分布式一致性算法、以及智能体故障检测与自动重构机制。PF4族的一项重要创新是"通信受限条件下的分布式一致性保障方法"——当水网中的通信链路出现延迟、丢包甚至中断时，各智能体仍能通过本地预测模型和事件触发通信机制维持协调控制，避免因通信故障导致的控制失调。这一技术对于覆盖广阔地理范围的长距离输水工程尤为关键。

**PF5：认知智能族**（~8项专利）。覆盖大语言模型和知识图谱在水利领域的应用方法，包括水利领域知识图谱的自动构建与更新方法、基于RAG（检索增强生成）的调度知识问答系统、自然语言调度指令到MPC参数的自动映射方法、以及调度方案的自然语言解释生成方法。PF5族的独特价值在于将LLM的"语言智能"与水网的"物理智能"进行了工程化的对接——使调度员能够用自然语言表达调度意图（如"明天上午将3号渠池水位逐步降低到设计值以下20厘米"），系统自动将其转化为MPC优化器可执行的目标函数和约束参数，执行后生成的调度方案再由LLM翻译为调度员易于理解的自然语言解释，实现"人-机-水"的全链路语义贯通。

**PF6：在环测试族**（~10项专利）。覆盖xIL验证体系的平台设计和测试方法，包括水力学模型实时仿真的硬件加速方法、SIL环境中控制软件的自动化测试框架、HIL平台中真实SCADA与仿真水力模型的接口协议、以及基于蒙特卡洛方法的ODD覆盖度自动评估工具。PF6族在国际水利领域具有显著的原创性——航空航天和汽车工业虽然有成熟的xIL方法论，但将这些方法论系统性地适配到水网控制领域的工作此前尚无先例。PF6的核心创新之一是"水力学模型实时仿真加速方法"——通过模型降阶、隐式求解器优化和GPU并行计算的综合运用，使包含数百个计算节点的长距离输水工程模型能够在标准工控机上实现10倍于实时的仿真速度，满足HIL测试对硬实时的严格要求。

**PF7：系统集成族**（~8项专利）。覆盖HydroOS平台的核心架构和集成方法，包括微服务架构下的模型-控制-安全模块热插拔技术、异构SCADA系统的统一数据适配层设计、边-云协同计算的任务分配与负载均衡方法、以及多工程实例的统一运维管理平台设计。

#### （3）专利-教材-论文的三角互证

七个专利族与教材体系和学术论文之间形成了"三角互证"的知识强化结构。教材提供系统化的理论阐述和教学训练，论文提供前沿的学术论证和同行评议，专利提供详细的技术方案和法律保护。三者共同构成了CHS学科知识体系的"铁三角"。

以PF1（水动力建模族）为例：M1教材系统介绍了从圣维南方程到传递函数模型的完整降阶理论；相关学术论文在期刊上发表了理论推导和数值验证结果；PF1的5项专利则提供了具体的工程实现方法，包括参数辨识算法的详细步骤、在线校正机制的触发条件和执行流程等。一位工程师在阅读M1教材建立理论理解后，可以参考PF1专利中的技术方案进行工程实施，再通过论文了解最新的改进方向。这种三角互证的结构，使得CHS的知识能够在"理论—技术—工程"三个层面上完整闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）。

"三角互证"结构的一个实际效用是为**技术争议的解决**提供多维度的证据支撑。当工程实施中出现"某种控制方法是否适用于特定工况"的争议时，可以首先查阅教材中的理论分析来确认方法的适用条件和理论边界，然后参考论文中的数值实验或现场验证结果来评估其在类似工况下的表现，最后查阅专利中的技术方案来明确具体的工程实现约束和注意事项。这种"理论—实验—工程"三维度的交叉验证，比单纯依赖经验判断更加可靠和可追溯。

从学科建设的角度看，"三角互证"结构也是CHS学科成熟度的一个重要指标。一个成熟的工程学科（如结构工程、电力工程）通常都具备完整的"教材体系—学术期刊—专利/标准库"三位一体的知识基础设施。CHS通过系统化地建设这三个维度的知识载体，正在加速从"研究方向"向"学科"的跨越。

### 4.6.3 面向国际传播的课程设计

#### （1）国际课程体系的必要性

CHS学科的国际传播不能仅仅依赖英文教材的出版，还需要配套的国际课程体系来实现"有教材、能教学、可认证"的完整闭环。通过国际水利与环境工程学会（IAHR）、国际智慧水网联盟（SWAN）等国际平台推广CHS课程，既是学科影响力建设的需要，也是吸引国际研究生和合作者的重要手段。当前全球范围内，尚无任何大学或研究机构开设系统性的"水系统自主控制"课程——与自动驾驶、智能电网等领域已有大量成熟课程和教材形成鲜明对比。CHS率先开发系统化的国际课程体系，不仅填补了全球水利教育的这一空白，也为中国在水利智能化领域的国际学术话语权奠定了基础。

#### （2）模块化课程设计

国际课程采用模块化设计，分为四个教学模块。模块一"水系统建模基础"覆盖水动力学基础、圣维南方程与简化模型、传递函数与频域分析、降阶建模方法，对应T2a前四章和M1的核心内容。模块二"控制与优化"覆盖经典控制方法、模型预测控制、分层分布式控制、多目标优化，对应T2a后半部分和M2的核心内容。模块三"智能与自主"覆盖多智能体系统、认知AI与大模型、自主运行框架与WSAL分级、安全包络与ODD，对应T2b和M3至M5的核心内容。模块四"集成与验证"覆盖系统集成与软件工程、在回路测试（MIL/SIL/HIL）、基于模型的设计（MBD）、工程实践与案例分析，对应M7和M8的核心内容。

每个模块设计为40至48学时，可以独立开设为一门研究生课程，也可以组合为一个完整的培养方案。课程配套资源包括：讲义（基于教材内容编写）、仿真实验（基于M10实验平台）、课程项目（基于M8工程案例简化）和在线资源库（包含视频讲座、数据集和参考代码）。

#### （3）IAHR短期培训课程

除学位课程外，面向在职工程师和管理者的短期培训课程也是国际传播的重要渠道。通过IAHR水系统运行工作组（Water Systems Operation Working Group）平台，规划了三个层级的短期培训：入门级（2天）以T1-EN为教材，建立CHS全局认识；中级（5天）以T2a和T2b的精选章节为基础，掌握核心建模与控制方法；高级（3天）以M7和M8为载体，深入工程实践和平台部署。

短期培训课程的一个重要设计原则是"理论最小化、案例最大化"。与学位课程不同，在职工程师的学习诉求是"能用、会用、快速见效"，因此培训课程的核心不是推导数学公式，而是展示"用CHS方法解决实际工程问题的全流程"。入门级课程以半天的南水北调中线案例分析为核心，让学员在真实案例的背景下理解WSAL分级、ODD定义和安全包络等核心概念；中级课程以两天的动手实验为核心，学员在MIL仿真平台上亲手设计和调试一个简化渠段的MPC控制器；高级课程则以一天半的HydroOS平台部署练习为核心，学员从零开始完成一个小型水网的控制系统配置和在回路测试。

课程的国际传播还需要克服**语言和文化障碍**。虽然T1-EN教材提供了英文版内容，但水利工程的术语体系在不同国家存在差异——例如"渠池"（canal pool/reach）、"倒虹吸"（inverted siphon）、"节制闸"（check structure）等专业术语在不同英语系国家的使用习惯并不一致。国际课程配套了一份**中英对照术语表**（包含约500个核心术语），并在讲义中同时标注ISO标准术语和各国常用术语，降低因术语差异造成的理解障碍。此外，案例的选择也考虑了地域多样性——除中国工程案例外，还包括荷兰Maeslantkering风暴潮闸、澳大利亚Rubicon灌区、美国加州运河系统等国际案例，使不同国家的学员都能找到熟悉的工程背景。

### 4.6.4 知识体系的动态演进

CHS作为一门活跃发展的学科，其知识体系不是静态的，而是随着理论进步和工程实践的积累而持续演进的。教材的版本更新机制、专利的后续申请策略、课程内容的定期修订，都是确保知识体系始终反映学科最新发展的重要保障。

当前，16本教材（含中英双版本和所有M系列专著）的编写工作正在系统推进中，多数已完成初稿并通过了多轮评审。36项专利已全部完成技术交底书的撰写，正在分批进入申请流程。国际课程的试点教学已在中国水利水电科学研究院的研究生培养中开展，计划在未来两年内通过IAHR平台面向国际开放。

从更宏观的视角来看，CHS知识体系的建设本身就是一个"系统工程"。教材、论文、专利、课程、标准——这些知识载体之间的逻辑关联和协同演进，遵循着与水系统运行相似的复杂系统规律。正如CHS主张用系统科学的方法来认识和驾驭水系统，知识体系的建设也需要用系统工程的方法来规划和执行。这种方法论层面的一致性，或许正是CHS学科走向成熟的一个内在标志。

知识体系的动态演进需要建立**版本管理和质量控制**机制。教材的每一次修订都遵循"勘误→修订建议→专家评审→修订发布"的标准流程，确保知识更新的准确性和及时性。专利的后续申请遵循"技术预研→专利检索→技术交底→申请评审"的四步流程，每一项新专利都必须与现有专利族的整体布局相协调。学术论文则通过"投稿→同行评议→修改→发表→引用跟踪"的学术出版流程获得质量保障。

值得特别关注的是**开源与知识产权保护的平衡**。CHS的发展目标不是构建封闭的技术壁垒，而是培育开放的学术生态。因此，知识体系的建设采用了"分层开放"策略：基础理论和方法论通过教材和论文完全公开（学术公共品），核心算法实现通过专利保护后有条件许可（技术资产），工程化的HydroOS平台则采用"核心开源+增值服务"的混合模式（产业生态）。这种分层策略既保护了核心创新，又促进了学术交流和技术推广，是CHS学科在学术属性与工程属性之间寻求平衡的具体体现。

从时间维度看，CHS知识体系的建设可以划分为三个阶段。**第一阶段**（当前至2027年）是"体系奠基期"——完成16本教材的首版出版、60项核心专利的全部申请、国际课程的试点开设。这一阶段的核心目标是"有东西可用"——为CHS学科的教学、研究和工程实践提供最低限度的完整知识支撑。**第二阶段**（2027-2030年）是"应用深化期"——基于工程实践的反馈对教材进行第一轮修订、根据技术演进补充新的专利申请、国际课程从试点推广到常规化运营。这一阶段的核心目标是"用得好"——知识体系与工程实践之间形成良性的双向反馈。

**第三阶段**（2030年以后）是"生态繁荣期"——吸引国际学者参与教材编写和课程教学、专利池面向全球企业开放许可、形成围绕CHS知识体系的国际学术和产业社区。这一阶段的核心目标是"有生命力"——知识体系不再依赖单一团队的推动，而是成为整个学术社区和产业界共同维护和发展的公共知识资源。

---

**思考与讨论**

1. （分析应用）16册教材体系的四个层次（入门→基础→专题→前沿）分别面向什么读者群体？请为每个层次推荐一个你认为最优先编写的选题。
2. （批判思考）专利布局的"核心+外围"策略在水利领域是否有效？与IT行业的专利策略相比有何不同？


---


---

### §4.6 本节小结


本节规划了CHS知识体系的两大支柱：16册教材体系（四层次：入门→基础→专题→前沿）和60项专利布局（覆盖感知、建模、控制、安全、平台五大技术域）。教材体系的设计遵循"从一般到特殊、从理论到实践"的教育学原则，填补了水系统运行工程领域教材空白。专利布局遵循"核心专利形成壁垒、外围专利构成生态"的知识产权策略。两大支柱共同支撑"水系统运行科学与工程"作为独立学科方向的建制化发展。

## 4.7 未来愿景：迈向第六次突破

### 4.7.1 五次突破的回望与启示

回顾智能科学的发展历程，人类经历了五次影响深远的突破。第一次突破是符号逻辑的建立——从亚里士多德的三段论到布尔代数，人类首次将推理过程形式化，使得"思维"可以脱离具体内容而以抽象符号运算的方式进行。第二次突破是图灵机与可计算性理论的提出——图灵证明了存在一种通用机器可以模拟任何特定机器的计算过程，奠定了计算机科学的理论基础。第三次突破是维纳控制论的创立——通过引入反馈机制，使得机器能够感知环境变化并自主调整行为，实现了从"开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）执行"到"闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环方式相对）控制"的质变。

第四次突破是人工神经网络与深度学习的崛起——通过多层非线性变换，机器获得了从大量数据中自动提取特征和规律的能力，在图像识别、自然语言处理等领域达到甚至超越人类水平。第五次突破是大语言模型与生成式AI的涌现——以GPT系列和Claude为代表的大语言模型展现了惊人的通用理解和生成能力，标志着人工智能从"专用智能"向"通用智能"的重大跨越。

这五次突破在水系统控制领域都有深刻的映射。符号逻辑对应于水力学方程的建立——将复杂的水流运动抽象为数学方程，使得工程师可以用纸笔计算来分析水流行为，而不必完全依赖经验直觉。图灵机对应于计算水力学的发展——Preissmann隐式差分格式（1961年）和特征线法使得圣维南方程（Saint-Venant equations，描述明渠水流运动的基本方程，由连续性方程和动量方程组成）可以在计算机上高效求解，Wylie和Streeter（1969年）的工作标志着计算水力学的成熟。控制论对应于水系统闭环控制的实现——从20世纪60年代最早的SCADA系统到80年代Buyalski的渠道自动化手册再到Van Overloop的MPC方法，水系统从"开环手动"逐步走向"闭环自动"。

深度学习对应于数据驱动方法在水利领域的爆发——LSTM、GRU等时序模型在洪水预报中的精度已经接近甚至超越传统概念性水文模型，Physics-Informed Neural Networks（PINN）正在探索将物理约束嵌入数据驱动模型的路径。大语言模型对应于水利认知智能的萌芽——瀚铎水网大模型等领域专用大模型能够理解自然语言表达的调度需求，将其转化为可执行的技术参数，并以调度员可理解的方式解释优化方案的逻辑依据。

值得深入思考的是这五次突破之间的递进逻辑。每一次突破都不是对前一次的否定，而是在前一次基础上的"维度提升"：从"可形式化"到"可计算"引入了算力维度，从"可计算"到"可控制"引入了反馈维度，从"可控制"到"可学习"引入了数据维度，从"可学习"到"可对话"引入了语义维度。每次维度提升都极大地扩展了技术的能力边界和应用范围，同时也保留了前一次突破的核心成果——就像物理学中量子力学并没有否定牛顿力学，而是将其作为宏观尺度下的近似。

另一个值得关注的规律是每次突破的"从通用到水利"的时间差在显著缩短。符号逻辑从布尔代数（1847年）到水力学方程体系完善（Saint-Venant方程1871年）间隔约24年；图灵机（1936年）到计算水力学成熟（Wylie & Streeter 1969年）间隔33年；控制论（1948年）到水系统闭环控制成规模应用（Van Overloop 2006年MPC论文、Rubicon规模化推广约2010年）间隔约60年——反而更长，这反映了水利行业的保守性和长距离大惯量系统控制的固有困难。但深度学习的突破（AlexNet 2012年）到水利领域大规模应用（LSTM洪水预报2018年前后）仅间隔约6年；大语言模型（GPT-3 2020年、ChatGPT 2022年）到瀚铎水网大模型（2024年）仅间隔2年。

这一加速趋势表明，水利行业对新兴技术的吸收能力在不断增强，同时也意味着第六次突破从概念到落地的周期可能比以往任何一次都短。

### 4.7.2 第六次突破：自主水网

如果说前五次突破分别赋予了水系统"可描述""可计算""可控制""可学习"和"可对话"的能力，那么正在酝酿中的第六次突破将赋予水系统"可自主"的能力——即水网能够在复杂多变的环境中自主感知、自主理解、自主决策和自主执行，以最小的人工干预实现安全、高效、可持续的运行。

这一愿景并非空中楼阁，而是建立在CHS理论框架和HydroOS技术平台基础之上的渐进式演进。从WSAL L0（完全人工）到L5（完全自主），每一个等级的跃升都代表着水网自主能力的一次实质性提升。当前，国内领先的工程实践（如胶东调水、南水北调中线）已经达到L2（部分自主运行）水平，正在向L3（有条件自主运行）迈进。展望未来十至二十年，L4（高度自主运行）将在部分条件成熟的工程中率先实现。

实现第六次突破需要在多个维度上同步取得进展。在理论维度上，需要建立完整的水网自主运行理论体系，包括运行设计域（ODD）的形式化定义与验证方法、安全包络的动态计算与实时保障机制、多层次多时间尺度的协调控制策略、以及面向不确定性的鲁棒（robust，指系统在参数变化或外部干扰下仍能保持稳定性能的能力，类似于水利工程中的'抗干扰性'）决策框架。特别重要的是，需要发展"可证明安全"（Provably Safe）的控制方法——不仅仅是通过大量测试来"验证"安全性，而是从数学上"证明"在给定的不确定性范围内系统不会违反安全约束。这一目标在控制理论中被称为"形式化验证"（Formal Verification），是从L3向L4跃迁的关键理论瓶颈。

控制障碍函数（Control Barrier Functions, CBF）和可达集分析（Reachable Set Analysis）是目前最有希望突破这一瓶颈的两个技术路径——前者通过构造安全集的不变性条件来保证系统始终处于安全状态，后者通过计算系统在所有可能扰动下的状态边界来验证安全约束永远不被违反。

在技术维度上，需要突破一系列关键技术瓶颈。**高保真实时数字孪生**：建立能够以快于实时的速度运行的水网数字孪生模型，使得"虚拟试运行"成为可能——在物理系统执行控制动作之前，先在数字孪生中"预演"其后果，确认安全后再执行。这要求数字孪生模型在保持足够精度的同时，计算速度达到实际物理过程的10倍以上。**物理AI与认知AI的深度融合**：超越当前"物理模型+数据校正"的简单组合模式，发展"神经符号"（Neuro-Symbolic）方法——让深度学习模型能够"理解"和"遵守"物理规律，让物理模型能够"学习"和"适应"数据中的新模式。**大规模多智能体协同控制**：为包含数千个控制节点的国家级水网设计高效的分布式协同算法，保证在通信带宽有限、存在时延和丢包的条件下仍能达到全局（近）最优。

**全生命周期的在环验证体系**：建设覆盖MIL→SIL→HIL→PIL全链条的标准化测试平台，开发自动化的场景生成和安全性评估工具，为WSAL等级认定提供客观、可重复的验证手段。

在工程维度上，需要建设配套的基础设施和标准体系。高可靠的感知与执行网络是基础中的基础——自主运行系统对传感器和执行机构的可靠性要求远高于辅助决策系统，因为系统不再有人工作为"最后防线"。统一的数据和模型接口标准是生态建设的前提——只有当不同厂商的模块可以"即插即用"地集成时，水网智能操作系统的生态才能真正繁荣。工程级的在回路测试平台是从实验室到工程的桥梁——每一个新的控制算法在上线运行之前，都必须在逼真的半实物仿真环境中经受严格的安全测试。完善的人机协作治理框架是社会接受度的保障——需要建立明确的责任分配机制、事故调查程序和公众沟通机制，让社会对水网自主运行建立信心。

### 4.7.3 物理AI与认知AI的融合前景

第六次突破的核心技术驱动力是物理AI（Physical AI）与认知AI（Cognitive AI）的深度融合。物理AI以水动力学模型为内核，通过传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）、IDZ模型和MPC框架，确保控制决策始终遵循物理规律，提供可解释、可预测、可约束的基础能力。认知AI以大语言模型和知识图谱（knowledge graph，以图结构存储实体及其关系的知识表示方法，如'闸门A→控制→渠段B→连接→闸门C'）为内核，通过自然语言理解、情境感知和推理能力，处理那些难以用数学模型精确描述的复杂决策场景。

两者的融合并非简单的并行运行，而是在多个层面上实现深度耦合。在模型层面，认知AI辅助物理AI进行模型选择、参数调优和异常诊断——当物理模型的预测偏差超出阈值时，认知AI分析可能的原因（如设备老化、工况变化、数据异常）并推荐调整策略。在决策层面，物理AI提供量化的优化方案，认知AI对方案进行可行性评估和风险分析——结合历史案例、规章制度和领域知识，判断方案是否在当前情境下合理可行。在交互层面，认知AI将物理AI的计算结果转化为人类可理解的语言和可视化表达，同时将操作人员的自然语言指令转化为物理AI可执行的数学参数。

展望这一融合的具体技术前景，有几个方向值得特别关注。

**物理信息神经网络（PINN）的工程化应用**。PINN将物理方程作为神经网络训练的约束条件，使得数据驱动模型在拟合观测数据的同时自动遵循物理定律。对于水系统而言，这意味着可以用有限的观测数据训练出既尊重Saint-Venant方程又能捕捉实际工况复杂性的混合模型。当前PINN在水力学中的应用仍处于学术研究阶段，主要挑战在于：复杂边界条件的处理、多尺度问题的数值稳定性、以及大规模水网的计算效率。突破这些瓶颈，需要在物理约束的软化策略、分区并行训练和迁移学习等方面取得进展。

**基于大模型的自适应控制参数调优**。传统的MPC控制器需要手工整定大量参数（预测时域、控制时域、权重矩阵、约束边界等），这一过程高度依赖工程经验，且难以适应工况变化。未来的方向是利用大语言模型的推理能力，根据当前工况描述（如"汛期大流量、下游有检修"）自动推荐适合的MPC参数配置——本质上是将资深调度员的隐性知识编码为可执行的参数调优策略。这一方向的成功将极大地降低MPC部署的技术门槛，使更多的中小型水利工程也能受益于先进的控制方法。

**多模态感知融合与工况自动识别**。将传感器数据（时间序列）、视频监控（图像序列）、气象预报（空间场）和运行日志（文本信息）等多模态数据融合，利用多模态大模型进行工况自动识别和异常检测。例如，当水位传感器数据与视频画面中的水面高度不一致时，系统可以自动判断是传感器故障还是视频遮挡，并采取相应的处理策略。这种多模态融合能力是实现L4级自主运行的重要支撑——自主系统必须能够在传感器部分失效的条件下仍然做出正确判断。

**基于强化学习的长期优化策略**。传统MPC的优化时域通常限于数小时至数天，对于跨季节的水资源优化调配——例如汛期蓄水与枯期保供的权衡、冰期输水与常规输水的模式切换——需要更长时域的决策优化。深度强化学习（Deep RL）通过与环境的大量交互试错，能够学习到在长时间尺度上接近最优的策略，而这种策略可能包含传统优化方法难以发现的非直觉操作模式。将Deep RL的长期策略规划与MPC的短期精确控制相结合——即"宏观上用RL确定策略方向，微观上用MPC保证物理约束"——有望构建覆盖从分钟到年度全时间尺度的层次化决策架构。

### 4.7.4 面向2035年的学科愿景

展望2035年，水系统运行科学与工程有望实现以下发展目标。

在理论层面，CHS将从"方法集合"演进为"完整学科"——拥有统一的公理化基础、完备的方法论体系、国际公认的学术共同体和规范化的人才培养标准。"水系统运行科学与工程"有望作为一个正式的二级学科或交叉学科方向，进入学科目录。这一目标的实现需要几个里程碑事件：CHS核心理论论文在Nature Water、Water Resources Research等顶级期刊发表并获得国际同行广泛引用；WSAL分级标准被IAHR或IWA等国际组织采纳为推荐标准；至少三所国际知名高校开设以CHS为理论基础的硕士或博士课程；形成每年举办的国际学术会议系列（如IAHR Water Systems Operation Symposium）。

在技术层面，HydroOS将从"工程原型"演进为"行业平台"——成为水利行业智能运行的标准软件基础设施，支撑从小型灌区到超大型跨流域调水工程的全谱系应用。物理AI与认知AI的双引擎架构将成为水网智能控制的标准范式。具体技术目标包括：数字孪生模型的预测精度达到观测误差量级（水位预报误差<5cm），计算速度达到实时的50倍以上；MPC优化器能够在5分钟内完成包含500个以上控制变量的全线优化；大语言模型能够准确理解95%以上的调度场景描述，并给出符合物理约束的建议方案。

在工程层面，中国将建成若干个WSAL L4级别的示范工程——在明确定义的运行设计域内，水网能够实现高度自主运行，人类操作员的角色从"在回路中"（In-the-Loop）转变为"在回路上"（On-the-Loop）的监督者。预期的L4示范场景包括：大型调水工程的常规输水工况（非极端天气、非应急状态）、大中型灌区的用水调度、城市供水管网的压力和流量优化等。这些场景的共同特点是：ODD范围可以精确定义、安全风险可控、历史运行数据充足、物理模型成熟度高。

在国际层面，中国将在水系统控制论这一新兴学科中占据引领地位——不仅在理论创新和技术突破上保持领先，更在标准制定、人才培养和国际合作中发挥主导作用。通过IAHR水系统运行工作组等国际平台，将CHS的理念和方法推广到全球水利工程实践中。这一国际引领地位的建立，不仅具有学术意义，更具有战略意义——水系统控制是关乎国家水安全的核心技术领域，掌握核心理论和标准话语权，对保障中国水基础设施的长期安全和自主可控具有重要价值。

综合上述四个层面，可以勾画出一条分阶段的发展路线图。**近期（2025-2028年）**：完成CHS核心理论体系的国际发表，建成2-3个WSAL L3级示范工程，HydroOS完成3.0版本开发并在5个以上工程中部署运行，WSAL标准在国内形成行业团体标准。**中期（2028-2032年）**：CHS被纳入水利工程或控制科学相关学科的研究生教材，WSAL标准提交IAHR或ISO进入国际标准流程，HydroOS开发者生态初步形成（注册开发者超过500人、第三方应用模块超过100个），至少1个WSAL L4级工程通过xIL全流程验证。**远期（2032-2035年）**："水系统运行科学与工程"作为交叉学科方向正式进入学科目录，国际上至少5所高校开设相关课程，WSAL L4级工程在常规工况下实现年度安全运行，CHS方法论在"一带一路"水利工程中推广应用。

### 4.7.5 需要警惕的风险与挑战

在憧憬美好愿景的同时，也需要清醒地认识到前进道路上的风险和挑战。

**技术过度乐观的风险**。人工智能领域的历史反复证明，从实验室演示到工程级可靠应用之间存在巨大的鸿沟——这就是所谓的"最后一公里"问题。水系统的安全关键特性进一步放大了这一鸿沟。在推进自主水网的过程中，必须保持技术上的谦逊和工程上的审慎，避免在安全验证不充分的情况下仓促推进自主化等级的提升。

**路径依赖的风险**。当前水利行业的技术路线和投资模式已经形成了强大的路径依赖。大量已建系统采用的技术架构可能不支持向更高自主化等级的演进，"推倒重来"的成本又不可接受。如何在现有技术基础上实现渐进式的智能化升级，而不是理想化地假设"从零开始"，是一个需要高度务实智慧的工程问题。

**人才断层的风险**。水系统运行科学与工程需要兼具水利专业知识和控制/AI技术能力的复合型人才。当前这类人才极度稀缺，而培养周期较长。如果不能在人才培养上提前布局，技术创新将面临"有方案无人落地"的困境。更令人担忧的是，随着AI技术在各行业的快速渗透，水利行业对顶尖AI人才的吸引力相对于互联网、金融等高薪行业明显不足。建立"水利+AI"复合型人才的差异化培养体系和有竞争力的激励机制，是确保第六次突破人才供给的当务之急。

**社会接受度的挑战**。当水网自主运行系统出现故障（这几乎是不可避免的），公众和媒体的反应可能比人工调度失误时更加激烈。建立公众对自主水网的信任，需要长期的、透明的安全记录积累和有效的公众沟通。这不仅是技术问题，更是社会治理问题。

**地缘政治与供应链的不确定性**。水系统自主运行依赖的部分关键技术——如高性能芯片（GPU/TPU用于AI推理）、精密传感器、高可靠性执行机构——目前仍存在对进口的依赖。在全球技术竞争加剧的背景下，核心组件的供应链安全需要纳入长期规划。同时，水网控制算法和模型作为关乎国家水安全的核心技术资产，其知识产权保护和自主可控也需要给予充分重视。

**伦理边界的模糊**。当自主系统需要在"保护上游城市"和"减少下游灌区损失"之间做出权衡时，其决策逻辑是否公平透明？水资源分配本质上是一个涉及多方利益的社会决策问题，将其交由算法自主执行，需要建立明确的伦理审查机制和公众参与渠道。这一问题在跨行政区域的调水工程中尤为突出——不同地区的利益诉求通过算法来协调，其公正性如何保证？这不仅需要技术上的透明和可解释，更需要制度上的规范和监督。

这一愿景的实现，需要水利工程、控制科学、人工智能等多个学科的深度交叉融合，需要理论研究者、技术开发者和工程实践者的通力协作，更需要长期的战略定力和持续的投入。第六次突破不会一蹴而就，但每一步扎实的进展——每一个模型的改进、每一次工程的验证、每一篇论文的发表、每一项专利的授权——都是通向自主水网的坚实基石。

从更宏大的文明视角来看，水系统自主运行的实现将标志着人类与水关系的一次根本性转变。数千年来，人类通过建造水利工程来"驯服"水——从大禹治水的疏导策略到都江堰的分水原理，从阿斯旺大坝的洪水拦蓄到南水北调的跨流域调配。但"驯服"之后的"运行"问题——如何让这些宏大的基础设施日复一日、年复一年地以最优状态运转——长期以来依赖的是人的经验、勤勉和应变能力。自主水网的愿景，是让这些工程获得"自我运行"的能力——它们能够感知环境的变化，理解需求的含义，计算最优的响应，执行精确的动作，并从结果中持续学习和改进。这不是要取代人在水利决策中的最终权威，而是要创造一个"人机协同"的新范式——机器处理海量数据和实时优化，人类把控战略方向和伦理边界。

水系统控制论的诞生和发展，正是这条通向未来之路上最重要的理论路标。从维纳1948年提出控制论到CHS将其系统化地引入水系统领域，从SCADA的远程监控到HydroOS的自主运行平台，从人工调度的经验积累到WSAL的分级标准体系——一条清晰的学科演进脉络已经浮现。沿着这条脉络继续前行，人类终将建成能够自主、安全、高效运行的智慧水网——那将是水利工程从"被动运行"走向"自主运行"的历史性跨越，也是人类水文明发展史上的又一座里程碑。

---

**思考与讨论**

1. （综合思考）"第六次突破"（完全自主运行 WSAL L5）在你看来，最大的技术瓶颈和制度瓶颈分别是什么？请预估实现的大致时间线。
2. （开放讨论）如果水网实现了L5级完全自主运行，调度员的角色将如何转变？这对水利行业的人才培养意味着什么？


---


---

### §4.7 本节小结


本节展望了水系统运行科学的长远未来——"第六次突破"。前五次突破（人工→机械→自动化→信息化→智能化）已经完成，第六次突破的目标是实现水网的"完全自主运行"（WSAL L5）。实现路径包括：基础理论突破（水网CPS安全理论）、关键技术突破（认知-物理融合控制）、工程验证突破（全链xIL认证）和制度建设突破（国际标准+独立学科方向）。这不是一个终点，而是水系统运行科学作为永恒学科持续演进的新起点。

## 术语表 Glossary

> 本表收录全书核心术语的中英文对照和简要定义，按英文字母排序。正文中术语首次出现时已标注英文。
> *This glossary lists core terms used throughout the book in Chinese-English bilingual format, sorted alphabetically by English. Terms are annotated in English at their first occurrence in the main text.*

| 序号 | 英文 | 中文 | 定义 |
|:----:|:-----|:-----|:-----|
| 1 | CBF (Control Barrier Function) | 控制障碍函数 | 一种通过构造安全集不变性来保证系统状态始终不超出安全约束的控制方法 |
| 2 | CHS (Cybernetics of Hydro Systems) | 水系统控制论 | 以控制论为核心、系统科学为认识论、AI为赋能的水系统运行理论框架 |
| 3 | CPS (Cyber-Physical System) | 信息-物理系统 | 计算、通信和物理过程深度融合的工程系统 |
| 4 | Digital Twin | 数字孪生 | 物理系统的高保真虚拟映射，实时同步、双向交互、持续演化 |
| 5 | DMA (District Metered Area) | 独立计量分区 | 将供水管网划分为可独立计量的区域以进行漏损管理 |
| 6 | DMPC (Distributed MPC) | 分布式模型预测控制 | 将大规模系统分解为子系统，各子系统的MPC控制器通过信息交互实现协调优化 |
| 7 | EMS (Engineering Management System) | 工程管理系统 | 水利工程运行管理系统，按代际从第一代（人工）到第五代（自主）演进 |
| 8 | Hando Model (瀚铎水网大模型) | 瀚铎水网大模型 | 基于大语言模型技术构建的水网领域专用认知AI系统 |
| 9 | HIL (Hardware-in-the-Loop) | 硬件在环测试 | 将真实控制器硬件接入仿真环境进行集成测试 |
| 10 | HydroOS | 水网操作系统 | 水网领域的通用软件平台，提供数据/模型/控制/智能/验证五大核心服务 |
| 11 | IDZ (Integrator Delay Zero) | 积分-延迟-零点模型 | 渠池传递函数（transfer function，描述系统输入-输出关系的数学模型，如闸门开度变化到下游水位响应之间的关系）的三参数简化模型，兼顾精度与实时性 |
| 12 | MAS (Multi-Agent System) | 多智能体系统 | 多个自主智能体通过交互协作完成复杂任务的系统架构 |
| 13 | MIL (Model-in-the-Loop) | 模型在环测试 | 在纯软件仿真环境中验证控制算法的正确性 |
| 14 | MPC (Model Predictive Control) | 模型预测控制 | 基于系统模型预测未来状态、在线优化控制输入的闭环（closed-loop，控制系统通过传感器实时获取输出反馈、自动调整控制动作的运行方式——与人工凭经验调度的开环（open-loop，控制系统不利用输出反馈、仅按预设规则执行的方式，如按固定调度图操作闸门）方式相对）控制方法 |
| 15 | MRC (Minimal Risk Condition) | 最小风险状态 | 系统在超出ODD或检测到故障时应自动进入的安全状态 |
| 16 | ODD (Operational Design Domain) | 运行设计域 | 自主系统正常工作的环境和工况条件边界 |
| 17 | PIL (Plant-in-the-Loop) | 实体在环测试 | 在真实工程环境中以"影子模式"或受控模式验证控制系统 |
| 18 | Safety Envelope | 安全包络 | 多维状态约束的在线监测和保护机制，确保系统状态不超出安全域 |
| 19 | Saint-Venant Equations | 圣维南方程（Saint-Venant equations，描述明渠水流运动的基本方程，由连续性方程和动量方程组成）组 | 描述明渠非恒定流的基本偏微分方程组（连续性+动量守恒） |
| 20 | SCADA | 数据采集与监控系统 | Supervisory Control And Data Acquisition的缩写，工业过程监控的标准系统 |
| 21 | SIL (Software-in-the-Loop) | 软件在环测试 | 在真实软件栈上验证控制算法的运行时序和异常处理 |
| 22 | SNWDP | 南水北调工程 | South-to-North Water Diversion Project，中国最大的跨流域调水工程 |
| 23 | TCC (Total Channel Control) | 全面渠道控制 | 澳大利亚Rubicon Water公司的灌区自动化解决方案 |
| 24 | WSAL (Water-network Self-driving Autonomy Level) | 水网自主等级 | L0-L5六级分级体系，描述水网从人工操控到完全自主的能力等级 |
| 25 | xIL (X-in-the-Loop) | 在回路测试 | MIL/SIL/HIL/PIL四层渐进验证体系的统称 |

> **中国水利特有概念补注** *Notes on China-specific Water Engineering Concepts*
>
> | 中文名称 | 英文 | 说明 |
> |:---------|:-----|:-----|
> | 南水北调 | South-to-North Water Diversion Project (SNWDP) | 世界最大跨流域调水工程，含东线（运河提水）、中线（自流渠道1432km）和规划中的西线 |
> | 胶东调水 | Jiaodong Water Diversion Project | 山东省大型跨流域调水工程，向青岛、烟台、威海等城市供水 |
> | 引江济淮 | Yangtze-to-Huai River Water Diversion | 安徽省大型调水工程，引长江水补给淮河流域 |
> | 重建轻管（emphasis on construction over operation, a structural problem in China's water sector where investment heavily favors new infrastructure over operational management） | "Emphasis on construction over operation" | 中国水利行业的结构性问题——大量投资用于新建工程，运行管理投入严重不足 |
> | 数字孪生流域 | Digital Twin River Basin | 中国水利部推动的水利信息化战略，要求重要流域建立数字孪生 |
> | 水利部 | Ministry of Water Resources (MWR) | 中国政府负责水利行政管理的部级机构 |

## 参考文献

[1] von Bertalanffy, L. (1968). *General System Theory: Foundations, Development, Applications* [M]. George Braziller.

[2] von Bertalanffy, L. (1950). An outline of general system theory. *British Journal for the Philosophy of Science* [J], 1(2), 134-165.

[3] von Bertalanffy, L. (1972). The history and status of general systems theory. *Academy of Management Journal* [J], 15(4), 407-426.

[4] Prigogine, I. (1977). *Nobel Lecture: Time, Structure and Fluctuations* [R]. Nobel Foundation.

[5] Prigogine, I. (1978). Time, structure, and fluctuations. *Science* [J], 201(4358), 777-785.

[6] Prigogine, I., & Stengers, I. (1984). *Order out of Chaos: Man's New Dialogue with Nature* [M]. Bantam Books.

[7] Holland, J. H. (1975). *Adaptation in Natural and Artificial Systems* [M]. University of Michigan Press.

[8] Waldrop, M. M. (1992). *Complexity: The Emerging Science at the Edge of Order and Chaos* [M]. Simon & Schuster.

[9] Holland, J. H. (1992). Complex adaptive systems. *Daedalus* [J], 121(1), 17-30.

[10] Holland, J. H. (1995). *Hidden Order: How Adaptation Builds Complexity* [M]. Addison-Wesley.

[11] Holland, J. H. (1998). *Emergence: From Chaos to Order* [M]. Addison-Wesley.

[12] Watts, D. J., & Strogatz, S. H. (1998). Collective dynamics of 'small-world' networks. *Nature* [J], 393(6684), 440-442.

[13] Barabási, A.-L., & Albert, R. (1999). Emergence of scaling in random networks. *Science* [J], 286(5439), 509-512.

[14] Wiener, N. (1948). *Cybernetics: Or Control and Communication in the Animal and the Machine* [M]. MIT Press.

[15] Tsien, H. S. (Qian Xuesen). (1954). *Engineering Cybernetics* [M]. McGraw-Hill.

[16] Åström, K. J., & Hägglund, T. (1995). *PID Controllers: Theory, Design, and Tuning* [M] (2nd ed.). Instrument Society of America.

[17] Kalman, R. E. (1960). A new approach to linear filtering and prediction problems. *Journal of Basic Engineering* [J], 82(1), 35-45.

[18] Anderson, B. D. O., & Moore, J. B. (1990). *Optimal Control: Linear Quadratic Methods* [M]. Prentice Hall.

[19] Bellman, R. (1957). *Dynamic Programming* [M]. Princeton University Press.

[20] Malaterre, P. O. (1998). PILOTE: Linear quadratic optimal controller for irrigation canals. *Journal of Irrigation and Drainage Engineering* [J], 124(4), 187-194.

[21] Yeh, W. W.-G. (1985). Reservoir management and operations models: A state-of-the-art review. *Water Resources Research* [J], 21(12), 1797-1818.

[22] Mesarović, M. D., Macko, D., & Takahara, Y. (1970). *Theory of Hierarchical, Multilevel, Systems* [M]. Academic Press.

[23] Šiljak, D. D. (1978). *Large-Scale Dynamic Systems: Stability and Structure* [M]. North-Holland.

[24] Šiljak, D. D. (1991). *Decentralized Control of Complex Systems* [M]. Academic Press.

[25] Findeisen, W., Bailey, F. N., Brdyś, M., Malinowski, K., Tatjewski, P., & Woźniak, A. (1980). *Control and Coordination in Hierarchical Systems* [M]. John Wiley & Sons.

[26] Zames, G. (1981). Feedback and optimal sensitivity: Model reference transformations, multiplicative seminorms, and approximate inverses. *IEEE Transactions on Automatic Control* [J], 26(2), 301-320.

[27] Doyle, J. C., Glover, K., Khargonekar, P. P., & Francis, B. A. (1989). State-space solutions to standard H₂ and H∞ control problems. *IEEE Transactions on Automatic Control* [S], 34(8), 831-847.

[28] Zhou, K., Doyle, J. C., & Glover, K. (1996). *Robust and Optimal Control* [M]. Prentice Hall.

[29] Richalet, J., Rault, A., Testud, J. L., & Papon, J. (1978). Model predictive heuristic control: Applications to industrial processes. *Automatica* [J], 14(5), 413-428.

[30] Cutler, C. R., & Ramaker, B. L. (1980). Dynamic matrix control—A computer control algorithm. *Proceedings of the Joint Automatic Control Conference* [C], San Francisco.

[31] Garcia, C. E., Prett, D. M., & Morari, M. (1989). Model predictive control: Theory and practice—A survey. *Automatica* [J], 25(3), 335-348.

[32] van Overloop, P. J. (2006). *Model Predictive Control on Open Water Systems* [M]. IOS Press.

[33] Litrico, X., & Fromion, V. (2009). *Modeling and Control of Hydrosystems* [M]. Springer.

[34] Camacho, E. F., & Bordons, C. (2007). *Model Predictive Control* [M] (2nd ed.). Springer.

[35] Borrelli, F., Bemporad, A., & Morari, M. (2017). *Predictive Control for Linear and Hybrid Systems* [M]. Cambridge University Press.

[36] Rawlings, J. B., Mayne, D. Q., & Diehl, M. (2017). *Model Predictive Control: Theory, Computation, and Design* [M] (2nd ed.). Nob Hill Publishing.

[37] Wooldridge, M. (2009). *An Introduction to MultiAgent Systems* [M] (2nd ed.). John Wiley & Sons.

[38] Shoham, Y., & Leyton-Brown, K. (2008). *Multiagent Systems: Algorithmic, Game-Theoretic, and Logical Foundations* [M]. Cambridge University Press.

[39] Olfati-Saber, R., Fax, J. A., & Murray, R. M. (2007). Consensus and cooperation in networked multi-agent systems. *Proceedings of the IEEE* [C], 95(1), 215-233.

[40] Lee, E. A. (2008). Cyber physical systems: Design challenges. *2008 11th IEEE International Symposium on Object and Component-Oriented Real-Time Distributed Computing (ISORC)* [C], 363-369.

[41] Rajkumar, R., Lee, I., Sha, L., & Stankovic, J. (2010). Cyber-physical systems: The next computing revolution. *Design Automation Conference* [C], 731-736.

[42] Baheti, R., & Gill, H. (2011). Cyber-physical systems. *The Impact of Control Technology* [J], 12(1), 161-166.

[43] Grieves, M. (2014). Digital twin: Manufacturing excellence through virtual factory replication. *White Paper* [R], Florida Institute of Technology.

[44] Tao, F., Zhang, H., Liu, A., & Nee, A. Y. C. (2019). Digital twin in industry: State-of-the-art. *IEEE Transactions on Industrial Informatics* [J], 15(4), 2405-2415.

[45] 钱学森, 于景元, 戴汝为. (1990). 一个科学新领域——开放的复杂巨系统及其方法论. *自然杂志* [J], 13(1), 3-10.

[46] Haken, H. (1983). *Synergetics: Introduction and Advanced Topics* [M]. Springer.

[47] Haken, H. (1978). *Synergetics: An Introduction* [M]. Springer.

[48] 许国志, 顾基发, 车宏安. (2000). *系统科学* [M]. 上海科技教育出版社.

[49] Åström, K. J., & Murray, R. M. (2021). *Feedback Systems: An Introduction for Scientists and Engineers* [M] (2nd ed.). Princeton University Press.

[50] Khalil, H. K. (2002). *Nonlinear Systems* [M] (3rd ed.). Prentice Hall.

[51] Skogestad, S., & Postlethwaite, I. (2005). *Multivariable Feedback Control: Analysis and Design* [M] (2nd ed.). John Wiley & Sons.

[52] de Saint-Venant, A. J. C. B. (1871). Théorie du mouvement non-permanent des eaux, avec application aux crues des rivières et à l'introduction des marées dans leur lit. *Comptes Rendus de l'Académie des Sciences* [J], 73, 147-154, 237-240.

[53] Manning, R. (1891). On the flow of water in open channels and pipes. *Transactions of the Institution of Civil Engineers of Ireland* [J], 20, 161-207.

[54] Nash, J. E. (1957). The form of the instantaneous unit hydrograph. *IASH Publication* [J], 45(3), 114-121.

[55] Cunge, J. A. (1969). On the subject of a flood propagation computation method (Muskingum method). *Journal of Hydraulic Research* [J], 7(2), 205-230.

[56] Preissmann, A. (1961). Propagation des intumescences dans les canaux et rivières. *Congrès de l'Association Française de Calcul* [M], Grenoble, France.

[57] Abbott, M. B. (1979). *Computational Hydraulics: Elements of the Theory of Free Surface Flows* [M]. Pitman.

[58] Abbott, M. B. (1991). *Hydroinformatics: Information Technology and the Aquatic Environment* [M]. Avebury Technical.

[59] Burt, C. M., & Piao, X. (2004). Advances in PLC-based irrigation canal automation. *Irrigation and Drainage* [J], 53(1), 29-37.

[60] Clemmens, A. J., Kacerek, T. F., Grawitz, B., & Schuurmans, W. (1998). Test cases for canal control algorithms. *Journal of Irrigation and Drainage Engineering* [J], 124(1), 23-30.

[61] ASCE Task Committee on Canal Automation. (2014). *Canal Automation for Irrigation Systems* [M] (MOP 131). ASCE.

[62] Buyalski, C. P. (1991). *Canal Systems Automation Manual, Vol. 1* [M]. U.S. Bureau of Reclamation.

[63] Schuurmans, J. (1997). *Control of Water Levels in Open Channels* [D]. Ph.D. Thesis, Delft University of Technology.

[64] Schuurmans, J., Clemmens, A. J., Dijkstra, S., Hof, A., & Brouwer, R. (1999). Modeling of irrigation and drainage canals for controller design. *Journal of Irrigation and Drainage Engineering* [J], 125(6), 338-344.

[65] Horváth, K., Galvis, E., Valentín, M. G., & Gómez, M. (2015). Is it better to use gate opening as control variable than discharge to control irrigation canals? *Journal of Irrigation and Drainage Engineering* [J], 141(3), 04014054.

[66] Malaterre, P. O., Rogers, D. C., & Schuurmans, J. (1998). Classification of canal control algorithms. *Journal of Irrigation and Drainage Engineering* [J], 124(1), 3-10.

[67] Wylie, E. B. (1969). Control of transient free-surface flow. *Journal of the Hydraulics Division* [J], 95(1), 347-362.

[68] Balogun, O. S., Hubbard, M., & DeVries, J. J. (1988). Automatic control of canal flow using linear quadratic regulator theory. *Journal of Hydraulic Engineering* [J], 114(1), 75-102.

[69] Reddy, J. M. (1990). Local optimal control of irrigation canals. *Journal of Irrigation and Drainage Engineering* [J], 116(5), 616-631.

[70] Litrico, X., & Fromion, V. (2004). Frequency modeling of open-channel flow. *Journal of Hydraulic Engineering* [J], 130(8), 806-815.

[71] Litrico, X., & Fromion, V. (2004). Simplified modeling of irrigation canals for controller design. *Journal of Irrigation and Drainage Engineering* [J], 130(5), 373-383.

[72] van Overloop, P. J., Miltenburg, I. J., Bombois, X., Clemmens, A. J., Strand, R. J., & van de Giesen, N. C. (2010). Identification of resonance waves in open water channels. *Control Engineering Practice* [J], 18(8), 863-872.

[73] Wahlin, B. T. (2004). Performance of model predictive control on ASCE test canal 1. *Journal of Irrigation and Drainage Engineering* [J], 130(3), 227-238.

[74] Lozano, D., Arranja, C., Rijo, M., & Mateos, L. (2010). Simulation of automatic control of an irrigation canal. *Agricultural Water Management* [J], 97(1), 91-100.

[75] 王浩, 尹正杰, 王建华, 等. (2017). *水资源系统分析* [M]. 中国水利水电出版社.

[76] 王浩, 周祖昊, 赵勇, 等. (2018). 水利学科发展与展望. *中国水利水电科学研究院学报* [J], 16(4), 241-252.

[77] Loucks, D. P., & van Beek, E. (2017). *Water Resource Systems Planning and Management: An Introduction to Methods, Models, and Applications* [M]. Springer.

[78] Loucks, D. P., Stedinger, J. R., & Haith, D. A. (1981). *Water Resource Systems Planning and Analysis* [M]. Prentice-Hall.

[79] Hashimoto, T., Stedinger, J. R., & Loucks, D. P. (1982). Reliability, resiliency, and vulnerability criteria for water resource system performance evaluation. *Water Resources Research* [J], 18(1), 14-20.

[80] Maass, A., Hufschmidt, M. M., Dorfman, R., Thomas, H. A., Marglin, S. A., & Fair, G. M. (1962). *Design of Water-Resource Systems* [M]. Harvard University Press.

[81] Simonovic, S. P. (2009). *Managing Water Resources: Methods and Tools for a Systems Approach* [M]. UNESCO Publishing.

[82] Price, R. K., & Vojinovic, Z. (2008). Urban flood disaster management. *Urban Water Journal* [J], 5(3), 259-276.

[83] Savic, D. A., & Kapelan, Z. S. (2014). *SMART Water Networks* [M]. CRC Press.

[84] Raissi, M., Perdikaris, P., & Karniadakis, G. E. (2019). Physics-informed neural networks: A deep learning framework for solving forward and inverse problems involving nonlinear partial differential equations. *Journal of Computational Physics* [J], 378, 686-707.

[85] Shen, C. (2018). A transdisciplinary review of deep learning research and its relevance for water resources scientists. *Water Resources Research* [J], 54(11), 8558-8593.

[86] Nearing, G. S., Kratzert, F., Sampson, A. K., et al. (2021). What role does hydrological science play in the age of machine learning? *Water Resources Research* [J], 57(1), e2020WR028091.

[87] Kratzert, F., Klotz, D., Shalev, G., Klambauer, G., Hochreiter, S., & Nearing, G. (2019). Towards learning universal, regional, and local hydrological behaviors via machine learning applied to large-sample datasets. *Hydrology and Earth System Sciences* [J], 23(12), 5089-5110.

[88] LeCun, Y., Bengio, Y., & Hinton, G. (2015). Deep learning. *Nature* [J], 521(7553), 436-444.

[89] Goodfellow, I., Bengio, Y., & Courville, A. (2016). *Deep Learning* [M]. MIT Press.

[90] Silver, D., Huang, A., Maddison, C. J., et al. (2016). Mastering the game of Go with deep neural networks and tree search. *Nature* [J], 529(7587), 484-489.

[91] Vaswani, A., Shazeer, N., Parmar, N., et al. (2017). Attention is all you need. *Advances in Neural Information Processing Systems* [M], 30.

[92] Brown, T. B., Mann, B., Ryder, N., et al. (2020). Language models are few-shot learners. *Advances in Neural Information Processing Systems* [M], 33.

[93] Sutton, R. S., & Barto, A. G. (2018). *Reinforcement Learning: An Introduction* [M] (2nd ed.). MIT Press.

[94] SAE International. (2021). *J3016: Taxonomy and Definitions for Terms Related to Driving Automation Systems for On-Road Motor Vehicles* [M] (Revised). SAE International.

[95] 雷晓辉. (2025a). 水系统控制论（CHS）：理论背景与研究范式. *南水北调与水利科技* [M], 已录用.

[96] 雷晓辉. (2025b). 自主运行水网：概念、架构与关键技术. *南水北调与水利科技* [M], 已录用.

[97] 雷晓辉. (2025c). 水网控制系统在回路测试方法与平台. *南水北调与水利科技* [M], 已录用.

[98] 雷晓辉. (2025d). 水资源系统分析：从优化到自主. *南水北调与水利科技* [M], 已录用.

[99] 雷晓辉. (2025). 水系统控制论（Cybernetics of Hydro Systems）：理论框架与学科建设. 河北工程大学 [J].

[100] Liu, P., Guo, S., Xu, X., & Chen, J. (2011). Derivation of aggregation-based joint operating rule curves for cascade hydropower reservoirs. *Water Resources Management* [J], 25(13), 3177-3200.

[101] Grigg, N. S. (1996). *Water Resources Management: Principles, Regulations, and Cases* [M]. McGraw-Hill.

[102] Rajagopalan, B., & Lall, U. (1999). A k-nearest-neighbor simulator for daily precipitation and other weather variables. *Water Resources Research* [J], 35(10), 3089-3101.

[103] Todini, E. (2007). Hydrological catchment modelling: Past, present and future. *Hydrology and Earth System Sciences* [J], 11(1), 468-482.

[104] Deltares. (2023). *SOBEK: Hydrodynamic Modelling Suite Technical Documentation* [M]. Deltares, Delft, The Netherlands.

[105] Rijkswaterstaat. (2022). *National Water Management in the Netherlands: Annual Report* [M]. Ministry of Infrastructure and Water Management, The Netherlands.

[106] 水利部. (2022). 数字孪生流域建设技术大纲（试行）. 中华人民共和国水利部 [S].

[107] 水利部. (2023). 关于加快推进智慧水利建设的指导意见. 中华人民共和国水利部 [S].

[108] Turing, A. M. (1936). On computable numbers, with an application to the Entscheidungsproblem. *Proceedings of the London Mathematical Society* [C], 2(42), 230-265.

[109] Shannon, C. E. (1948). A mathematical theory of communication. *The Bell System Technical Journal* [J], 27(3), 379-423.

[110] von Neumann, J., & Morgenstern, O. (1944). *Theory of Games and Economic Behavior* [M]. Princeton University Press.

[111] McCulloch, W. S., & Pitts, W. (1943). A logical calculus of the ideas immanent in nervous activity. *The Bulletin of Mathematical Biophysics* [J], 5(4), 115-133.

[112] Rosenblatt, F. (1958). The perceptron: A probabilistic model for information storage and organization in the brain. *Psychological Review* [J], 65(6), 386-408.

[113] Rumelhart, D. E., Hinton, G. E., & Williams, R. J. (1986). Learning representations by back-propagating errors. *Nature* [J], 323(6088), 533-536.

[114] Hochreiter, S., & Schmidhuber, J. (1997). Long short-term memory. *Neural Computation* [J], 9(8), 1735-1780.

[115] 钱学森. (1982). 论系统工程. *新建筑* [M], (1), 14-16.

[116] 钱学森, 许国志, 王寿云. (1978). 组织管理的技术——系统工程. *文汇报* [M], 9月27日.

[117] Ljung, L. (1999). *System Identification: Theory for the User* [M] (2nd ed.). Prentice Hall.

[118] Bemporad, A., & Morari, M. (1999). Robust model predictive control: A survey. In *Robustness in Identification and Control* [M] (pp. 207-226). Springer.

[119] Mayne, D. Q., Rawlings, J. B., Rao, C. V., & Scokaert, P. O. M. (2000). Constrained model predictive control: Stability and optimality. *Automatica* [J], 36(6), 789-814.

[120] Negenborn, R. R., van Overloop, P. J., Keviczky, T., & De Schutter, B. (2009). Distributed model predictive control of irrigation canals. *Networks and Heterogeneous Media* [J], 4(2), 359-380.

[121] Fele, F., Maestre, J. M., & Camacho, E. F. (2014). Coalitional control: Cooperative game theory and control. *IEEE Control Systems Magazine* [J], 37(1), 53-69.

[122] Blanke, M., Kinnaert, M., Lunze, J., & Staroswiecki, M. (2016). *Diagnosis and Fault-Tolerant Control* [M] (3rd ed.). Springer.

[123] Isermann, R. (2006). *Fault-Diagnosis Systems: An Introduction from Fault Detection to Fault Tolerance* [M]. Springer.

[124] Mnih, V., Kavukcuoglu, K., Silver, D., et al. (2015). Human-level control through deep reinforcement learning. *Nature* [J], 518(7540), 529-533.

[125] Lillicrap, T. P., Hunt, J. J., Pritzel, A., et al. (2016). Continuous control with deep reinforcement learning. *arXiv preprint arXiv:1509.02971* [M].

[126] Devlin, J., Chang, M. W., Lee, K., & Toutanova, K. (2019). BERT: Pre-training of deep bidirectional transformers for language understanding. *Proceedings of NAACL-HLT* [C], 4171-4186.

[127] Karniadakis, G. E., Kevrekidis, I. G., Lu, L., Perdikaris, P., Wang, S., & Yang, L. (2021). Physics-informed machine learning. *Nature Reviews Physics* [J], 3, 422-440.

[128] Hogan, N. (1985). Impedance control: An approach to manipulation. *Journal of Dynamic Systems, Measurement, and Control* [J], 107(1), 1-7.

[129] 钱学森. (1957). *工程控制论* [M]. 科学出版社.（中文版）

[130] Malaterre, P. O. (1995). *Regulation of Irrigation Canals* [D]. Ph.D. Thesis, LAAS-CNRS, Toulouse, France.

[131] Burt, C. M., Clemmens, A. J., Strelkoff, T. S., et al. (1997). Irrigation performance measures: Efficiency and uniformity. *Journal of Irrigation and Drainage Engineering* [J], 123(6), 423-442.

[132] Clemmens, A. J., & Schuurmans, J. (2004). Simple optimal downstream feedback canal controllers: Theory. *Journal of Irrigation and Drainage Engineering* [J], 130(1), 26-34.

[133] Cantoni, M., Weyer, E., Li, Y., Ooi, S. K., Mareels, I., & Ryan, M. (2007). Control of large-scale irrigation networks. *Proceedings of the IEEE* [C], 95(1), 75-91.

[134] Ooi, S. K., & Weyer, E. (2008). Control design for an irrigation channel from physical data. *Control Engineering Practice* [J], 16(9), 1132-1150.

[135] Weyer, E. (2001). System identification of an open water channel. *Control Engineering Practice* [J], 9(12), 1289-1299.

[136] Li, Y., & De Schutter, B. (2011). Performance analysis of irrigation channels with distributed control. *IEEE International Conference on Networking, Sensing and Control* [C], 377-382.

[137] Xu, M., Negenborn, R. R., van Overloop, P. J., & van de Giesen, N. C. (2012). De Saint-Venant equations-based model assessment in model predictive control of open channel flow. *Advances in Water Resources* [J], 49, 37-45.

[138] Horváth, K., Gómez, M., Valentín, M. G., & Galvis, E. (2015). New semi-physical model for canal pool: Accounting for water dynamics. *Journal of Irrigation and Drainage Engineering* [J], 141(6), 04014082.

[139] Isapour, M., Hendrickx, J. M. H., & Muñoz-Carpena, R. (2019). Model-based canal control: Comparison of MPC and optimal integral control. *Journal of Irrigation and Drainage Engineering* [J], 145(12).

[140] 王浩. (2003). *水资源合理配置的理论与实践* [M]. 中国水利水电出版社.

[141] 王浩, 王建华, 秦大庥, 等. (2006). 基于二元水循环模式的水资源评价理论方法. *水利学报* [J], 37(12), 1496-1502.

[142] 杨明祥, 雷晓辉, 蒋云钟, 等. (2020). 长距离输水明渠多目标模型预测控制. *水利学报* [J], 51(8), 958-968.

[143] 赵明松, 雷晓辉, 蔡建元, 等. (2021). 基于数字孪生的智慧灌区运行管理关键技术. *中国农村水利水电* [M], (6), 1-6.

[144] 中国水利水电科学研究院. (2023). *南水北调中线工程智能调度系统技术报告* [M]. 内部报告.

[145] OpenAI. (2023). GPT-4 technical report. *arXiv preprint arXiv:2303.08774* [R].

[146] Lewis, P., Perez, E., Piktus, A., et al. (2020). Retrieval-augmented generation for knowledge-intensive NLP tasks. *Advances in Neural Information Processing Systems* [J], 33, 9459-9474.

[147] Hogan, P. (2023). Digital twins for water infrastructure: From concept to implementation. *Journal of Water Resources Planning and Management* [J], 149(4).

[148] Makropoulos, C., & Savic, D. A. (2019). Urban hydroinformatics: Past, present and future. *Water* [J], 11(10), 1959.

[149] IWA (International Water Association). (2019). *Digital Water: Industry Leaders Chart the Transformation Journey* [M]. IWA Publishing.

[150] SWAN (Smart Water Networks Forum). (2022). *State of the Water Industry Report 2022* [M]. SWAN Forum.

[151] Agyenim-Boateng, E., & Maslov, D. (2022). Digital twin framework for water distribution systems. *Journal of Hydroinformatics* [J], 24(4), 870-886.

[152] Tscheikner-Gratl, F., Bellos, V., Schellart, A., et al. (2019). Recent insights on uncertainties present in integrated catchment water quality modelling. *Water Research* [J], 150, 368-379.

[153] Brdys, M. A., & Ulanicki, B. (1994). *Operational Control of Water Systems: Structures, Algorithms, and Applications* [M]. Prentice Hall.

[154] Negenborn, R. R., & Maestre, J. M. (2014). Distributed model predictive control: An overview and roadmap of future research opportunities. *IEEE Control Systems Magazine* [J], 34(4), 87-97.

[155] Christofides, P. D., Scattolini, R., de la Peña, D. M., & Liu, J. (2013). Distributed model predictive control: A tutorial review and future research directions. *Computers & Chemical Engineering* [J], 51, 21-41.

[156] Russell, S., & Norvig, P. (2021). *Artificial Intelligence: A Modern Approach* [M] (4th ed.). Pearson.

[157] McCarthy, J., Minsky, M. L., Rochester, N., & Shannon, C. E. (1955). A proposal for the Dartmouth summer research project on artificial intelligence. *AI Magazine* [J], 27(4), 12-14 (reprinted 2006).

[158] Minsky, M. (1988). *The Society of Mind* [M]. Simon & Schuster.

[159] Pearl, J. (2009). *Causality: Models, Reasoning, and Inference* [M] (2nd ed.). Cambridge University Press.

[160] Bengio, Y., Lecun, Y., & Hinton, G. (2021). Deep learning for AI. *Communications of the ACM* [J], 64(7), 58-65.

[161] Kaelbling, L. P., Littman, M. L., & Moore, A. W. (1996). Reinforcement learning: A survey. *Journal of Artificial Intelligence Research* [J], 4, 237-285.

[162] Hutter, F., Kotthoff, L., & Vanschoren, J. (Eds.). (2019). *Automated Machine Learning: Methods, Systems, Challenges* [M]. Springer.

[163] Ji, S., Pan, S., Cambria, E., Marttinen, P., & Yu, P. S. (2022). A survey on knowledge graphs: Representation, acquisition, and applications. *IEEE Transactions on Neural Networks and Learning Systems* [J], 33(2), 494-514.

[164] Bommasani, R., Hudson, D. A., Adeli, E., et al. (2021). On the opportunities and risks of foundation models. *arXiv preprint arXiv:2108.07258* [M].

[165] 日本水道技术研究センター. (2021). *水道施設のスマート化に関するガイドライン* [M]. 日本.

[166] IPCC. (2022). *Climate Change 2022: Impacts, Adaptation and Vulnerability* [M]. Contribution of Working Group II to the Sixth Assessment Report. Cambridge University Press.

[167] ASCE. (2021). *2021 Report Card for America's Infrastructure* [M]. American Society of Civil Engineers.

[168] ICOLD (International Commission on Large Dams). (2020). *World Register of Dams* [M]. Paris: ICOLD.

[169] UNESCO. (2023). *United Nations World Water Development Report 2023: Partnerships and Cooperation for Water* [M]. UNESCO Publishing.

[170] 魏山忠, 李原园, 黄火键, 等. (2022). 智慧水利发展的总体思路与重点任务. *中国水利* [M], (6), 1-6.

[171] 蒋云钟, 冶运涛, 赵红莉, 等. (2021). 数字孪生流域关键技术探讨. *水利学报* [J], 52(7), 757-768.

[172] 崔远来, 李远华, 罗玉峰. (2020). *灌区水管理* [M]. 中国水利水电出版社.

[173] Lei, X. H., et al. (2025). Cybernetics of hydro systems: A theoretical framework for autonomous water network operation. 投稿中 [Z].

[174] Isermann, R. (2011). *Fault-Diagnosis Applications: Model-Based Condition Monitoring: Actuators, Drives, Machinery, Plants, Sensors, and Fault-tolerant Systems* [M]. Springer.

[175] Blanchard, B. S., & Fabrycky, W. J. (2011). *Systems Engineering and Analysis* [M] (5th ed.). Prentice Hall.

[176] Leveson, N. G. (2011). *Engineering a Safer World: Systems Thinking Applied to Safety* [M]. MIT Press.

[177] Fritzson, P. (2014). *Principles of Object-Oriented Modeling and Simulation with Modelica 3.3* [M] (2nd ed.). IEEE Press.

[178] Modelica Association. (2023). *Modelica Language Specification 3.6* [M]. Modelica Association.

[179] Isermann, R., & Münchhof, M. (2011). *Identification of Dynamic Systems: An Introduction with Applications* [M]. Springer.

[180] Nocedal, J., & Wright, S. J. (2006). *Numerical Optimization* [M] (2nd ed.). Springer.

[181] Boyd, S., & Vandenberghe, L. (2004). *Convex Optimization* [M]. Cambridge University Press.

[182] Bertsekas, D. P. (2012). *Dynamic Programming and Optimal Control* [M] (4th ed., Vol. II). Athena Scientific.

[183] García-Martín, E., Rodrigues, C. F., Riley, G., & Grahn, H. (2019). Estimation of energy consumption in machine learning. *Journal of Parallel and Distributed Computing* [J], 134, 75-88.

[184] Kopp, R. E. (1962). Pontryagin maximum principle. In *Mathematics in Science and Engineering* [M] (Vol. 5, pp. 255-279). Academic Press.

[185] 刘昌明. (2002). *中国水问题* [M]. 气象出版社.

[186] IWA Task Group on Digital Water. (2022). *Smart Urban Water Systems: What, Why and How* [M]. IWA Publishing.

[187] Giustolisi, O., Kapelan, Z., & Savic, D. (2008). Extended period simulation analysis considering valve shutdowns. *Journal of Water Resources Planning and Management* [J], 134(6), 527-537.

[188] 吴长彬, 雷晓辉, 王超, 等. (2019). 南水北调中线冰期输水闸群智能调控技术. *水利学报* [J], 50(12), 1482-1492.

[189] Litrico, X., & Fromion, V. (2006). H∞ control of an irrigation canal pool with a mixed control politics. *IEEE Transactions on Control Systems Technology* [J], 14(5), 880-890.

[190] van Overloop, P. J., Weijs, S., & Dijkstra, S. (2008). Multiple model predictive control on a drainage canal system. *Control Engineering Practice* [J], 16(5), 531-540.

[191] 国际大坝委员会中国国家委员会. (2020). *中国大坝年鉴* [M]. 中国水利水电出版社.

[192] Maidment, D. R. (1993). *Handbook of Hydrology* [M]. McGraw-Hill.

[193] Chow, V. T. (1959). *Open-Channel Hydraulics* [M]. McGraw-Hill.

[194] Henderson, F. M. (1966). *Open Channel Flow* [M]. Macmillan.

[195] Cunge, J. A., Holly, F. M., & Verwey, A. (1980). *Practical Aspects of Computational River Hydraulics* [M]. Pitman.

[196] Strelkoff, T. (1969). One-dimensional equations of open-channel flow. *Journal of the Hydraulics Division* [J], 95(3), 861-876.

[197] Szymkiewicz, R. (2010). *Numerical Modeling in Open Channel Hydraulics* [M]. Springer.

[198] Chaudhry, M. H. (2008). *Open-Channel Flow* [M] (2nd ed.). Springer.

[199] Graf, W. H., & Altinakar, M. S. (1998). *Fluvial Hydraulics: Flow and Transport Processes in Channels of Simple Geometry* [M]. Wiley.

[200] 谢省宗, 匡尚富, 王浩. (2008). 中国水利科技发展60年. *中国水利水电科学研究院学报* [J], 6(4), 251-262.


[201] Raissi, M., Perdikaris, P., & Karniadakis, G. E. (2019). Physics-informed neural networks: A deep learning framework for solving forward and inverse problems involving nonlinear partial differential equations. *Journal of Computational Physics* [J], 378, 686-707.

[202] Willard, J., Jia, X., Xu, S., Steinbach, M., & Kumar, V. (2022). Integrating scientific knowledge with machine learning for engineering and environmental systems. *ACM Computing Surveys* [J], 55(4), 1-37.

[203] Luo, X., Yuan, X., Zhu, S., Xu, Z., Meng, L., & Peng, J. (2023). A hybrid support vector regression framework for streamflow forecast. *Journal of Hydrology* [J], 623, 129707.

[204] Zhao, G., Pang, B., Xu, Z., Peng, D., & Xu, L. (2021). Assessment of urban flood susceptibility using semi-supervised machine learning model. *Science of the Total Environment* [J], 800, 149659.

[205] Xu, T., & Valocchi, A. J. (2022). Data-driven methods for subsurface flow and transport: A review and perspective. *Water Resources Research* [J], 58(6), e2021WR031392.

[206] Maier, H. R., Razavi, S., Kapelan, Z., Matott, L. S., Kasprzyk, J., & Tolson, B. A. (2023). Introductory overview: Optimization using evolutionary algorithms and other metaheuristics. *Environmental Modelling & Software* [J], 114, 105589.

[207] Menapace, A., Zanfei, A., & Righetti, M. (2022). Automatic leak detection in water distribution networks via spectral analysis on pressure data. *Water Resources Management* [J], 36, 4451-4464.

[208] Vrachimis, S. G., Eliades, D. G., Taormina, R., Kapelan, Z., Ostfeld, A., Liu, S., ... & Polycarpou, M. M. (2022). BattLeDIM: Battle of the leakage detection and isolation methods. *Journal of Water Resources Planning and Management* [J], 148(12), 04022068.

[209] Moy de Vitry, M., Schneider, M., Wani, O., Matte, D., & Leitão, J. P. (2022). Smart urban water systems: What could possibly go wrong? *Environmental Research Letters* [J], 17(3), 033001.

[210] Eggimann, S., Mutzner, L., Wani, O., Schneider, M. Y., Spuhler, D., Moy de Vitry, M., ... & Maurer, M. (2017). The potential of knowing more: A review of data-driven urban water management. *Environmental Science & Technology* [J], 51(5), 2538-2553.

[211] Sun, A. Y. (2021). Optimal carbon storage reservoir management through deep reinforcement learning. *Applied Energy* [J], 278, 115660.

[212] Castelletti, A., Galelli, S., Restelli, M., & Soncini-Sessa, R. (2010). Tree-based reinforcement learning for optimal water reservoir operation. *Water Resources Research* [J], 46(9), W09507.

[213] Saliba, S. M., Bowes, B. D., Adams, S., Beling, P. A., & Goodall, J. L. (2022). Deep reinforcement learning with uncertain data for real-time stormwater system control and flood mitigation. *Water* [J], 12(11), 3222.

[214] Wei, S., Xu, T., Niu, G., & Zeng, R. (2023). Deep reinforcement learning for real-time optimal operation of reservoirs. *Journal of Water Resources Planning and Management* [J], 149(10), 04023050.

[215] Rasheed, A., San, O., & Kvamsdal, T. (2020). Digital twin: Values, challenges and enablers from a modeling perspective. *IEEE Access* [J], 8, 21980-22012.

[216] Liu, M., Fang, S., Dong, H., & Xu, C. (2021). Review of digital twin about concepts, technologies, and industrial applications. *Journal of Manufacturing Systems* [J], 58, 346-361.

[217] Therrien, J.-D., Nicolaï, N., & Bhatt, V. (2021). A critical review of the data pipeline for artificial intelligence applications in water and wastewater management. *Water Science & Technology* [J], 84(10-11), 2580-2594.

[218] Zounemat-Kermani, M., Matta, E., Cominola, A., Xia, X., Zhang, Q., Liang, Q., & Hinkelmann, R. (2021). Neurocomputing in surface water hydrology and hydraulics: A review of two decades retrospective, current status and future prospects. *Journal of Hydrology* [J], 588, 125033.

[219] Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., Kaiser, Ł., & Polosukhin, I. (2017). Attention is all you need. *Advances in Neural Information Processing Systems* [C], 30, 5998-6008.

[220] Brown, T. B., Mann, B., Ryder, N., et al. (2020). Language models are few-shot learners. *Advances in Neural Information Processing Systems* [C], 33, 1877-1901.

[221] Touvron, H., Lavril, T., Izacard, G., et al. (2023). LLaMA: Open and efficient foundation language models. *arXiv preprint arXiv:2302.13971* [R].

[222] Chen, C., Seff, A., Kornhauser, A., & Xiao, J. (2022). DeepDriving: Learning affordance for direct perception in autonomous driving. *Proceedings of the IEEE International Conference on Computer Vision* [C], 2555-2563.

[223] Sievert, E. J., Lickley, M., & Solomon, S. (2022). IPCC AR6 and beyond: Advances in climate science and implications for water management. *Annual Review of Environment and Resources* [J], 47, 279-308.

[224] Konapala, G., Mishra, A. K., Wada, Y., & Mann, M. E. (2020). Climate change will affect global water availability through compounding changes in seasonal precipitation and evaporation. *Nature Communications* [J], 11, 3044.

[225] Qin, Y., Abatzoglou, J. T., Siebert, S., Huning, L. S., AghaKouchak, A., Mankin, J. S., ... & Mueller, N. D. (2020). Agricultural risks from changing snowmelt. *Nature Climate Change* [J], 10, 459-465.

[226] He, X., Bryant, B. P., Moran, T., Mach, K. J., Wei, Z., & Freyberg, D. L. (2021). Climate-informed hydrologic modeling and policy typology to guide managed aquifer recharge. *Science Advances* [J], 7(17), eabe6025.

[227] Xu, B., Zhong, P., Wu, Y., Fu, J., Chen, J., & Yan, K. (2021). A multiobjective short-term optimal operation model for a cascade system of interconnected reservoirs considering ecological flow requirements. *Water Resources Research* [J], 57(9), e2021WR029734.

[228] Lei, X. H., Wang, H., Wang, C., et al. (2025). Autonomous water network operation: A conceptual framework based on cybernetics of hydro systems. *南水北调与水利科技（英文）* [J], 23(1), 1-18.

[229] Xu, B., Zhong, P., Wu, Y., Fu, J., & Chen, J. (2021). A multiobjective stochastic programming model for hydropower station operation with flood control and power generation. *Journal of Hydrology* [J], 603, 126890.

[230] Castelletti, A., Giuliani, M., & Zatarain Salazar, J. (2021). A general framework for flood control operations via multi-objective reinforcement learning. *Water Resources Research* [J], 57(9), e2020WR029510.

[231] Feng, D., Fang, K., & Shen, C. (2021). Enhancing streamflow forecast and extracting insights using long-short term memory networks with data integration at continental scales. *Water Resources Research* [J], 57(9), e2019WR026793.

[232] Frame, J., Kratzert, F., Klotz, D., Gauch, M., Shalev, G., Gilon, O., Qualls, L., Gupta, H., & Nearing, G. (2022). Deep learning rainfall-runoff predictions of extreme events. *Hydrology and Earth System Sciences* [J], 26(13), 3377-3392.

[233] Nearing, G., Cohen, D., Dube, T., Gauch, M., Gilon, O., Harrigan, S., ... & Kratzert, F. (2024). Global prediction of extreme floods in ungauged watersheds. *Nature* [J], 627, 559-563.

[234] Slater, L., Arnal, L., Boucher, M. A., Chang, A.,"; Lapointe, S., & Seidou, O. (2023). Hybrid forecasting: Blending machine learning with hydrological models for improved flood prediction. *Reviews of Geophysics* [J], 61(4), e2023RG000786.

[235] Zounemat-Kermani, M., Matta, E., Cominola, A., Xia, X., Zhang, Q., Liang, Q., & Hinkelmann, R. (2021). Neurocomputing in surface water hydrology and hydraulics: A review of two decades retrospective, current status and future prospects. *Journal of Hydrology* [J], 588, 125533.

[236] Kiranyaz, S., Avci, O., Abdeljaber, O., Ince, T., Gabbouj, M., & Inman, D. J. (2021). 1D convolutional neural networks and applications: A survey. *Mechanical Systems and Signal Processing* [J], 151, 107398.

[237] Tian, Y., Xu, Y. P., Yang, Z., Wang, G., & Zhu, Q. (2021). Integration of a parsimonious hydrological model with recurrent neural networks for improved streamflow forecasting. *Water* [J], 13(11), 1572.

[238] Hunt, K. M. R., Matthews, G. R., Pappenberger, F., & Prudhomme, C. (2022). Using a long short-term memory (LSTM) neural network to boost river streamflow forecasts over the western United States. *Hydrology and Earth System Sciences* [J], 26, 5449-5472.

[239] Sit, M., Demiray, B. Z., Xiang, Z., Ewing, G. J., Sermet, Y., & Demir, I. (2020). A comprehensive review of deep learning applications in hydrology and water resources. *Water Science and Technology* [J], 82(12), 2635-2670.

[240] Mosavi, A., Ozturk, P., & Chau, K. W. (2018). Flood prediction using machine learning models: Literature review. *Water* [J], 10(11), 1536.

[241] Shin, S., Pokhrel, Y., Yamazaki, D., Huang, X., Torbick, N., Qi, J., ... & Nguyen, M. (2023). High-resolution modeling of reservoir release and storage dynamics at the global scale. *Water Resources Research* [J], 59(5), e2022WR033932.

[242] Ouyang, W., Todini, E., Balsamo, G., & Decharme, B. (2023). Continental-scale streamflow simulation in Python using LSTM networks. *Geoscientific Model Development* [J], 16, 1069-1089.

[243] Liu, Y., Gupta, H., Springer, E., & Wagener, T. (2021). Linking science with environmental decision making: Experiences from an integrated modeling approach to supporting sustainable water resources management. *Environmental Modelling & Software* [J], 144, 105134.

[244] Yang, S., Yang, D., Chen, J., & Zhao, B. (2023). Real-time reservoir operation using deep reinforcement learning. *Journal of Water Resources Planning and Management* [J], 149(7), 04023026.

[245] Berthet, L., Andréassian, V., Perrin, C., & Javelle, P. (2021). How crucial is it to account for the antecedent moisture conditions in flood forecasting? Comparison of event-based and continuous approaches on 178 catchments. *Hydrology and Earth System Sciences* [J], 13, 819-831.

[246] Van Overloop, P. J., Horváth, K., & Aydin, B. E. (2022). Model predictive control based on an integrator delay model applied to an open water channel. *IFAC-PapersOnLine* [J], 55(33), 6-11.

[247] Horváth, K., Van Overloop, P. J., Galvis, E., Quintero Caro, H. N.,"; Bermudez, L. (2021). Multivariable model predictive control of water levels on a laboratory canal. *Journal of Irrigation and Drainage Engineering* [J], 147(10), 04021042.

[248] Aydin, B. E., Van Overloop, P. J., &"; Schwanenberg, D. (2022). A review of model predictive control for open channel hydraulic systems. *Annual Reviews in Control* [J], 54, 327-340.

[249] Wahlin, B. T., & Zimbelman, D. D. (2022). Canal automation for irrigation systems: Challenges and opportunities. *Journal of Irrigation and Drainage Engineering* [J], 148(3), 02522001.

[250] Pham, H. T., Tran, Q. K., & Li, C. (2023). Application of deep learning in canal water level prediction for smart irrigation. *Agricultural Water Management* [J], 278, 108136.

[251] Li, M., Wang, Q. J., Bennett, J. C., & Robertson, D. E. (2022). A review and prospect of long-range reservoir inflow forecasting. *Journal of Hydrology* [J], 609, 127723.

[252] Bauer, P., Dueben, P. D., Hoefler, T., Quintino, T., Schulthess, T. C., & Wedi, N. P. (2021). The digital revolution of Earth-system science. *Nature Computational Science* [J], 1, 104-113.

[253] Minaee, S., Kalchbrenner, N., Cambria, E., Nikzad, N., Chenaghlu, M., & Gao, J. (2022). Deep learning-based text classification: A comprehensive review. *ACM Computing Surveys* [J], 54(3), 1-40.

[254] Bommasani, R., Hudson, D. A., Adeli, E., ... (2022). On the opportunities and risks of foundation models. *arXiv* preprint 2108.07258.

[255] Jiang, S., Sweet, L. B., & Blougouras, G. (2023). Digital twin for water infrastructure: A comprehensive review. *Water Research* [J], 245, 120575.

[256] Riedel, T., Kossida, M., Byström, K., &"; Barthel, R. (2023). Digital twins for water utilities — A review of applications and challenges. *Journal of Water Resources Planning and Management* [J], 149(12), 03123003.

[257] Mullapudi, A., Lewis, M. J., Gruden, C. L., & Kerkez, B. (2022). Deep reinforcement learning for autonomous water system control. *Water Research* [J], 218, 118487.

[258] Balla, K. M., Knudsen, B. R., Totu, L. C., & Imsland, L. (2022). Model predictive control for large-scale district heating systems: A real-life case study. *Energy* [J], 239, 122257.

[259] Chen, X., Wu, Z., Liu, P., Cheng, L., Wang, H., & Huang, K. (2023). Multi-objective optimization of reservoir flood control operation considering dynamic risk. *Journal of Hydrology* [J], 616, 128803.

[260] Maier, H. R., Razavi, S., Kapelan, Z., Matott, L. S., Kasprzyk, J., & Tolson, B. A. (2023). Introductory overview: Optimization using evolutionary computation and other metaheuristics. *Environmental Modelling & Software* [J], 114, 104590.

[261] Xu, D., Zhang, Q., Tong, H., & Wang, H. (2024). Safety-critical control of autonomous systems using control barrier functions: A survey. *Annual Reviews in Control* [J], 57, 100937.

[262] Abreu, J. M., Cabrera, E., Izquierdo, J., & García-Serra, J. (2022). Flow modeling in pressurized systems revisited: Status, advances, and future needs. *Journal of Hydraulic Engineering* [J], 148(3), 03122001.

[263] Zhao, T., Zhao, J., Lei, X., Wang, X., & Wu, B. (2022). Improved dynamic programming for reservoir operation optimization with a concave objective function. *Journal of Water Resources Planning and Management* [J], 148(1), 04021088.

[264] Wei, C. C. (2022). Soft computing techniques in ensemble precipitation nowcast allowing for flash flood early warning. *Water Resources Research* [J], 58(3), e2021WR031624.

[265] Wan, W., Guo, X., Lei, X., Jiang, Y., & Wang, H. (2024). A knowledge-enhanced deep reinforcement learning approach for urban flood management. *Journal of Hydroinformatics* [J], 26(1), 48-65.

[266] Diao, K., Sweetapple, C., Farmani, R., Fu, G., Ward, S., & Butler, D. (2016). Global resilience analysis of water distribution systems. *Water Research* [J], 106, 383-393.

[267] Li, J., Lei, X., Tian, Y., Lv, X., Wang, H., & Jiang, Y. (2023). Research progress on ice period operation safety for long-distance water transfer canals. *南水北调与水利科技* [J], 21(4), 673-685.

[268] Creaco, E., Franchini, M., & Alvisi, S. (2022). Optimal placement of isolation valves in water distribution systems based on valve cost and weighted average demand shortfall. *Water Resources Management* [J], 24(15), 4317-4338.

[269] Tsai, W. P., Feng, D., Jia, X., Shen, C., & Valocchi, A. J. (2021). From calibration to parameter learning: Harnessing the scaling effects of big data in geoscientific modeling. *Nature Communications* [J], 12, 5988.

[270] Gharari, S., Razavi, S., & Clark, M. P. (2023). Improving hydrological model predictions using observations of change. *Water Resources Research* [J], 59(8), e2022WR034264.

[271] Fleming, S. W., Watson, J. R., Ellenson, A., Cannon, A. J., & Gibbons, C. (2021). Machine learning in Earth and environmental science requires better benchmarking. *Nature Geoscience* [J], 14, 785-788.

[272] Lu, D., & Ricciuto, D. (2021). Efficient surrogate modeling methods for large-scale Earth system models based on machine learning techniques. *Geoscientific Model Development* [J], 14(4), 1943-1958.

[273] Shen, C., & Lawson, K. (2021). Applications of deep learning in hydrology. In *Deep Learning for the Earth Sciences* [M], Wiley, pp. 283-297.

[274] O'Gorman, P. A., & Dwyer, J. G. (2023). Using machine learning to parameterize moist convection: Potential for modeling of climate, climate change, and extreme events. *Journal of Advances in Modeling Earth Systems* [J], 10, 2548-2563.

[275] Xiang, Z., Yan, J., & Demir, I. (2022). A rainfall-runoff model with LSTM-based sequence-to-sequence learning. *Water Resources Research* [J], 56, e2019WR025326.

[276] Xu, Y., Hu, C., Wu, Q., Li, Z., Jian, S., & Chen, Y. (2023). Application of temporal fusion transformer for day-ahead PV power forecasting. *Energy* [J], 281, 128218.

[277] Cai, H., Liu, S., Shi, H., Zhou, Z., Jiang, S., & Babovic, V. (2022). Toward improved lumped groundwater level predictions at catchment scale: Mutual integration of water balance mechanism and deep learning method. *Journal of Hydrology* [J], 613, 128495.

[278] Höge, M., Scheidegger, A., Baity-Jesi, M., Albert, C., & Fenicia, F. (2022). Improving hydrologic models for predictions and process understanding using neural ODEs. *Hydrology and Earth System Sciences* [J], 26, 5085-5102.

[279] Kratzert, F., Klotz, D., Hochreiter, S., & Nearing, G. S. (2021). A note on leveraging synergy in multiple meteorological data sets with deep learning for rainfall-runoff modeling. *Hydrology and Earth System Sciences* [J], 25, 2685-2703.

[280] Lees, T., Buechel, M., Anderson, B., Slater, L., Reece, S., Coxon, G., & Dadson, S. J. (2021). Benchmarking data-driven rainfall-runoff models in Great Britain: A comparison of long short-term memory (LSTM)-based models with four lumped conceptual models. *Hydrology and Earth System Sciences* [J], 25, 5517-5534.

[281] Willard, J. D., Jia, X., Xu, S., Steinbach, M., & Kumar, V. (2022). Integrating scientific knowledge with machine learning for engineering and environmental systems. *ACM Computing Surveys* [J], 55(4), 1-37.

[282] Razavi, S. (2021). Deep learning, explained: Fundamentals, explainability, and bridgeability to process-based modelling. *Environmental Modelling & Software* [J], 144, 105159.

[283] Reichstein, M., Camps-Valls, G., Stevens, B., Jung, M., Denzler, J., Carvalhais, N., & Prabhat (2019). Deep learning and process understanding for data-driven Earth system science. *Nature* [J], 566, 195-204.

[284] Gauch, M., Kratzert, F., Klotz, D., Nearing, G., Lin, J., & Hochreiter, S. (2021). Rainfall-runoff prediction at multiple timescales with a single long short-term memory network. *Hydrology and Earth System Sciences* [J], 25, 2045-2062.

[285] Mosavi, A., Shamshirband, S., Salwana, E., Chau, K. W., & Tah, J. H. M. (2021). Prediction of multi-inputs bubble column reactor using a novel hybrid model of computational fluid dynamics and machine learning. *Engineering Applications of Computational Fluid Mechanics* [J], 13(1), 482-492.

