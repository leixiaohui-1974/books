## 2.7 重大工程案例：CHS理论的实践验证

理论的生命力在于实践。CHS理论框架的形成，不是书斋中的纯粹思辨，而是扎根于多项重大水利工程的实践探索。本节选取三个代表性工程案例——胶东调水工程、沙坪水电梯级系统和南水北调中线工程——系统展示CHS理论在不同类型水系统中的应用。这三个案例分别代表了长距离明渠调水、水力发电梯级联合调度和超大规模跨流域调水三种典型工程场景，涵盖了水系统运行中最具挑战性的核心问题。更重要的是，这三个工程的实践经验不仅验证了CHS理论的工程可行性，而且反过来推动了理论的深化和完善——许多核心概念正是在解决工程实际问题的过程中被提炼和升华的。

### 2.7.1 胶东调水工程：SCADA+HDC协同控制

#### （1）工程概况与运行挑战

胶东调水工程是山东省重要的跨区域水资源配置工程，承担着向青岛、烟台、威海等胶东半岛城市群供水的战略任务。工程由引黄济青改扩建工程和引黄济青干线延伸至胶东半岛的输水渠系组成，涉及多段明渠、管道和泵站，输水线路跨越数百公里。工程沿线设有多座节制闸和分水闸，构成典型的多渠池串联控制系统。

胶东调水工程的运行面临多重挑战。第一，长距离输水带来的大时滞问题。上游闸门的操作到下游水位响应之间存在数小时甚至更长的传播延迟，传统的反馈控制方法在大时滞条件下容易产生超调和振荡。以典型渠段为例，若渠段长度为$L$，水波传播速度约为$v_0+c_0$（其中$v_0$为平均流速，$c_0=\sqrt{gA_0/T_0}$为小扰动波速），则传播延迟$\tau_d=L/(v_0+c_0)$在数十分钟到数小时量级。当多个渠段串联时，累积延迟可达十余小时，这对控制器的设计提出了极高的要求。

第二，多用户多目标的协调问题。沿线有多个取水口服务于不同城市，各城市的需水时段和需水量不同，需要在保障各用户供水可靠性的同时维持渠道的安全水位。供水可靠性要求系统尽量满足各用户的取水需求，而运行安全性要求渠道水位始终维持在安全上下限之间。这两个目标在取水高峰期可能产生矛盾——大量取水导致渠道水位下降，可能触及安全下限。

第三，来水不确定性。水源区来水受降雨和黄河来水条件影响，存在较大的不确定性。此外，渠道沿线的旁侧入流（如区间降雨汇入）和旁侧出流（如渗漏损失）也构成了系统的外部扰动。运行调度需要在不确定条件下保持稳健性，即在最不利的扰动情况下仍能保障系统安全运行。

第四，渠道水力特性的非线性和时变性。明渠中的水流由圣维南方程描述，这是一组非线性偏微分方程。渠道的水力参数（如糙率系数$n$）会随季节、淤积状况和水生植物生长等因素发生变化，导致系统模型具有时变特性。夏季水生植物旺盛生长时，渠道的Manning糙率系数可能从设计值0.013增大到0.018甚至更高，这意味着同样的流量条件下水位会显著升高，过流能力下降。冬季低温条件下，水的粘滞系数增大也会改变水力特性。这种时变性要求控制系统具备在线辨识和参数自适应能力——固定参数的控制器在模型参数漂移后可能出现性能下降甚至失稳。

第五，多工况运行带来的模式切换问题。胶东调水工程在不同季节、不同来水条件和不同需求场景下的运行模式存在显著差异。丰水期的运行重点是防止渠道溢流，需要加大下泄能力；枯水期的运行重点是保障供水可靠性，需要精打细算每一方水量；特殊事件（如上游水源突发水质问题、下游城市突增应急供水需求）则要求系统快速切换到应急运行模式。不同运行模式下的控制目标、约束条件和优先级排序各不相同，系统需要能够根据运行条件的变化自动识别并切换到适当的控制模式——这正是CHS理论中"运行设计域"（ODD）概念的工程来源之一。

#### （2）从圣维南方程到IDZ传递函数：建模基础

要对胶东调水工程实施基于模型的控制，首先需要建立适合控制器设计的数学模型。这涉及一个关键的科学问题：如何将描述明渠水流的非线性偏微分方程（圣维南方程）转化为控制工程中可用的低阶传递函数模型？

圣维南方程组由连续性方程和动量方程组成：

$$\frac{\partial A}{\partial t}+\frac{\partial Q}{\partial x}=q_l$$

$$\frac{\partial Q}{\partial t}+\frac{\partial}{\partial x}\left(\frac{Q^2}{A}\right)+gA\frac{\partial h}{\partial x}=gA(S_0-S_f)$$

其中$A$为过水断面面积，$Q$为流量，$q_l$为旁侧入流，$S_0$为底坡，$S_f$为摩阻坡降。这组方程虽然能够精确描述明渠水流的动态行为，但由于其非线性和分布参数特性，无法直接用于控制器设计。

为解决这一问题，研究团队发展了一套系统化的降阶建模方法。第一步，确定渠池的基准稳态工作点。根据设计流量$Q_0$和渠池几何参数（长度$L$、底宽$b$、边坡系数$m$、底坡$S_0$、Manning糙率系数$n$），利用Manning公式求解均匀流条件下的基准水深$y_0$和基准流速$v_0$。第二步，对圣维南方程组进行线性化处理。将流量和水深分解为稳态分量与扰动分量之和，即$Q(x,t)=Q_0+q(x,t)$、$y(x,t)=y_0+\tilde{y}(x,t)$，忽略扰动量的高阶项，得到线性化偏微分方程组。第三步，对线性化方程进行Laplace变换，推导分布参数传递矩阵$\mathbf{G}(s)$，建立上下游边界变量之间的频域关系。第四步，在低频段对分布参数传递矩阵进行有理函数近似，构建积分延迟零（Integrator Delay Zero, IDZ）传递函数模型：

$$P(s)=\frac{(1+\tau_z \cdot s) \cdot e^{-\tau_d \cdot s}}{A_s \cdot s}$$

其中，$A_s=T_0 \cdot L$为渠池蓄量面积，表征积分特性；$\tau_d=L/(v_0+c_0)$为传播延迟时间；$\tau_z$为零点时间常数，通过频域拟合确定。IDZ模型是Litrico和Fromion于2004年在ID模型基础上提出的改进模型，通过增加零点项改善了高频段的响应精度。

这一降阶建模方法的关键创新在于建立了多工况传递函数库。在渠池设计运行流量范围$[Q_{min},Q_{max}]$内，选取多个特征工况流量值，对每个工况分别计算IDZ传递函数参数，构成参数查找表。当实际运行工况处于相邻特征工况之间时，采用插值获取当前工况的模型参数。仿真验证表明，在流量偏离设计值50%的工况下，多工况插值模型的水位预测均方根误差较固定参数IDZ模型降低约25%至35%。

此外，为适应渠道糙率变化、淤积等长期演变因素，还发展了基于递推最小二乘法（RLS）的在线参数辨识机制。该机制实时采集闸门流量变化和下游水位响应数据，在线辨识传递函数参数，当辨识值与库中参数的偏差超过预设阈值时自动触发参数更新。这一"建模—辨识—更新"的闭环机制，体现了CHS理论中"数据—物理融合"原理的工程实现。

#### （3）SCADA+HDC融合架构

在建模基础上，胶东调水工程采用了SCADA与分层分布式控制（HDC）相融合的技术架构。这一架构是CHS理论"分层分布式统一"原理的典型工程实现。

在SCADA层面，工程建设了覆盖全线的数据采集与监控网络。关键控制断面设置了水位传感器、流量计、闸门开度传感器等监测设备，实时数据通过光纤和无线通信网络传输至中央控制中心。SCADA系统不仅承担传统的数据采集和远程监控功能，还集成了数据质量评估模块——对传感器数据进行异常检测、缺失补全和一致性校验，为控制算法提供经过清洗和融合的高质量输入。

在HDC层面，控制架构分为三个层级，每个层级解决不同空间尺度和时间尺度的控制问题。

L0层（本地控制层）实现单个闸门的本地自动控制。每个闸门配备独立的可编程逻辑控制器（PLC），根据目标水位和实际水位的偏差，通过改进的PID算法自动调节闸门开度。L0层的响应速度在秒级，主要职责是快速消除局部水位扰动。L0层控制器还内置了安全联锁逻辑：当水位超过安全上限时自动开闸放水，当水位低于安全下限时自动关闸蓄水。这些联锁逻辑不依赖上层通信，确保了在通信中断等极端情况下的基本安全保障。

L1层（渠段协调层）是多渠段水位协调的关键。当某个渠段的水位偏离目标值时，如果仅由L0层各自独立调节，可能引发"推波效应"——上游闸门为降低水位而增大开度放水，导致下游渠段水位升高；下游闸门为降低水位也增大开度放水，波动进一步向下游传递和放大。L1层通过前馈补偿和解耦控制技术协调相邻闸门的联动：当上游闸门调节放水时，L1层同时向下游闸门发送前馈信号，使其提前做好接纳准备，避免水位波动的级联传播。L1层的控制周期为分钟级到十分钟级。

L2层（全系统调度层）负责全线的优化调度。L2层的核心算法采用模型预测控制（MPC），其预测模型基于全线IDZ传递函数的离散状态空间表达。L2层综合考虑各城市的需水计划（通常以日为周期更新）、水源区的来水预报、气象信息（降雨预报用于估计区间来水，蒸发预报用于估计水量损失），以及渠道安全约束（水位上下限、闸门操作限制），计算未来数小时到数天内各闸门的最优操作序列。

SCADA与HDC的深度融合是一个关键设计理念。传统上，SCADA和控制算法往往是分离的子系统——SCADA负责"看"（数据采集与显示），控制算法负责"算"（决策与优化），两者之间通过简单的数据接口连接，缺乏深度耦合。在胶东调水工程中，这一传统架构被打破：SCADA的数据质量评估结果直接影响HDC算法的运行模式。具体而言，系统定义了三级运行模式：正常模式——当数据质量良好（传感器在线率大于95%、数据一致性校验通过）时，HDC算法以设计参数正常运行；保守模式——当数据质量下降到一定阈值以下（如关键传感器故障或通信延迟超限）时，HDC自动切换到保守控制模式，减小控制动作幅度、扩大水位安全裕度以降低风险；安全回退模式——当数据链中断或出现重大异常时，系统自动将所有闸门锁定在当前位置或预设的安全开度，并触发告警请求人工接管。

这种基于数据质量的三级运行模式切换机制，在概念上与CHS理论后来提出的"运行设计域"（ODD）和"安全包络"密切相关——数据质量是定义ODD边界的关键因素之一，不同的数据质量水平对应不同的ODD范围和安全包络宽度。胶东调水工程的这一实践经验，直接推动了ODD概念在CHS理论中的形成和完善。

此外，胶东调水工程还在HDC架构中引入了故障容错机制。当L1层或L2层控制器发生故障时，下级控制器能够自动切换到独立运行模式——L0层控制器基于本地PID控制继续维持单闸水位稳定，虽然全局优化性能有所降低，但系统的基本安全运行得到保障。这种"优雅降级"设计思想是CHS理论"安全优先于效率"原则的工程体现。

#### （4）MPC在线优化

胶东调水工程的L2层调度采用了模型预测控制（MPC）方法。MPC是一种基于模型的滚动优化控制策略，其核心思想是：在每个控制时刻$k$，利用预测模型向前预测未来$N_p$个时步的系统响应，在预测域内求解一个约束优化问题，得到最优控制序列，执行第一步控制动作后丢弃其余，然后在下一个控制时刻重新预测和优化。

MPC的优化目标函数定义为：

$$J=\sum_{i=1}^{N_p}\left\|\mathbf{y}(k+i|k)-\mathbf{y}_{ref}(k+i)\right\|_{\mathbf{Q}}^2+\sum_{j=0}^{N_c-1}\left\|\Delta\mathbf{u}(k+j|k)\right\|_{\mathbf{R}}^2$$

其中第一项衡量预测输出$\mathbf{y}$与参考轨迹$\mathbf{y}_{ref}$的偏差，第二项衡量控制增量$\Delta\mathbf{u}$的大小，$\mathbf{Q}$和$\mathbf{R}$为权重矩阵。约束条件包括水位安全包络$\mathbf{y}_{min} \leq \mathbf{y} \leq \mathbf{y}_{max}$、闸门开度范围和开度变化速率限制。

MPC方法在胶东调水工程中取得了显著的运行效果。在正常输水工况下，主要控制断面的水位偏差控制在目标值的正负5厘米以内，显著优于人工调度的正负15至20厘米精度。这一精度提升的背后有深层的工程意义：水位波动减小意味着渠道可以在更接近设计水位的条件下运行，有效利用的过水断面增大，输水能力相应提高；同时，水位波动的减小降低了渠道护坡和衬砌的冲刷风险，延长了工程的使用寿命。

在需水变化工况下，MPC的前瞻预测能力体现出关键优势。当某个城市的取水量即将增加时，MPC利用需水计划信息提前数小时调整上游闸门开度，使得额外的水量在取水增加之前就已经进入输水渠道，从而避免了取水瞬间的水位大幅下降。相比之下，人工调度模式下调度员通常在收到取水请求后才开始调整闸门，由于传播延迟的存在，下游水位在调整生效前就已经出现明显下降——这种"先降后补"的模式不仅影响供水质量，还可能触发低水位告警甚至引发安全事件。

在突发扰动工况下（如局部强降雨导致渠道旁侧来水突增、上游水源流量意外变化等），MPC表现出良好的鲁棒性。MPC的滚动优化机制使其能够在每个控制时刻根据最新的测量数据重新计算控制方案——当扰动发生时，MPC在下一个控制时刻即可感知到偏差并自动调整后续的控制序列，无需等待人工干预。在多次实际运行中，MPC成功应对了多种突发扰动，始终将水位维持在安全包络之内，实现了WNAL L3级别的条件自主运行。

值得关注的是MPC的工程实施细节。在线计算方面，由于IDZ传递函数模型的计算复杂度低（单步求解时间为微秒量级），MPC的在线优化能够在标准工控机上数秒内完成，满足了实时控制要求。在通信方面，MPC的控制指令通过SCADA系统下发到现场执行器，指令的传输延迟被显式纳入MPC的预测模型中进行补偿。在安全保障方面，MPC的输出在下发执行前经过安全检查模块的校验——如果MPC计算出的闸门开度指令超出安全范围或变化速率过大，安全检查模块会对指令进行裁剪或拒绝，确保执行器不会收到不安全的指令。这种"优化+安全校核"的双重机制，是CHS理论"优化—安全统一"原则在工程中的具体实现。

#### （5）工程启示

胶东调水工程的实践为CHS理论提供了多方面的验证和启示。SCADA+HDC融合架构验证了"分层分布式统一"原理的工程可行性；从圣维南方程到IDZ传递函数的系统化降阶方法验证了"可控模型族"概念的工程价值；MPC在长距离调水中的成功应用验证了基于模型的预测控制在水系统中的有效性。同时，传感器故障、通信延迟和模型参数漂移等实际问题推动了状态估计、延迟补偿和自适应控制方法的发展，体现了"实践推动理论"的学科发展规律。

### 2.7.2 沙坪水电梯级：发电—防洪多目标协同

#### （1）工程概况与运行挑战

沙坪水电站位于四川省大渡河流域，是蒲布—深溪沟—镇头—沙坪四级水电梯级系统的组成部分。整个梯级系统承担着电力调峰、防洪泄洪和生态流量保障等多重功能。与胶东调水以供水为核心目标不同，水电梯级系统的运行问题本质上是一个多目标协同优化问题——发电效益最大化、防洪安全保障和生态流量维持三者之间存在结构性矛盾。

发电目标追求水能利用效率最大化，希望维持较高的水库水位以获得更大的发电水头$H$（发电功率$P=\eta \rho g Q H$），因此倾向于蓄水；防洪目标则要求在汛期保持充足的防洪库容，需要降低水库水位；生态目标要求在特定时段维持特定的下泄流量过程。此外，梯级系统内部的级联耦合效应显著增加了运行复杂性——上级电站的泄水直接构成下级电站的来水，一个电站的运行方式变化会沿梯级向下游逐级传播。

从控制系统的角度看，沙坪梯级至少存在三类不同时标：秒级的机组保护与联锁、分钟级的机组与闸门调节、小时级的梯级调度计划修正。CHS理论的"分层分布式"架构为这种多时标问题提供了自然的解决框架。

#### （2）控制对象建模

沙坪梯级的建模与胶东调水有显著差异。胶东调水的核心是明渠水流动力学（圣维南方程），关注的是沿渠道空间分布的水位和流量变化；而沙坪梯级的核心是水库水量平衡与发电-泄洪耦合动力学，关注的是集总参数（水库水位、机组出力、泄洪流量）的时间演变。

对于单个电站，基本的水量平衡方程为：

$$\frac{dV}{dt}=Q_{in}(t)-Q_{out}(t)$$

其中$V$为水库蓄水量（$m^3$），$Q_{in}$为入库流量，$Q_{out}$为出库总流量。出库流量由发电流量$Q_{pow}$和泄洪流量$Q_{spill}$两部分组成：$Q_{out}=Q_{pow}+Q_{spill}$。通过库容曲线$V=f(h)$可将水量平衡方程转化为水位动态方程。库容曲线通常是非线性的——在低水位段库容随水位变化较慢（河谷狭窄），在高水位段库容随水位变化较快（库面展开）。

对于梯级系统，四个电站的水量平衡方程通过上下游关系耦合在一起：

$$Q_{in,i}=Q_{out,i-1}+q_i, \quad i=2,3,4$$

即下游电站的入库流量等于上游电站的出库流量加上区间来水$q_i$。这种级联耦合使得梯级系统的状态空间维数随电站数量线性增加，而约束条件的数量也成倍增长，优化问题的求解复杂度随之急剧增大。

发电功率模型需要考虑机组的运行特性。水轮发电机组的发电功率为$P=\eta \rho g Q_{pow} H$，其中$H$为净水头（上游水位减去下游水位再减去水头损失），$\eta$为水轮机效率。关键的非线性来自效率$\eta$——它是水头$H$和流量$Q_{pow}$的复杂非线性函数，通常以"机组工况曲线"（hill chart）的形式给出。工况曲线上存在"高效率区"和"振动区"：在高效率区运行可以最大化发电效益，而在振动区运行会产生水力振动，加速机组磨损甚至导致设备损坏。因此，发电优化不仅要追求功率最大化，还必须通过约束条件严格规避振动区运行。

此外，梯级系统还需要考虑水流传播的时间延迟。上游电站泄水后，水流到达下游电站需要一定时间（取决于河道长度和流速），这一"级间传播延迟"使得上下游电站的控制不能简单地同步进行，必须考虑时序协调。在洪水期间，级间传播延迟可能只有数十分钟到一两个小时，但其对水位变化的放大效应可能非常显著——上游泄洪波在下游叠加区间来水后，可能使下游电站面临超出设计标准的入库洪峰。

#### （3）发电—泄洪一体化控制

沙坪梯级采用了一体化控制方法，将发电调度和泄洪调度纳入统一优化框架：

$$J=\alpha \cdot J_{power}+\beta \cdot J_{flood}+\gamma \cdot J_{eco}$$

关键创新在于权重系数的动态调整机制：汛期$\beta$自动增大优先保障防洪库容，枯水期$\alpha$增大优先发电效益，鱼类繁殖季$\gamma$增大保障生态流量。权重调整规则编码在运行设计域（ODD）中，由水文气象条件自动触发工况切换。

约束条件分为三层：硬约束（不可违反的安全边界）、软约束（可通过惩罚函数纳入优化的性能指标）、治理约束（确保可审计可追责的管理要求）。这种动态权重与三层约束分级的设计，是CHS"多目标统一"和"安全优先"原理在水电场景中的融合实现。

#### （4）梯级"一键调"协同

"一键调"（One-Click Dispatch）是沙坪梯级的重要技术创新。调度员只需设定梯级整体运行目标（总发电负荷、总泄洪流量、各站水位目标），系统自动计算各级电站的最优运行方式并一键下发。

技术实现依赖于分层优化：上层优化器确定各级电站的总出力和总泄流分配（电站间协调），目标是梯级整体效益最大化同时满足级间水量平衡约束；下层优化器确定每个电站内部各机组的出力分配（电站内部优化），目标是单站效率最大化同时规避振动区。

上层优化器的数学模型可以表述为：在满足梯级总出力需求$\sum_i P_i = P_{total}$、各电站水位约束$h_{min,i} \le h_i \le h_{max,i}$和级间水量平衡$Q_{in,i} = Q_{out,i-1} + q_i$的条件下，最小化多目标函数。上层优化的决策变量是各电站的出力分配$P_i$和泄洪分配$Q_{spill,i}$，维度仅为$2 \times 4 = 8$个决策变量，可以在毫秒级完成求解。

下层优化器则面向单个电站内部。以沙坪电站为例，假设有$n$台机组，每台机组的效率曲线$\eta_j(H, Q_j)$是非线性的，且存在不可运行的振动区间。下层优化需要在满足上层分配的总出力$P_i$的条件下，确定各机组的个体出力$P_{i,j}$，使得总发电效率最大化并避免任何机组落入振动区。这一优化问题虽然是非凸的（由于振动区的存在），但由于单站机组数量有限（通常不超过10台），可以通过枚举可行机组组合加连续优化的混合方法在秒级内求解。

"一键调"在人机交互层面的设计同样值得关注。系统为调度员提供了三种交互模式：第一种是"目标输入模式"——调度员只需输入梯级的整体目标（如"总出力提升到120MW"），系统自动计算并显示各电站的分配方案；第二种是"约束调整模式"——调度员可以手动修改某个电站的约束（如"沙坪电站3号机组检修停机"），系统在新约束下重新优化并更新方案；第三种是"方案对比模式"——系统同时生成多个候选方案（如"效率优先方案""安全优先方案""均衡方案"），调度员从中选择最合适的方案执行。

这种两层分解的数学基础是拉格朗日松弛或交替方向乘子法（ADMM）。以拉格朗日松弛为例，梯级级间的水量平衡约束$Q_{in,i}=Q_{out,i-1}+q_i$被松弛到目标函数中，引入拉格朗日乘子$\lambda_i$作为级间"水价"信号。上层优化通过调整乘子$\lambda_i$来协调各电站之间的水量分配，下层各电站独立求解以$\lambda_i$为参数的局部优化问题。经过数轮迭代，乘子收敛到最优值，各电站的局部最优解自然满足级间耦合约束，同时实现梯级整体的帕累托最优。

"一键调"的人机交互设计也值得关注。调度员在界面上只需完成三步操作：第一步，确认或修改梯级的整体运行目标（系统会根据电网调度指令和水情预报自动给出推荐值）；第二步，检查安全约束的设置（系统根据当前水情和设备状态自动更新约束参数）；第三步，点击"执行"按钮。系统在后台完成两层优化计算后，将各电站的详细运行方案以表格和图形两种形式呈现给调度员审核，同时高亮显示与上一时刻方案的差异和关键约束的裕度。调度员确认后，指令通过SCADA系统同步下发到四个电站。

"一键调"将传统需要数十分钟到数小时的梯级调度过程缩短到秒级，并保证全局帕累托最优。更重要的是，它改变了调度员的工作模式——从"逐站计算、逐站下发"的繁琐操作转变为"审核整体方案、一键确认执行"的高效决策。这种人机交互模式的优化，正是CHS理论"人机共融"理念在操作层面的具体体现。在实际运行中，"一键调"不仅提高了调度效率，更重要的是减少了人为操作失误的风险——传统模式下，调度员在逐一调整各电站运行方式时，容易出现"顾此失彼"的情况，导致某个电站的调整与梯级整体目标不一致。"一键调"通过算法保证各电站运行方式的全局协调性，从根本上避免了这类失误。

#### （5）认知AI辅助决策

沙坪梯级还引入了认知AI作为辅助决策工具。核心能力来自经水电领域微调的大语言模型（LLM），微调过程包括领域持续预训练（DAPT）和监督微调（SFT），并引入知识图谱增强检索（KG-RAG）。

主要应用包括三方面：第一，调度方案的自然语言解释——将MPC输出的数值化方案转化为包含"水情分析""调度思路""风险提示""操作建议"四部分的可读文字；第二，运行规程的智能检索——支持自然语言查询，从知识图谱中检索并返回精确条款引用；第三，异常工况的辅助研判——综合历史案例和运行规程给出处置建议，经物理约束校核器验证后呈现给调度员。

物理AI（MPC优化器）负责"算"——基于水力学模型给出数值最优的调度方案，保证方案的物理可行性和数学最优性；认知AI（LLM辅助系统）负责"解释"和"建议"——将数值方案转化为可理解的操作指导，从知识库中检索相关规程和案例，辅助调度员快速理解和评估方案。两者之间的协作通过一个"物理约束校核器"来保障质量：认知AI的每一条输出（无论是方案解释、规程引用还是异常处置建议）都会经过校核器的审查——检查其中涉及的数值是否在物理合理范围内，引用的规程条款是否与当前工况匹配，建议的操作是否违反安全约束。只有通过校核的内容才会呈现给调度员。

这种"双AI引擎+物理校核"的架构，有效地发挥了两类AI各自的优势——物理AI擅长精确计算但缺乏解释能力，认知AI擅长理解和生成自然语言但可能产生"幻觉"——同时通过校核机制抑制了各自的劣势，体现了CHS"双AI引擎"架构的核心设计思想。

#### （6）工程启示

沙坪实践验证了CHS理论在水电调度领域的适用性。多目标协同优化成功地将发电、防洪、生态三个矛盾目标纳入统一框架；"一键调"将复杂梯级调度简化为一步操作；认知AI提供了全方位决策支持。同时也揭示了LLM"幻觉"问题和分布式优化效率等需要进一步研究的课题。

### 2.7.3 南水北调中线工程：超大规模自主运行探索

#### （1）工程概况与世界级挑战

南水北调中线工程总干渠从丹江口水库至北京团城湖，全长1432公里，沿线设有60余座节制闸。自2014年通水以来，累计调水超过700亿立方米，惠及1.76亿人口。

工程面临世界级挑战：超长距离带来的超大时滞（水流从渠首到终端传播十余天）、60余座闸门构成的超高维控制系统（状态组合数为天文数字）、跨四省市的多元需求协调（工业供水、生活供水、农业灌溉、生态补水四类需求各异）、以及冰期运行的特殊安全风险。

从系统控制的角度进行定量分析，这些挑战的严峻性可以更清晰地看到。关于时滞问题：以中线工程典型运行流量条件计算，水流从陶岔渠首到北京团城湖的传播时间约为10至15天。这意味着如果调度员今天发现北京段水位偏低，回溯到渠首端的调度调整，其效果需要两周后才能到达——在此期间，需水条件可能已经发生了多次变化。传统的反馈控制在如此大的时滞条件下基本失效，必须采用基于预测模型的前馈控制与反馈修正相结合的策略。

关于高维控制问题：60余座节制闸加上多座退水闸和分水口，构成了一个具有上百个决策变量的控制系统。如果将每个闸门的开度离散化为10个等级，状态空间的理论规模为$10^{60}$量级。即使采用最先进的全局优化算法，在合理的计算时间内也无法遍历这一搜索空间。分层分布式架构通过将全局优化问题分解为多个互相协调的局部优化问题来降低计算复杂度——这不是一种"近似"或"妥协"，而是应对维度灾难的唯一工程可行途径。

关于多元需求协调：工业供水（连续性要求高、水质要求严）、城市生活供水（时段性波动、保障优先级最高）、农业灌溉（季节性集中、水量大）和生态补水（特定时段的流量过程要求）四类需求在水量、时间分布和保障优先级上各不相同。水源充裕时可同时满足，水源紧张时（枯水年或突发水质事件）需求冲突凸显——需要在"保谁、减谁、缓谁"之间做出决策。这种多利益主体的协调问题超越了纯技术优化范畴，需要将政策法规和社会公平因素嵌入优化框架，CHS理论中的"治理约束"概念正是为此而生。

#### （2）分层分布式控制架构

面对上述挑战，南水北调中线采用了专门设计的三层分层分布式控制架构。

面对上述挑战，南水北调中线工程采用了经过专门设计的分层分布式控制架构。全线被划分为若干管理段，每个管理段包含数座节制闸和相应渠段，由一个区域管理处负责日常运行。

控制架构分为三个层级，各层级的职责和响应时间尺度明确区分：

L0层（本地控制层）：每座节制闸配备本地自动控制系统，内置PID控制器。本地控制器根据上级下达的目标水位设定值，通过测量闸前（或闸后）水位与目标值的偏差，自动调节闸门开度。L0层的控制周期为秒级到分钟级，主要职责是快速消除因短时扰动（如旁侧来水突变、下游取水波动）引起的局部水位偏差。L0层还承担安全联锁功能——当水位触及安全上限或下限时，自动执行预设的保护动作（如紧急开闸或关闸），不依赖上级指令，确保在通信中断等极端情况下仍能保障局部安全。

L1层（管理段协调层）：每个管理段设有区域调度中心，配备工业控制计算机和SCADA显示系统。L1层控制器接收L2层下达的调度计划，将其分解为段内各闸门的目标水位和流量设定值。L1层的核心任务是段内多闸协调——当某座闸门的调节动作影响到相邻闸门的控制效果时，L1层通过前馈补偿和解耦控制协调多闸联动，避免水位波动在闸门之间传递放大。此外，L1层具有一定程度的自主处置权限：当段内出现一般性异常（如单个传感器故障、短时通信中断、小幅度旁侧来水增大等），L1层在预设的运行设计域（ODD）范围内自主调整控制策略，只有超出ODD边界的异常才上报L2层请求干预。L1层的控制周期为分钟级到小时级。

L2层（全系统调度层）：位于北京的南水北调中线建设管理局调度中心，是整个控制体系的最高决策层。L2层综合考虑以下信息源制定调度方案：丹江口水库的来水预报和可供水量、沿线各省市的月/旬/日需水计划、气象预报（用于预测渠道蒸发损失和区间降雨来水）、以及冬季的冰情预报。基于这些信息，L2层采用MPC方法计算未来数天到数周的最优闸门操作序列。L2层的控制周期为小时级到天级——日常运行中每隔数小时更新一次调度方案，在水文条件剧变或突发事件时可缩短到小时级甚至更短。

三层架构通过明确定义的接口和信息流协议连接。自上而下：L2向L1下达调度计划和约束条件（目标水位、流量上下限、特殊工况指示），L1向L0下达水位设定值和保护参数。自下而上：L0向L1实时上报闸门状态、水位测量值和报警信息，L1向L2定时上报管理段运行摘要（水位达标率、闸门动作次数、异常事件记录等）。这种"目标向下分解、信息向上汇聚"的双向流机制，实现了全局优化与局部快速响应的有机统一。

值得注意的是，三层架构的设计还考虑了"优雅降级"（Graceful Degradation）能力。当L2层与L1层的通信中断时，L1层切换到"自主保持模式"——按照最近一次有效的调度计划继续运行，同时加强段内水位监控，收紧安全包络以增加安全裕度。当L1层与L0层的通信中断时，L0层切换到"本地安全模式"——维持当前闸门开度不变或缓慢趋向安全位置，同时启动安全联锁保护。这种逐级降级的设计确保了系统在任何单点故障条件下都不会丧失基本的安全保障能力。

#### （3）冰期运行控制

冰期运行是中线工程最具挑战性的工况。冰盖形成改变渠道水力特性——附加阻力使过流能力下降；冰塞可能导致水位急剧上升威胁结构安全。

研究团队发展了冰水力学耦合模型，在圣维南方程基础上增加冰盖热力学方程：

$$\rho_i L_f \frac{d\delta_i}{dt}=\phi_{ia}-\phi_{iw}$$

其中$\rho_i$为冰密度，$L_f$为潜热，$\delta_i$为冰盖厚度，$\phi_{ia}$和$\phi_{iw}$分别为冰-气和冰-水界面热通量。

冰期控制策略的核心是"保温控流"——通过精确控制渠道流速和水位，维持一个稳定的冰盖运行状态。具体而言，流速控制需要在两个临界值之间取得平衡：流速过快（超过约0.7至0.8米/秒的临界破冰流速）会导致冰盖破碎形成大量流冰，流冰在闸门前堆积极易形成冰塞，而冰塞一旦形成，其上游水位可能在数小时内急剧上升数米，构成严重的安全威胁；流速过慢（低于约0.3米/秒）则水体与大气的热交换时间延长，水温下降加速，可能导致冰盖过厚或底冰形成，降低渠道过流能力。因此，冰期运行的流速控制目标是将各渠段流速维持在0.4至0.6米/秒的"安全窗口"内。

水位控制在冰期同样面临特殊要求。冰盖形成后，渠道的有效过流断面减小（冰盖占据了部分断面），为维持相同的输水流量，水位需要相应抬高。但水位抬高又受到渠道超高限制——冰期水位加上冰盖厚度不能超过渠道设计水位。因此，冰期输水流量通常需要较常规工况降低20%至40%，以在安全约束范围内维持稳定运行。

冰期安全包络因此比常规工况更加严格和多维——不仅有水位上下限约束，还有流速范围约束、冰盖厚度约束和输水流量约束，这些约束之间还存在耦合关系（流速影响冰盖厚度，冰盖厚度影响有效过流面积，有效过流面积影响水位）。系统在这一更严格的多维安全包络内实施自主控制，代表了CHS"安全包络"原理在极端工况下的重要工程验证。

冰期运行控制的成功实施也推动了CHS理论在"场景自适应"方面的发展。系统需要能够自动识别冰期的开始和结束（基于气温、水温和冰情监测数据），自动切换控制模式（从常规模式切换到冰期模式），并在冰期内根据冰情的发展动态调整安全包络参数。这种"运行设计域随工况自适应"的能力，是水系统向更高自主等级迈进的关键技术之一。

#### （4）走向更高水平的自主运行

南水北调中线工程的运行实践正在向更高水平的自主运行推进。当前系统的运行能力可以按照WNAL分级体系进行评估：

在常规输水工况下（占全年运行时间的60%至70%），系统已实现L3级别（条件自主运行）——在定义明确的运行设计域内，系统能够根据需水计划和来水条件自主调节各闸门开度，维持全线水位在目标范围内，无需调度员逐闸下达指令。调度员的角色是监督系统运行状态和审批重大调度方案的调整。

在一般性异常工况下（如单个传感器故障、短时通信中断、小幅度来水偏差等，占运行时间的20%至30%），系统处于L2级别（部分自主运行）——系统能够自动检测异常并在局部范围内自主调整控制策略，但需要调度员确认异常的处置方案。

在极端工况下（如大洪水、严重冰期、重大设备故障、水质突发事件等，占运行时间不到5%），系统处于L1级别（辅助运行）——系统提供决策建议和风险预警，但关键决策由调度员做出，系统负责执行。

向更高水平的自主运行推进，面临若干关键挑战。第一是运行设计域的扩展——需要将更多工况类型（特别是复合型异常工况）纳入系统能够自主处理的范围，这要求建立更完善的场景库、更精确的预测模型和更鲁棒的控制策略。第二是异常检测和故障诊断能力的提升——系统需要能够识别"从未见过"的异常模式，而不仅仅是匹配预定义的报警规则；这需要融合物理模型的一致性检验和数据驱动的异常检测方法。第三是人机协作界面的深度优化——随着系统自主程度的提高，调度员需要从"操作者"转变为"监督者"，这要求界面能够清晰展示系统的决策逻辑、置信度和风险评估，使调度员能够在秒级到分钟级内判断是否需要介入。第四是跨省协调机制的标准化——中线工程跨越四省市，不同管理段的调度权限划分和信息共享机制需要进一步标准化和自动化。

### 2.7.4 三大案例的共性启示与理论提炼

综合三个工程案例的实践经验，可以提炼出以下深层次的共性启示：

第一，CHS理论框架具有跨工程类型的普适性。从长距离明渠调水（胶东）到水电梯级联合调度（沙坪）到超大规模跨流域调水（南水北调），CHS核心概念——闭环控制、分层分布式架构、模型预测控制、安全包络、多目标协同——在不同工程中都得到了有效验证。这种普适性源于CHS对水系统运行本质问题的抽象——"感知—建模—预测—优化—执行—反馈"的控制闭环和"安全—稳定—高效"的目标层次是共通的。

第二，从理论到工程的转化需要系统化的验证流程。三个工程一致表明，控制算法从实验室到现场需经历"离线仿真—MIL—SIL—HIL—现场试运行—正式上线"的完整验证链。任何环节的缺失都可能导致上线后性能不达预期。这一认识催生了CHS理论中专门的"在回路测试"方法论（详见§4.5）。

第三，工程实践是理论创新的最重要驱动力。CHS中的许多核心概念——安全包络（源于冰期运行的极端约束需求）、运行设计域（源于多工况切换管理需求）、可控模型族（源于在线控制对精度与效率的折中需求）、双AI引擎（源于数值优化与人工理解之间的鸿沟）——都是在工程中遇到具体问题后经理论抽象而形成的。这种"实践问题→理论概念→工程方法→更广泛实践"的螺旋上升是CHS学科发展的根本动力。

第四，人机协作是当前阶段的现实路径。三个工程经验一致表明，完全自主运行（WNAL L5）尚不现实，但条件自主运行（WNAL L3）在限定ODD内已完全可行且效果显著。人机协作——机器处理常规和可预见工况，人处理异常和不可预见工况——是从L2到L4过渡阶段最务实的策略。

第五，标准化与可复用性是规模化推广的关键。三个工程虽形态各异，但控制架构、建模方法和验证流程具有相当共性。将这些共性抽象为标准化技术规范和可复用软件模块，是CHS从"点上突破"走向"面上推广"的必由之路。HydroOS水网操作系统的设计正基于这一认识——将CHS核心方法封装为标准化组件，使其能在不同工程中快速部署和定制配置（详见§4.4）。

事实上，CHS理论的工程验证并不限于上述三个案例。在城市智慧水务领域，福州市智慧水务系统（供水管网压力优化与漏损控制）和中山市智慧水务系统（排水雨洪协同调度）也在不同程度上应用了CHS框架中的核心方法（详见§3.2）。这些项目与前述三个大型调水/水电案例一起，构成了CHS理论从"长距离调水→水电梯级→超大规模调水→城市水务"的完整工程验证谱系，进一步证实了CHS理论框架的跨领域普适性。

第六，理论与工程的双向驱动是学科持续进步的保障。回顾三大案例的发展历程，可以清晰地看到"工程需求拉动理论创新"和"理论突破推动工程升级"的双向循环。胶东调水工程的大时滞控制难题拉动了MPC方法在水系统中的系统化应用；MPC方法的成功应用又推动了工程管理层对控制自动化的更高期望，进而提出更具挑战性的运行需求。沙坪梯级的多目标冲突拉动了一体化优化方法的发展；优化方法的进步又使"一键调"成为可能，极大提升了梯级调度效率。南水北调的冰期安全问题拉动了冰水力学耦合建模理论的发展；冰期模型的建立又为冰期安全运行提供了科学依据，使冬季输水成为可能。这种理论与工程的良性互动，正是CHS作为一个应用导向学科保持生命力的根本机制。
