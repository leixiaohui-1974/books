<!-- 变更日志
v2 2026-02-16: 根据四角色评审修订——补充术语一致性声明与基础题答案要点，强化课堂落地
v1 2026-02-16: 初稿
-->

# 第五章 经典控制方法

---

## 学习目标

完成本章后，你应能够：

1. 说明 PID/PI 控制在水系统中的适用场景与局限；
2. 设计前馈-反馈组合控制结构并解释其抗扰机理；
3. 识别多变量耦合通道并构建解耦控制的基本思路；
4. 使用 Bode/Nyquist 图进行稳定性与裕度分析；
5. 将经典控制器与 ODD/Safety Envelope 约束联动，形成可上线方案。

> **章首衔接（承接ch04）**  
> 上一章给出 ROM 及其上线校核流程。本章在此基础上回答“给定可计算模型后如何控制”：从单回路 PID/PI 到前馈-反馈与多变量解耦，再到频域整形，构成后续现代控制与 MPC 的共同底座。

> **前章回顾**：上一章介绍了本领域的核心概念与方法。本章在此基础上进一步展开。


## 经典控制在水系统中的角色

在水系统工程中，经典控制并未过时。其核心价值是结构简单、参数可解释、上线风险可控，适合作为“基础层控制器”或“降级控制器”。在 ODD 边界附近，即使上层优化器退出，底层 PI/PID 仍需维持基本稳定与安全。

[表5-1: 经典控制方法的工程定位]
| 方法 | 典型场景 | 优势 | 主要风险 |
|---|---|---|---|
| PI | 慢过程液位/流量控制 | 调参简单，稳态无偏差 | 时滞大时易振荡 |
| PID | 快慢混合过程 | 兼顾响应速度与稳态精度 | 微分噪声敏感 |
| 前馈+反馈 | 扰动可预测场景 | 抗扰更快 | 预测偏差放大 |
| 解耦控制 | 多泵/多闸耦合系统 | 降低回路互扰 | 模型失配导致反耦合 |

## PI/PID 控制基础

### 5.2.1 物理直觉与基本公式

[物理直觉] 反馈控制的本质是“看误差、改动作”。比例项决定立刻反应，积分项消除长期偏差，微分项抑制变化趋势。

[公式]
\[
u(t)=K_p e(t)+K_i\int_0^t e(\xi)d\xi+K_d\frac{de(t)}{dt}
\]

[工程解释] 在液位等慢变量控制中，常先用 PI；仅当扰动变化快且测量噪声可控时再引入微分项。

### 5.2.2 参数整定与抗饱和

参数整定建议遵循“先稳后快”原则：先确保无持续振荡，再逐步提高响应速度。执行器存在开度、速率和最小停留时间约束时，必须配置抗积分饱和（anti-windup）机制，防止恢复阶段超调。

[表5-2: 常见控制异常与整定修正]
| 现象 | 可能原因 | 修正方向 |
|---|---|---|
| 长期偏差 | \(K_i\) 过小 | 适度增加积分作用 |
| 高频振荡 | \(K_p\) 过大/时滞未补偿 | 降低 \(K_p\)，增加滤波 |
| 大超调 | 积分饱和 | 启用 anti-windup |
| 响应迟缓 | \(K_p\) 过小 | 提升比例作用并复核约束 |

## 前馈-反馈组合控制

### 5.3.1 结构与作用机理

在可获得来水或需求预测时，前馈可先行补偿，反馈用于校正剩余误差。两者组合可显著降低峰值偏差与恢复时间。

[公式]
\[
u(t)=u_{fb}(t)+u_{ff}(t)
\]

其中 \(u_{fb}\) 来自反馈回路，\(u_{ff}\) 来自扰动估计通道。

[工程解释] 若预测质量下降，应自动降低前馈权重并回退到保守反馈模式，保持 \(\mathcal{X}_{safe}\subseteq\mathcal{X}_{ODD}\) 约束优先级。

### 5.3.2 实施要点

1. 前馈信号与反馈信号需统一时间戳；
2. 前馈通道应设置幅值上限与速率上限；
3. 前馈失配时触发降级：前馈减权 → 纯反馈 → 人工接管。

[图5-1: 前馈-反馈组合控制与降级路径]
{描述: 左侧为扰动预测与设定值输入，中部为前馈与反馈并联结构，右侧为约束监视器与降级状态机。}
{尺寸: 全页}
{颜色方案: 蓝色系}
{对应ARCH编号: 无（本章自定义教学图）}

## 多变量解耦控制

### 5.4.1 为什么需要解耦

多泵站、多闸门系统常存在“一个动作影响多个输出”的耦合现象。若按单回路独立调节，常出现回路间互相拉扯，导致振荡和能耗上升。

### 5.4.2 基本思路

- 先通过实验或模型识别主耦合通道；
- 构建静态/动态解耦补偿器；
- 在解耦后通道上进行单回路整定；
- 通过 Nyquist/Bode 复核耦合抑制效果。

[图5-2: 双输入双输出系统解耦设计流程]
{描述: 展示“耦合识别→补偿器设计→单回路整定→频域复核→上线监控”五步流程。}
{尺寸: 半页}
{颜色方案: 蓝色系}
{对应ARCH编号: ARCH-04（架构思想借鉴）}

## 频域设计：Bode 与 Nyquist

### 5.5.1 Bode图的工程用途

Bode 图用于观察不同频率下系统增益和相位特性，可直观评估带宽、相位裕度、增益裕度是否满足稳定性要求。

### 5.5.2 Nyquist 判据的工程化理解

Nyquist 曲线围绕 \((-1,0)\) 点的关系可用于判断闭环稳定性。工程中常将其与时域指标联合使用：频域不过关，时域结果即便短期可看，也不应上线。

[表5-3: 频域指标与工程风险映射]
| 指标 | 偏低时风险 | 工程后果 |
|---|---|---|
| 相位裕度 | 易振荡 | 执行器频繁动作、磨损加剧 |
| 增益裕度 | 抗不确定性弱 | 工况波动下失稳概率升高 |
| 带宽 | 响应慢 | 扰动后恢复时间过长 |

## 例题：泵站液位 PI 控制与前馈补偿

【例5-1】某泵站集水池液位控制采用 PI 回路，雨前可获得 1 小时来水预测。请给出“PI+前馈”控制实施步骤，并说明前馈失配时的降级策略。

**已知**：

- 液位约束属于 Safety Envelope 硬约束；
- 泵组启停存在最小停留时间；
- 来水预测存在偏差。

**求解**：

1. 设计控制结构；
2. 说明整定与上线要点；
3. 给出降级顺序。

**解题过程**：

步骤1：构建 PI 反馈主回路，保证稳态液位无偏差。  
步骤2：接入来水预测前馈通道，限制前馈幅值与变化率。  
步骤3：设置 anti-windup 与启停保护，防止饱和和频繁动作。  
步骤4：定义降级策略“前馈减权→纯反馈→人工接管”，并绑定审计日志。

**结果讨论**：

该结构在预测可信时提升抗扰性能，在预测失配时仍可保持保守稳定，符合“可用优先于最优”的工程上线原则。

### 经典控制上线检查清单

- [ ] 是否完成 PI/PID 参数整定记录与版本归档；
- [ ] 是否配置 anti-windup 与执行器保护约束；
- [ ] 是否定义前馈失配降级策略；
- [ ] 是否完成频域稳定裕度复核（Bode/Nyquist）；
- [ ] 是否验证 ODD 边界附近的保守可运行性。

## 本章小结

本章给出经典控制的完整工程链条：PI/PID 基础、前馈-反馈组合、解耦控制与频域设计。核心结论是：经典控制不是“低级替代”，而是水系统分层控制中的稳定底座与安全后盾。下一章将进入现代控制方法，在状态空间框架下讨论 LQR/LQG、鲁棒与自适应控制。

## 习题

### 基础题

**5-1.** 解释 PI 与 PID 在水系统中的典型适用差异。  
**5-2.** 为什么执行器饱和时必须配置 anti-windup？  
**5-3.** 前馈-反馈组合相比纯反馈的主要收益是什么？

### 基础题参考答案要点

**5-4.** PI 适合慢过程稳态控制，PID 适合对动态速度有更高要求且噪声可控场景。  
**5-5.** 执行器饱和会导致积分累积失真，恢复后易产生大超调与长时间振荡。  
**5-6.** 前馈可提前抵消可预测扰动，反馈负责纠偏，组合可降低峰值偏差与恢复时间。

### 应用题

**5-7.** 针对双泵站液位系统，给出一个最小可执行的前馈-反馈控制框架并列出关键约束。  
**5-8.** 某回路相位裕度偏低，请提出两种改进策略并分析副作用。

### 思考题

**5-9.** 在“预测质量波动频繁”的场景中，如何设计前馈权重的自适应调节逻辑，避免频繁误切换？

## 拓展阅读

1. Åström, K.J., & Hägglund, T. *PID Controllers: Theory, Design, and Tuning*.
2. Litrico, X., & Fromion, V. *Modeling and Control of Hydrosystems*.
3. Van Overloop, P.J. *Model Predictive Control on Open Water Systems*.
4. 钱学森. 《工程控制论》.
5. Lei et al. (2025a). 理论背景与研究范式。
