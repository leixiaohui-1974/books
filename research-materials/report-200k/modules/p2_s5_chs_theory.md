## 2.5 水系统控制论：理论框架的升华

### 2.5.1 CHS的提出背景与历程

水系统控制论（Cybernetics of Hydro Systems, CHS）的提出，源于对水利行业一个根本性问题的深刻反思：水利工程"怎么建"有成熟的理论体系（水力学、结构力学、岩土力学等），但"怎么运行好"却缺乏一个统一的理论框架。

长期以来，水系统运行领域的研究呈现出高度碎片化的状态：水库调度属于水资源规划方向，洪水预报属于水文学方向，渠道控制属于灌溉排水方向，水质管理属于环境工程方向。这些方向各自为政，使用不同的理论语言和方法论，缺乏一个统一的学科框架来整合和协调。

雷晓辉教授在长期的跨领域工程实践中——包括南水北调中线工程调度控制、雅砻江水电梯级联合调度、福州和中山等城市供排水系统优化、长江上游防洪调度、以及生态调度和水文水动力模拟等——深刻认识到了这一问题。他发现，尽管不同类型的水系统在物理特性、工程规模和运行目标上差异巨大，但在"运行"层面却遵循相同的基本规律：都涉及感知（获取系统状态信息）、决策（根据目标和约束计算控制方案）、执行（通过闸门、泵站等执行控制动作）和反馈（根据执行效果调整决策）的闭环过程。这种跨越工程类型的共性，正是控制论所揭示的普遍规律。

2022年前后，雷晓辉教授开始系统地提出水系统控制的相关思想，探索用统一的控制论框架来描述和求解水系统运行中的各类问题。这一探索建立在他二十余年的跨领域工程实践和理论积累之上：在中国水利水电科学研究院的工作使他熟悉了水力学建模和数值仿真的核心方法；在日本筑波大学的留学经历使他接受了系统工程和控制理论的严格训练；主持南水北调东线和中线两个国家重点研发计划项目的经验使他深刻理解了超大规模水系统运行的工程复杂性。正是这种横跨水力学、控制论和工程实践的独特知识结构，使他能够识别出传统学科分割的根本问题，并提出跨学科整合的理论方案。

2025年初，他全职加入河北工程大学担任学术副校长，获得了更加专注于理论研究和学科建设的平台。同年，他正式命名了"水系统控制论（Cybernetics of Hydro Systems, CHS）"这一理论框架，并在《南水北调与水利科技》等期刊上发表了系列论文（Lei 2025a—2025d），分别从CHS理论总述、水网自主运行概念框架、在回路测试方法论和水资源系统分析四个维度展开论述，标志着这一理论体系的正式确立。与此同时，他启动了CHS理论的系统化教材编写工程，规划了覆盖入门、基础、专题和前沿四个层次的16册教材体系，旨在为水系统运行科学与工程的人才培养提供完整的知识供给。

CHS的命名本身蕴含着深刻的学科渊源。"Cybernetics"直接致敬了维纳1948年的开创性工作，表明CHS是控制论在水系统领域的系统性应用和发展。"Hydro Systems"则强调了研究对象的系统性——不是单个水库或单条渠道，而是作为整体的水系统。这一命名也将CHS与钱学森《工程控制论》的学术传统联系起来——CHS可以被视为"工程控制论"在水系统领域的当代延伸。



> **图 2-1　CHS六要素闭环架构**
>
> ```
>                    ┌─────────────────────────────────────────┐
>                    │         ⑥ 人机界面（HMI）                │
>                    │   战略监督 · 异常接管 · 知识注入          │
>                    └────────┬───────────────────┬────────────┘
>                             │ 指令/确认          │ 态势呈现
>        ┌───────────────────────────────────────────────────────┐
>        │                 ⑤ 通信网络                             │
>        │   5G/光纤/卫星 · 边缘-区域-中央拓扑 · 时延补偿        │
>        └──┬──────────┬──────────┬──────────┬──────────┬───────┘
>           │          │          │          │          │
>      ┌────▼───┐ ┌────▼───┐ ┌────▼────┐ ┌──▼────┐ ┌──▼────┐
>      │① 感知  │ │② 可控  │ │③ 控制器 │ │④ 执行 │ │  反馈  │
>      │  网络  │→│ 模型族 │→│  集合   │→│ 系统  │→│  回路  │
>      └────────┘ └────────┘ └─────────┘ └───────┘ └───────┘
>       水位/流量    I/ID/IDZ   PID/MPC/    闸门/泵站   SCADA采集
>       水质/雨量    /LSV/SV    DMPC/RL     阀门/电机   →① 感知
>       视频/遥感    +专家规则  +MAS协商                 (闭环)
> ```
>
> 六要素构成"感知→建模→决策→执行→反馈"的完整闭环，人机界面贯穿全过程。


### 2.5.2 CHS的核心理论追求：六个维度的统一

CHS的核心理论追求，是用一个统一的控制论框架整合目前水利行业高度碎片化的各种细分专业和学科体系。这种统一性体现在六个维度。

**第一，多类型统一。** 调水工程、水电梯级、灌区渠系、城市供排水、流域防洪、生态调度等不同工程类型，在CHS框架下都是"水系统"，都遵循"感知→决策→执行→反馈"的闭环控制基本规律。

以南水北调中线工程和城市供水管网为例。前者是全长1432公里的长距离明渠调水工程，后者是管道、泵站、水厂组成的城市有压供水网络。两者在物理特性上差异巨大：前者是明渠重力流，时间尺度为小时至天级，控制执行器主要是节制闸；后者是有压管道流，时间尺度为分钟至小时级，控制执行器主要是加压泵和调节阀。然而，从控制论的视角来看，两者的运行问题具有本质共性：都需要感知系统状态（水位/压力、流量、水质等）、预测未来变化（需水量预测、来水预测）、计算最优控制方案（MPC优化）、执行控制动作（闸门/泵站调节）并根据反馈进行调整（滚动优化）。

再以水力发电和灌溉供水为例。前者的核心目标是发电效益最大化，后者的核心目标是供水可靠性最大化——看似完全不同的优化问题。但在CHS框架下，两者都可以统一表示为：在水量平衡约束和安全约束下，寻找执行器操作序列使目标函数最优。不同之处仅在于目标函数的具体形式（发电功率积分 vs. 供水缺口惩罚）和约束条件的具体内容（机组工况约束 vs. 渠道水位约束）。

CHS的"多类型统一"，就是提供一个通用的理论语言和方法论框架，使得不同类型水系统的运行问题能够用相同的思维方式和技术工具来分析和求解。这种统一性的实践价值在于：一套核心算法（如MPC）经过适当的参数化和定制，可以部署在多种不同类型的水系统中，大幅降低技术开发和维护成本。

**第二，多目标统一。** 防洪、供水、发电、生态、航运、水质等运行目标，在CHS框架下统一表示为多目标优化控制问题。

以三峡水库为例，其防洪、发电、航运、供水、生态等功能之间存在复杂的竞争与协调关系。在传统碎片化研究模式下，这些目标由不同部门和研究团队分别处理。CHS的多目标统一将所有目标纳入同一个控制论框架，表示为目标函数和约束条件，通过帕累托多目标优化方法系统求解。

**第三，多尺度统一。** 从秒级的实时闸泵控制，到小时级的防洪调度，到月/年级的水资源配置，在CHS框架下都是不同时间尺度的控制问题。

传统上，这些不同时间尺度的问题分属不同学科方向，使用完全不同的方法论：实时控制属于自动化方向，短期调度属于运筹学方向，长期规划属于水资源规划方向。这种学科分割导致了一个普遍存在的问题——不同时间尺度的决策之间缺乏有效衔接。例如，年度水资源配置方案可能没有考虑日级调度的实际可操作性，而日级调度方案又可能偏离年度配置的整体意图。

CHS的多尺度统一通过分层控制架构来实现：上层（战略层）处理长期水资源配置问题，其输出（如月度或旬度的水量分配方案）作为中层（战术层）短期调度的约束和目标；中层处理日级或实时调度问题，其输出（如小时级的闸门操作序列）传递给下层（执行层）的实时控制。各层之间通过标准化的接口进行信息传递和目标分解，形成一个多尺度协同的控制体系。

更深层次的统一体现在方法论上。CHS认为，无论时间尺度如何，运行问题的本质都是"在约束条件下寻找最优决策"——区别仅在于决策变量的粒度（年度水量 vs. 实时闸门开度）、约束条件的类型（水权分配 vs. 水位安全限）和目标函数的形式（年供水保证率 vs. 瞬时水位偏差）。MPC方法的滚动优化思想天然地适用于多种时间尺度——改变预测域的长度和控制域的步长，同一套MPC框架就可以在不同的时间尺度上运行。

**第四，多主体统一。** 从单个闸门的本地控制器，到区域调度中心，到流域级决策机构，在CHS框架下都是多智能体系统（Multi-Agent System, MAS）中的"智能体"。

水系统的运行决策通常涉及多个决策主体，这些主体可能有不同的利益诉求和信息集合。以南水北调中线工程为例，水源区丹江口水库的管理方关注水库蓄水效益，总干渠的各分水口门管理方关注取水保障率，沿线地方政府关注防洪安全和生态用水——这些主体的利益并不总是一致的。在极端枯水年份，水库管理方倾向于蓄水，而下游用水户需要放水，产生直接的利益冲突。传统的集中式调度模式通过行政命令来解决这种冲突——但当系统规模扩大到覆盖多个省市、涉及数百个利益相关方时，纯行政协调的效率和精度都难以保证。CHS的多主体统一通过MAS理论框架来实现：每个控制节点被建模为一个具有局部信息、局部目标和局部决策能力的智能体，通过智能体之间的通信和协商来实现全局协调。协商机制可以是合同网协议（Contract Net Protocol，适用于任务分配场景）、拍卖机制（适用于水权交易场景）或纳什谈判（适用于利益平衡场景）。这一框架既能处理集中式决策场景，也能处理分布式协商场景，为水系统运行的组织形式提供了灵活的理论支持。

**第五，知识表示统一。** 将物理模型（机理方程）、数据模型（机器学习）和经验模型（专家规则）统一为"可控模型族"。

传统上，水系统运行中使用的模型种类繁多——水力学模型、水文模型、统计模型、神经网络模型等，各有特点和适用范围。更突出的问题是，调度专家的经验知识往往以"规则"或"惯例"的形式存在于人的头脑中，无法被形式化地纳入任何数学模型——例如"冰期来临前三天开始预降水位"这样的经验规则，在传统的优化模型中找不到自然的表达位置。CHS提出"可控模型族"的概念，不仅将数学模型按照精度和计算代价的层次排列，形成一个从高阶（圣维南方程全模型）到中阶（IDZ传递函数模型）再到低阶（线性代理模型）的模型谱系，更将专家经验编码为形式化的规则库，作为模型族中"定性知识"维度的组成部分。控制器设计者可以根据控制需求和计算资源从中选取最合适的模型。在运行过程中，系统可以根据工况的复杂程度动态切换模型精度等级，实现精度与效率的最优平衡。



> **表 2-1　CHS可控模型族层次体系**
>
> | 层级 | 模型名称 | 数学形式 | 计算速度 | 精度 | 典型应用场景 |
> |:----:|:--------:|:--------:|:--------:|:----:|:------------|
> | L1 | 积分（I）模型 | 一阶积分环节 | ★★★★★ | ★ | 参数灵敏度分析、初步设计 |
> | L2 | 积分-延迟（ID）模型 | 积分+纯延迟 | ★★★★☆ | ★★ | 快速参数扫描、离线预筛选 |
> | L3 | 积分-延迟-零点（IDZ）模型 | 二阶传递函数+延迟 | ★★★☆☆ | ★★★ | **实时MPC优化（主力模型）** |
> | L4 | 线性圣维南（LSV）模型 | 线性化偏微分方程 | ★★☆☆☆ | ★★★★ | 高保真验证、安全包络计算 |
> | L5 | 完整圣维南（SV）模型 | 非线性偏微分方程 | ★☆☆☆☆ | ★★★★★ | 洪水风险评估、极端工况仿真 |
> | — | 专家规则库 | IF-THEN规则+模糊逻辑 | ★★★★★ | 定性 | 冰期预判、异常工况识别 |


这种动态切换的实际场景是：在日常平稳运行中，系统使用低阶代理模型进行快速实时控制，计算速度快但精度有限；当检测到异常工况（如上游突发来水增加）时，系统自动切换到中阶IDZ模型以获得更准确的预测；在需要进行洪水风险评估或复杂调度方案优化时，系统调用高阶圣维南全模型进行精细仿真。整个切换过程对上层控制算法透明——这正是HydroOS"模型即服务"架构的理论基础。

**第六，分层分布式统一。** 将水系统的控制架构统一为"分层分布式"范式。

水系统天然具有层次结构——从单个闸泵到渠段/管段，到干线/支线，到全系统/全流域。CHS将这种天然的层次结构映射为分层分布式控制（HDC）架构，在每一层设置相应的控制逻辑，通过层间的信息传递和目标分解实现全局协调。HDC架构的优势在于它同时兼顾了全局最优性（通过自上而下的目标分解）和局部自主性（每一层可以独立处理其能力范围内的问题），是应对大规模水系统控制问题的有效框架。

### 2.5.3 CHS的八原理体系

在"六个统一"的基础上，CHS进一步凝练了支撑水系统自主运行的八条基本原理：

| 原理序号 | 原理名称 | 核心内涵 |
|:---------|:---------|:---------|
| 原理一 | 传递函数化 | 将水系统的物理过程转化为控制理论可用的传递函数或状态空间模型 |
| 原理二 | 可控可观性 | 在部署控制算法之前，先诊断系统的可控性和可观性，识别结构性瓶颈 |
| 原理三 | 安全包络 | 为系统定义刚性安全边界，确保在任何工况下都不突破关键安全指标 |
| 原理四 | 分层分布式 | 采用多层次、多节点的分布式控制架构，兼顾全局协调和局部自主 |
| 原理五 | 多目标协同 | 在统一的优化框架下处理多个相互竞争的运行目标 |
| 原理六 | 数据物理融合 | 将物理机理模型与数据驱动方法有机结合，发挥各自优势 |
| 原理七 | 人机共融 | 根据自主等级定义人与机器的职责分配，实现平滑的人机协作过渡 |
| 原理八 | 自主演进 | 系统具备从运行经验中持续学习的能力，逐步提升自主等级 |

以下对八条原理逐一展开阐述。

**原理一：传递函数化。** 这是CHS全部方法论的基石。水系统的物理过程由偏微分方程（如圣维南方程、管网水力方程）描述，这些方程虽然物理意义明确，但由于非线性和分布参数特性，无法直接用于控制器设计。"传递函数化"要求将这些复杂的物理模型通过线性化、降阶和离散化等步骤，转化为控制理论可以直接处理的传递函数或状态空间模型。以明渠系统为例，圣维南方程经过线性化和频域近似后，可以转化为IDZ传递函数模型（见§2.4）；以管网系统为例，管网水力方程经过线性化后可以转化为节点压力—管段流量的状态空间模型。传递函数化不是对物理模型的"简化"或"近似"——它是一种系统化的"翻译"，将水力学家的语言翻译为控制工程师的语言，使得两个学科能够在同一个数学框架下对话和协作。CHS进一步提出了"可控模型族"的概念，将不同精度等级的模型组织为一个层次化的模型体系，在不同应用场景中选用最合适的模型层级。

**原理二：可控可观性诊断。** 在部署任何控制算法之前，必须先回答一个根本性问题：这个系统在结构上是否可控？系统的状态是否可观？如果一个水系统在某些工况下结构不可控（即无论如何调节闸门都无法将水位调到目标值），或者结构不可观（即现有的传感器无法提供足够的信息来推断系统的完整状态），那么再先进的控制算法也无济于事。可控可观性诊断是对"硬件是否就绪"的系统性评估。在工程实践中，这一原理要求在控制系统设计之前，先进行可控性分析（判断执行器配置是否充分）和可观性分析（判断传感器配置是否充分），如果存在可控性或可观性缺陷，应首先通过增加执行器或传感器来解决结构性问题，而不是试图用更复杂的算法来弥补硬件的不足。这一"先诊断、后设计"的思路，在水利行业中具有重要的实践指导意义——许多水利工程的控制效果不佳，根本原因不在于算法不够先进，而在于传感器布局不合理或执行器配置不充分。

**原理三：安全包络。** 安全包络（Safety Envelope）是一组在任何情况下都不得违反的刚性约束集合，数学上表示为：$\mathbf{x}(t) \in \mathcal{X}_{safe}, \forall t$。安全包络的设计遵循"防御性设计"理念——即使控制算法出现故障、模型出现偏差或通信出现中断，系统的状态也不应超出安全包络的边界。在水系统中，安全包络通常包括水位上下限（防止溢流或干渠）、流速范围（防止冲刷或淤积）、水质阈值（防止水质恶化）和设备运行边界（防止设备损坏）。安全包络的设计需要考虑最不利工况下的极端情形——例如，在冰期运行条件下，南水北调中线工程的安全包络比常规工况更为严格，不仅包括水位约束，还包括流速范围约束和冰盖厚度约束。安全包络是CHS理论中"安全优先"思想的数学化表达，也是系统能够获得公众信任和监管认可的前提条件。

**原理四：分层分布式。** 大规模水系统的控制不可能由一个集中式控制器来完成——超长距离的信息传输延迟、超高维度的优化计算复杂度和单点故障的系统可靠性风险，都要求采用分层分布式架构。CHS将水系统的控制架构划分为多个层级：底层（L0）负责单个执行器的本地控制，响应速度为秒级；中层（L1）负责局部区域的协调控制，响应速度为分钟级；上层（L2）负责全系统的优化调度，响应速度为小时级到天级。各层之间通过标准化的接口传递信息和指令：自上而下传递目标和约束，自下而上传递状态和报告。分层分布式架构的关键优势在于"降维"——将一个不可求解的大规模全局优化问题，分解为多个可以高效求解的小规模局部优化问题，同时通过层间协调保持全局一致性。

**原理五：多目标协同。** 水系统运行几乎总是面临多个相互竞争的目标——供水可靠性与节水效率、发电效益与防洪安全、运行经济性与环境生态性。CHS将多目标问题统一表示为带约束的多目标优化问题，通过帕累托最优（Pareto Optimality）的概念来处理目标之间的折中。在工程实施中，多目标协同通常通过加权目标函数法（将多个目标加权求和为单一目标）或字典序法（按优先级依次优化）来实现，权重系数可以根据季节、工况和管理需求动态调整。

**原理六：数据物理融合。** 纯物理模型（如圣维南方程）具有明确的物理意义和良好的外推能力，但参数标定困难、计算成本高；纯数据模型（如神经网络）训练方便、计算快速，但缺乏物理一致性保障且外推能力不足。CHS倡导将两者有机融合——用物理模型提供结构约束和先验知识，用数据模型补偿物理模型的残差和不确定性。典型的融合方式包括：物理引导的神经网络（Physics-Informed Neural Networks, PINNs）、基于物理模型的残差学习、物理约束下的强化学习等。数据物理融合不是简单的"两个模型并行运行"，而是在数学上实现深度耦合——物理方程作为神经网络的损失函数约束，数据驱动的参数辨识反过来校正物理模型的不确定参数。

**原理七：人机共融。** 在当前技术条件下，完全取代人的判断和决策既不现实也不明智。CHS提出的人机共融原理，通过WSAL分级体系（见§2.5.4）来定义不同自主等级下人与机器的职责边界。在低自主等级（L0—L1），人是主要的决策者，机器提供信息支持；在中等自主等级（L2—L3），机器在限定条件下自主决策，人负责监督和异常处置；在高自主等级（L4—L5），机器处理绝大部分决策，人仅做战略级指导。人机共融的设计需要同时考虑技术因素（系统能做什么）和人因工程因素（人如何有效地监督和介入），避免两个极端——过度依赖自动化导致人的"技能退化"（De-skilling），或过度依赖人工导致自动化优势无法发挥。

**原理八：自主演进。** 水系统的运行环境不是静态的——气候变化导致水文特性发生变化，工程老化导致设备参数发生漂移，用水需求变化导致运行目标发生调整。CHS的自主演进原理要求系统具备从运行经验中持续学习和适应的能力。具体机制包括：在线参数辨识（根据运行数据实时更新模型参数）、案例库学习（将成功处置的异常工况记录为案例，扩充系统的处置能力）、策略进化（根据运行绩效评估结果优化控制策略参数）和ODD扩展（在验证安全的前提下逐步扩大自主运行的工况范围）。自主演进是CHS与传统自动化控制的根本区别——传统自动化系统的行为在上线后基本固定，而CHS系统则具备"越运行越聪明"的自我进化能力。

以水力模型参数的在线辨识为具体例子。一条调水渠道的糙率系数会随着季节变化（夏季生物附着增加糙率、冬季冰盖改变流态）和工程老化（混凝土表面逐渐粗糙化）而缓慢变化。传统做法是每年进行一到两次的人工率定——派遣技术人员到现场测量，然后手动修正模型参数。CHS的自主演进机制则利用常态化的水位和流量监测数据，通过扩展卡尔曼滤波（EKF）或集合卡尔曼滤波（EnKF）在线实时辨识糙率参数——模型参数随物理系统的变化而自动更新，无需人工干预。更进一步，如果系统在运行中遇到了前所未有的极端工况（如百年一遇的特大洪水），该事件的完整记录——包括传感器数据、模型预测、控制动作和最终效果——将被自动归档到案例库中。下一次遇到类似工况时，系统可以检索相关案例作为决策参考，而不必完全依赖物理模型的外推能力。这种"案例+模型"的混合决策机制，使系统的能力边界随运行经验的积累而不断扩展。

八原理之间并非平行并列的关系，而是具有明确的依赖和递进逻辑。原理一至三构成"可计算、可设计、可验证"的基础底座——如果一个水系统的控制模型无法建立（违反原理一），或者系统在结构上不可控不可观（违反原理二），或者缺乏安全保障机制（违反原理三），那么后续的一切高阶能力都无从谈起。原理四至六构成"从单点到系统、从单一到融合"的方法扩展层——分层分布式架构解决了规模问题，多目标协同解决了目标冲突问题，数据物理融合解决了模型精度与效率的折中问题。原理七至八构成"从自动到自主"的能力跃迁层——人机共融定义了当前阶段的运行模式，自主演进描绘了未来的发展方向。

这种分层递进的结构，确保了CHS理论体系的工程可落地性——不是一步到位地追求完全自主运行（L5），而是从基础底座开始，逐层积累，渐进演化。

### 2.5.4 水网自主等级（WSAL）

CHS的另一个核心贡献是提出了水网自主等级（Water-network System Autonomy Level, WSAL）分级体系，将水网运行的自主化程度分为L0至L5六个等级：

| 等级 | 名称 | 描述 | 人机关系 |
|:-----|:-----|:-----|:---------|
| L0 | 人工运行 | 完全人工观测、人工决策、人工操作 | 人执行一切 |
| L1 | 辅助运行 | SCADA提供监测信息，人工决策和操作，部分本地自动控制 | 人决策，机器辅助信息 |
| L2 | 部分自主 | 系统在正常工况下自动运行特定任务，人监督并随时接管 | 人监督，机器执行常规 |
| L3 | 条件自主 | 在定义的ODD内自主运行，超出ODD时请求人工接管 | 人待命，机器自主运行 |
| L4 | 高度自主 | 在更广泛的ODD内自主运行，自动处理多数异常 | 人远程监督 |
| L5 | 完全自主 | 在所有工况下自主运行，无需人工干预 | 人仅做战略决策 |

WSAL的灵感来自自动驾驶领域的SAE J3016分级标准，但针对水系统的特殊性进行了重要调整。与自动驾驶的SAE分级相比，WSAL的关键差异在于：

第一，WSAL引入了"运行设计域"（Operational Design Domain, ODD）的概念。ODD定义了系统可以自主运行的条件范围——包括水文条件（流量范围、水位范围）、气象条件（是否冰期）、设备状态（哪些闸门可用）和安全约束（最高/最低水位）。系统只在ODD范围内自主运行；一旦超出ODD，自动进入"最小风险状态"并请求人工接管。ODD的定义不是一成不变的——随着系统运行经验的积累和算法能力的提升，ODD可以逐步扩展，从而实现自主等级的渐进提升。

以南水北调中线工程为例，其当前的ODD可能定义为："设计流量的30%至100%范围内、非冰期、所有关键闸门正常工作、通信链路完好"。在这一ODD范围内，系统以L3等级自主运行。当进入冰期（超出ODD的气象条件）或发生关键闸门故障（超出ODD的设备条件）时，系统自动降级到L1或L2，增加人工干预比例。随着冰期控制算法的成熟和验证，冰期工况可以逐步纳入ODD，实现从"冰期需要人工接管"到"冰期也能自主运行"的能力提升。

第二，WSAL的"安全包络"（Safety Envelope）是一个刚性约束集合，满足$\mathcal{X}_{safe} \subseteq \mathcal{X}_{ODD}$。安全包络不是"建议值"或"参考值"，而是系统在任何情况下都不得突破的绝对边界。安全包络的实施机制是多层次的：控制算法在优化求解时将安全包络作为硬约束纳入；即使优化算法输出了超出安全包络的指令，执行层的安全联锁机制也会拦截并拒绝执行；即使联锁机制失效，物理层面的安全设施（如溢洪道、退水闸）也会作为最后一道防线发挥作用。这种多层次的安全保障机制，体现了"纵深防御"（Defense in Depth）的安全设计理念。

第三，WSAL考虑了水系统特有的多时间尺度特性。水系统的运行决策跨越从秒级（闸门控制）到季节级（水资源配置）的多个时间尺度，在不同时间尺度上的自主等级可以不同——例如，一个系统在秒级的闸门控制上可能达到L3，但在季节级的水资源配置上仍处于L1。这种"分时标分级"的设计，比自动驾驶的单一分级更加灵活，也更符合水系统运行的实际需求。

第四，WSAL的分级评估需要配套的量化指标体系。CHS建议从四个维度评估自主等级：自主决策覆盖率（系统自主处理的决策比例）、安全包络保持率（系统状态保持在安全包络内的时间比例）、人工干预频率（单位时间内需要人工介入的次数）和故障恢复时间（从检测到异常到恢复正常运行的时间）。这四个指标分别从能力、安全、人机协作和韧性四个角度刻画了系统的自主运行水平。

当前，全球大多数水利工程处于WSAL L1至L2水平——SCADA系统提供监测信息，部分闸门实现了本地自动控制，但调度决策仍主要依赖人工。少数先进系统达到了L2至L3水平，如胶东调水工程的SCADA+HDC系统在正常输水工况下已实现条件自主（L3），荷兰Maeslantkering风暴潮屏障在特定触发条件下可自主关闭闸门（L3）。达到L4及以上水平，需要在模型精度、异常处理能力、安全保障机制和社会信任建设等方面取得根本性突破，是CHS的长期研究目标。

WSAL分级体系的一个重要配套需求是建立系统化的等级认证和验证方法论。与自动驾驶领域已形成较为成熟的测试评价标准（如EURO NCAP、ISO 21448 SOTIF）不同，水利领域目前尚无类似的自主等级认证框架。CHS提出了基于xIL（在回路测试）的验证方法论：L2认证要求通过MIL（模型在回路）仿真验证在所有预设工况下控制算法的正确性和安全性；L3认证要求在MIL基础上增加SIL（软件在回路）验证，确认算法在真实软件环境中的运行时序、通信延迟和异常处理能力；L4认证则要求进一步通过HIL（硬件在回路）验证，在半实物仿真环境中测试算法与真实PLC、RTU和通信网络的兼容性和可靠性。每一级的认证都要求比前一级更广泛的ODD覆盖和更严格的安全保障指标——这种"渐进认证、逐级放权"的方法论，借鉴了航空适航认证（DO-178C）的成熟思路，但根据水系统的时间尺度和空间分布特性进行了适当简化，确保在安全可控的前提下推进自主化进程。

## 2.6 CHS与水信息学的辨析

CHS（水系统控制论）和水信息学（Hydroinformatics）都关注信息技术在水系统中的应用，但二者在学科定位、理论内核和方法论上存在本质差异。厘清二者的关系，对于理解水系统运行科学与工程的学科结构具有重要意义。这一辨析不是为了在两个方向之间分高下，而是为了帮助研究者和工程师正确地定位自己的工作，选择合适的理论工具。

### 2.6.1 学科定位与历史渊源的差异

水信息学的创始人迈克尔·阿博特（Michael B. Abbott）在1991年正式提出了"Hydroinformatics"的概念，并在随后的著作中系统阐述了这一学科的内涵和外延。阿博特将水信息学定义为信息技术在水科学与水工程中的应用，其产生的直接背景是20世纪80-90年代信息技术革命对水利行业的冲击——计算机图形学使得水力学仿真结果可以可视化展示，互联网技术使得水文数据可以远程共享，数据库技术使得海量的观测数据可以高效管理。水信息学的核心关注点是"信息"——如何获取、传输、存储、处理和可视化水系统的信息。其方法论主要来源于计算机科学和信息科学，包括数据库管理、网络通信、人机交互、软件工程等。

CHS的学科定位则是水系统运行的"基础理论学科"——它不仅仅是将某种已有的理论或技术"应用于"水系统，而是要针对水系统运行的特殊需求，发展专门的理论框架和方法论。CHS的核心关注点是"控制"——如何使水系统在复杂多变的环境中实现安全、高效、可持续的运行。其方法论主要来源于控制科学、系统科学和优化理论，包括反馈控制、模型预测控制、分布式优化、鲁棒控制、自适应控制等。

从方法论特征上看，两者的差异可以从以下维度来把握：水信息学倾向于"数据驱动"的研究范式——强调从大量观测数据中提取规律和知识，方法上偏重统计分析、机器学习和数据挖掘。CHS倾向于"模型驱动"与"数据增强"相结合的研究范式——以物理模型（如圣维南方程、IDZ模型）为核心，用数据方法对模型进行校正和增强，方法上偏重动力学建模、最优控制和系统辨识。这一差异并非绝对——两个方向在技术实践中都在走向"模型+数据"的融合，但在理论出发点和方法论偏好上仍有明确的分野。

### 2.6.2 一个类比：驾驶与仪表盘

CHS和水信息学的关系，可以用"驾驶"与"仪表盘"的类比来理解。CHS关注的是"如何驾驶"——控制策略、决策逻辑、安全保障、人机分工，相当于方向盘、油门和刹车。水信息学关注的是"仪表盘和导航系统"——如何为驾驶员提供速度、油量、路线等信息。两者缺一不可，共同服务于"安全高效地到达目的地"这一最终目标。

但必须指出的是，在一辆汽车中，"驾驶系统"（动力总成、转向系统、制动系统）的理论基础——力学、控制理论——是独立于"仪表系统"（传感器、显示器、通信模块）的理论基础——电子学、信息论——而存在的。同样，CHS的理论内核（控制论、优化理论、系统科学）独立于水信息学的技术基础（数据库、通信协议、人机界面）。二者在应用中深度融合，但在理论上各有独立的学科根基。

### 2.6.3 各自在水系统运行中的角色

在水系统运行科学与工程的学科架构中，CHS和水信息学各有明确的角色定位：

CHS（水系统控制论）是理论内核——它提供了水系统运行的基本范式（闭环控制）、理论框架（六个统一、八原理）和方法论体系（从PID到MPC到MAS再到自主运行）。CHS回答的是"为什么这样控制"和"如何最优地控制"的理论问题。

水信息学（Hydroinformatics）是技术支撑——它提供了实现闭环控制所需的信息技术工具和平台，包括数据采集与传输、信息融合与处理、模型集成与可视化、决策支持与人机交互等。水信息学回答的是"用什么技术手段来实现"的工程问题。

这一定位并非贬低水信息学的价值——事实上，没有水信息学提供的信息技术支撑，CHS的理论再完美也无法落地。就像没有发动机管理系统（ECU），再好的发动机设计也无法高效运行。两个方向是互补共生的关系，共同构成水系统运行科学与工程的完整学科体系。

从发展趋势来看，CHS和水信息学都在向彼此的传统领地"渗透"：水信息学从最初关注数据管理和可视化，越来越多地涉及预测建模和决策支持，已开始触及控制和优化的问题边界；CHS从最初聚焦于物理建模和控制算法设计，越来越多地引入机器学习和大数据分析方法，深度融入了信息技术的成果。这种双向渗透是学科进步的自然结果，但它不意味着两个方向将最终合并——正如电气工程和计算机科学虽然密切交叉但始终保持各自的学科独立性一样，CHS和水信息学在理论内核和方法论传统上的根本差异决定了它们将长期并存、协同发展。

需要再次强调的是，在学科层级上，水信息学作为一个应用层面的交叉方向，不与系统科学、控制科学、人工智能这三大基础性理论支柱并列。CHS从控制科学出发，以系统科学为认识论基础，以人工智能为技术赋能，三者共同构成了水系统运行科学与工程的理论根基。水信息学则在这一理论根基之上，提供了面向工程实现的技术方案和集成平台。这一层次关系的厘清，对于水系统运行学科体系的健康发展具有重要意义。

