<!-- 变更日志
v1 2026-02-16: 初稿
-->

# 第六章 频率域辨识方法

---

## 学习目标

完成本章后，你应能够：

1. 理解频率域辨识在明渠降阶模型中的定位与优势；
2. 掌握频响函数（FRF）估计的基本流程与数据要求；
3. 使用 Bode 图判断增益、相位与时滞特性；
4. 基于频域指标率定低阶 Transfer Function / IDZ 候选模型；
5. 识别频域辨识的噪声风险与工程门禁要求。

## 6.1 章间衔接：从时域率定到频域校核

前一章完成了 Muskingum 类模型的时域演算与率定。本章转向频率域辨识，其核心价值不在替代时域方法，而在补充“不同频段下模型是否可靠”的信息。对于在线控制系统，这一点尤为关键。

[物理直觉] 同一模型可能在慢变化工况下拟合很好，但在快速扰动下出现相位误差。频率域分析正是把这种“频段差异”显式化。

## 6.2 频率响应与辨识对象

对线性近似系统，有：

$$
G(j\omega)=\frac{Y(j\omega)}{U(j\omega)}
$$

其中 $|G(j\omega)|$ 给出幅值比，$\angle G(j\omega)$ 给出相位差。

[工程解释] 在明渠场景中，低频段常对应调度趋势项，中频段对应操作扰动传播，高频段更多受测量噪声和局部未建模动态影响。因此，工程辨识通常关注“控制相关频段”的拟合质量，而非全频段极致最优。

[表6-1: 频段—工程含义—建模关注点]
{描述: 低/中/高频段对应的运行现象、控制敏感性、常见误差来源。}
{尺寸: 半页}
{颜色方案: 灰度}

## 6.3 FRF 估计流程

推荐流程如下：

1. 设计激励信号（阶跃序列、PRBS 或多正弦）；
2. 采集输入 $u(t)$ 与输出 $y(t)$，执行去趋势与异常点处理；
3. 用 FFT 计算功率谱与互谱，估计 FRF；
4. 计算相干函数用于判定数据可信度；
5. 在可信频段拟合候选低阶模型参数。

常用相干函数定义：

$$
\gamma^2(\omega)=\frac{|S_{uy}(\omega)|^2}{S_{uu}(\omega)S_{yy}(\omega)}
$$

当 $\gamma^2(\omega)$ 持续较低时，意味着该频段噪声主导或非线性影响显著，不宜用于参数主率定。

[图6-1: 频域辨识流程与数据门禁]
{描述: 激励设计→数据采集→谱估计→相干筛选→模型拟合→上线门禁。}
{尺寸: 全页}
{颜色方案: 蓝色系}

## 6.4 从 Bode 图提取模型参数

### 6.4.1 传递函数参数

- 低频增益近似给出静态增益 $K$；
- 斜率变化点可估计时间常数 $T$；
- 相位近似线性下降区可估计延时 $\tau$。

### 6.4.2 IDZ 参数

- 低频相位特征体现积分环节；
- 中频相位补偿需求可映射零点 $z$；
- 相位整体平移对应 $\tau$。

[工程解释] 频域参数不是“直接替代时域率定”，而是提供稳健初值与频段一致性约束，最终仍需在时域闭环中验证。

## 6.5 可复现实例：单渠段 FRF 辨识

【例6-1】某渠段在 ODD 内施加小幅 PRBS 激励，采样周期 10 s，采样总长 6 h。经处理后在频段 $\omega\in[2\times10^{-4},1.2\times10^{-3}]\,\text{rad/s}$ 内相干函数均值为 0.86。

**已知**：
- 低频幅值平台约为 -8 dB；
- 相位在中频近似线性下降，拟合斜率对应延时约 300 s；
- 拐点频率约 $1.0\times10^{-3}\,\text{rad/s}$。

**求解**：估算一阶滞后模型初值。

**解题过程**：

步骤1：由 -8 dB 求增益
$$
K\approx 10^{-8/20}=0.398
$$

步骤2：由拐点频率估计时间常数
$$
T\approx \frac{1}{\omega_c}=1000\,\text{s}
$$

步骤3：由相位线性区估计延时
$$
\tau\approx 300\,\text{s}
$$

步骤4：形成候选模型
$$
G(s)=\frac{0.398e^{-300s}}{1000s+1}
$$

**结果讨论**：

该初值可作为时域再优化起点。若在闭环仿真中发现高频振荡，应优先缩小控制带宽而非盲目提高模型阶次。

[图6-2: 实测FRF与低阶模型拟合对比]
{描述: Bode幅频与相频两子图，对比实测FRF与候选模型。}
{尺寸: 半页}
{颜色方案: 蓝色系}

## 6.6 工程门禁与常见误区

- **门禁1：相干阈值**：核心频段相干均值建议不低于 0.7；
- **门禁2：闭环验证**：频域拟合通过后必须回到时域闭环测试；
- **门禁3：可回退性**：上线时保留上一版参数包与回退脚本。

常见误区：

1. 只看幅值误差，不看相位误差；
2. 追求全频段拟合最优，忽视控制相关频段；
3. 把噪声频段参数硬纳入率定，导致上线不稳定。

## 6.7 本章小结

本章建立了频率域辨识在明渠 ROM 体系中的方法框架：从 FRF 估计、相干筛选到参数提取与工程门禁，形成“频域提取 + 时域验证”的双域闭环。其核心结论是：频率域辨识能显著提升参数初值质量与频段可解释性，但不能脱离 ODD、Safety Envelope 与 In-the-Loop Testing 单独使用。下一章将进入数据驱动降阶方法，讨论如何在保留机理边界的同时引入学习能力。

## 习题

### 基础题

1. 为什么频率域辨识不能完全替代时域辨识？  
2. 相干函数在频域辨识中起什么作用？  
3. Bode 图中相位线性下降通常对应什么物理量？

### 应用题

4. 某系统在低频增益为 -6 dB，拐点频率为 $8\times10^{-4}\,\text{rad/s}$，延时估计 240 s。写出一阶滞后候选模型。  
5. 给定一组 FRF 数据与相干曲线，设计“可上线/不可上线”的判据，并说明阈值依据。

### 思考题

6. 当频域拟合优良但闭环测试性能一般时，你会优先调整模型结构、控制器带宽还是传感器配置？请给出工程决策逻辑。

## 拓展阅读

1. Ljung, L. (1999). *System Identification*.  
2. Pintelon, R. & Schoukens, J. (2012). *System Identification: A Frequency Domain Approach*.  
3. Litrico, X. & Fromion, V. (2009). *Modeling and Control of Hydrosystems*.  
4. Van Overloop, P. J. (2006). *Model Predictive Control on Open Water Systems*.  
5. Lei et al. (2025b). 自主智能水网架构。
