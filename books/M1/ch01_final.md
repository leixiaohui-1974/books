<!-- 变更日志
v2 2026-02-16: 根据评审补充基础题答案要点与术语一致性声明
v1 2026-02-16: 初稿
-->

# 第一章 绪论：为什么需要降阶模型

---

## 学习目标

完成本章后，你应能够：

1. 解释明渠水动力高保真模型在工程调度中的计算瓶颈；
2. 说明降阶模型（Reduced-Order Model, ROM）在实时控制中的价值定位；
3. 区分“机理保持型降阶”与“数据驱动型降阶”的适用边界；
4. 给出 ROM 在胶东调水等长距离输水系统中的典型应用场景；
5. 建立“精度—可解释性—计算开销”三目标权衡意识。

## 工程问题背景：高保真模型为何“不够快”

[物理直觉] 明渠输水系统的核心动态来自波传播、边界扰动与闸门联动。完整 Saint-Venant 方程能够精确描述这些机理，但在大规模网络与实时调度场景下，计算速度常常成为首要约束。

在实际工程中，调度决策通常要求分钟级刷新，且需要在多种工况（常态、汛期、检修、突发需水）下反复求解。若每次都采用高维偏微分方程全量离散，常见问题包括：

- **求解耗时长**：难以满足模型预测控制（Model Predictive Control, MPC）在线滚动优化节奏；
- **参数整定难**：模型维度高导致辨识、校准和维护成本高；
- **系统耦合强**：跨渠段联动使全局优化求解不稳定，难以形成可治理发布流程。

因此，工程需要“保留关键动力学、降低状态维度”的模型形态，这正是降阶模型的出发点。

## 降阶模型的概念与目标

降阶模型（Reduced-Order Model, ROM）并不是“粗糙近似”，而是围绕目标任务进行信息压缩。

### 1.2.1 核心定义

- **降阶**：在保证关键输入输出行为的前提下，减少状态维度与计算复杂度；
- **保真边界**：在运行设计域（Operational Design Domain, ODD）内保持误差可控；
- **任务导向**：面向控制、预测、告警或仿真训练等具体任务优化模型结构。

### 1.2.2 三个评价指标

1. **精度**：对关键输出（如流量 $Q$、水位 $h$）的误差上界；
2. **效率**：单位时间可完成的仿真或优化迭代次数；
3. **可解释性**：参数与物理量之间是否保持可追溯关系。

## 两类主流技术路径

### 1.3.1 机理保持型路径

代表方法包括传递函数、IDZ 模型、Muskingum 类模型等。这类方法优点是可解释性强、与工程经验兼容度高，缺点是面对强非线性与时变工况时精度下降明显。

### 1.3.2 数据驱动型路径

利用系统辨识、机器学习或混合建模从运行数据中提取低维动力学。优点是拟合能力强，缺点是样本依赖与外推风险高。

[工程解释] 实际项目常采用“机理主干 + 数据校正”的混合方式：用机理模型保证边界可信，用数据模块补偿局部偏差。

[图1-1: 明渠降阶建模技术路线图]
{描述: 展示高保真模型到ROM的两条路径（机理保持型、数据驱动型）及其在控制、预测、验证中的应用接口。}
{尺寸: 全页}
{颜色方案: 蓝色系}

## 典型应用场景：从离线分析到在线控制

ROM 在水系统中的价值并非单一场景，而是覆盖“设计—运行—复盘”全流程：

- **离线阶段**：用于方案比选与灵敏度分析；
- **在线阶段**：嵌入 MPC 或分层分布式控制（Hierarchical Distributed Control, HDC）回路；
- **复盘阶段**：快速重演工况，定位策略失效原因。

在胶东调水场景中，长距离明渠具有明显传输延时 $\tau$，ROM 能够显著降低滚动优化时间，使“分钟级更新”具备工程可行性。

## 与国际工作的关系与差异

国际明渠控制研究长期积累了传递函数与预测控制方法（如 Litrico & Fromion, Van Overloop）。CHS 语境下的差异在于：

1. 将 ROM 明确纳入“ODD + Safety Envelope + In-the-Loop Testing”治理链条；
2. 强调 SCADA+MAS Fusion Architecture 下的跨层协同，而非单控制器性能最优；
3. 将“可回退、可审计、可迭代”作为模型上线门槛。

这意味着本书不仅讨论“如何建模”，还讨论“如何让模型在工程组织中长期可用”。

## 可复现实例：单渠段ROM速度收益估算

【例1-1】某单渠段高保真模型一次仿真耗时 6.0 s，候选 ROM 一次仿真耗时 0.35 s；在同一测试集上，关键断面水位 MAE 从 0.000 m（基准）变为 0.028 m。

**已知**：
- 在线优化每次滚动需调用模型 120 次；
- 调度刷新周期目标为 5 min；
- 允许水位建模误差门限为 0.05 m（ODD 内）。

**求解**：判断 ROM 是否满足在线部署条件。

**解题过程**：

步骤1：计算高保真模型单次滚动时长：$120 \times 6.0 = 720$ s。  
步骤2：计算 ROM 单次滚动时长：$120 \times 0.35 = 42$ s。  
步骤3：比较误差门限：$0.028 < 0.05$ m，满足精度约束。  
步骤4：比较刷新周期：42 s 远小于 300 s，满足实时性约束。

**结果讨论**：

ROM 在该场景下同时满足精度与效率要求，可进入下一步 In-the-Loop Testing。若后续出现季节性偏差，应通过参数重标定或混合校正模块补偿。

[图1-2: 精度-效率权衡示意]
{描述: 横轴为单次滚动计算时间，纵轴为关键变量误差，标注高保真模型与ROM所在位置及可部署区域。}
{尺寸: 半页}
{颜色方案: 蓝色系}

## 本章小结

本章回答了“为什么需要降阶模型”这一根本问题：在明渠系统实时调度中，高保真模型虽精确但常不满足时效性要求，ROM 则通过任务导向的信息压缩实现“足够准确且足够快”。同时，ROM 的工程价值不只在算法层，而在其能否纳入 ODD、Safety Envelope 与在环测试构成的治理闭环。下一章将进入 Saint-Venant 方程与特征线分析，为后续 ROM 构建提供机理基础。

## 习题

### 基础题

**1-1.** 为什么“高保真模型精度高”不等于“工程可用”？  
**1-2.** ROM 的三项核心评价指标是什么？  
**1-3.** 机理保持型与数据驱动型降阶路径各自优势是什么？


### 基础题参考答案要点

**1-4.** 因为工程可用性同时受实时性、稳定性与治理流程约束，仅高精度不足以支撑在线闭环决策。  
**1-5.** 精度、效率、可解释性。  
**1-6.** 机理保持型可解释性强且便于工程维护；数据驱动型拟合能力强但外推风险较高。

### 应用题

**1-7.** 某项目高保真模型滚动耗时 540 s，ROM 耗时 75 s，误差为 0.041 m，刷新周期 6 min。请判断是否可上线并说明理由。  
**1-8.** 设计一个 ROM 上线门禁清单（至少包含精度、效率、回退、审计四类指标）。

### 思考题

**1-9.** 当模型精度与实时性冲突时，应如何在不同工况（常态/汛期/检修）下设置分级门限？

## 拓展阅读

1. **Litrico, X. & Fromion, V. (2009). *Modeling and Control of Hydrosystems*.**
2. **Van Overloop, P. J. (2006). *Model Predictive Control on Open Water Systems*.**
3. **ASCE (2014). *MOP 131: Canal Automation for Irrigation Systems*.**
4. **Lei et al. (2025a). 理论背景与研究范式。**
5. **Lei et al. (2025b). 自主智能水网架构。**
