<!-- 变更日志
v1 2026-02-16: 初稿
-->

# 第七章 数据驱动降阶方法

---

## 学习目标

完成本章后，你应能够：

1. 理解数据驱动降阶方法在明渠建模中的角色；
2. 掌握从数据清洗到特征构造的基本流程；
3. 比较线性子空间法、稀疏辨识与浅层学习模型的适用边界；
4. 完成一个可复现实例并评估泛化风险；
5. 形成“机理先验 + 数据校正”的工程建模意识。

## 7.1 章间衔接

前一章通过频率域辨识提高了参数估计的稳健性。本章进一步回答：当系统非线性增强、运行工况频繁切换时，仅靠固定结构参数模型可能不足，如何利用运行数据构造更具适应性的降阶模型（Reduced-Order Model, ROM）。

[物理直觉] 数据驱动并不是“抛弃机理”，而是在机理框架难以细化之处，用数据补齐局部动态。

## 7.2 数据驱动 ROM 的三条主路径

### 7.2.1 子空间降阶

通过 SVD/POD 将高维状态投影到低维主子空间，保留主导能量模态。其优点是结构清晰，缺点是对工况漂移敏感。

### 7.2.2 稀疏辨识

在候选库中选择最少项描述系统动力学，强调可解释性与低复杂度。

### 7.2.3 轻量学习模型

如岭回归、随机森林、浅层神经网络等，用于补偿机理模型残差。优点是拟合灵活，缺点是外推风险需严格门禁。

[表7-1: 三类数据驱动ROM方法对比]
{描述: 对比输入需求、可解释性、实时性、部署复杂度与失效风险。}
{尺寸: 半页}
{颜色方案: 灰度}

## 7.3 标准流程：数据到模型

1. **数据治理**：时间对齐、缺失补全、异常剔除；
2. **特征工程**：构造时滞特征、工况标签、边界条件特征；
3. **训练验证划分**：按时段与工况分层抽样，防止泄漏；
4. **模型训练**：目标函数选择 MAE/RMSE + 约束惩罚；
5. **泛化评估**：跨季节、跨流量区间验证；
6. **上线门禁**：ODD、Safety Envelope、In-the-Loop Testing 联合验收。

[图7-1: 数据驱动ROM开发与上线闭环]
{描述: 数据治理→建模训练→验证评估→在环测试→上线→监测回训。}
{尺寸: 全页}
{颜色方案: 蓝色系}

## 7.4 可复现实例：残差学习增强

【例7-1】某渠段已部署一阶传递函数基线模型，验证集 MAE 为 0.041 m。现采用随机森林对残差进行学习校正，输入特征包含上游流量、闸门开度、过去30 min 水位滞后项与工况标签。

**已知**：
- 校正后验证集 MAE 为 0.026 m；
- ODD 门限为 0.05 m；
- 推理耗时从 8 ms 增加到 15 ms。

**求解**：评估是否具备上线条件。

**解题过程**：

步骤1：精度改善幅度
$$
\Delta MAE = 0.041-0.026=0.015\,\text{m}
$$

步骤2：相对改善率
$$
\frac{0.015}{0.041}=36.6\%
$$

步骤3：门限检查。校正后误差 0.026 m < 0.05 m，满足精度门禁。

步骤4：实时性检查。15 ms 远小于分钟级调度周期，满足时效性。

**结果讨论**：

该方法可进入在环回归测试。上线时应保留“仅基线模型”回退开关，并对工况外样本触发告警。

[图7-2: 基线模型与残差学习模型误差箱线图]
{描述: 对比两模型在多工况下误差分布，中位数与离群点可视化。}
{尺寸: 半页}
{颜色方案: 蓝色系}

## 7.5 工程风险与控制策略

- **数据偏移风险**：季节变化导致分布漂移；
- **标签噪声风险**：测点异常传播到训练目标；
- **黑箱风险**：模型可解释性不足影响调度信任；
- **联锁风险**：模型输出异常可能触发控制链放大。

对应策略：

1. 建立漂移监测指标（PSI、误差滑窗均值）；
2. 采用可解释特征重要性报告；
3. 配置最小风险状态（MRS）回退逻辑；
4. 定期执行 In-the-Loop Testing 回归。

## 7.6 本章小结

本章给出数据驱动降阶方法的工程框架：以数据治理为前提、以泛化评估为核心、以上线门禁为保障。结论是：数据驱动 ROM 最有效的用法不是替代机理，而是作为机理模型的校正层。下一章将进入冰期工况降阶建模，重点讨论参数时变与模型切换策略。

## 习题

### 基础题

1. 为什么数据驱动 ROM 必须配合 ODD 与 Safety Envelope 使用？  
2. 子空间法与残差学习法的主要差异是什么？  
3. 数据泄漏会对验证结果造成什么影响？

### 应用题

4. 某模型 MAE 从 0.050 m 降至 0.034 m，推理时延从 10 ms 升至 22 ms。请评估上线可行性并说明依据。  
5. 设计一个“模型漂移监测看板”指标集，至少包含精度、分布漂移、告警触发与回退频次。

### 思考题

6. 在高风险调度场景下，你会优先选择“高精度黑箱模型”还是“中等精度可解释模型”？请给出工程决策原则。

## 拓展阅读

1. Brunton, S. et al. (2016). Sparse identification of nonlinear dynamics.  
2. Kutz, J. (2013). Data-Driven Modeling & Scientific Computation.  
3. Litrico, X. & Fromion, V. (2009). *Modeling and Control of Hydrosystems*.  
4. Van Overloop, P. J. (2006). *Model Predictive Control on Open Water Systems*.  
5. Lei et al. (2025c). 在环测试系统。
