<!-- 变更日志
v1 2026-02-16: 初稿（基于“继续”命令自动续写）
-->

# ch04 SCADA+HDC控制系统设计

## 学习目标

完成本章后，读者应能够：

1. 说明胶东调水场景中 SCADA 与 HDC 的职责分工与协同关系；
2. 基于 ch03 模型结果设计“感知—决策—执行—审计”控制链路；
3. 建立 SCADA 点表字段与模型变量映射模板（补齐 ch03 跟踪项）；
4. 给出控制模式切换、联锁降级与回退机制设计；
5. 为 ch05 的 MPC 在线优化提供系统接口基础。

> 承接 ch03：模型已可计算，本章回答“模型如何接入控制系统并稳定运行”。

> **前章回顾**：上一章介绍了本领域的核心概念与方法。本章在此基础上进一步展开。


## SCADA+HDC 融合架构定位

在胶东调水工程中，SCADA 与 HDC 不是替代关系，而是“执行中枢 + 协调大脑”的互补关系：

- **SCADA**：采集、告警、基础联锁、人工接管；
- **HDC**：跨渠段协调、目标分解、约束求解、策略下发。

[工程解释] 若仅有 SCADA，系统容易陷入“局部最优”；若仅有 HDC，系统缺少现场稳态保障与可追溯执行。

[图4-1: SCADA+HDC融合控制架构]
{描述: 展示感知层、执行层、协调层、优化层及审计链路，标注数据流与控制流方向。}
{尺寸: 全页}
{颜色方案: 蓝色系}
{对应ARCH编号: ARCH-04}

## 控制链路设计：从指标到动作

建议控制链路按四步闭环组织：

1. **状态感知**：采集 $Q,h$、闸门开度、告警状态；
2. **策略生成**：HDC 根据目标函数与约束求解控制增量；
3. **动作执行**：SCADA 下发闸门指令并监测反馈；
4. **审计留痕**：记录策略版本、执行结果与异常处置。

可写为离散调度表达：

$$
\mathbf{u}_{k}=\mathbf{u}_{k-1}+\Delta \mathbf{u}_{k},\quad \Delta \mathbf{u}_{k}=\pi(\mathbf{x}_{k},\text{ODD},\text{Safety Envelope})
$$

其中 $\pi(\cdot)$ 为策略映射，受 ODD 与安全包络约束。

[物理直觉] 调度动作不是“越快越好”，而是“在可承受变化率内稳定逼近目标”。

## 接口字段与模型变量映射（补齐ch03跟踪项）

为补齐 ch03 跟踪项，本节给出最小映射模板：

- SCADA 点表字段：`tag_id`、`value`、`timestamp`、`quality`；
- 模型变量：$Q_i,h_i,\Delta u_i,d_i$；
- 控制上下文：`policy_version`、`mode`、`risk_level`。

映射原则：

- 一类物理量仅一个主信号源；
- 缺测时触发替代规则并标注质量等级；
- 执行指令必须关联策略版本与审计流水号。

[表4-1: SCADA点表字段—模型变量映射模板]
{描述: 列包括SCADA字段、模型变量、单位、刷新周期、容错规则、审计字段。}
{尺寸: 半页}
{颜色方案: 灰度}

[TODO: 需补充胶东现场点表编码规范与命名规则样例]

## 控制模式切换与联锁降级

建议设置三种运行模式：

- **自动模式**：HDC 主导，SCADA 执行并监控；
- **协同模式**：HDC 给建议，值守人员确认后执行；
- **人工模式**：人工直接调度，系统保留联锁保护。

模式切换触发条件示例：

- 数据质量连续低于阈值；
- 关键执行设备通信中断；
- 安全包络进入红区并持续超时。

联锁降级要求：

- 优先进入最小风险状态；
- 保证关键供水任务可维持；
- 自动生成异常工单与审计记录。

## 在环联调与发布前检查

在 ch05 上线优化策略前，建议执行最小联调清单：

1. 点表映射一致性校验；
2. 指令闭环时延测试；
3. 模式切换正确性回归；
4. 联锁触发与回退演练。

[工程解释] “接口打通”不等于“可上线”，必须经过在环联调验证实际时序与异常路径。

## 可复现实例：一次模式切换处置

【例4-1】运行中某关键水位测点质量连续降级，HDC 置信度下降。

**已知**：
- 测点质量等级由 A 下降至 C 持续 20 min；
- 规则：关键测点质量 < B 持续 15 min 触发协同模式；
- 当前处于自动模式。

**求解**：给出最小处置链路。

**解题过程**：
1. 触发模式切换条件，系统由自动切至协同模式；
2. 启用替代测点与估计值，并标注数据质量；
3. 人工确认关键指令后执行；
4. 记录切换事件与恢复条件，待质量恢复后回到自动模式。

**结果讨论**：
模式切换将“数据不可信”风险显式化，避免在低质量数据下盲目自动执行。

## 本章小结

本章完成了胶东调水 SCADA+HDC 控制系统的工程化设计，包括架构定位、控制链路、点表映射模板、模式切换与联锁降级机制。下一章将在此基础上开展 MPC 在线优化调度。

## 习题

### 基础题

**4-1.** SCADA 与 HDC 在胶东调水中的核心分工是什么？
**4-2.** 为什么指令执行必须绑定策略版本与审计流水号？
**4-3.** 简述自动/协同/人工三种模式的适用场景。

### 应用题

**4-4.** 设计一份“SCADA字段—模型变量”映射模板，至少包含 8 个字段。  
**4-5.** 给出一个联锁降级流程图草案，覆盖触发、降级、恢复三阶段。

### 思考题

**4-6.** 在供水紧约束条件下，若自动模式频繁切换到协同模式，系统治理上应优先改进哪一层？

### 基础题参考答案要点

**4-7.** SCADA负责执行与监控，HDC负责协调与决策。  
**4-8.** 便于追责、复盘与版本一致性管理。  
**4-9.** 自动适合常态，协同适合不确定状态，人工适合极端与应急。

## 拓展阅读

1. **Lei et al. (2025b). 自主智能水网架构。**
2. **Lei et al. (2025c). 在环测试系统。**
3. **ASCE (2014). *MOP 131: Canal Automation for Irrigation Systems*.**
4. **Litrico, X. & Fromion, V. (2009). *Modeling and Control of Hydrosystems*.**
5. **NIST SP 800-53 Rev.5 (Audit & System Integrity).**
