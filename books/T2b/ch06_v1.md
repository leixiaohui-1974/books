<!-- 变更日志
v1 2026-02-16: 初稿
-->

# 第六章 大语言模型与认知AI

---

## 学习目标

完成本章后，你应能够：

1. 说明大语言模型（LLM）在水系统调度中的能力边界与风险边界；
2. 构建“检索增强生成（RAG）+水利知识图谱”的认知AI引擎基础流程；
3. 设计面向调度问答、工况解释、策略建议的提示词与工具调用链路；
4. 将认知AI引擎接入 SCADA+MAS Fusion Architecture，并明确人与模型的职责分工；
5. 制定认知AI上线的门禁指标、审计机制与回退策略。

> **章首衔接（承接ch05）**  
> 上一章讨论了强化学习如何生成控制动作。本章回答另一个关键问题：当系统面对规范文档、历史处置记录和专家经验时，如何让模型“看懂语义、解释决策、辅助协同”，从而把控制智能提升为认知智能。

## 6.1 从“会算”到“会解释”

[物理直觉] 控制器擅长计算最优动作，但工程运行并不只关心“给什么动作”，还关心“为什么这样做、是否符合规程、异常时谁来确认”。

[工程解释] 认知AI引擎的价值在于把规程、案例、告警、实时状态联结为可对话的知识与推理能力。其定位是“辅助决策与解释增强”，而不是绕过安全联锁直接接管执行层。

## 6.2 LLM 在水系统中的任务分解

可将任务分为三类：

1. **信息理解任务**：解析调度规程、事故通报、检修票据与设备日志；
2. **认知问答任务**：回答“当前工况为何高风险”“推荐策略依据是什么”；
3. **协同编排任务**：生成应急处置流程、交接班摘要、跨站协同建议。

[表6-1: LLM任务类型与能力边界]
| 任务类型 | 典型输入 | 典型输出 | 风险点 | 约束策略 |
|---|---|---|---|---|
| 信息理解 | 规程PDF、日志文本 | 结构化要点 | 幻觉/遗漏 | RAG检索与出处引用 |
| 认知问答 | 实时状态+知识库 | 风险解释与建议 | 越权建议 | ODD/Safety Envelope约束校验 |
| 协同编排 | 告警序列+班组角色 | 操作清单 | 流程冲突 | 人工确认+审批签核 |

## 6.3 RAG 与水利知识图谱

### 6.3.1 RAG 基础链路

RAG 典型流程：文档分块 → 向量检索 → 证据重排 → 受约束生成 → 引用输出。

[工程意义] 对水系统而言，RAG 的关键收益是“回答可追溯”。模型若不能指出依据条款、历史案例与数据来源，即不应进入生产辅助流程。

### 6.3.2 知识图谱增强

在 RAG 之外构建“设备—工况—告警—处置”知识图谱，可提升跨文档推理一致性。

示例实体与关系：
- 实体：泵站、闸门、渠段、告警类型、班组角色；
- 关系：上游影响、联锁依赖、职责归属、处置先后。

[图6-1: 认知AI引擎（RAG+知识图谱）架构]
{描述: 左侧为多源数据（规程、日志、实时SCADA）；中间为检索层与知识图谱推理层；右侧为对话接口、策略解释与审计日志输出。}
{尺寸: 全页}
{颜色方案: 蓝色系}
{对应ARCH编号: ARCH-05}

## 6.4 提示词工程与工具调用

[物理直觉] LLM 不是“知道一切”的黑箱，其输出质量由上下文、约束和工具能力共同决定。

### 6.4.1 提示词模板要素

建议固定以下槽位：
- 当前 ODD 标签与关键工况；
- 可调用工具清单（趋势分析、规则校验、历史检索）；
- 输出格式约束（结论、依据、风险等级、建议动作）；
- 禁止项（不得生成越过联锁的直接执行指令）。

### 6.4.2 工具调用闭环

“提问—检索—计算—校验—回答”应形成闭环：
1. LLM 接收问题并分解子任务；
2. 调用检索工具获取规程与案例证据；
3. 调用计算工具估算关键指标；
4. 调用规则工具校验 ODD 与 Safety Envelope；
5. 输出带证据引用的建议，并写入审计日志。

## 6.5 认知AI与 SCADA+MAS Fusion Architecture 融合

推荐职责划分：

- **执行层（L0-L1）**：保持确定性控制与硬联锁；
- **协调层（L2）**：MAS 协同多站点状态与任务分发；
- **认知层（L3）**：认知AI引擎提供语义理解、方案解释、冲突消解建议。

[工程解释] 在该模式下，认知AI不直接“发命令”，而是生成“可审计建议包”：包括建议动作、依据条款、影响范围、风险等级与回退建议，由值班工程师确认后执行。

[图6-2: 认知AI辅助调度的人机共融闭环]
{描述: 人员提问与系统告警进入认知层，输出建议包，经人工确认后下发协调层与执行层，并回流效果评估。}
{尺寸: 全页}
{颜色方案: 蓝色系}
{对应ARCH编号: ARCH-04}

## 6.6 例题：汛期突发告警下的认知AI辅助处置

【例6-1】某调水干线在暴雨过程中出现“上游来水突增+中段闸位异常抖动”复合告警，值班人员需在 10 分钟内完成处置建议。

**已知**：
- 规程库包含汛期限流、闸门变位速率、检修期间降级运行条款；
- 系统可调用实时趋势分析、历史案例检索与规则校验工具；
- 当前工况标签为“汛期+局部检修”。

**求解**：设计认知AI引擎的辅助决策流程与输出模板。

**解题过程**：

步骤1：提取告警要素并绑定 ODD 标签。  
步骤2：RAG 检索相关规程条款与历史相似案例。  
步骤3：调用规则工具校验 Safety Envelope 越界风险。  
步骤4：生成三档建议方案（保守/平衡/收益优先）并标注风险等级。  
步骤5：输出“结论+依据+不确定性+回退策略”的建议包。  
步骤6：人工确认后执行，并记录执行效果反馈用于后评估。

**结果讨论**：

该流程的核心不是让模型替代调度员，而是压缩信息汇总时间、提升解释一致性、降低跨班组沟通成本。若检索证据不足或规则冲突，系统应自动降级为“仅信息摘要模式”。

### 认知AI章节上线检查清单

- [ ] 是否建立受控知识库并完成版本管理；
- [ ] 是否实现回答出处引用与证据可追溯；
- [ ] 是否配置越权建议拦截与安全规则校验；
- [ ] 是否完成影子运行与人工一致性评估；
- [ ] 是否建立审计日志、责任边界与一键回退机制。

## 6.7 本章小结

本章构建了大语言模型与认知AI引擎的工程落地路径：以 RAG 保障证据可追溯，以知识图谱增强跨文档一致性，以工具调用形成“检索—计算—校验—回答”闭环。关键结论是：认知AI应定位为“可审计的辅助决策层”，并在 ODD 与 Safety Envelope 约束下与 SCADA+MAS Fusion Architecture 协同运行。下一章将进入多智能体系统理论，系统讨论协同控制中的共识、博弈与任务分配机制。

## 习题

### 基础题

1. 为什么认知AI引擎必须要求“回答带出处”？  
2. RAG 与知识图谱在功能上有何互补关系？  
3. 为什么认知AI不应直接绕过执行层联锁下发控制指令？

### 应用题

4. 设计一个“告警处置建议包”的标准输出模板（字段不少于6项）。  
5. 给出认知AI影子运行阶段的人机一致性评估指标。

### 思考题

6. 当规程条款与历史案例结论冲突时，认知AI应如何排序证据优先级？请给出可执行规则。

## 拓展阅读

1. Lewis et al. (2020). Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks.  
2. Bommasani et al. (2021). On the Opportunities and Risks of Foundation Models.  
3. Litrico, X. & Fromion, V. *Modeling and Control of Hydrosystems*.  
4. Lei et al. (2025b). 自主智能水网架构。  
5. Lei et al. (2025c). 在环测试系统。
