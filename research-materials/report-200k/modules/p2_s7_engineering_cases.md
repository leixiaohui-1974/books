## 2.7 重大工程案例：CHS理论的实践验证

理论的生命力在于实践。CHS理论框架的形成，不是书斋中的纯粹思辨，而是扎根于多项重大水利工程的实践探索。本节选取三个代表性工程案例——胶东调水工程、沙坪水电梯级系统和南水北调中线工程——系统展示CHS理论在不同类型水系统中的应用。这三个案例分别代表了长距离明渠调水、水力发电梯级联合调度和超大规模跨流域调水三种典型工程场景，涵盖了水系统运行中最具挑战性的核心问题。更重要的是，这三个工程的实践经验不仅验证了CHS理论的工程可行性，而且反过来推动了理论的深化和完善——许多核心概念正是在解决工程实际问题的过程中被提炼和升华的。

### 2.7.1 胶东调水工程：SCADA+HDC协同控制

#### （1）工程概况与运行挑战

胶东调水工程是山东省重要的跨区域水资源配置工程，承担着向青岛、烟台、威海等胶东半岛城市群供水的战略任务。工程由引黄济青改扩建工程和引黄济青干线延伸至胶东半岛的输水渠系组成，涉及多段明渠、管道和泵站，输水线路跨越数百公里。工程沿线设有多座节制闸和分水闸，构成典型的多渠池串联控制系统。

胶东调水工程的运行面临多重挑战。第一，长距离输水带来的大时滞问题。上游闸门的操作到下游水位响应之间存在数小时甚至更长的传播延迟，传统的反馈控制方法在大时滞条件下容易产生超调和振荡。以典型渠段为例，若渠段长度为$L$，水波传播速度约为$v_0+c_0$（其中$v_0$为平均流速，$c_0=\sqrt{gA_0/T_0}$为小扰动波速），则传播延迟$\tau_d=L/(v_0+c_0)$在数十分钟到数小时量级。当多个渠段串联时，累积延迟可达十余小时，这对控制器的设计提出了极高的要求。

第二，多用户多目标的协调问题。沿线有多个取水口服务于不同城市，各城市的需水时段和需水量不同，需要在保障各用户供水可靠性的同时维持渠道的安全水位。供水可靠性要求系统尽量满足各用户的取水需求，而运行安全性要求渠道水位始终维持在安全上下限之间。这两个目标在取水高峰期可能产生矛盾——大量取水导致渠道水位下降，可能触及安全下限。

第三，来水不确定性。水源区来水受降雨和黄河来水条件影响，存在较大的不确定性。此外，渠道沿线的旁侧入流（如区间降雨汇入）和旁侧出流（如渗漏损失）也构成了系统的外部扰动。运行调度需要在不确定条件下保持稳健性，即在最不利的扰动情况下仍能保障系统安全运行。

第四，渠道水力特性的非线性和时变性。明渠中的水流由圣维南方程描述，这是一组非线性偏微分方程。渠道的水力参数（如糙率系数$n$）会随季节、淤积状况和水生植物生长等因素发生变化，导致系统模型具有时变特性。固定参数的控制器在模型参数漂移后可能出现性能下降甚至失稳。

#### （2）从圣维南方程到IDZ传递函数：建模基础

要对胶东调水工程实施基于模型的控制，首先需要建立适合控制器设计的数学模型。这涉及一个关键的科学问题：如何将描述明渠水流的非线性偏微分方程（圣维南方程）转化为控制工程中可用的低阶传递函数模型？

圣维南方程组由连续性方程和动量方程组成：

$$\frac{\partial A}{\partial t}+\frac{\partial Q}{\partial x}=q_l$$

$$\frac{\partial Q}{\partial t}+\frac{\partial}{\partial x}\left(\frac{Q^2}{A}\right)+gA\frac{\partial h}{\partial x}=gA(S_0-S_f)$$

其中$A$为过水断面面积，$Q$为流量，$q_l$为旁侧入流，$S_0$为底坡，$S_f$为摩阻坡降。这组方程虽然能够精确描述明渠水流的动态行为，但由于其非线性和分布参数特性，无法直接用于控制器设计。

为解决这一问题，研究团队发展了一套系统化的降阶建模方法。第一步，确定渠池的基准稳态工作点。根据设计流量$Q_0$和渠池几何参数（长度$L$、底宽$b$、边坡系数$m$、底坡$S_0$、Manning糙率系数$n$），利用Manning公式求解均匀流条件下的基准水深$y_0$和基准流速$v_0$。第二步，对圣维南方程组进行线性化处理。将流量和水深分解为稳态分量与扰动分量之和，即$Q(x,t)=Q_0+q(x,t)$、$y(x,t)=y_0+\tilde{y}(x,t)$，忽略扰动量的高阶项，得到线性化偏微分方程组。第三步，对线性化方程进行Laplace变换，推导分布参数传递矩阵$\mathbf{G}(s)$，建立上下游边界变量之间的频域关系。第四步，在低频段对分布参数传递矩阵进行有理函数近似，构建积分延迟零（Integrator Delay Zero, IDZ）传递函数模型：

$$P(s)=\frac{(1+\tau_z \cdot s) \cdot e^{-\tau_d \cdot s}}{A_s \cdot s}$$

其中，$A_s=T_0 \cdot L$为渠池蓄量面积，表征积分特性；$\tau_d=L/(v_0+c_0)$为传播延迟时间；$\tau_z$为零点时间常数，通过频域拟合确定。IDZ模型是Litrico和Fromion于2004年在ID模型基础上提出的改进模型，通过增加零点项改善了高频段的响应精度。

这一降阶建模方法的关键创新在于建立了多工况传递函数库。在渠池设计运行流量范围$[Q_{min},Q_{max}]$内，选取多个特征工况流量值，对每个工况分别计算IDZ传递函数参数，构成参数查找表。当实际运行工况处于相邻特征工况之间时，采用插值获取当前工况的模型参数。仿真验证表明，在流量偏离设计值50%的工况下，多工况插值模型的水位预测均方根误差较固定参数IDZ模型降低约25%至35%。

此外，为适应渠道糙率变化、淤积等长期演变因素，还发展了基于递推最小二乘法（RLS）的在线参数辨识机制。该机制实时采集闸门流量变化和下游水位响应数据，在线辨识传递函数参数，当辨识值与库中参数的偏差超过预设阈值时自动触发参数更新。这一"建模—辨识—更新"的闭环机制，体现了CHS理论中"数据—物理融合"原理的工程实现。

#### （3）SCADA+HDC融合架构

在建模基础上，胶东调水工程采用了SCADA与分层分布式控制（HDC）相融合的技术架构。这一架构是CHS理论"分层分布式统一"原理的典型工程实现。

在SCADA层面，工程建设了覆盖全线的数据采集与监控网络。关键控制断面设置了水位传感器、流量计、闸门开度传感器等监测设备，实时数据通过光纤和无线通信网络传输至中央控制中心。SCADA系统不仅承担传统的数据采集和远程监控功能，还集成了数据质量评估模块——对传感器数据进行异常检测、缺失补全和一致性校验，为控制算法提供经过清洗和融合的高质量输入。

在HDC层面，控制架构分为三个层级。L0层（本地控制层）实现单个闸门的本地自动控制，根据目标水位和实际水位的偏差自动调节闸门开度，响应速度在秒级。L1层（渠段协调层）对相邻的多个闸门进行协调控制，当某个渠段的水位偏离目标值时，不仅调整本渠段的闸门，还协调上下游闸门联动，避免水位波动在渠段之间传递和放大。L2层（全系统调度层）负责全线的优化调度，其核心算法采用模型预测控制（MPC）。

SCADA与HDC的深度融合是一个关键设计理念。在胶东调水工程中，SCADA的数据质量评估结果直接影响HDC算法的运行模式：当数据质量良好时，HDC算法正常运行；当数据质量下降到一定阈值以下时，HDC自动切换到保守控制模式，减小控制动作幅度以降低风险；当数据链中断时，系统自动退回到预设的安全运行状态。这种基于数据质量的自适应控制模式切换，体现了CHS理论"安全优先"的核心原则。

#### （4）MPC在线优化

胶东调水工程的L2层调度采用了模型预测控制（MPC）方法。MPC是一种基于模型的滚动优化控制策略，其核心思想是：在每个控制时刻$k$，利用预测模型向前预测未来$N_p$个时步的系统响应，在预测域内求解一个约束优化问题，得到最优控制序列，执行第一步控制动作后丢弃其余，然后在下一个控制时刻重新预测和优化。

MPC的优化目标函数定义为：

$$J=\sum_{i=1}^{N_p}\left\|\mathbf{y}(k+i|k)-\mathbf{y}_{ref}(k+i)\right\|_{\mathbf{Q}}^2+\sum_{j=0}^{N_c-1}\left\|\Delta\mathbf{u}(k+j|k)\right\|_{\mathbf{R}}^2$$

其中第一项衡量预测输出$\mathbf{y}$与参考轨迹$\mathbf{y}_{ref}$的偏差，第二项衡量控制增量$\Delta\mathbf{u}$的大小，$\mathbf{Q}$和$\mathbf{R}$为权重矩阵。约束条件包括水位安全包络$\mathbf{y}_{min} \leq \mathbf{y} \leq \mathbf{y}_{max}$、闸门开度范围和开度变化速率限制。

MPC方法在胶东调水工程中取得了显著的运行效果。在正常输水工况下，主要控制断面的水位偏差控制在目标值的正负5厘米以内，显著优于人工调度的正负15至20厘米精度。在需水变化工况下，MPC能够提前数小时预见需求变化并渐进调整闸门开度，避免了"急调猛调"。在突发扰动工况下，MPC能够在安全约束范围内自动重新计算控制方案，实现了WNAL L3级别的条件自主运行。

由于IDZ传递函数模型的计算复杂度低（单步求解时间为微秒量级，相比圣维南方程数值求解提速约三个数量级），MPC的在线优化能够在数秒内完成，满足了实时控制要求。这一效率优势正是"可控模型族"理念的工程价值所在。

#### （5）工程启示

胶东调水工程的实践为CHS理论提供了多方面的验证和启示。SCADA+HDC融合架构验证了"分层分布式统一"原理的工程可行性；从圣维南方程到IDZ传递函数的系统化降阶方法验证了"可控模型族"概念的工程价值；MPC在长距离调水中的成功应用验证了基于模型的预测控制在水系统中的有效性。同时，传感器故障、通信延迟和模型参数漂移等实际问题推动了状态估计、延迟补偿和自适应控制方法的发展，体现了"实践推动理论"的学科发展规律。

### 2.7.2 沙坪水电梯级：发电—防洪多目标协同

#### （1）工程概况与运行挑战

沙坪水电站位于四川省大渡河流域，是蒲布—深溪沟—镇头—沙坪四级水电梯级系统的组成部分。整个梯级系统承担着电力调峰、防洪泄洪和生态流量保障等多重功能。与胶东调水以供水为核心目标不同，水电梯级系统的运行问题本质上是一个多目标协同优化问题——发电效益最大化、防洪安全保障和生态流量维持三者之间存在结构性矛盾。

发电目标追求水能利用效率最大化，希望维持较高的水库水位以获得更大的发电水头$H$（发电功率$P=\eta \rho g Q H$），因此倾向于蓄水；防洪目标则要求在汛期保持充足的防洪库容，需要降低水库水位；生态目标要求在特定时段维持特定的下泄流量过程。此外，梯级系统内部的级联耦合效应显著增加了运行复杂性——上级电站的泄水直接构成下级电站的来水，一个电站的运行方式变化会沿梯级向下游逐级传播。

从控制系统的角度看，沙坪梯级至少存在三类不同时标：秒级的机组保护与联锁、分钟级的机组与闸门调节、小时级的梯级调度计划修正。CHS理论的"分层分布式"架构为这种多时标问题提供了自然的解决框架。

#### （2）控制对象建模

沙坪梯级的建模与胶东调水有显著差异。核心模型是水库水量平衡与发电-泄洪耦合动力学。对于单个电站，基本水量平衡方程为：

$$\frac{dV}{dt}=Q_{in}(t)-Q_{out}(t)$$

出库流量由发电流量和泄洪流量两部分组成：$Q_{out}=Q_{pow}+Q_{spill}$。对于梯级系统，四个电站通过$Q_{in,i}=Q_{out,i-1}+q_i$耦合在一起。发电功率模型需要考虑机组效率的非线性特性$\eta(H,Q)$，某些水头-流量组合可能落入振动区，需通过约束条件规避。

#### （3）发电—泄洪一体化控制

沙坪梯级采用了一体化控制方法，将发电调度和泄洪调度纳入统一优化框架：

$$J=\alpha \cdot J_{power}+\beta \cdot J_{flood}+\gamma \cdot J_{eco}$$

关键创新在于权重系数的动态调整机制：汛期$\beta$自动增大优先保障防洪库容，枯水期$\alpha$增大优先发电效益，鱼类繁殖季$\gamma$增大保障生态流量。权重调整规则编码在运行设计域（ODD）中，由水文气象条件自动触发工况切换。

约束条件分为三层：硬约束（不可违反的安全边界）、软约束（可通过惩罚函数纳入优化的性能指标）、治理约束（确保可审计可追责的管理要求）。这种动态权重与三层约束分级的设计，是CHS"多目标统一"和"安全优先"原理在水电场景中的融合实现。

#### （4）梯级"一键调"协同

"一键调"（One-Click Dispatch）是沙坪梯级的重要技术创新。调度员只需设定梯级整体运行目标（总发电负荷、总泄洪流量、各站水位目标），系统自动计算各级电站的最优运行方式并一键下发。

技术实现依赖于分层优化：上层优化器确定各级电站的总出力和总泄流分配（电站间协调），目标是梯级整体效益最大化同时满足级间水量平衡约束；下层优化器确定每个电站内部各机组的出力分配（电站内部优化），目标是单站效率最大化同时规避振动区。

这种两层分解将大规模耦合优化问题降维为多个小规模问题，每层优化能在数秒内完成。"一键调"将传统需要数十分钟到数小时的梯级调度过程缩短到秒级，并保证全局帕累托最优。

#### （5）认知AI辅助决策

沙坪梯级还引入了认知AI作为辅助决策工具。核心能力来自经水电领域微调的大语言模型（LLM），微调过程包括领域持续预训练（DAPT）和监督微调（SFT），并引入知识图谱增强检索（KG-RAG）。

主要应用包括三方面：第一，调度方案的自然语言解释——将MPC输出的数值化方案转化为包含"水情分析""调度思路""风险提示""操作建议"四部分的可读文字；第二，运行规程的智能检索——支持自然语言查询，从知识图谱中检索并返回精确条款引用；第三，异常工况的辅助研判——综合历史案例和运行规程给出处置建议，经物理约束校核器验证后呈现给调度员。

物理AI（MPC优化器）负责"算"，认知AI（LLM辅助系统）负责"解释"和"建议"，两者协同实现了CHS"双AI引擎"架构的工程落地。

#### （6）工程启示

沙坪实践验证了CHS理论在水电调度领域的适用性。多目标协同优化成功地将发电、防洪、生态三个矛盾目标纳入统一框架；"一键调"将复杂梯级调度简化为一步操作；认知AI提供了全方位决策支持。同时也揭示了LLM"幻觉"问题和分布式优化效率等需要进一步研究的课题。

### 2.7.3 南水北调中线工程：超大规模自主运行探索

#### （1）工程概况与世界级挑战

南水北调中线工程总干渠从丹江口水库至北京团城湖，全长1432公里，沿线设有60余座节制闸。自2014年通水以来，累计调水超过700亿立方米，惠及1.76亿人口。

工程面临世界级挑战：超长距离带来的超大时滞（水流从渠首到终端传播十余天）、60余座闸门构成的超高维控制系统（状态组合数为天文数字）、跨四省市的多元需求协调（工业供水、生活供水、农业灌溉、生态补水四类需求各异）、以及冰期运行的特殊安全风险。

#### （2）分层分布式控制架构

全线被划分为若干管理段，控制架构分三层：L0层（本地控制层）每座节制闸配备本地PID控制器，响应秒级到分钟级；L1层（管理段协调层）每个管理段设区域调度中心，负责段内多闸协调，在自身权限范围内自主处置异常，响应分钟级到小时级；L2层（全系统调度层）位于北京的中线调度中心，综合来水预报、需水计划、气象和冰期预报制定全线调度方案，采用MPC在线优化，响应小时级到天级。

三层架构通过明确的双向信息流连接：自上而下，L2向L1下达目标和约束，L1向L0下达设定值；自下而上，L0报告执行状态，L1报告运行摘要和异常事件。这种架构实现了全局优化和局部响应的有机统一。

#### （3）冰期运行控制

冰期运行是中线工程最具挑战性的工况。冰盖形成改变渠道水力特性——附加阻力使过流能力下降；冰塞可能导致水位急剧上升威胁结构安全。

研究团队发展了冰水力学耦合模型，在圣维南方程基础上增加冰盖热力学方程：

$$\rho_i L_f \frac{d\delta_i}{dt}=\phi_{ia}-\phi_{iw}$$

其中$\rho_i$为冰密度，$L_f$为潜热，$\delta_i$为冰盖厚度，$\phi_{ia}$和$\phi_{iw}$分别为冰-气和冰-水界面热通量。

冰期控制策略的核心是"保温控流"——控制流速在适宜范围内（不过快以免破冰形成冰塞，不过慢以免加速结冰），维持稳定冰盖状态。冰期安全包络比常规工况更严格——不仅有水位约束，还有流速范围和冰盖厚度约束，构成多维安全运行域。冰期运行控制的成功是CHS"安全包络"原理在极端工况下的重要验证。

#### （4）走向更高水平的自主运行

当前系统已实现WNAL L2至L3级别的运行能力：正常工况下系统自主调节无需人工干预，极端工况下自动退回安全模式请求人工接管。向更高水平推进面临三方面挑战：运行设计域的扩展（更多工况纳入自主处理范围）、异常检测和故障诊断能力提升（早期识别异常征兆）、人机协作界面优化（调度员实时了解系统决策逻辑）。

### 2.7.4 三大案例的共性启示与理论提炼

综合三个工程案例的实践经验，可以提炼出以下深层次的共性启示：

第一，CHS理论框架具有跨工程类型的普适性。从长距离明渠调水（胶东）到水电梯级联合调度（沙坪）到超大规模跨流域调水（南水北调），CHS核心概念——闭环控制、分层分布式架构、模型预测控制、安全包络、多目标协同——在不同工程中都得到了有效验证。这种普适性源于CHS对水系统运行本质问题的抽象——"感知—建模—预测—优化—执行—反馈"的控制闭环和"安全—稳定—高效"的目标层次是共通的。

第二，从理论到工程的转化需要系统化的验证流程。三个工程一致表明，控制算法从实验室到现场需经历"离线仿真—MIL—SIL—HIL—现场试运行—正式上线"的完整验证链。任何环节的缺失都可能导致上线后性能不达预期。这一认识催生了CHS理论中专门的"在回路测试"方法论（详见§4.5）。

第三，工程实践是理论创新的最重要驱动力。CHS中的许多核心概念——安全包络（源于冰期运行的极端约束需求）、运行设计域（源于多工况切换管理需求）、可控模型族（源于在线控制对精度与效率的折中需求）、双AI引擎（源于数值优化与人工理解之间的鸿沟）——都是在工程中遇到具体问题后经理论抽象而形成的。这种"实践问题→理论概念→工程方法→更广泛实践"的螺旋上升是CHS学科发展的根本动力。

第四，人机协作是当前阶段的现实路径。三个工程经验一致表明，完全自主运行（WNAL L5）尚不现实，但条件自主运行（WNAL L3）在限定ODD内已完全可行且效果显著。人机协作——机器处理常规和可预见工况，人处理异常和不可预见工况——是从L2到L4过渡阶段最务实的策略。

第五，标准化与可复用性是规模化推广的关键。三个工程虽形态各异，但控制架构、建模方法和验证流程具有相当共性。将这些共性抽象为标准化技术规范和可复用软件模块，是CHS从"点上突破"走向"面上推广"的必由之路。HydroOS水网操作系统的设计正基于这一认识——将CHS核心方法封装为标准化组件，使其能在不同工程中快速部署和定制配置（详见§4.4）。
