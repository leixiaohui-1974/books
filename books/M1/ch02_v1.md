<!-- 变更日志
v1 2026-02-16: 初稿
-->

# 第二章 Saint-Venant方程与特征线分析

---

## 学习目标

完成本章后，你应能够：

1. 从质量守恒与动量守恒出发写出一维明渠 Saint-Venant 方程组；
2. 解释方程中各项的物理意义，并完成量纲一致性核查；
3. 理解亚临界流条件下的边界条件配置原则；
4. 掌握特征线法（Method of Characteristics, MOC）在渠段传播分析中的基本计算流程；
5. 识别特征线分析对降阶模型（Reduced-Order Model, ROM）参数提取的作用。

## 2.1 从守恒定律到控制问题

[物理直觉] 调度指令并不会“瞬时”传到下游。闸门开度变化引发的是波动沿渠传播，其传播速度、衰减与反射共同决定了控制效果。因此，任何面向控制的明渠模型都必须先回答：波是如何走的、多久到、到后衰减多少。

在工程建模上，Saint-Venant 方程是连接“流体机理”与“控制模型”的桥梁。它不像纯经验公式那样仅给出静态映射，而是明确描述了水位 $h$、流量 $Q$ 随时间和空间的演化，为后续传递函数、IDZ 与 Muskingum 类 ROM 提供母体。

## 2.2 Saint-Venant 方程组与物理解释

### 2.2.1 质量守恒方程

[物理直觉] 某一渠段内“存水量变化率 = 流入 - 流出 + 旁侧入流”。

在一维近似下，连续方程可写为：

$$
\frac{\partial A}{\partial t} + \frac{\partial Q}{\partial x} = q_l
$$

[工程解释] 其中 $A$ 为过水断面面积，$Q$ 为流量，$q_l$ 为单位长度旁侧入流（正值表示汇入，负值表示取水）。该式决定了“水位变化由哪里来”。

### 2.2.2 动量守恒方程

[物理直觉] 流速变化来自重力驱动、压力梯度与摩阻损失三者平衡。

常用形式为：

$$
\frac{\partial Q}{\partial t}
+ \frac{\partial}{\partial x}\left(\frac{\alpha Q^2}{A}\right)
+ gA\frac{\partial h}{\partial x}
+ gA(S_f - S_0) = 0
$$

[工程解释] 其中 $S_0$ 为底坡，$S_f$ 为摩阻坡降，$\alpha$ 为动量修正系数，$g$ 为重力加速度。若采用 Manning 公式，则

$$
S_f = \frac{n^2Q|Q|}{A^2R^{4/3}}
$$

这里 $n$ 为 Manning 粗糙系数，$R$ 为水力半径。该项决定了波在传播过程中的衰减强度。

### 2.2.3 量纲核查与工程常错点

- 连续方程三项量纲均为 $\mathrm{m^2/s}$；
- 动量方程各项量纲可统一到“单位长度比能变化率”；
- 工程常见错误：将 $h$ 与 $y$ 混用却未声明、将 $S_0$ 误写成角度制坡度、旁侧取水未以负号录入。

[表2-1: Saint-Venant方程主要符号与单位]
{描述: 列出 Q, h, A, B, S0, Sf, n, c 等符号、物理意义与单位，并标注常见误用。}
{尺寸: 半页}
{颜色方案: 灰度}

## 2.3 线性化与小扰动假设

[物理直觉] 在常态运行中，调度动作常围绕某个稳态工况做“小幅度修正”。若扰动足够小，非线性项可在工作点附近线性化，从而得到更适合控制设计的模型。

设稳态量为 $(Q_0, h_0, A_0)$，扰动量为 $(\tilde Q, \tilde h, \tilde A)$，保留一阶项后可得线性化方程组。进一步在宽浅渠近似下，常写为：

$$
\frac{\partial \tilde h}{\partial t} + a_1\frac{\partial \tilde Q}{\partial x} = a_2\tilde q_l
$$

$$
\frac{\partial \tilde Q}{\partial t} + b_1\frac{\partial \tilde h}{\partial x} + b_2\tilde Q = 0
$$

其中 $a_1,b_1$ 与断面几何和工况有关，$b_2$ 体现等效阻尼。线性化的价值不在“取代”全模型，而在于提供可分析、可辨识、可控制的中间层。

## 2.4 特征线法：把偏微分方程变成传播轨道

### 2.4.1 基本思想

[物理直觉] 对双曲型方程而言，信息不是“全域瞬时扩散”，而是沿两族特征线前后传播。沿特征线，偏微分方程可化为常微分关系，数值求解更稳定直观。

对线性化 Saint-Venant 方程，可得到两族特征方向：

$$
\frac{dx}{dt} = u_0 + c, \qquad \frac{dx}{dt} = u_0 - c
$$

其中 $u_0=Q_0/A_0$，$c$ 为波速。亚临界流 ($u_0<c$) 下，上下游边界都对内部状态有影响，这也是工程调度需要双边边界条件的根本原因。

### 2.4.2 离散计算流程

特征线法在工程软件中的标准流程可概括为：

1. 依据 CFL 条件选择 $\Delta t,\Delta x$；
2. 在 $C^+$ 与 $C^-$ 两族线上插值上一时刻状态；
3. 在交点求解 $(Q,h)$ 更新值；
4. 施加闸门、泵站、分水口等边界与内边界约束；
5. 执行稳定性与守恒误差检查。

[图2-1: 特征线网格与信息传播方向示意]
{描述: 显示x-t平面上C+与C-两族特征线、边界输入位置和某时刻状态更新点。}
{尺寸: 全页}
{颜色方案: 蓝色系}

### 2.4.3 与其他方法的对比

与有限体积法相比，MOC 在“单渠传播时延分析、边界波响应解释”方面直观性强；与 Preissmann 隐式格式相比，MOC 对工程人员更易解释“命令为何延后生效”。

但 MOC 对复杂河网拓扑与强非线性工况的鲁棒性不总是最优，因此在大系统中常与其他离散方法混合使用：主干渠段用 MOC 抽取传播参数，局部复杂节点用隐式格式细化。

## 2.5 从特征线到降阶模型参数

ROM 并非凭空拟合。特征线分析能够直接提供三类关键参数：

1. **传输延时 $\tau$**：由扰动峰值在上下游断面的到达时间差估计；
2. **主导时间常数 $T$**：由响应包络的上升/衰减趋势识别；
3. **波速 $c$ 与阻尼指标**：由特征斜率与振幅衰减估计。

这些参数可直接进入 IDZ 或传递函数结构，使 ROM 具备“物理可解释初值”，再由数据辨识做二次修正。

[图2-2: 由MOC响应提取ROM参数流程图]
{描述: 从边界扰动试验、时序响应、峰值追踪到tau/T估计，再到IDZ与传递函数初始化的流程。}
{尺寸: 半页}
{颜色方案: 蓝色系}

## 2.6 可复现实例：单级闸门扰动传播分析

【例2-1】某矩形渠段长 $L=12\,\text{km}$，稳态流速 $u_0=0.75\,\text{m/s}$，波速估计 $c=3.25\,\text{m/s}$。上游闸门在 $t=0$ 时施加小幅阶跃，观测下游控制断面主响应峰出现于 $t=2920\,\text{s}$。

**已知**：
- 亚临界流；
- 扰动幅值小，可采用线性化；
- 旁侧入流可忽略。

**求解**：
1) 由特征速度估算理论传播时间；2) 与观测值比较并讨论差异来源。

**解题过程**：

步骤1：计算下游主导特征传播速度：$u_0+c=4.00\,\text{m/s}$。  
步骤2：理论传播时间：$\tau_{th}=L/(u_0+c)=12000/4.00=3000\,\text{s}$。  
步骤3：观测传播时间：$\tau_{obs}=2920\,\text{s}$。  
步骤4：相对偏差：$|2920-3000|/3000=2.67\%$。

**结果讨论**：

偏差在工程可接受范围内，可能来源包括断面非均匀、边界执行延迟、观测噪声与局部回水影响。可将 $\tau$ 初值设为 2920–3000 s 区间，再在辨识阶段细化。

## 2.7 与国际研究的系统对比

近五年国际研究的趋势是“高保真数值模拟 + 数据同化/学习校正”。其优势是精度高、场景覆盖广；其挑战是在线部署成本高、解释门槛高。相比之下，本书强调“机理参数先验 + 数据校正”的双阶段路线，目的不是追求离线最优误差，而是追求“可上线、可维护、可回退”的运行性能。

这一路线与 CHS 的 Operational Design Domain (ODD) 与 Safety Envelope 治理逻辑一致：模型先满足边界可控，再追求局部精度提升。

## 2.8 本章小结

本章从守恒定律出发建立了 Saint-Venant 方程组，给出了关键符号与量纲检查要点，并说明了线性化在控制建模中的作用。随后通过特征线法解释了明渠扰动传播机制与亚临界流边界条件本质，进一步展示了如何由特征响应提取 ROM 所需的传输延时与主导动态参数。下一章将进入传递函数模型，给出从 PDE 到可控输入输出模型的系统化推导。

## 习题

### 基础题

1. 写出一维明渠 Saint-Venant 连续方程与动量方程，并说明各项物理意义。  
2. 为什么亚临界流需要上下游双边界条件？  
3. 在特征线法中，$C^+$ 与 $C^-$ 两族线分别代表什么信息传播方向？

### 应用题

4. 某渠段 $L=8\,\text{km}$，$u_0=0.6\,\text{m/s}$，$c=2.4\,\text{m/s}$。估算下游主导响应传播时间，并讨论若旁侧入流不可忽略该估计会如何偏移。  
5. 设计一个“边界小扰动试验方案”，用于识别 $\tau$ 与主导时间常数 $T$，需给出采样周期、观测变量与误差评价指标。

### 思考题

6. 在冰期或高含沙条件下，Manning 粗糙系数时变明显。此时应如何修改“线性化+特征线”分析流程以保持 ROM 参数有效性？

## 拓展阅读

1. Litrico, X. & Fromion, V. (2009). *Modeling and Control of Hydrosystems*.  
2. Malaterre, P.-O. et al. (1998). Simplified modeling of irrigation canals.  
3. Savic, D. et al. (2020). Data assimilation trends in hydraulic modeling.  
4. Lei et al. (2025a). 理论背景与研究范式。  
5. Lei et al. (2025c). 在环测试系统。
