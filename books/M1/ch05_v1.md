<!-- 变更日志
v1 2026-02-16: 初稿
-->

# 第五章 Muskingum类模型及其推广

---

## 学习目标

完成本章后，你应能够：

1. 解释 Muskingum 类模型的质量平衡思想与参数物理含义；
2. 写出经典 Muskingum 与 Muskingum-Cunge 离散形式；
3. 说明参数 $K, X$ 与波传播/扩散特性的关系；
4. 完成单河段洪波演算与参数率定的基础计算；
5. 对比 Muskingum、IDZ、传递函数在控制与调洪任务中的适用边界。

## 5.1 章间衔接：从控制导向模型到河道演算模型

前两章（ch03/ch04）讨论了以传递函数与 IDZ 为代表的控制导向 ROM。本章进入 Muskingum 类模型，其优势在于：以简单储蓄方程刻画洪波推进与衰减，便于在长河段或多河段串联系统中进行快速演算。

[物理直觉] 洪峰沿程传播时，既有“向下游平移”的波动，也有“被河道蓄滞削峰”的扩散。Muskingum 模型用少量参数同时刻画这两种效应。

## 5.2 经典 Muskingum 模型

### 5.2.1 连续形式与参数定义

储量假设：

$$
S=K[XI+(1-X)O]
$$

质量守恒：

$$
\frac{dS}{dt}=I-O
$$

其中 $I$ 为入流，$O$ 为出流，$K$ 为等效滞时参数，$X$ 为加权系数（通常 $0\le X\le 0.5$）。

[工程解释] $K$ 近似反映波到达时间尺度；$X$ 体现平移与扩散权重，$X$ 越大，平移性越强。

### 5.2.2 离散递推形式

在时间步长 $\Delta t$ 下，经典递推写为：

$$
O_{t+1}=C_0I_{t+1}+C_1I_t+C_2O_t
$$

其中：

$$
C_0=\frac{-KX+0.5\Delta t}{K-KX+0.5\Delta t},\quad
C_1=\frac{KX+0.5\Delta t}{K-KX+0.5\Delta t},\quad
C_2=\frac{K-KX-0.5\Delta t}{K-KX+0.5\Delta t}
$$

并满足 $C_0+C_1+C_2=1$。

[表5-1: Muskingum 模型参数与工程意义]
{描述: 汇总K、X、Δt、C0/C1/C2 的意义、约束与常见取值范围。}
{尺寸: 半页}
{颜色方案: 灰度}

## 5.3 Muskingum-Cunge 推广

Muskingum-Cunge 通过把参数与河道水力特性挂钩，提升可迁移性。其核心思路是：将数值扩散与物理扩散匹配，减少纯经验率定依赖。

[工程解释] 在工程中，Muskingum-Cunge 常用于“资料不完备但需快速调度演算”的场景，可作为高保真模型与纯经验模型之间的折中。

## 5.4 参数率定与稳定性约束

推荐率定流程：

1. 选取代表性洪水过程线；
2. 依据峰现时间差给出 $K$ 初值；
3. 依据削峰程度给出 $X$ 初值；
4. 通过 NSE、峰值误差、到时误差联合优化；
5. 检查离散稳定性与参数物理可解释性。

常见约束包括：

- $0\le X\le 0.5$；
- $\Delta t$ 不宜过大，避免相位误差放大；
- 在多河段串联时需统一时间基准与边界更新顺序。

[图5-1: Muskingum 参数率定与验证流程]
{描述: 从洪水样本选择、初值估计、优化率定到验证评估与上线门禁的流程图。}
{尺寸: 全页}
{颜色方案: 蓝色系}

## 5.5 可复现实例：单河段洪波演算

【例5-1】某河段率定参数为 $K=6\,\text{h}$、$X=0.2$，时间步长 $\Delta t=2\,\text{h}$。已知某时段入流：$I_t=220\,\text{m}^3/\text{s}$、$I_{t+1}=260\,\text{m}^3/\text{s}$，且 $O_t=200\,\text{m}^3/\text{s}$。

**求解**：计算 $O_{t+1}$。

**解题过程**：

步骤1：系数计算，分母
$$
D=K-KX+0.5\Delta t=6-1.2+1=5.8
$$

步骤2：
$$
C_0=\frac{-1.2+1}{5.8}=-0.0345,\quad
C_1=\frac{1.2+1}{5.8}=0.3793,\quad
C_2=\frac{6-1.2-1}{5.8}=0.6552
$$

步骤3：递推
$$
O_{t+1}=(-0.0345)\times260+0.3793\times220+0.6552\times200
$$
$$
O_{t+1}\approx205.9\,\text{m}^3/\text{s}
$$

**结果讨论**：

该步结果体现了“入流上升但出流响应滞后”的河道蓄滞特性。若连续时段计算中出现异常振荡，应优先检查 $\Delta t$ 与参数组合是否导致数值不稳。

[图5-2: 入流-出流过程线与洪峰平移示意]
{描述: 展示I/O两条过程线，标注洪峰时差和削峰幅度。}
{尺寸: 半页}
{颜色方案: 蓝色系}

## 5.6 与传递函数/IDZ 的系统比较

- **任务定位**：Muskingum 更偏洪水演算与河道路由；传递函数/IDZ 更偏控制器设计与在线预测；
- **参数解释**：Muskingum 参数与河道蓄滞特性绑定；IDZ 更强调积分-时滞响应；
- **计算开销**：三者均轻量，但 Muskingum 在多河段串联上更直接；
- **工程融合**：在 CHS 体系中常采用“Muskingum 作为上游路由 + IDZ/传函作为局部控制模型”的混合架构。

## 5.7 本章小结

本章给出了 Muskingum 类模型的基本方程、离散递推、参数率定与工程稳定性约束，并通过算例演示了洪波演算过程。结论是：Muskingum 类模型在河道路由与快速调度场景中具有高性价比，尤其适合与控制导向 ROM 形成分层协同。下一章将进入频率域辨识方法，讨论如何从频域数据提取可用于控制与预测的低维模型参数。

## 习题

### 基础题

1. Muskingum 参数 $K$ 与 $X$ 各代表什么物理意义？  
2. 为什么 $X$ 通常取值在 $[0,0.5]$？  
3. 递推系数 $C_0,C_1,C_2$ 为什么应满足和为 1？

### 应用题

4. 设 $K=5\,\text{h}, X=0.25, \Delta t=1\,\text{h}$，已知 $I_t=180, I_{t+1}=210, O_t=170\,\text{m}^3/\text{s}$，计算 $O_{t+1}$。  
5. 设计一个 Muskingum 参数率定方案，要求包含样本选择、目标函数、验证指标与上线门禁。

### 思考题

6. 在冰期或强人类调控（频繁闸控）条件下，Muskingum 参数可能时变。你会采用“分季节参数库”还是“在线更新参数”？请说明工程权衡。

## 拓展阅读

1. Chow, V.T. et al. (1988). *Applied Hydrology*.  
2. Cunge, J.A. (1969). On the subject of a flood propagation computation method.  
3. Litrico, X. & Fromion, V. (2009). *Modeling and Control of Hydrosystems*.  
4. ASCE (2014). *MOP 131: Canal Automation for Irrigation Systems*.  
5. Lei et al. (2025a). 理论背景与研究范式。
