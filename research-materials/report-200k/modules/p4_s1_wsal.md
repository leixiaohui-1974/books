## 4.1 从"辅助决策"到"自主运行"的演进路径

当前，全球水系统的运行管理仍然高度依赖人类调度员的经验判断和手动操作。即使是最先进的智慧水利系统，其角色也主要是"辅助决策"——为调度员提供数据、预报和方案建议，最终的决策和执行仍由人类完成。然而，随着感知技术、模型能力和AI技术的快速发展，水系统运行正在从"辅助决策"向"自主运行"演进。

这一演进并非水利领域独有的现象，而是跨领域的共同趋势。回顾其他工程领域的自主运行发展历程，可以为水系统提供有益的参照和启示。

### 4.1.1 跨领域的自主运行演进

**航空领域**。航空是人类最早实现高度自主运行的工程领域之一。1914年，劳伦斯·斯佩里（Lawrence Sperry）首次演示了飞机自动驾驶仪，实现了飞行姿态的自动保持。1947年，美国空军的C-54飞机完成了首次全自动跨大西洋飞行，包括起飞、巡航和着陆全过程。1965年，自动着陆系统（Autoland）开始在商业航空中应用，大幅提升了低能见度条件下的飞行安全。此后，飞行管理系统（FMS）、自动飞行控制系统（AFCS）持续发展，现代商用飞机在巡航阶段已实现高度自主运行。航空领域的经验表明：自主运行的核心不是取消人类，而是让人类从繁重的操纵任务中解放出来，专注于异常处置和战略决策。

**汽车领域**。SAE International制定的自动驾驶分级标准J3016是自主运行分级领域最具影响力的标准框架。该标准将自动驾驶分为L0（无自动化）到L5（完全自动化）六个等级，每个等级对应明确的人机职责划分。J3016的核心贡献在于引入了两个关键概念：运行设计域（Operational Design Domain, ODD）——定义自动驾驶系统可以正常工作的环境条件边界；以及动态驾驶任务（Dynamic Driving Task, DDT）——定义需要自动化的具体任务内容。这两个概念为自主运行的分级提供了严格的逻辑基础。如今，Waymo、百度Apollo等公司的自动驾驶出租车已在部分城市开展商业运营，处于L4水平的有限场景应用。

**电网领域**。20世纪50年代，自动发电控制（AGC）系统开始在电网中应用，实现了发电功率的自动调节。60年代，SCADA系统得到推广。80年代，能量管理系统（EMS）实现了电网的集中优化调度。2011年以来，随着新能源大规模接入，电网面临越来越大的不确定性，自主运行的需求日益迫切。智能电网的发展正在推动电力调度从集中式优化向分布式自主协调的方向演进——这与水网面临的挑战高度相似。

**工业过程控制领域**。1975年，分布式控制系统（DCS）的出现标志着工业过程控制进入分布式时代。2022年，日本横河电机公司实现了化工厂的AI自主运行35天的里程碑——在此期间，整个化工生产过程由人工智能系统全自主管理，人类操作员仅在监督岗位待命。这一事件被视为工业过程控制领域向自主运行迈进的标志性事件。

**船舶领域**。1957年，美国海军研发了第一艘自主水下航行器（AUV）。挪威Yara公司的Yara Birkeland号成为世界首艘全电动自主集装箱船。近年来，国际海事组织（IMO）正在制定海上自主水面船舶（MASS）的国际规则框架——包括自主运行分级、安全标准和法律责任等。

### 4.1.2 共同规律与水网的特殊性

上述领域的发展历程揭示了两条共同规律：

**规律一：渐进演进**。自主运行的实现是一个渐进的过程，从完全人工操作，到辅助决策，到部分自动化，到高度自动化，最终到完全自主运行。每个领域都经历了数十年的发展才达到当前水平。跳跃式发展不仅技术上难以实现，安全上更不可接受。航空领域从斯佩里的自动驾驶仪（1914年）到现代自动着陆系统的成熟应用，历经了近80年；汽车领域从DARPA Grand Challenge（2004年）到L4级自动驾驶出租车的商业运营，也经过了20年的技术积累。水系统控制的历史同样漫长——从20世纪60年代最早的SCADA应用到今天，已过去半个多世纪。但水系统在自主运行分级方面的发展明显滞后于航空和汽车，这既有技术原因（水系统的特殊复杂性），也有制度原因（水利行业对自主运行概念的接受度较低）。

**规律二：分级框架是发展的基础设施**。每个成功推进自主运行的领域，都建立了明确的分级框架——航空的CAT等级（自动着陆的I/II/IIIa/IIIb/IIIc分类）、汽车的SAE L0-L5、电网的成熟度模型、船舶的IMO MASS分级。分级框架为技术发展提供了清晰的目标牵引，为安全监管提供了评估依据，为社会接受度的培养提供了渐进路径。更深层地看，分级框架的建立本身就是一个领域从"技术探索"走向"工程成熟"的标志——它意味着该领域对自主运行的内涵、路径和边界已经形成了共识。

**规律三：安全验证是等级跃迁的瓶颈**。在所有领域中，安全验证而非技术开发是限制自主运行等级提升的主要瓶颈。自动驾驶汽车在封闭测试场可以轻松完成各种高难度场景，但要获得公共道路的L4运营许可，需要经过数百万公里的道路测试和海量的场景覆盖验证。航空领域的适航认证更是以严苛著称——一架飞机的飞行控制系统需要满足10⁻⁹（十亿分之一）级别的故障概率要求。这一规律对水系统的启示是：即使控制算法在仿真环境中表现完美，要在真实工程中获得L3或L4的自主运行授权，仍需建立完善的验证测试体系——这正是CHS提出的xIL（X-in-the-Loop）渐进验证方法论的重要性所在。

然而，水网作为自主运行的应用场景，具有不同于上述领域的特殊性：

| 比较维度 | 自动驾驶汽车 | 自主运行水网 |
| :--- | :--- | :--- |
| 系统规模 | 单车（局部系统） | 跨越数百至上千千米的网络系统 |
| 时间常数 | 毫秒-秒级响应 | 分钟-小时级（长距离调水延迟可达数天） |
| 失效后果 | 车祸（局部性） | 洪水/断水（区域性、社会性） |
| 环境不确定性 | 交通流、天气、行人 | 来水不确定性、需求变化、设施老化、冰期 |
| 传感覆盖度 | 高密度多模态传感 | 稀疏传感，大量区域不可观 |
| 执行器响应 | 毫秒级（电机驱动） | 分钟级（水力闸门）到小时级（水库蓄放） |
| 社会感知度 | 公众高度关注 | 相对"隐形"但后果可能更严重 |

这些特殊性决定了水网的自主运行分级不能简单照搬SAE J3016，需要根据水利系统的固有特征进行针对性设计。具体而言，水网的特殊性对分级框架的设计提出了以下独特要求：

**"慢系统"的预见性要求**。自动驾驶汽车的决策周期是毫秒级的——在0.1秒内必须做出转向或刹车决策。水系统的决策周期是分钟到小时级的，但需要提前数小时到数天进行预测和预控。这意味着水系统的自主运行不是"快速反应"问题，而是"长程预见"问题。水系统的L3等级不要求毫秒级的实时决策能力，而要求数小时到数天尺度的精准预测和预控能力。

**网络效应的级联风险**。自动驾驶汽车的失效是局部性的——一辆车出事不会导致所有车出事。但水网是一个紧密耦合的网络系统，上游的控制失误会通过水力波动级联传播到下游，可能引发系统级的连锁反应。这种网络级联效应要求水系统的安全包络不仅要定义在单个节点层面，还必须在网络层面进行协调——确保全网范围内不存在导致级联失效的运行状态。

**不可逆性与社会影响**。自动驾驶汽车的失控可以通过紧急制动在数秒内停止。但水系统的调度决策一旦执行，其后果在短时间内是不可逆的——水库泄洪后水量无法回收，渠道超量供水后多余的水无法立即排出。这种不可逆性要求水系统自主运行必须有更强的"先验安全"机制——在做出决策之前就能预判其后果是否安全，而非事后补救。

值得强调的是：**水网是最后一个没有建立L0-L5自主运行分级体系的重大工程领域**。航空有飞行自动化等级，汽车有SAE J3016，电网有智能电网成熟度模型，船舶有IMO的MASS分级，但水网至今没有一个类似的分级框架来描述和评估其自主运行水平。这一空白，正是WSAL概念提出的背景和动因。WSAL的提出，不仅是一个技术分级标准的建立，更是一种范式转换——它第一次将水利工程的运行管理从"人控"思维转向"人机协同与自主运行"思维，为水利行业拥抱自主运行时代提供了概念基础和路线图。

## 4.2 WSAL：水网自主等级分级体系

### 4.2.1 WSAL的基本定义

WSAL（Water Systems Autonomy Levels，水网自主等级）是雷晓辉教授在水系统控制论（CHS）框架下提出的分级体系，用于描述和评估水系统自主运行的程度。WSAL借鉴了SAE J3016自动驾驶分级的思想，同时针对水利系统的特殊性进行了适配设计，将水系统的自主运行水平分为L0到L5六个等级。

WSAL的设计遵循三条基本原则：**渐进性**——从L0到L5的演进是渐进的，每一级都建立在前一级的基础之上，不鼓励跳级；**可验证性**——每一级的定义必须是可测试、可评估的，而非模糊的定性描述；**安全保底**——在任何等级、任何工况下，系统都必须能够退回到安全状态，安全性不因自主等级的提升而降低。

从概念架构上看，WSAL沿用了SAE J3016的核心逻辑——按照"人机职责划分"来定义自主等级，但在以下方面进行了水利特色的适配：第一，将SAE中的"动态驾驶任务"（DDT）替换为"水网动态运行任务"（Dynamic Water Network Operation Task, DWNOT），包括实时水位/流量监测、闸站调度决策、执行指令下达、异常工况识别和应急响应等；第二，将SAE中面向单车的ODD扩展为面向网络系统的ODD——水网的ODD不仅涉及单个设施的运行条件，还涉及网络拓扑、上下游耦合、多源多汇的系统级条件；第三，增加了"可观性约束"维度——水系统的传感覆盖度远低于自动驾驶汽车，大量系统状态不可直接观测，需要通过模型推算，这一特征在自主运行等级定义中必须予以体现。

在定义WSAL之前，需要先明确两个基础概念：

**运行设计域（Operational Design Domain, ODD）**。ODD定义了自主运行系统可以正常工作的环境条件集合。对于水系统而言，ODD包括：来水条件范围（枯水/平水/丰水/洪水/冰期）、用水需求范围、水质条件范围、设备可用性条件、通信条件等。ODD的边界定义了系统"可以自主运行"和"需要人工接管"的临界条件。

**最小风险状态（Minimum Risk Condition, MRC）**。MRC是当系统运行条件超出ODD边界或发生严重故障时，系统应达到的安全状态。对于水系统而言，MRC可能包括：所有闸门保持当前开度不变（静止模式）、所有闸门全开或全关至安全位置、泵站紧急停机等。MRC的设计原则是：在任何情况下，系统都能够安全地退出自主运行模式，不会导致灾难性后果。

### 4.2.2 WSAL六级定义

| 等级 | 名称 | 人机角色分工 | ODD范围 | 核心技术要求 |
| :--- | :--- | :--- | :--- | :--- |
| L0 | 人工运行 | 人类完成全部感知、决策和执行 | 不适用 | 水尺、电话、纸质调度规程 |
| L1 | 辅助监控 | 系统提供监测数据和报警，人类完成决策和执行 | 不适用 | SCADA系统、远程监控 |
| L2 | 辅助决策 | 系统提供决策建议（预报+方案），人类确认后执行 | 不适用 | 水动力模型、优化算法、数字孪生 |
| L3 | 条件自主 | 在ODD范围内系统自主决策和执行，人类监督并随时接管 | 受限ODD | MPC/DMPC、安全包络、接管机制 |
| L4 | 高度自主 | 在扩展ODD范围内系统自主运行，异常时自动执行MRC | 扩展ODD | 自适应控制、在线学习、MRC自动执行 |
| L5 | 完全自主 | 系统在全工况域内自主运行，人类仅做战略监督 | 全工况域 | 通用水利智能体、自演化系统 |

**L0：人工运行**。系统没有任何自动化辅助。调度员依靠现场巡视或电话汇报获取水情信息，根据经验和规程做出调度决策，通过人工操作闸门、泵站等设备执行决策。中国目前仍有大量小型水利工程处于这一水平。

**L1：辅助监控**。系统通过SCADA等技术实现了远程数据采集和设备远程控制，但决策完全由人类完成。SCADA系统的角色是"帮人看得更远、手伸得更长"，不参与决策过程。中国大中型水利工程普遍达到了L1水平。

**L2：辅助决策**。系统不仅提供监测数据，还运行数学模型和优化算法，为调度员提供预报信息和调度方案建议。但最终的决策权仍在人类——调度员可以采纳系统建议，也可以根据自身判断进行修改。当前中国最先进的智慧水利系统大致处于L2水平。"四预"功能本质上就是L2级能力的水利化表达。

**L3：条件自主**。这是一个质变性的等级——系统在定义明确的ODD范围内，可以自主完成"感知→决策→执行→反馈"的完整闭环，不需要人类实时干预。但有两个重要的限制条件：一是ODD范围是受限的（例如仅限常规工况，不包括极端洪水、冰期等），二是人类调度员必须在"回路上"（on-the-loop）监督系统运行，随时准备接管。L3的核心技术要求包括：基于MPC/DMPC的实时优化控制、安全包络（Safety Envelope）机制（确保系统状态始终在安全范围内）、以及规范化的人工接管流程。L3是当前技术条件下最现实的近期目标。

L3等级的工程实施需要解决一个关键的"信任建立"问题。调度员需要经历从"由我决策"到"由机器决策、我来监督"的心理转变。工程实践表明，这一转变需要经历三个阶段："影子运行"阶段（系统在后台运行自主控制算法，但不实际执行，调度员对比系统建议与自己的决策差异，逐步建立对系统能力的认知）；"有限授权"阶段（在特定时段或特定工况下，允许系统自主执行，但调度员全程监督并可随时接管）；"常态自主"阶段（系统在ODD内常态化自主运行，调度员仅在异常时介入）。这一渐进授权过程，是L3成功实施的社会技术基础。

**L4：高度自主**。系统在比L3更广泛的ODD范围内实现自主运行。与L3的关键区别在于：当运行条件超出ODD边界时，L4系统能够自动识别这一情况并自主执行最小风险状态（MRC），而不需要人类接管。这意味着L4系统在异常情况下也能保证安全——即使通信中断、人类无法及时干预，系统也能自主退到安全状态。L4的核心技术要求包括：自适应控制（能够在模型参数变化时自动校正）、在线学习（从运行经验中持续优化策略）、ODD边界的实时监测和判断、以及MRC的自动执行和验证。

**L5：完全自主**。系统在全工况域内实现自主运行，不需要定义ODD边界——因为系统能够处理所有可能遇到的工况。人类的角色完全退到"战略监督"层面，不参与日常运行决策。L5是一个理想化的长远目标，在可预见的未来（10-20年内）难以实现。它可能需要通用人工智能（AGI）水平的技术突破，以及对水利系统物理过程的近乎完美的理解和建模能力。

### 4.2.3 ODD的结构化定义

WSAL的核心技术概念之一是ODD的结构化定义。在SAE J3016中，ODD被定义为自动驾驶系统设计适用的具体运行条件（包括但不限于地理区域、道路类型、速度范围、天气条件等）。在WSAL框架中，水系统的ODD需要从以下维度进行结构化定义：

| ODD维度 | 具体要素 | 示例条件范围 |
| :--- | :--- | :--- |
| 水文条件 | 来水流量/水位范围 | Q ∈ [Q_min, Q_max], H ∈ [H_min, H_max] |
| 气象条件 | 气温、降雨、冰冻 | T > 0°C（非冰期），P < P_alarm（非暴雨） |
| 需求条件 | 用水需求变化范围 | D ∈ [D_min, D_max]，变化率 ≤ ΔD_max |
| 设备条件 | 闸门/泵站可用性 | 可用率 ≥ 95%，备用设备可切换 |
| 通信条件 | 传感器和通信链路状态 | 丢包率 < 5%，延迟 < T_comm_max |
| 水质条件 | 水质参数范围 | 无突发污染事件 |

ODD的数学表达可以形式化为这些维度的笛卡尔积的一个子集：

$$ODD = \{(q, t, d, e, c, w) \mid q \in \mathcal{Q}, t \in \mathcal{T}, d \in \mathcal{D}, e \in \mathcal{E}, c \in \mathcal{C}, w \in \mathcal{W}\}$$

其中每个维度集合都有明确的上下界。当系统的实际运行条件落在ODD内时，自主运行系统负责决策和执行；当运行条件超出ODD边界时，系统必须触发退出机制（L3：请求人工接管；L4：自动执行MRC）。

ODD的定义不是一次性的，而是随着技术进步和运行经验积累而逐步扩展的。从L3到L4到L5的升级过程，本质上就是ODD范围不断扩展的过程——从受限ODD到扩展ODD再到全工况域。

ODD的工程化定义面临几个实践挑战。**维度组合爆炸**：上述六个ODD维度的组合空间极为庞大——即使每个维度只划分为3个等级（低/中/高），组合数也达到3⁶=729种。对每种组合都进行完整的安全验证是不现实的，需要发展基于可达集分析（Reachable Set Analysis）等方法的高效验证技术，从数学上证明安全约束在整个ODD范围内的满足性，而不是逐点验证。**边界模糊性**：物理系统的ODD边界往往不是清晰的阈值，而是渐变的"灰区"——例如，从"非冰期"到"冰期"的过渡不是在某个温度瞬间发生的，而是一个持续数天的渐变过程。ODD边界定义需要处理这种模糊性，可能需要引入模糊集合或概率性的边界描述。**动态ODD**：水系统的ODD可能随时间动态变化——河道淤积会改变安全水位上限，设备老化会改变可用性条件，气候变化会改变来水统计特征。系统需要具备ODD的自动更新能力，根据最新的工程状况和水文统计重新计算ODD边界。

### 4.2.4 安全包络与最小风险状态

安全包络（Safety Envelope）是WSAL L3及以上等级的核心安全机制。安全包络定义了系统状态变量的安全边界，确保在自主运行过程中系统状态始终保持在安全范围内：

$$\mathcal{X}_{safe} = \{x \mid h_i(x) \leq 0, \, i = 1, \ldots, m\}$$

其中 $h_i(x)$ 是安全约束函数。例如，对于一个调水渠道，安全包络可能包括：各节点水位不超过渠堤高程的安全余量、各节点水位不低于最小工作水深、闸门开度在物理限幅范围内、闸门开度变化速率不超过机械限制等。

安全包络与MPC优化目标之间的关系是：安全包络是硬约束，MPC优化目标是软目标。当两者发生冲突时，安全包络优先——即使牺牲供水效率或偏离目标水位，也必须保证系统状态不突破安全边界。这一"安全优先"的设计原则，与航空领域的"安全第一"理念和汽车领域的功能安全标准（ISO 26262的ASIL等级）一脉相承。

最小风险状态（MRC）的设计原则遵循"失效安全"（Fail-Safe）理念。对于不同类型的水利工程，MRC的具体定义有所不同：对于调水渠道，MRC通常是"闸门保持当前开度，泵站维持当前工况"（静止模式），避免任何可能恶化局势的操作；对于防洪系统，MRC可能是"闸门全开，最大化泄洪能力"；对于供水系统，MRC可能是"维持最低保障供水量"。MRC的执行必须是自动化的、不依赖通信的——因为触发MRC的场景往往伴随着通信故障或其他异常。

安全包络的实时计算是一个技术难点。由于水系统的状态空间是连续的、高维的，直接计算安全集合$\mathcal{X}_{safe}$在当前模型预测时域内的可达性（即判断"从当前状态出发，在所有可能的扰动下，系统是否可能越过安全边界"）是一个计算量极大的问题。实践中，常用的方法包括：**显式约束**方法——将安全约束直接作为MPC的硬约束，由优化器保证满足，但这要求优化器具有处理硬约束的能力且求解必须在规定时间内完成；**安全裕度**方法——在安全边界上预留一定的裕度（如水位安全上限取渠顶高程减30cm而非仅减10cm），以吸收模型误差和执行延迟带来的不确定性；**控制屏障函数**（Control Barrier Function, CBF）方法——定义一个随系统状态连续变化的屏障函数，当系统状态接近安全边界时，屏障函数趋向零，强制控制器采取保守行动避免越界。CBF方法具有计算高效且形式化安全保证的优点，是当前安全控制领域的研究前沿。

### 4.2.5 WSAL的工程映射

将WSAL框架映射到中国现有水利工程的实际状况，可以形成以下评估：

| 工程类型 | 当前主流水平 | 近期目标（5年） | 中期目标（10年） |
| :--- | :--- | :--- | :--- |
| 大型水库（三峡、丹江口等） | L1-L2 | L2-L3 | L3-L4 |
| 南水北调中线 | L1-L2 | L3（常规工况） | L3-L4 |
| 胶东调水 | L2（部分渠段L3试点） | L3 | L4 |
| 大中型灌区 | L0-L1 | L1-L2 | L2-L3 |
| 城市供水管网 | L1-L2 | L2-L3 | L3 |
| 小型农村水利 | L0 | L0-L1 | L1 |

这一映射揭示了几个重要事实：第一，中国水利工程的自主运行水平整体处于L0-L2阶段，距离L3（条件自主）还有明确的技术和标准差距；第二，不同类型工程的发展节奏差异显著——大型工程有望在5-10年内达到L3-L4，而小型工程的智能化仍是长期任务；第三，胶东调水工程在L3试点方面走在前列，有望成为中国首个达到WSAL L3水平的大型调水工程。

**从L2到L3的跃迁要求**。L2到L3是WSAL分级中最关键的一次跃迁，因为它标志着从"人类决策、机器辅助"到"机器决策、人类监督"的根本转变。实现这一跃迁需要满足以下最低要求：控制系统必须具备完整的闭环自动控制能力（不仅仅是方案建议，还要能自动执行）；安全包络机制必须经过严格的SIL和HIL验证，证明在所有ODD内的工况组合下系统状态不会突破安全边界；人工接管机制必须经过实战演练，确保在系统退出自主模式时能够平滑过渡到人工控制而不引发扰动；ODD的定义必须经过形式化验证——不是简单地列出"大概的适用范围"，而是对每个ODD维度给出精确的数学边界并证明系统在边界内的安全性。

**从L3到L4的跃迁要求**。L3到L4的核心差异在于异常处理能力——L3系统在遇到超出ODD的情况时"请求人工接管"，而L4系统能够"自主执行MRC"。这意味着L4系统必须具备三项L3不要求的关键能力：ODD边界的实时自主监测和判断（系统需要自己判断"当前是否仍在ODD内"，而不是依赖人工预先设定的阈值告警）；MRC策略的自动选择和执行（不同的异常场景需要不同的MRC策略，系统需要根据异常类型自主选择最合适的MRC）；以及通信中断条件下的独立安全运行能力（L4系统必须能在失去与上级控制中心通信的情况下，依靠本地资源维持安全运行）。

**国际对标分析**。将WSAL映射到全球范围，可以发现：荷兰Maeslantkering风暴潮屏障在特定触发条件下的自主关闭操作达到了L3水平（但其ODD极为狭窄，仅限于风暴潮超过设定阈值这一单一场景）；澳大利亚Rubicon Water的TCC系统在灌区渠道控制中达到了L3水平（ODD覆盖常规灌溉工况）；日本横河电机在化工厂实现的35天AI自主运行可类比为L4水平（在扩展的ODD内系统自主处理了多种工况变化）。全球范围内，尚无水利工程达到L5水平，L4也仅在极少数特定场景中有所探索。这一现状说明，水利行业的自主运行之路仍处于起步阶段，WSAL框架的提出恰逢其时。

### 4.2.6 WSAL与xIL验证的对应关系

WSAL的每一级跃迁都需要通过严格的验证才能被认定。CHS框架提出的xIL（X-in-the-Loop）验证体系，为WSAL等级认定提供了方法论支撑：

| WSAL等级 | 必须通过的验证阶段 | 验证要求 |
| :--- | :--- | :--- |
| L1→L2 | MIL（模型在回路） | 模型精度验证：预报和优化结果与实测数据的偏差在可接受范围内 |
| L2→L3 | MIL + SIL（软件在回路） | 控制软件在仿真环境中的功能验证和安全约束满足验证 |
| L3→L4 | MIL + SIL + HIL（硬件在回路） | 控制系统在含真实硬件的半实物仿真环境中的性能和安全验证 |
| L4→L5 | MIL + SIL + HIL + PIL（现场在回路） | 控制系统在实际工程现场的影子运行和渐进授权验证 |

这一渐进式验证流程借鉴了航空领域的适航认证和汽车领域的功能安全认证理念，确保每一级自主运行水平的提升都经过了充分的安全验证。关于xIL验证体系的详细介绍，将在§4.5中展开。
